{"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-physics/pullrequests/100/comments/115210838.json"}, "code": {"href": "https://api.bitbucket.org/2.0/repositories/ignitionrobotics/ign-physics/diff/ignitionrobotics/ign-physics:86c76a3c434d..4eeae2be4fa1?path=include%2Fignition%2Fphysics%2FJoint.hh"}, "html": {"href": "#!/ignitionrobotics/ign-physics/pull-requests/100/_/diff#comment-115210838"}}, "parent": {"id": 115066982, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-physics/pullrequests/100/comments/115066982.json"}, "html": {"href": "#!/ignitionrobotics/ign-physics/pull-requests/100/_/diff#comment-115066982"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 100, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-physics/pullrequests/100.json"}, "html": {"href": "#!/ignitionrobotics/ign-physics/pull-requests/100"}}, "title": "SetJointVelocityCommand feature"}, "content": {"raw": "To make this documentation \u201ccorrect\u201d, I think it would be sufficient to mention that the specified force limits of the joint will be respected. Of course the joint may be given an infinite force limit, in which case an arbitrarily large change in velocity will be permitted by the physics engine.\n\n> Instead, it is necessary to apply an impulse \\(i.e. an infinite amount of torque/effort\\), as done in this case by the DART implementation\n\nThis is not always true. The impulse you\u2019re seeing there is to enforce a position limit constraint. For a commanded velocity constraint, DART instead uses inverse dynamics to directly compute what joint force is needed in order to achieve the requested joint velocity by the next simulation step. If that joint force exceeds the joint force limit, then it gets clamped. That computed force is then used as the joint force in the forward time step.\n\nIn ODE this is handled differently. Instead of directly computed the necessary joint force, ODE adds an additional constraint to the system of equations that it\u2019s solving for its physics update. The additional constraint dictates that the joint velocity should try to reach the commanded value without violating the joint force limit. In this case the necessary joint force will hopefully be found implicitly by solving the constrained system of equations.", "markup": "markdown", "html": "<p>To make this documentation \u201ccorrect\u201d, I think it would be sufficient to mention that the specified force limits of the joint will be respected. Of course the joint may be given an infinite force limit, in which case an arbitrarily large change in velocity will be permitted by the physics engine.</p>\n<blockquote>\n<p>Instead, it is necessary to apply an impulse (i.e. an infinite amount of torque/effort), as done in this case by the DART implementation</p>\n</blockquote>\n<p>This is not always true. The impulse you\u2019re seeing there is to enforce a position limit constraint. For a commanded velocity constraint, DART instead uses inverse dynamics to directly compute what joint force is needed in order to achieve the requested joint velocity by the next simulation step. If that joint force exceeds the joint force limit, then it gets clamped. That computed force is then used as the joint force in the forward time step.</p>\n<p>In ODE this is handled differently. Instead of directly computed the necessary joint force, ODE adds an additional constraint to the system of equations that it\u2019s solving for its physics update. The additional constraint dictates that the joint velocity should try to reach the commanded value without violating the joint force limit. In this case the necessary joint force will hopefully be found implicitly by solving the constrained system of equations.</p>", "type": "rendered"}, "created_on": "2019-09-02T03:20:09.619785+00:00", "user": {"display_name": "Michael Grey", "uuid": "{c1cdfe52-2887-474c-ae99-72fdc53a59c9}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Bc1cdfe52-2887-474c-ae99-72fdc53a59c9%7D"}, "html": {"href": "https://bitbucket.org/%7Bc1cdfe52-2887-474c-ae99-72fdc53a59c9%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:67759e29-d1df-465f-868d-047738e36fc9/d42d74cf-c1bd-4431-8288-07f543bbe325/128"}}, "nickname": "mxgrey", "type": "user", "account_id": "557058:67759e29-d1df-465f-868d-047738e36fc9"}, "inline": {"to": 326, "from": null, "outdated": false, "path": "include/ignition/physics/Joint.hh"}, "updated_on": "2019-09-02T03:20:09.628906+00:00", "type": "pullrequest_comment", "id": 115210838}