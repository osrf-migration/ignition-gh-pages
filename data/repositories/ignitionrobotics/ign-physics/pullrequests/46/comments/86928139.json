{"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-physics/pullrequests/46/comments/86928139.json"}, "code": {"href": "https://api.bitbucket.org/2.0/repositories/ignitionrobotics/ign-physics/diff/ignitionrobotics/ign-physics:3ad751997e5a..79bf3aa1b63b?path=dartsim%2Fsrc%2FLinkFeatures_TEST.cc"}, "html": {"href": "#!/ignitionrobotics/ign-physics/pull-requests/46/_/diff#comment-86928139"}}, "parent": {"id": 86099693, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-physics/pullrequests/46/comments/86099693.json"}, "html": {"href": "#!/ignitionrobotics/ign-physics/pull-requests/46/_/diff#comment-86099693"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 46, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-physics/pullrequests/46.json"}, "html": {"href": "#!/ignitionrobotics/ign-physics/pull-requests/46"}}, "title": "[WIP] Add Link features"}, "content": {"raw": ">  I don\u2019t know why this issue is not detected by the test in https://bitbucket.org/osrf/gazebo/src/42e1138a7af08d199df7e78ece2a5ae573f52c35/test/integration/physics_link.cc#lines-145\n\nThe test you linked to doesn't check the position after setting the angular velocity so it can't detect this issue. It also seems like the problem only occurs when the angular velocity vector is not aligned with one of the principal axes of the link. In the test you linked, the angular velocity is set to `(0, 2.0, 0)`. Setting it to something like `(0.1, 2.0, 0)` might expose the problem.\n\n> but perhaps the appropriate methods to call is FreeJoint::setAngularVelocity ( https://github.com/dartsim/dart/blob/a206b1995a4c4ee96de691351cb109b808d0a347/dart/dynamics/FreeJoint.hpp#L205 )\n\nThanks for pointing this out. I had simply copied the implementation from [DARTLink::SetAngularVel](https://bitbucket.org/osrf/gazebo/src/582827025ea59c832cc50e33d64a07ae13cad76a/gazebo/physics/dart/DARTLink.cc?at=default&fileviewer=file-view-default#DARTLink.cc-417). `FreeJoint::setAngularVelocity` was added in DART 6 and seems to do what we need, so I don't see why we can't use it. See 3ad7519. However, the issue of unexpected translation still remains with this change.", "markup": "markdown", "html": "<blockquote>\n<p>I don\u2019t know why this issue is not detected by the test in <a href=\"https://bitbucket.org/osrf/gazebo/src/42e1138a7af08d199df7e78ece2a5ae573f52c35/test/integration/physics_link.cc#lines-145\" rel=\"nofollow\" class=\"ap-connect-link\">https://bitbucket.org/osrf/gazebo/src/42e1138a7af08d199df7e78ece2a5ae573f52c35/test/integration/physics_link.cc#lines-145</a></p>\n</blockquote>\n<p>The test you linked to doesn't check the position after setting the angular velocity so it can't detect this issue. It also seems like the problem only occurs when the angular velocity vector is not aligned with one of the principal axes of the link. In the test you linked, the angular velocity is set to <code>(0, 2.0, 0)</code>. Setting it to something like <code>(0.1, 2.0, 0)</code> might expose the problem.</p>\n<blockquote>\n<p>but perhaps the appropriate methods to call is FreeJoint::setAngularVelocity ( <a href=\"https://github.com/dartsim/dart/blob/a206b1995a4c4ee96de691351cb109b808d0a347/dart/dynamics/FreeJoint.hpp#L205\" rel=\"nofollow\" class=\"ap-connect-link\">https://github.com/dartsim/dart/blob/a206b1995a4c4ee96de691351cb109b808d0a347/dart/dynamics/FreeJoint.hpp#L205</a> )</p>\n</blockquote>\n<p>Thanks for pointing this out. I had simply copied the implementation from <a data-is-external-link=\"true\" href=\"https://bitbucket.org/osrf/gazebo/src/582827025ea59c832cc50e33d64a07ae13cad76a/gazebo/physics/dart/DARTLink.cc?at=default&amp;fileviewer=file-view-default#DARTLink.cc-417\" rel=\"nofollow\">DARTLink::SetAngularVel</a>. <code>FreeJoint::setAngularVelocity</code> was added in DART 6 and seems to do what we need, so I don't see why we can't use it. See <a href=\"#!/ignitionrobotics/ign-physics/commits/3ad7519\" rel=\"nofollow\" class=\"ap-connect-link\">3ad7519</a>. However, the issue of unexpected translation still remains with this change.</p>", "type": "rendered"}, "created_on": "2019-01-03T00:40:52.080711+00:00", "user": {"display_name": "Addisu Z. Taddese", "uuid": "{9d7fdc68-d270-4080-bf03-4df0d0dbf635}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B9d7fdc68-d270-4080-bf03-4df0d0dbf635%7D"}, "html": {"href": "https://bitbucket.org/%7B9d7fdc68-d270-4080-bf03-4df0d0dbf635%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:90bc87b0-2886-4377-a17c-3a6629a697ff/afbf9be5-1e4c-4810-89d4-e58831f34b11/128"}}, "nickname": "azeey", "type": "user", "account_id": "557058:90bc87b0-2886-4377-a17c-3a6629a697ff"}, "inline": {"to": 134, "from": null, "outdated": true, "path": "dartsim/src/LinkFeatures_TEST.cc"}, "updated_on": "2019-01-03T00:40:52.090662+00:00", "type": "pullrequest_comment", "id": 86928139}