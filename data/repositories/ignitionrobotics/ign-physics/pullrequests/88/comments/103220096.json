{"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-physics/pullrequests/88/comments/103220096.json"}, "html": {"href": "#!/ignitionrobotics/ign-physics/pull-requests/88/_/diff#comment-103220096"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 88, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-physics/pullrequests/88.json"}, "html": {"href": "#!/ignitionrobotics/ign-physics/pull-requests/88"}}, "title": "[Citadel] Improve compile times"}, "content": {"raw": "also, several tests appear to pass but dump a core during teardown\n\n~~~\n$ bin/UNIT_EntityManagement_TEST \n[==========] Running 2 tests from 1 test case.\n[----------] Global test environment set-up.\n[----------] 2 tests from EntityManagement_TEST\n[ RUN      ] EntityManagement_TEST.ConstructEmptyWorld\n[       OK ] EntityManagement_TEST.ConstructEmptyWorld (41 ms)\n[ RUN      ] EntityManagement_TEST.RemoveEntities\n[       OK ] EntityManagement_TEST.RemoveEntities (0 ms)\n[----------] 2 tests from EntityManagement_TEST (41 ms total)\n\n[----------] Global test environment tear-down\n[==========] 2 tests from 1 test case ran. (41 ms total)\n[  PASSED  ] 2 tests.\ndouble free or corruption (fasttop)\nAborted (core dumped)\n~~~\n\n~~~\n(gdb) r\nStarting program: build/ignition-physics2/bin/UNIT_SimulationFeatures_TEST \n[Thread debugging using libthread_db enabled]\nUsing host libthread_db library \"/lib/x86_64-linux-gnu/libthread_db.so.1\".\n[==========] Running 6 tests from 1 test case.\n[----------] Global test environment set-up.\n[----------] 6 tests from PhysicsPlugins/SimulationFeatures_TEST\n[ RUN      ] PhysicsPlugins/SimulationFeatures_TEST.Falling/0\nTesting library build/ignition-physics2/lib/libignition-physics2-dartsim-plugin.so.2.0.0~pre0\n -- Plugin name: ignition::physics::dartsim::Plugin\n[       OK ] PhysicsPlugins/SimulationFeatures_TEST.Falling/0 (984 ms)\n[ RUN      ] PhysicsPlugins/SimulationFeatures_TEST.Falling/1\n[       OK ] PhysicsPlugins/SimulationFeatures_TEST.Falling/1 (0 ms)\n[ RUN      ] PhysicsPlugins/SimulationFeatures_TEST.ShapeBoundingBox/0\n -- Plugin name: ignition::physics::dartsim::Plugin\n[       OK ] PhysicsPlugins/SimulationFeatures_TEST.ShapeBoundingBox/0 (49 ms)\n[ RUN      ] PhysicsPlugins/SimulationFeatures_TEST.ShapeBoundingBox/1\n[       OK ] PhysicsPlugins/SimulationFeatures_TEST.ShapeBoundingBox/1 (0 ms)\n[ RUN      ] PhysicsPlugins/SimulationFeatures_TEST.RetrieveContacts/0\n -- Plugin name: ignition::physics::dartsim::Plugin\n[       OK ] PhysicsPlugins/SimulationFeatures_TEST.RetrieveContacts/0 (60 ms)\n[ RUN      ] PhysicsPlugins/SimulationFeatures_TEST.RetrieveContacts/1\n[       OK ] PhysicsPlugins/SimulationFeatures_TEST.RetrieveContacts/1 (0 ms)\n[----------] 6 tests from PhysicsPlugins/SimulationFeatures_TEST (1093 ms total)\n\n[----------] Global test environment tear-down\n[==========] 6 tests from 1 test case ran. (1093 ms total)\n[  PASSED  ] 6 tests.\ndouble free or corruption (fasttop)\n\nProgram received signal SIGABRT, Aborted.\n__GI_raise (sig=sig@entry=6) at ../sysdeps/unix/sysv/linux/raise.c:51\n51\t../sysdeps/unix/sysv/linux/raise.c: No such file or directory.\n(gdb) bt\n#0  __GI_raise (sig=sig@entry=6) at ../sysdeps/unix/sysv/linux/raise.c:51\n#1  0x00007ffff5e2d801 in __GI_abort () at abort.c:79\n#2  0x00007ffff5e76897 in __libc_message (action=action@entry=do_abort, fmt=fmt@entry=0x7ffff5fa3b9a \"%s\\n\") at ../sysdeps/posix/libc_fatal.c:181\n#3  0x00007ffff5e7d90a in malloc_printerr (str=str@entry=0x7ffff5fa5828 \"double free or corruption (fasttop)\") at malloc.c:5350\n#4  0x00007ffff5e85004 in _int_free (have_lock=0, p=0x5555558a5960, av=0x7ffff61d8c40 <main_arena>) at malloc.c:4230\n#5  __GI___libc_free (mem=0x5555558a5970) at malloc.c:3124\n#6  0x00007ffff5e30041 in __run_exit_handlers (status=0, listp=0x7ffff61d8718 <__exit_funcs>, run_list_atexit=run_list_atexit@entry=true, run_dtors=run_dtors@entry=true) at exit.c:108\n#7  0x00007ffff5e3013a in __GI_exit (status=<optimized out>) at exit.c:139\n#8  0x00007ffff5e0eb9e in __libc_start_main (main=0x555555577770 <main(int, char**)>, argc=1, argv=0x7fffffffe318, init=<optimized out>, fini=<optimized out>, rtld_fini=<optimized out>, stack_end=0x7fffffffe308)\n    at ../csu/libc-start.c:344\n#9  0x0000555555577eea in _start () at /usr/include/c++/8/ext/new_allocator.h:116\n(gdb)\n~~~", "markup": "markdown", "html": "<p>also, several tests appear to pass but dump a core during teardown</p>\n<div class=\"codehilite\"><pre><span></span>$ bin/UNIT_EntityManagement_TEST \n<span class=\"o\">[==========]</span> Running <span class=\"m\">2</span> tests from <span class=\"m\">1</span> <span class=\"nb\">test</span> <span class=\"k\">case</span>.\n<span class=\"o\">[</span>----------<span class=\"o\">]</span> Global <span class=\"nb\">test</span> environment set-up.\n<span class=\"o\">[</span>----------<span class=\"o\">]</span> <span class=\"m\">2</span> tests from EntityManagement_TEST\n<span class=\"o\">[</span> RUN      <span class=\"o\">]</span> EntityManagement_TEST.ConstructEmptyWorld\n<span class=\"o\">[</span>       OK <span class=\"o\">]</span> EntityManagement_TEST.ConstructEmptyWorld <span class=\"o\">(</span><span class=\"m\">41</span> ms<span class=\"o\">)</span>\n<span class=\"o\">[</span> RUN      <span class=\"o\">]</span> EntityManagement_TEST.RemoveEntities\n<span class=\"o\">[</span>       OK <span class=\"o\">]</span> EntityManagement_TEST.RemoveEntities <span class=\"o\">(</span><span class=\"m\">0</span> ms<span class=\"o\">)</span>\n<span class=\"o\">[</span>----------<span class=\"o\">]</span> <span class=\"m\">2</span> tests from EntityManagement_TEST <span class=\"o\">(</span><span class=\"m\">41</span> ms total<span class=\"o\">)</span>\n\n<span class=\"o\">[</span>----------<span class=\"o\">]</span> Global <span class=\"nb\">test</span> environment tear-down\n<span class=\"o\">[==========]</span> <span class=\"m\">2</span> tests from <span class=\"m\">1</span> <span class=\"nb\">test</span> <span class=\"k\">case</span> ran. <span class=\"o\">(</span><span class=\"m\">41</span> ms total<span class=\"o\">)</span>\n<span class=\"o\">[</span>  PASSED  <span class=\"o\">]</span> <span class=\"m\">2</span> tests.\ndouble free or corruption <span class=\"o\">(</span>fasttop<span class=\"o\">)</span>\nAborted <span class=\"o\">(</span>core dumped<span class=\"o\">)</span>\n</pre></div>\n\n\n<div class=\"codehilite\"><pre><span></span>(gdb) r\nStarting program: build/ignition-physics2/bin/UNIT_SimulationFeatures_TEST \n[Thread debugging using libthread_db enabled]\nUsing host libthread_db library &quot;/lib/x86_64-linux-gnu/libthread_db.so.1&quot;.\n[==========] Running 6 tests from 1 test case.\n[----------] Global test environment set-up.\n[----------] 6 tests from PhysicsPlugins/SimulationFeatures_TEST\n[ RUN      ] PhysicsPlugins/SimulationFeatures_TEST.Falling/0\nTesting library build/ignition-physics2/lib/libignition-physics2-dartsim-plugin.so.2.0.0~pre0\n -- Plugin name: ignition::physics::dartsim::Plugin\n[       OK ] PhysicsPlugins/SimulationFeatures_TEST.Falling/0 (984 ms)\n[ RUN      ] PhysicsPlugins/SimulationFeatures_TEST.Falling/1\n[       OK ] PhysicsPlugins/SimulationFeatures_TEST.Falling/1 (0 ms)\n[ RUN      ] PhysicsPlugins/SimulationFeatures_TEST.ShapeBoundingBox/0\n -- Plugin name: ignition::physics::dartsim::Plugin\n[       OK ] PhysicsPlugins/SimulationFeatures_TEST.ShapeBoundingBox/0 (49 ms)\n[ RUN      ] PhysicsPlugins/SimulationFeatures_TEST.ShapeBoundingBox/1\n[       OK ] PhysicsPlugins/SimulationFeatures_TEST.ShapeBoundingBox/1 (0 ms)\n[ RUN      ] PhysicsPlugins/SimulationFeatures_TEST.RetrieveContacts/0\n -- Plugin name: ignition::physics::dartsim::Plugin\n[       OK ] PhysicsPlugins/SimulationFeatures_TEST.RetrieveContacts/0 (60 ms)\n[ RUN      ] PhysicsPlugins/SimulationFeatures_TEST.RetrieveContacts/1\n[       OK ] PhysicsPlugins/SimulationFeatures_TEST.RetrieveContacts/1 (0 ms)\n[----------] 6 tests from PhysicsPlugins/SimulationFeatures_TEST (1093 ms total)\n\n[----------] Global test environment tear-down\n[==========] 6 tests from 1 test case ran. (1093 ms total)\n[  PASSED  ] 6 tests.\ndouble free or corruption (fasttop)\n\nProgram received signal SIGABRT, Aborted.\n__GI_raise (sig=sig@entry=6) at ../sysdeps/unix/sysv/linux/raise.c:51\n51  ../sysdeps/unix/sysv/linux/raise.c: No such file or directory.\n(gdb) bt\n#0  __GI_raise (sig=sig@entry=6) at ../sysdeps/unix/sysv/linux/raise.c:51\n#1  0x00007ffff5e2d801 in __GI_abort () at abort.c:79\n#2  0x00007ffff5e76897 in __libc_message (action=action@entry=do_abort, fmt=fmt@entry=0x7ffff5fa3b9a &quot;%s\\n&quot;) at ../sysdeps/posix/libc_fatal.c:181\n#3  0x00007ffff5e7d90a in malloc_printerr (str=str@entry=0x7ffff5fa5828 &quot;double free or corruption (fasttop)&quot;) at malloc.c:5350\n#4  0x00007ffff5e85004 in _int_free (have_lock=0, p=0x5555558a5960, av=0x7ffff61d8c40 &lt;main_arena&gt;) at malloc.c:4230\n#5  __GI___libc_free (mem=0x5555558a5970) at malloc.c:3124\n#6  0x00007ffff5e30041 in __run_exit_handlers (status=0, listp=0x7ffff61d8718 &lt;__exit_funcs&gt;, run_list_atexit=run_list_atexit@entry=true, run_dtors=run_dtors@entry=true) at exit.c:108\n#7  0x00007ffff5e3013a in __GI_exit (status=&lt;optimized out&gt;) at exit.c:139\n#8  0x00007ffff5e0eb9e in __libc_start_main (main=0x555555577770 &lt;main(int, char**)&gt;, argc=1, argv=0x7fffffffe318, init=&lt;optimized out&gt;, fini=&lt;optimized out&gt;, rtld_fini=&lt;optimized out&gt;, stack_end=0x7fffffffe308)\n    at ../csu/libc-start.c:344\n#9  0x0000555555577eea in _start () at /usr/include/c++/8/ext/new_allocator.h:116\n(gdb)\n</pre></div>", "type": "rendered"}, "created_on": "2019-05-23T20:14:55.987779+00:00", "user": {"display_name": "Steve Peters", "uuid": "{2ccfed09-18b8-4921-8d58-15ef01092802}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D"}, "html": {"href": "https://bitbucket.org/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/1fb4816dad9e68337d3096f750951f6cd=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsSP-1.png"}}, "nickname": "Steven Peters", "type": "user", "account_id": "557058:5de38267-b118-494c-aa76-4fab35448816"}, "updated_on": "2019-05-23T20:14:55.997388+00:00", "type": "pullrequest_comment", "id": 103220096}