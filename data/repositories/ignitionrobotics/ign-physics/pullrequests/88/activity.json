{"pagelen": 50, "values": [{"update": {"description": "This PR drastically improves the compile times of applications and libraries that use `ign-physics`. The key issue was that the length of symbol names was growing unbounded for classes that were being instantiated from templates. The itanium ABI mangles the names of template arguments into the symbol names of classes that get instantiated from templates, so the full name of each new feature that we added to a link, model, joint, world, etc, was getting mangled into all the symbol names that were being produced.\r\n\r\nThis PR mitigates this by using some class inheritance and SNFINAE tricks that allow us to easily minimize the symbol names. For example, a symbol that used to come out as\r\n\r\n```\r\n_ZTIN8ignition7physics6detail9AggregateINS1_12SelectEngineEvvE4typeIJNS0_13FeaturePolicyIdLm3EEENS0_11FeatureListIJNS8_IJNS0_26GetCylinderShapePropertiesENS0_26SetCylinderShapePropertiesENS0_26AttachCylinderShapeFeatureEEEENS8_IJNS0_26GetRevoluteJointPropertiesENS0_26SetRevoluteJointPropertiesEEEENS8_IJNS0_21GetBoxShapePropertiesENS0_21SetBoxShapePropertiesENS0_21AttachBoxShapeFeatureEEEEEEEEEE\r\n```\r\n\r\ncan now come out as\r\n\r\n```\r\n_ZTIN8ignition7physics6detail9AggregateINS1_12SelectEngineENS1_7GetNextINS4_I15FeatureSetClassvE1nEvE1nEvE4typeIJNS0_13FeaturePolicyIdLm3EEES5_EEE\r\n```\r\n\r\nWe can also add many more features into this symbol without significantly impacting the length of its name. The key is to group features into sets of features using explicit inheritance. For example, we use to do this:\r\n\r\n```\r\nusing MyFeatureList = ignition::physics::FeatureList<\r\n  /* some list of features */\r\n>;\r\n```\r\n\r\nbut now we can do this instead:\r\n\r\n```\r\nstruct MyFeatureList : ignition::physics::FeatureList<\r\n  /* some list of features */\r\n> { };\r\n```\r\n\r\nand the resulting symbol names from using `MyFeatureList` will be very lean and not have any dependence on the lengths of the feature names.\r\n\r\nThis matters primarily because the compile times on GCC seem to grow almost exponentially as the sizes of symbol names increase. Clang is also affected, but not as severely. Here are some charts of the compile times that I observed before and after these changes:\r\n\r\n| Before | -j1 | -j16 |\r\n| --- | --- | --- |\r\n| gcc | 17:59 | 15:18 |\r\n| clang | 5:30 | 1:55 |\r\n\r\n| After | -j1 | -j16 |\r\n| --- | --- | --- |\r\n| gcc | 6:58 | 2:05 |\r\n| clang | 5:11 | 1:12 |\r\n\r\nThis PR depends on an [ign-plugin PR here](#!/ignitionrobotics/ign-plugin/pull-requests/32/).\r\n\r\nUpdate: retargeted to `improve_compile_times_headers` branch of pr #93", "title": "[Citadel] Improve compile times", "destination": {"commit": {"hash": "a31b57dc5ce8", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-physics/commit/a31b57dc5ce8.json"}, "html": {"href": "#!/ignitionrobotics/ign-physics/commits/a31b57dc5ce8"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-physics.json"}, "html": {"href": "#!/ignitionrobotics/ign-physics"}, "avatar": {"href": "data/bytebucket.org/ravatar/{63a01c4f-5625-443b-96f0-73c4005ccada}ts=c_plus_plus"}}, "type": "repository", "name": "ign-physics", "full_name": "ignitionrobotics/ign-physics", "uuid": "{63a01c4f-5625-443b-96f0-73c4005ccada}"}, "branch": {"name": "default"}}, "reason": "", "source": {"commit": {"hash": "afb8307ca9a5", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-physics/commit/afb8307ca9a5.json"}, "html": {"href": "#!/ignitionrobotics/ign-physics/commits/afb8307ca9a5"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-physics.json"}, "html": {"href": "#!/ignitionrobotics/ign-physics"}, "avatar": {"href": "data/bytebucket.org/ravatar/{63a01c4f-5625-443b-96f0-73c4005ccada}ts=c_plus_plus"}}, "type": "repository", "name": "ign-physics", "full_name": "ignitionrobotics/ign-physics", "uuid": "{63a01c4f-5625-443b-96f0-73c4005ccada}"}, "branch": {"name": "improve_compile_times"}}, "state": "MERGED", "author": {"display_name": "Steve Peters", "uuid": "{2ccfed09-18b8-4921-8d58-15ef01092802}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D"}, "html": {"href": "https://bitbucket.org/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/1fb4816dad9e68337d3096f750951f6cd=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsSP-1.png"}}, "nickname": "Steven Peters", "type": "user", "account_id": "557058:5de38267-b118-494c-aa76-4fab35448816"}, "date": "2019-11-25T19:46:49.040822+00:00"}, "pull_request": {"type": "pullrequest", "id": 88, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-physics/pullrequests/88.json"}, "html": {"href": "#!/ignitionrobotics/ign-physics/pull-requests/88"}}, "title": "[Citadel] Improve compile times"}}, {"approval": {"date": "2019-11-25T19:46:40.163427+00:00", "pullrequest": {"type": "pullrequest", "id": 88, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-physics/pullrequests/88.json"}, "html": {"href": "#!/ignitionrobotics/ign-physics/pull-requests/88"}}, "title": "[Citadel] Improve compile times"}, "user": {"display_name": "Steve Peters", "uuid": "{2ccfed09-18b8-4921-8d58-15ef01092802}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D"}, "html": {"href": "https://bitbucket.org/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/1fb4816dad9e68337d3096f750951f6cd=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsSP-1.png"}}, "nickname": "Steven Peters", "type": "user", "account_id": "557058:5de38267-b118-494c-aa76-4fab35448816"}}, "pull_request": {"type": "pullrequest", "id": 88, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-physics/pullrequests/88.json"}, "html": {"href": "#!/ignitionrobotics/ign-physics/pull-requests/88"}}, "title": "[Citadel] Improve compile times"}}, {"update": {"description": "This PR drastically improves the compile times of applications and libraries that use `ign-physics`. The key issue was that the length of symbol names was growing unbounded for classes that were being instantiated from templates. The itanium ABI mangles the names of template arguments into the symbol names of classes that get instantiated from templates, so the full name of each new feature that we added to a link, model, joint, world, etc, was getting mangled into all the symbol names that were being produced.\r\n\r\nThis PR mitigates this by using some class inheritance and SNFINAE tricks that allow us to easily minimize the symbol names. For example, a symbol that used to come out as\r\n\r\n```\r\n_ZTIN8ignition7physics6detail9AggregateINS1_12SelectEngineEvvE4typeIJNS0_13FeaturePolicyIdLm3EEENS0_11FeatureListIJNS8_IJNS0_26GetCylinderShapePropertiesENS0_26SetCylinderShapePropertiesENS0_26AttachCylinderShapeFeatureEEEENS8_IJNS0_26GetRevoluteJointPropertiesENS0_26SetRevoluteJointPropertiesEEEENS8_IJNS0_21GetBoxShapePropertiesENS0_21SetBoxShapePropertiesENS0_21AttachBoxShapeFeatureEEEEEEEEEE\r\n```\r\n\r\ncan now come out as\r\n\r\n```\r\n_ZTIN8ignition7physics6detail9AggregateINS1_12SelectEngineENS1_7GetNextINS4_I15FeatureSetClassvE1nEvE1nEvE4typeIJNS0_13FeaturePolicyIdLm3EEES5_EEE\r\n```\r\n\r\nWe can also add many more features into this symbol without significantly impacting the length of its name. The key is to group features into sets of features using explicit inheritance. For example, we use to do this:\r\n\r\n```\r\nusing MyFeatureList = ignition::physics::FeatureList<\r\n  /* some list of features */\r\n>;\r\n```\r\n\r\nbut now we can do this instead:\r\n\r\n```\r\nstruct MyFeatureList : ignition::physics::FeatureList<\r\n  /* some list of features */\r\n> { };\r\n```\r\n\r\nand the resulting symbol names from using `MyFeatureList` will be very lean and not have any dependence on the lengths of the feature names.\r\n\r\nThis matters primarily because the compile times on GCC seem to grow almost exponentially as the sizes of symbol names increase. Clang is also affected, but not as severely. Here are some charts of the compile times that I observed before and after these changes:\r\n\r\n| Before | -j1 | -j16 |\r\n| --- | --- | --- |\r\n| gcc | 17:59 | 15:18 |\r\n| clang | 5:30 | 1:55 |\r\n\r\n| After | -j1 | -j16 |\r\n| --- | --- | --- |\r\n| gcc | 6:58 | 2:05 |\r\n| clang | 5:11 | 1:12 |\r\n\r\nThis PR depends on an [ign-plugin PR here](#!/ignitionrobotics/ign-plugin/pull-requests/32/).\r\n\r\nUpdate: retargeted to `improve_compile_times_headers` branch of pr #93", "title": "[Citadel] Improve compile times", "destination": {"commit": {"hash": "a31b57dc5ce8", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-physics/commit/a31b57dc5ce8.json"}, "html": {"href": "#!/ignitionrobotics/ign-physics/commits/a31b57dc5ce8"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-physics.json"}, "html": {"href": "#!/ignitionrobotics/ign-physics"}, "avatar": {"href": "data/bytebucket.org/ravatar/{63a01c4f-5625-443b-96f0-73c4005ccada}ts=c_plus_plus"}}, "type": "repository", "name": "ign-physics", "full_name": "ignitionrobotics/ign-physics", "uuid": "{63a01c4f-5625-443b-96f0-73c4005ccada}"}, "branch": {"name": "default"}}, "reason": "", "source": {"commit": {"hash": "afb8307ca9a5", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-physics/commit/afb8307ca9a5.json"}, "html": {"href": "#!/ignitionrobotics/ign-physics/commits/afb8307ca9a5"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-physics.json"}, "html": {"href": "#!/ignitionrobotics/ign-physics"}, "avatar": {"href": "data/bytebucket.org/ravatar/{63a01c4f-5625-443b-96f0-73c4005ccada}ts=c_plus_plus"}}, "type": "repository", "name": "ign-physics", "full_name": "ignitionrobotics/ign-physics", "uuid": "{63a01c4f-5625-443b-96f0-73c4005ccada}"}, "branch": {"name": "improve_compile_times"}}, "state": "OPEN", "author": {"display_name": "Steve Peters", "uuid": "{2ccfed09-18b8-4921-8d58-15ef01092802}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D"}, "html": {"href": "https://bitbucket.org/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/1fb4816dad9e68337d3096f750951f6cd=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsSP-1.png"}}, "nickname": "Steven Peters", "type": "user", "account_id": "557058:5de38267-b118-494c-aa76-4fab35448816"}, "date": "2019-11-25T18:37:58.917171+00:00"}, "pull_request": {"type": "pullrequest", "id": 88, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-physics/pullrequests/88.json"}, "html": {"href": "#!/ignitionrobotics/ign-physics/pull-requests/88"}}, "title": "[Citadel] Improve compile times"}}, {"update": {"description": "This PR drastically improves the compile times of applications and libraries that use `ign-physics`. The key issue was that the length of symbol names was growing unbounded for classes that were being instantiated from templates. The itanium ABI mangles the names of template arguments into the symbol names of classes that get instantiated from templates, so the full name of each new feature that we added to a link, model, joint, world, etc, was getting mangled into all the symbol names that were being produced.\r\n\r\nThis PR mitigates this by using some class inheritance and SNFINAE tricks that allow us to easily minimize the symbol names. For example, a symbol that used to come out as\r\n\r\n```\r\n_ZTIN8ignition7physics6detail9AggregateINS1_12SelectEngineEvvE4typeIJNS0_13FeaturePolicyIdLm3EEENS0_11FeatureListIJNS8_IJNS0_26GetCylinderShapePropertiesENS0_26SetCylinderShapePropertiesENS0_26AttachCylinderShapeFeatureEEEENS8_IJNS0_26GetRevoluteJointPropertiesENS0_26SetRevoluteJointPropertiesEEEENS8_IJNS0_21GetBoxShapePropertiesENS0_21SetBoxShapePropertiesENS0_21AttachBoxShapeFeatureEEEEEEEEEE\r\n```\r\n\r\ncan now come out as\r\n\r\n```\r\n_ZTIN8ignition7physics6detail9AggregateINS1_12SelectEngineENS1_7GetNextINS4_I15FeatureSetClassvE1nEvE1nEvE4typeIJNS0_13FeaturePolicyIdLm3EEES5_EEE\r\n```\r\n\r\nWe can also add many more features into this symbol without significantly impacting the length of its name. The key is to group features into sets of features using explicit inheritance. For example, we use to do this:\r\n\r\n```\r\nusing MyFeatureList = ignition::physics::FeatureList<\r\n  /* some list of features */\r\n>;\r\n```\r\n\r\nbut now we can do this instead:\r\n\r\n```\r\nstruct MyFeatureList : ignition::physics::FeatureList<\r\n  /* some list of features */\r\n> { };\r\n```\r\n\r\nand the resulting symbol names from using `MyFeatureList` will be very lean and not have any dependence on the lengths of the feature names.\r\n\r\nThis matters primarily because the compile times on GCC seem to grow almost exponentially as the sizes of symbol names increase. Clang is also affected, but not as severely. Here are some charts of the compile times that I observed before and after these changes:\r\n\r\n| Before | -j1 | -j16 |\r\n| --- | --- | --- |\r\n| gcc | 17:59 | 15:18 |\r\n| clang | 5:30 | 1:55 |\r\n\r\n| After | -j1 | -j16 |\r\n| --- | --- | --- |\r\n| gcc | 6:58 | 2:05 |\r\n| clang | 5:11 | 1:12 |\r\n\r\nThis PR depends on an [ign-plugin PR here](#!/ignitionrobotics/ign-plugin/pull-requests/32/).\r\n\r\nUpdate: retargeted to `improve_compile_times_headers` branch of pr #93", "title": "[Citadel] Improve compile times", "destination": {"commit": {"hash": "a31b57dc5ce8", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-physics/commit/a31b57dc5ce8.json"}, "html": {"href": "#!/ignitionrobotics/ign-physics/commits/a31b57dc5ce8"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-physics.json"}, "html": {"href": "#!/ignitionrobotics/ign-physics"}, "avatar": {"href": "data/bytebucket.org/ravatar/{63a01c4f-5625-443b-96f0-73c4005ccada}ts=c_plus_plus"}}, "type": "repository", "name": "ign-physics", "full_name": "ignitionrobotics/ign-physics", "uuid": "{63a01c4f-5625-443b-96f0-73c4005ccada}"}, "branch": {"name": "default"}}, "reason": "", "source": {"commit": {"hash": "046eaeaa1aad", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-physics/commit/046eaeaa1aad.json"}, "html": {"href": "#!/ignitionrobotics/ign-physics/commits/046eaeaa1aad"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-physics.json"}, "html": {"href": "#!/ignitionrobotics/ign-physics"}, "avatar": {"href": "data/bytebucket.org/ravatar/{63a01c4f-5625-443b-96f0-73c4005ccada}ts=c_plus_plus"}}, "type": "repository", "name": "ign-physics", "full_name": "ignitionrobotics/ign-physics", "uuid": "{63a01c4f-5625-443b-96f0-73c4005ccada}"}, "branch": {"name": "improve_compile_times"}}, "state": "OPEN", "author": {"display_name": "Steve Peters", "uuid": "{2ccfed09-18b8-4921-8d58-15ef01092802}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D"}, "html": {"href": "https://bitbucket.org/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/1fb4816dad9e68337d3096f750951f6cd=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsSP-1.png"}}, "nickname": "Steven Peters", "type": "user", "account_id": "557058:5de38267-b118-494c-aa76-4fab35448816"}, "date": "2019-11-25T18:37:31.368109+00:00"}, "pull_request": {"type": "pullrequest", "id": 88, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-physics/pullrequests/88.json"}, "html": {"href": "#!/ignitionrobotics/ign-physics/pull-requests/88"}}, "title": "[Citadel] Improve compile times"}}, {"update": {"description": "This PR drastically improves the compile times of applications and libraries that use `ign-physics`. The key issue was that the length of symbol names was growing unbounded for classes that were being instantiated from templates. The itanium ABI mangles the names of template arguments into the symbol names of classes that get instantiated from templates, so the full name of each new feature that we added to a link, model, joint, world, etc, was getting mangled into all the symbol names that were being produced.\r\n\r\nThis PR mitigates this by using some class inheritance and SNFINAE tricks that allow us to easily minimize the symbol names. For example, a symbol that used to come out as\r\n\r\n```\r\n_ZTIN8ignition7physics6detail9AggregateINS1_12SelectEngineEvvE4typeIJNS0_13FeaturePolicyIdLm3EEENS0_11FeatureListIJNS8_IJNS0_26GetCylinderShapePropertiesENS0_26SetCylinderShapePropertiesENS0_26AttachCylinderShapeFeatureEEEENS8_IJNS0_26GetRevoluteJointPropertiesENS0_26SetRevoluteJointPropertiesEEEENS8_IJNS0_21GetBoxShapePropertiesENS0_21SetBoxShapePropertiesENS0_21AttachBoxShapeFeatureEEEEEEEEEE\r\n```\r\n\r\ncan now come out as\r\n\r\n```\r\n_ZTIN8ignition7physics6detail9AggregateINS1_12SelectEngineENS1_7GetNextINS4_I15FeatureSetClassvE1nEvE1nEvE4typeIJNS0_13FeaturePolicyIdLm3EEES5_EEE\r\n```\r\n\r\nWe can also add many more features into this symbol without significantly impacting the length of its name. The key is to group features into sets of features using explicit inheritance. For example, we use to do this:\r\n\r\n```\r\nusing MyFeatureList = ignition::physics::FeatureList<\r\n  /* some list of features */\r\n>;\r\n```\r\n\r\nbut now we can do this instead:\r\n\r\n```\r\nstruct MyFeatureList : ignition::physics::FeatureList<\r\n  /* some list of features */\r\n> { };\r\n```\r\n\r\nand the resulting symbol names from using `MyFeatureList` will be very lean and not have any dependence on the lengths of the feature names.\r\n\r\nThis matters primarily because the compile times on GCC seem to grow almost exponentially as the sizes of symbol names increase. Clang is also affected, but not as severely. Here are some charts of the compile times that I observed before and after these changes:\r\n\r\n| Before | -j1 | -j16 |\r\n| --- | --- | --- |\r\n| gcc | 17:59 | 15:18 |\r\n| clang | 5:30 | 1:55 |\r\n\r\n| After | -j1 | -j16 |\r\n| --- | --- | --- |\r\n| gcc | 6:58 | 2:05 |\r\n| clang | 5:11 | 1:12 |\r\n\r\nThis PR depends on an [ign-plugin PR here](#!/ignitionrobotics/ign-plugin/pull-requests/32/).\r\n\r\nUpdate: retargeted to `improve_compile_times_headers` branch of pr #93", "title": "[Citadel] Improve compile times", "destination": {"commit": {"hash": "a31b57dc5ce8", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-physics/commit/a31b57dc5ce8.json"}, "html": {"href": "#!/ignitionrobotics/ign-physics/commits/a31b57dc5ce8"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-physics.json"}, "html": {"href": "#!/ignitionrobotics/ign-physics"}, "avatar": {"href": "data/bytebucket.org/ravatar/{63a01c4f-5625-443b-96f0-73c4005ccada}ts=c_plus_plus"}}, "type": "repository", "name": "ign-physics", "full_name": "ignitionrobotics/ign-physics", "uuid": "{63a01c4f-5625-443b-96f0-73c4005ccada}"}, "branch": {"name": "default"}}, "reason": "", "source": {"commit": {"hash": "3380478f9349", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-physics/commit/3380478f9349.json"}, "html": {"href": "#!/ignitionrobotics/ign-physics/commits/3380478f9349"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-physics.json"}, "html": {"href": "#!/ignitionrobotics/ign-physics"}, "avatar": {"href": "data/bytebucket.org/ravatar/{63a01c4f-5625-443b-96f0-73c4005ccada}ts=c_plus_plus"}}, "type": "repository", "name": "ign-physics", "full_name": "ignitionrobotics/ign-physics", "uuid": "{63a01c4f-5625-443b-96f0-73c4005ccada}"}, "branch": {"name": "improve_compile_times"}}, "state": "OPEN", "author": {"display_name": "Steve Peters", "uuid": "{2ccfed09-18b8-4921-8d58-15ef01092802}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D"}, "html": {"href": "https://bitbucket.org/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/1fb4816dad9e68337d3096f750951f6cd=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsSP-1.png"}}, "nickname": "Steven Peters", "type": "user", "account_id": "557058:5de38267-b118-494c-aa76-4fab35448816"}, "date": "2019-11-25T18:36:33.135944+00:00"}, "pull_request": {"type": "pullrequest", "id": 88, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-physics/pullrequests/88.json"}, "html": {"href": "#!/ignitionrobotics/ign-physics/pull-requests/88"}}, "title": "[Citadel] Improve compile times"}}, {"update": {"description": "This PR drastically improves the compile times of applications and libraries that use `ign-physics`. The key issue was that the length of symbol names was growing unbounded for classes that were being instantiated from templates. The itanium ABI mangles the names of template arguments into the symbol names of classes that get instantiated from templates, so the full name of each new feature that we added to a link, model, joint, world, etc, was getting mangled into all the symbol names that were being produced.\r\n\r\nThis PR mitigates this by using some class inheritance and SNFINAE tricks that allow us to easily minimize the symbol names. For example, a symbol that used to come out as\r\n\r\n```\r\n_ZTIN8ignition7physics6detail9AggregateINS1_12SelectEngineEvvE4typeIJNS0_13FeaturePolicyIdLm3EEENS0_11FeatureListIJNS8_IJNS0_26GetCylinderShapePropertiesENS0_26SetCylinderShapePropertiesENS0_26AttachCylinderShapeFeatureEEEENS8_IJNS0_26GetRevoluteJointPropertiesENS0_26SetRevoluteJointPropertiesEEEENS8_IJNS0_21GetBoxShapePropertiesENS0_21SetBoxShapePropertiesENS0_21AttachBoxShapeFeatureEEEEEEEEEE\r\n```\r\n\r\ncan now come out as\r\n\r\n```\r\n_ZTIN8ignition7physics6detail9AggregateINS1_12SelectEngineENS1_7GetNextINS4_I15FeatureSetClassvE1nEvE1nEvE4typeIJNS0_13FeaturePolicyIdLm3EEES5_EEE\r\n```\r\n\r\nWe can also add many more features into this symbol without significantly impacting the length of its name. The key is to group features into sets of features using explicit inheritance. For example, we use to do this:\r\n\r\n```\r\nusing MyFeatureList = ignition::physics::FeatureList<\r\n  /* some list of features */\r\n>;\r\n```\r\n\r\nbut now we can do this instead:\r\n\r\n```\r\nstruct MyFeatureList : ignition::physics::FeatureList<\r\n  /* some list of features */\r\n> { };\r\n```\r\n\r\nand the resulting symbol names from using `MyFeatureList` will be very lean and not have any dependence on the lengths of the feature names.\r\n\r\nThis matters primarily because the compile times on GCC seem to grow almost exponentially as the sizes of symbol names increase. Clang is also affected, but not as severely. Here are some charts of the compile times that I observed before and after these changes:\r\n\r\n| Before | -j1 | -j16 |\r\n| --- | --- | --- |\r\n| gcc | 17:59 | 15:18 |\r\n| clang | 5:30 | 1:55 |\r\n\r\n| After | -j1 | -j16 |\r\n| --- | --- | --- |\r\n| gcc | 6:58 | 2:05 |\r\n| clang | 5:11 | 1:12 |\r\n\r\nThis PR depends on an [ign-plugin PR here](#!/ignitionrobotics/ign-plugin/pull-requests/32/).\r\n\r\nUpdate: retargeted to `improve_compile_times_headers` branch of pr #93", "title": "[Citadel] Improve compile times", "destination": {"commit": {"hash": "a31b57dc5ce8", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-physics/commit/a31b57dc5ce8.json"}, "html": {"href": "#!/ignitionrobotics/ign-physics/commits/a31b57dc5ce8"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-physics.json"}, "html": {"href": "#!/ignitionrobotics/ign-physics"}, "avatar": {"href": "data/bytebucket.org/ravatar/{63a01c4f-5625-443b-96f0-73c4005ccada}ts=c_plus_plus"}}, "type": "repository", "name": "ign-physics", "full_name": "ignitionrobotics/ign-physics", "uuid": "{63a01c4f-5625-443b-96f0-73c4005ccada}"}, "branch": {"name": "default"}}, "reason": "", "source": {"commit": {"hash": "3380478f9349", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-physics/commit/3380478f9349.json"}, "html": {"href": "#!/ignitionrobotics/ign-physics/commits/3380478f9349"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-physics.json"}, "html": {"href": "#!/ignitionrobotics/ign-physics"}, "avatar": {"href": "data/bytebucket.org/ravatar/{63a01c4f-5625-443b-96f0-73c4005ccada}ts=c_plus_plus"}}, "type": "repository", "name": "ign-physics", "full_name": "ignitionrobotics/ign-physics", "uuid": "{63a01c4f-5625-443b-96f0-73c4005ccada}"}, "branch": {"name": "improve_compile_times"}}, "state": "OPEN", "author": {"display_name": "Steve Peters", "uuid": "{2ccfed09-18b8-4921-8d58-15ef01092802}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D"}, "html": {"href": "https://bitbucket.org/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/1fb4816dad9e68337d3096f750951f6cd=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsSP-1.png"}}, "nickname": "Steven Peters", "type": "user", "account_id": "557058:5de38267-b118-494c-aa76-4fab35448816"}, "date": "2019-11-25T18:36:33.105176+00:00"}, "pull_request": {"type": "pullrequest", "id": 88, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-physics/pullrequests/88.json"}, "html": {"href": "#!/ignitionrobotics/ign-physics/pull-requests/88"}}, "title": "[Citadel] Improve compile times"}}, {"comment": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-physics/pullrequests/88/comments/125889286.json"}, "html": {"href": "#!/ignitionrobotics/ign-physics/pull-requests/88/_/diff#comment-125889286"}}, "parent": {"id": 125888459, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-physics/pullrequests/88/comments/125888459.json"}, "html": {"href": "#!/ignitionrobotics/ign-physics/pull-requests/88/_/diff#comment-125888459"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 88, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-physics/pullrequests/88.json"}, "html": {"href": "#!/ignitionrobotics/ign-physics/pull-requests/88"}}, "title": "[Citadel] Improve compile times"}, "content": {"raw": "ign-plugin 1.1.0 is building", "markup": "markdown", "html": "<p>ign-plugin 1.1.0 is building</p>", "type": "rendered"}, "created_on": "2019-11-22T02:12:54.290468+00:00", "user": {"display_name": "Steve Peters", "uuid": "{2ccfed09-18b8-4921-8d58-15ef01092802}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D"}, "html": {"href": "https://bitbucket.org/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/1fb4816dad9e68337d3096f750951f6cd=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsSP-1.png"}}, "nickname": "Steven Peters", "type": "user", "account_id": "557058:5de38267-b118-494c-aa76-4fab35448816"}, "updated_on": "2019-11-22T02:12:54.303838+00:00", "type": "pullrequest_comment", "id": 125889286}, "pull_request": {"type": "pullrequest", "id": 88, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-physics/pullrequests/88.json"}, "html": {"href": "#!/ignitionrobotics/ign-physics/pull-requests/88"}}, "title": "[Citadel] Improve compile times"}}, {"comment": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-physics/pullrequests/88/comments/125888459.json"}, "html": {"href": "#!/ignitionrobotics/ign-physics/pull-requests/88/_/diff#comment-125888459"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 88, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-physics/pullrequests/88.json"}, "html": {"href": "#!/ignitionrobotics/ign-physics/pull-requests/88"}}, "title": "[Citadel] Improve compile times"}, "content": {"raw": "I don't understand all of this, but it works, so let's do it. I'll start by merging the ign-plugin PR and making a stable release", "markup": "markdown", "html": "<p>I don't understand all of this, but it works, so let's do it. I'll start by merging the ign-plugin PR and making a stable release</p>", "type": "rendered"}, "created_on": "2019-11-22T01:53:57.570796+00:00", "user": {"display_name": "Steve Peters", "uuid": "{2ccfed09-18b8-4921-8d58-15ef01092802}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D"}, "html": {"href": "https://bitbucket.org/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/1fb4816dad9e68337d3096f750951f6cd=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsSP-1.png"}}, "nickname": "Steven Peters", "type": "user", "account_id": "557058:5de38267-b118-494c-aa76-4fab35448816"}, "updated_on": "2019-11-22T01:53:57.577732+00:00", "type": "pullrequest_comment", "id": 125888459}, "pull_request": {"type": "pullrequest", "id": 88, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-physics/pullrequests/88.json"}, "html": {"href": "#!/ignitionrobotics/ign-physics/pull-requests/88"}}, "title": "[Citadel] Improve compile times"}}, {"comment": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-physics/pullrequests/88/comments/125879784.json"}, "html": {"href": "#!/ignitionrobotics/ign-physics/pull-requests/88/_/diff#comment-125879784"}}, "parent": {"id": 125690972, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-physics/pullrequests/88/comments/125690972.json"}, "html": {"href": "#!/ignitionrobotics/ign-physics/pull-requests/88/_/diff#comment-125690972"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 88, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-physics/pullrequests/88.json"}, "html": {"href": "#!/ignitionrobotics/ign-physics/pull-requests/88"}}, "title": "[Citadel] Improve compile times"}, "content": {"raw": "[![Build Status](https://build.osrfoundation.org/buildStatus/icon?job=ign_physics-pr-win&build=417)](https://build.osrfoundation.org/job/ign_physics-pr-win/417/) https://build.osrfoundation.org/job/ign_physics-pr-win/417/", "markup": "markdown", "html": "<p><a data-is-external-link=\"true\" href=\"https://build.osrfoundation.org/job/ign_physics-pr-win/417/\" rel=\"nofollow\"><img alt=\"Build Status\" src=\"https://build.osrfoundation.org/buildStatus/icon?job=ign_physics-pr-win&amp;build=417\" /></a> <a href=\"https://build.osrfoundation.org/job/ign_physics-pr-win/417/\" rel=\"nofollow\" class=\"ap-connect-link\">https://build.osrfoundation.org/job/ign_physics-pr-win/417/</a></p>", "type": "rendered"}, "created_on": "2019-11-21T23:24:25.093379+00:00", "user": {"display_name": "Steve Peters", "uuid": "{2ccfed09-18b8-4921-8d58-15ef01092802}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D"}, "html": {"href": "https://bitbucket.org/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/1fb4816dad9e68337d3096f750951f6cd=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsSP-1.png"}}, "nickname": "Steven Peters", "type": "user", "account_id": "557058:5de38267-b118-494c-aa76-4fab35448816"}, "updated_on": "2019-11-21T23:24:25.100576+00:00", "type": "pullrequest_comment", "id": 125879784}, "pull_request": {"type": "pullrequest", "id": 88, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-physics/pullrequests/88.json"}, "html": {"href": "#!/ignitionrobotics/ign-physics/pull-requests/88"}}, "title": "[Citadel] Improve compile times"}}, {"update": {"description": "This PR drastically improves the compile times of applications and libraries that use `ign-physics`. The key issue was that the length of symbol names was growing unbounded for classes that were being instantiated from templates. The itanium ABI mangles the names of template arguments into the symbol names of classes that get instantiated from templates, so the full name of each new feature that we added to a link, model, joint, world, etc, was getting mangled into all the symbol names that were being produced.\r\n\r\nThis PR mitigates this by using some class inheritance and SNFINAE tricks that allow us to easily minimize the symbol names. For example, a symbol that used to come out as\r\n\r\n```\r\n_ZTIN8ignition7physics6detail9AggregateINS1_12SelectEngineEvvE4typeIJNS0_13FeaturePolicyIdLm3EEENS0_11FeatureListIJNS8_IJNS0_26GetCylinderShapePropertiesENS0_26SetCylinderShapePropertiesENS0_26AttachCylinderShapeFeatureEEEENS8_IJNS0_26GetRevoluteJointPropertiesENS0_26SetRevoluteJointPropertiesEEEENS8_IJNS0_21GetBoxShapePropertiesENS0_21SetBoxShapePropertiesENS0_21AttachBoxShapeFeatureEEEEEEEEEE\r\n```\r\n\r\ncan now come out as\r\n\r\n```\r\n_ZTIN8ignition7physics6detail9AggregateINS1_12SelectEngineENS1_7GetNextINS4_I15FeatureSetClassvE1nEvE1nEvE4typeIJNS0_13FeaturePolicyIdLm3EEES5_EEE\r\n```\r\n\r\nWe can also add many more features into this symbol without significantly impacting the length of its name. The key is to group features into sets of features using explicit inheritance. For example, we use to do this:\r\n\r\n```\r\nusing MyFeatureList = ignition::physics::FeatureList<\r\n  /* some list of features */\r\n>;\r\n```\r\n\r\nbut now we can do this instead:\r\n\r\n```\r\nstruct MyFeatureList : ignition::physics::FeatureList<\r\n  /* some list of features */\r\n> { };\r\n```\r\n\r\nand the resulting symbol names from using `MyFeatureList` will be very lean and not have any dependence on the lengths of the feature names.\r\n\r\nThis matters primarily because the compile times on GCC seem to grow almost exponentially as the sizes of symbol names increase. Clang is also affected, but not as severely. Here are some charts of the compile times that I observed before and after these changes:\r\n\r\n| Before | -j1 | -j16 |\r\n| --- | --- | --- |\r\n| gcc | 17:59 | 15:18 |\r\n| clang | 5:30 | 1:55 |\r\n\r\n| After | -j1 | -j16 |\r\n| --- | --- | --- |\r\n| gcc | 6:58 | 2:05 |\r\n| clang | 5:11 | 1:12 |\r\n\r\nThis PR depends on an [ign-plugin PR here](#!/ignitionrobotics/ign-plugin/pull-requests/32/).\r\n\r\nUpdate: retargeted to `improve_compile_times_headers` branch of pr #93", "title": "[Citadel] Improve compile times", "destination": {"commit": {"hash": "0ed385736734", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-physics/commit/0ed385736734.json"}, "html": {"href": "#!/ignitionrobotics/ign-physics/commits/0ed385736734"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-physics.json"}, "html": {"href": "#!/ignitionrobotics/ign-physics"}, "avatar": {"href": "data/bytebucket.org/ravatar/{63a01c4f-5625-443b-96f0-73c4005ccada}ts=c_plus_plus"}}, "type": "repository", "name": "ign-physics", "full_name": "ignitionrobotics/ign-physics", "uuid": "{63a01c4f-5625-443b-96f0-73c4005ccada}"}, "branch": {"name": "default"}}, "reason": "", "source": {"commit": {"hash": "3380478f9349", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-physics/commit/3380478f9349.json"}, "html": {"href": "#!/ignitionrobotics/ign-physics/commits/3380478f9349"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-physics.json"}, "html": {"href": "#!/ignitionrobotics/ign-physics"}, "avatar": {"href": "data/bytebucket.org/ravatar/{63a01c4f-5625-443b-96f0-73c4005ccada}ts=c_plus_plus"}}, "type": "repository", "name": "ign-physics", "full_name": "ignitionrobotics/ign-physics", "uuid": "{63a01c4f-5625-443b-96f0-73c4005ccada}"}, "branch": {"name": "improve_compile_times"}}, "state": "OPEN", "author": {"display_name": "Steve Peters", "uuid": "{2ccfed09-18b8-4921-8d58-15ef01092802}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D"}, "html": {"href": "https://bitbucket.org/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/1fb4816dad9e68337d3096f750951f6cd=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsSP-1.png"}}, "nickname": "Steven Peters", "type": "user", "account_id": "557058:5de38267-b118-494c-aa76-4fab35448816"}, "date": "2019-11-21T23:22:59.777992+00:00"}, "pull_request": {"type": "pullrequest", "id": 88, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-physics/pullrequests/88.json"}, "html": {"href": "#!/ignitionrobotics/ign-physics/pull-requests/88"}}, "title": "[Citadel] Improve compile times"}}, {"update": {"description": "This PR drastically improves the compile times of applications and libraries that use `ign-physics`. The key issue was that the length of symbol names was growing unbounded for classes that were being instantiated from templates. The itanium ABI mangles the names of template arguments into the symbol names of classes that get instantiated from templates, so the full name of each new feature that we added to a link, model, joint, world, etc, was getting mangled into all the symbol names that were being produced.\r\n\r\nThis PR mitigates this by using some class inheritance and SNFINAE tricks that allow us to easily minimize the symbol names. For example, a symbol that used to come out as\r\n\r\n```\r\n_ZTIN8ignition7physics6detail9AggregateINS1_12SelectEngineEvvE4typeIJNS0_13FeaturePolicyIdLm3EEENS0_11FeatureListIJNS8_IJNS0_26GetCylinderShapePropertiesENS0_26SetCylinderShapePropertiesENS0_26AttachCylinderShapeFeatureEEEENS8_IJNS0_26GetRevoluteJointPropertiesENS0_26SetRevoluteJointPropertiesEEEENS8_IJNS0_21GetBoxShapePropertiesENS0_21SetBoxShapePropertiesENS0_21AttachBoxShapeFeatureEEEEEEEEEE\r\n```\r\n\r\ncan now come out as\r\n\r\n```\r\n_ZTIN8ignition7physics6detail9AggregateINS1_12SelectEngineENS1_7GetNextINS4_I15FeatureSetClassvE1nEvE1nEvE4typeIJNS0_13FeaturePolicyIdLm3EEES5_EEE\r\n```\r\n\r\nWe can also add many more features into this symbol without significantly impacting the length of its name. The key is to group features into sets of features using explicit inheritance. For example, we use to do this:\r\n\r\n```\r\nusing MyFeatureList = ignition::physics::FeatureList<\r\n  /* some list of features */\r\n>;\r\n```\r\n\r\nbut now we can do this instead:\r\n\r\n```\r\nstruct MyFeatureList : ignition::physics::FeatureList<\r\n  /* some list of features */\r\n> { };\r\n```\r\n\r\nand the resulting symbol names from using `MyFeatureList` will be very lean and not have any dependence on the lengths of the feature names.\r\n\r\nThis matters primarily because the compile times on GCC seem to grow almost exponentially as the sizes of symbol names increase. Clang is also affected, but not as severely. Here are some charts of the compile times that I observed before and after these changes:\r\n\r\n| Before | -j1 | -j16 |\r\n| --- | --- | --- |\r\n| gcc | 17:59 | 15:18 |\r\n| clang | 5:30 | 1:55 |\r\n\r\n| After | -j1 | -j16 |\r\n| --- | --- | --- |\r\n| gcc | 6:58 | 2:05 |\r\n| clang | 5:11 | 1:12 |\r\n\r\nThis PR depends on an [ign-plugin PR here](#!/ignitionrobotics/ign-plugin/pull-requests/32/).\r\n\r\nUpdate: retargeted to `improve_compile_times_headers` branch of pr #93", "title": "[Citadel] Improve compile times", "destination": {"commit": {"hash": "0ed385736734", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-physics/commit/0ed385736734.json"}, "html": {"href": "#!/ignitionrobotics/ign-physics/commits/0ed385736734"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-physics.json"}, "html": {"href": "#!/ignitionrobotics/ign-physics"}, "avatar": {"href": "data/bytebucket.org/ravatar/{63a01c4f-5625-443b-96f0-73c4005ccada}ts=c_plus_plus"}}, "type": "repository", "name": "ign-physics", "full_name": "ignitionrobotics/ign-physics", "uuid": "{63a01c4f-5625-443b-96f0-73c4005ccada}"}, "branch": {"name": "default"}}, "reason": "", "source": {"commit": {"hash": "6327de4dda9a", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-physics/commit/6327de4dda9a.json"}, "html": {"href": "#!/ignitionrobotics/ign-physics/commits/6327de4dda9a"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-physics.json"}, "html": {"href": "#!/ignitionrobotics/ign-physics"}, "avatar": {"href": "data/bytebucket.org/ravatar/{63a01c4f-5625-443b-96f0-73c4005ccada}ts=c_plus_plus"}}, "type": "repository", "name": "ign-physics", "full_name": "ignitionrobotics/ign-physics", "uuid": "{63a01c4f-5625-443b-96f0-73c4005ccada}"}, "branch": {"name": "improve_compile_times"}}, "state": "OPEN", "author": {"display_name": "Steve Peters", "uuid": "{2ccfed09-18b8-4921-8d58-15ef01092802}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D"}, "html": {"href": "https://bitbucket.org/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/1fb4816dad9e68337d3096f750951f6cd=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsSP-1.png"}}, "nickname": "Steven Peters", "type": "user", "account_id": "557058:5de38267-b118-494c-aa76-4fab35448816"}, "date": "2019-11-21T23:22:35.335136+00:00"}, "pull_request": {"type": "pullrequest", "id": 88, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-physics/pullrequests/88.json"}, "html": {"href": "#!/ignitionrobotics/ign-physics/pull-requests/88"}}, "title": "[Citadel] Improve compile times"}}, {"update": {"description": "This PR drastically improves the compile times of applications and libraries that use `ign-physics`. The key issue was that the length of symbol names was growing unbounded for classes that were being instantiated from templates. The itanium ABI mangles the names of template arguments into the symbol names of classes that get instantiated from templates, so the full name of each new feature that we added to a link, model, joint, world, etc, was getting mangled into all the symbol names that were being produced.\r\n\r\nThis PR mitigates this by using some class inheritance and SNFINAE tricks that allow us to easily minimize the symbol names. For example, a symbol that used to come out as\r\n\r\n```\r\n_ZTIN8ignition7physics6detail9AggregateINS1_12SelectEngineEvvE4typeIJNS0_13FeaturePolicyIdLm3EEENS0_11FeatureListIJNS8_IJNS0_26GetCylinderShapePropertiesENS0_26SetCylinderShapePropertiesENS0_26AttachCylinderShapeFeatureEEEENS8_IJNS0_26GetRevoluteJointPropertiesENS0_26SetRevoluteJointPropertiesEEEENS8_IJNS0_21GetBoxShapePropertiesENS0_21SetBoxShapePropertiesENS0_21AttachBoxShapeFeatureEEEEEEEEEE\r\n```\r\n\r\ncan now come out as\r\n\r\n```\r\n_ZTIN8ignition7physics6detail9AggregateINS1_12SelectEngineENS1_7GetNextINS4_I15FeatureSetClassvE1nEvE1nEvE4typeIJNS0_13FeaturePolicyIdLm3EEES5_EEE\r\n```\r\n\r\nWe can also add many more features into this symbol without significantly impacting the length of its name. The key is to group features into sets of features using explicit inheritance. For example, we use to do this:\r\n\r\n```\r\nusing MyFeatureList = ignition::physics::FeatureList<\r\n  /* some list of features */\r\n>;\r\n```\r\n\r\nbut now we can do this instead:\r\n\r\n```\r\nstruct MyFeatureList : ignition::physics::FeatureList<\r\n  /* some list of features */\r\n> { };\r\n```\r\n\r\nand the resulting symbol names from using `MyFeatureList` will be very lean and not have any dependence on the lengths of the feature names.\r\n\r\nThis matters primarily because the compile times on GCC seem to grow almost exponentially as the sizes of symbol names increase. Clang is also affected, but not as severely. Here are some charts of the compile times that I observed before and after these changes:\r\n\r\n| Before | -j1 | -j16 |\r\n| --- | --- | --- |\r\n| gcc | 17:59 | 15:18 |\r\n| clang | 5:30 | 1:55 |\r\n\r\n| After | -j1 | -j16 |\r\n| --- | --- | --- |\r\n| gcc | 6:58 | 2:05 |\r\n| clang | 5:11 | 1:12 |\r\n\r\nThis PR depends on an [ign-plugin PR here](#!/ignitionrobotics/ign-plugin/pull-requests/32/).\r\n\r\nUpdate: retargeted to `improve_compile_times_headers` branch of pr #93", "title": "[Citadel] Improve compile times", "destination": {"commit": {"hash": "0ed385736734", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-physics/commit/0ed385736734.json"}, "html": {"href": "#!/ignitionrobotics/ign-physics/commits/0ed385736734"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-physics.json"}, "html": {"href": "#!/ignitionrobotics/ign-physics"}, "avatar": {"href": "data/bytebucket.org/ravatar/{63a01c4f-5625-443b-96f0-73c4005ccada}ts=c_plus_plus"}}, "type": "repository", "name": "ign-physics", "full_name": "ignitionrobotics/ign-physics", "uuid": "{63a01c4f-5625-443b-96f0-73c4005ccada}"}, "branch": {"name": "default"}}, "reason": "", "source": {"commit": {"hash": "6327de4dda9a", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-physics/commit/6327de4dda9a.json"}, "html": {"href": "#!/ignitionrobotics/ign-physics/commits/6327de4dda9a"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-physics.json"}, "html": {"href": "#!/ignitionrobotics/ign-physics"}, "avatar": {"href": "data/bytebucket.org/ravatar/{63a01c4f-5625-443b-96f0-73c4005ccada}ts=c_plus_plus"}}, "type": "repository", "name": "ign-physics", "full_name": "ignitionrobotics/ign-physics", "uuid": "{63a01c4f-5625-443b-96f0-73c4005ccada}"}, "branch": {"name": "improve_compile_times"}}, "state": "OPEN", "author": {"display_name": "Steve Peters", "uuid": "{2ccfed09-18b8-4921-8d58-15ef01092802}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D"}, "html": {"href": "https://bitbucket.org/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/1fb4816dad9e68337d3096f750951f6cd=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsSP-1.png"}}, "nickname": "Steven Peters", "type": "user", "account_id": "557058:5de38267-b118-494c-aa76-4fab35448816"}, "date": "2019-11-21T23:22:35.299540+00:00"}, "pull_request": {"type": "pullrequest", "id": 88, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-physics/pullrequests/88.json"}, "html": {"href": "#!/ignitionrobotics/ign-physics/pull-requests/88"}}, "title": "[Citadel] Improve compile times"}}, {"update": {"description": "This PR drastically improves the compile times of applications and libraries that use `ign-physics`. The key issue was that the length of symbol names was growing unbounded for classes that were being instantiated from templates. The itanium ABI mangles the names of template arguments into the symbol names of classes that get instantiated from templates, so the full name of each new feature that we added to a link, model, joint, world, etc, was getting mangled into all the symbol names that were being produced.\r\n\r\nThis PR mitigates this by using some class inheritance and SNFINAE tricks that allow us to easily minimize the symbol names. For example, a symbol that used to come out as\r\n\r\n```\r\n_ZTIN8ignition7physics6detail9AggregateINS1_12SelectEngineEvvE4typeIJNS0_13FeaturePolicyIdLm3EEENS0_11FeatureListIJNS8_IJNS0_26GetCylinderShapePropertiesENS0_26SetCylinderShapePropertiesENS0_26AttachCylinderShapeFeatureEEEENS8_IJNS0_26GetRevoluteJointPropertiesENS0_26SetRevoluteJointPropertiesEEEENS8_IJNS0_21GetBoxShapePropertiesENS0_21SetBoxShapePropertiesENS0_21AttachBoxShapeFeatureEEEEEEEEEE\r\n```\r\n\r\ncan now come out as\r\n\r\n```\r\n_ZTIN8ignition7physics6detail9AggregateINS1_12SelectEngineENS1_7GetNextINS4_I15FeatureSetClassvE1nEvE1nEvE4typeIJNS0_13FeaturePolicyIdLm3EEES5_EEE\r\n```\r\n\r\nWe can also add many more features into this symbol without significantly impacting the length of its name. The key is to group features into sets of features using explicit inheritance. For example, we use to do this:\r\n\r\n```\r\nusing MyFeatureList = ignition::physics::FeatureList<\r\n  /* some list of features */\r\n>;\r\n```\r\n\r\nbut now we can do this instead:\r\n\r\n```\r\nstruct MyFeatureList : ignition::physics::FeatureList<\r\n  /* some list of features */\r\n> { };\r\n```\r\n\r\nand the resulting symbol names from using `MyFeatureList` will be very lean and not have any dependence on the lengths of the feature names.\r\n\r\nThis matters primarily because the compile times on GCC seem to grow almost exponentially as the sizes of symbol names increase. Clang is also affected, but not as severely. Here are some charts of the compile times that I observed before and after these changes:\r\n\r\n| Before | -j1 | -j16 |\r\n| --- | --- | --- |\r\n| gcc | 17:59 | 15:18 |\r\n| clang | 5:30 | 1:55 |\r\n\r\n| After | -j1 | -j16 |\r\n| --- | --- | --- |\r\n| gcc | 6:58 | 2:05 |\r\n| clang | 5:11 | 1:12 |\r\n\r\nThis PR depends on an [ign-plugin PR here](#!/ignitionrobotics/ign-plugin/pull-requests/32/).", "title": "[Citadel] Improve compile times", "destination": {"commit": {"hash": "c927df47b213", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-physics/commit/c927df47b213.json"}, "html": {"href": "#!/ignitionrobotics/ign-physics/commits/c927df47b213"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-physics.json"}, "html": {"href": "#!/ignitionrobotics/ign-physics"}, "avatar": {"href": "data/bytebucket.org/ravatar/{63a01c4f-5625-443b-96f0-73c4005ccada}ts=c_plus_plus"}}, "type": "repository", "name": "ign-physics", "full_name": "ignitionrobotics/ign-physics", "uuid": "{63a01c4f-5625-443b-96f0-73c4005ccada}"}, "branch": {"name": "default"}}, "reason": "", "source": {"commit": {"hash": "6327de4dda9a", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-physics/commit/6327de4dda9a.json"}, "html": {"href": "#!/ignitionrobotics/ign-physics/commits/6327de4dda9a"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-physics.json"}, "html": {"href": "#!/ignitionrobotics/ign-physics"}, "avatar": {"href": "data/bytebucket.org/ravatar/{63a01c4f-5625-443b-96f0-73c4005ccada}ts=c_plus_plus"}}, "type": "repository", "name": "ign-physics", "full_name": "ignitionrobotics/ign-physics", "uuid": "{63a01c4f-5625-443b-96f0-73c4005ccada}"}, "branch": {"name": "improve_compile_times"}}, "state": "OPEN", "author": {"display_name": "Steve Peters", "uuid": "{2ccfed09-18b8-4921-8d58-15ef01092802}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D"}, "html": {"href": "https://bitbucket.org/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/1fb4816dad9e68337d3096f750951f6cd=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsSP-1.png"}}, "nickname": "Steven Peters", "type": "user", "account_id": "557058:5de38267-b118-494c-aa76-4fab35448816"}, "date": "2019-11-21T01:56:44.470020+00:00"}, "pull_request": {"type": "pullrequest", "id": 88, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-physics/pullrequests/88.json"}, "html": {"href": "#!/ignitionrobotics/ign-physics/pull-requests/88"}}, "title": "[Citadel] Improve compile times"}}, {"comment": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-physics/pullrequests/88/comments/125690972.json"}, "html": {"href": "#!/ignitionrobotics/ign-physics/pull-requests/88/_/diff#comment-125690972"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 88, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-physics/pullrequests/88.json"}, "html": {"href": "#!/ignitionrobotics/ign-physics/pull-requests/88"}}, "title": "[Citadel] Improve compile times"}, "content": {"raw": "new windows test:\n\n* [![Build Status](https://build.osrfoundation.org/buildStatus/icon?job=ign_physics-pr-win&build=412)](https://build.osrfoundation.org/job/ign_physics-pr-win/412/) https://build.osrfoundation.org/job/ign_physics-pr-win/412/", "markup": "markdown", "html": "<p>new windows test:</p>\n<ul>\n<li><a data-is-external-link=\"true\" href=\"https://build.osrfoundation.org/job/ign_physics-pr-win/412/\" rel=\"nofollow\"><img alt=\"Build Status\" src=\"https://build.osrfoundation.org/buildStatus/icon?job=ign_physics-pr-win&amp;build=412\" /></a> <a href=\"https://build.osrfoundation.org/job/ign_physics-pr-win/412/\" rel=\"nofollow\" class=\"ap-connect-link\">https://build.osrfoundation.org/job/ign_physics-pr-win/412/</a></li>\n</ul>", "type": "rendered"}, "created_on": "2019-11-21T01:56:39.183951+00:00", "user": {"display_name": "Steve Peters", "uuid": "{2ccfed09-18b8-4921-8d58-15ef01092802}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D"}, "html": {"href": "https://bitbucket.org/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/1fb4816dad9e68337d3096f750951f6cd=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsSP-1.png"}}, "nickname": "Steven Peters", "type": "user", "account_id": "557058:5de38267-b118-494c-aa76-4fab35448816"}, "updated_on": "2019-11-21T01:56:39.189330+00:00", "type": "pullrequest_comment", "id": 125690972}, "pull_request": {"type": "pullrequest", "id": 88, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-physics/pullrequests/88.json"}, "html": {"href": "#!/ignitionrobotics/ign-physics/pull-requests/88"}}, "title": "[Citadel] Improve compile times"}}, {"update": {"description": "This PR drastically improves the compile times of applications and libraries that use `ign-physics`. The key issue was that the length of symbol names was growing unbounded for classes that were being instantiated from templates. The itanium ABI mangles the names of template arguments into the symbol names of classes that get instantiated from templates, so the full name of each new feature that we added to a link, model, joint, world, etc, was getting mangled into all the symbol names that were being produced.\r\n\r\nThis PR mitigates this by using some class inheritance and SNFINAE tricks that allow us to easily minimize the symbol names. For example, a symbol that used to come out as\r\n\r\n```\r\n_ZTIN8ignition7physics6detail9AggregateINS1_12SelectEngineEvvE4typeIJNS0_13FeaturePolicyIdLm3EEENS0_11FeatureListIJNS8_IJNS0_26GetCylinderShapePropertiesENS0_26SetCylinderShapePropertiesENS0_26AttachCylinderShapeFeatureEEEENS8_IJNS0_26GetRevoluteJointPropertiesENS0_26SetRevoluteJointPropertiesEEEENS8_IJNS0_21GetBoxShapePropertiesENS0_21SetBoxShapePropertiesENS0_21AttachBoxShapeFeatureEEEEEEEEEE\r\n```\r\n\r\ncan now come out as\r\n\r\n```\r\n_ZTIN8ignition7physics6detail9AggregateINS1_12SelectEngineENS1_7GetNextINS4_I15FeatureSetClassvE1nEvE1nEvE4typeIJNS0_13FeaturePolicyIdLm3EEES5_EEE\r\n```\r\n\r\nWe can also add many more features into this symbol without significantly impacting the length of its name. The key is to group features into sets of features using explicit inheritance. For example, we use to do this:\r\n\r\n```\r\nusing MyFeatureList = ignition::physics::FeatureList<\r\n  /* some list of features */\r\n>;\r\n```\r\n\r\nbut now we can do this instead:\r\n\r\n```\r\nstruct MyFeatureList : ignition::physics::FeatureList<\r\n  /* some list of features */\r\n> { };\r\n```\r\n\r\nand the resulting symbol names from using `MyFeatureList` will be very lean and not have any dependence on the lengths of the feature names.\r\n\r\nThis matters primarily because the compile times on GCC seem to grow almost exponentially as the sizes of symbol names increase. Clang is also affected, but not as severely. Here are some charts of the compile times that I observed before and after these changes:\r\n\r\n| Before | -j1 | -j16 |\r\n| --- | --- | --- |\r\n| gcc | 17:59 | 15:18 |\r\n| clang | 5:30 | 1:55 |\r\n\r\n| After | -j1 | -j16 |\r\n| --- | --- | --- |\r\n| gcc | 6:58 | 2:05 |\r\n| clang | 5:11 | 1:12 |\r\n\r\nThis PR depends on an [ign-plugin PR here](#!/ignitionrobotics/ign-plugin/pull-requests/32/).", "title": "[Citadel] Improve compile times", "destination": {"commit": {"hash": "d3fd7dd31317", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-physics/commit/d3fd7dd31317.json"}, "html": {"href": "#!/ignitionrobotics/ign-physics/commits/d3fd7dd31317"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-physics.json"}, "html": {"href": "#!/ignitionrobotics/ign-physics"}, "avatar": {"href": "data/bytebucket.org/ravatar/{63a01c4f-5625-443b-96f0-73c4005ccada}ts=c_plus_plus"}}, "type": "repository", "name": "ign-physics", "full_name": "ignitionrobotics/ign-physics", "uuid": "{63a01c4f-5625-443b-96f0-73c4005ccada}"}, "branch": {"name": "default"}}, "reason": "", "source": {"commit": {"hash": "baad7b4fbde6", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-physics/commit/baad7b4fbde6.json"}, "html": {"href": "#!/ignitionrobotics/ign-physics/commits/baad7b4fbde6"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-physics.json"}, "html": {"href": "#!/ignitionrobotics/ign-physics"}, "avatar": {"href": "data/bytebucket.org/ravatar/{63a01c4f-5625-443b-96f0-73c4005ccada}ts=c_plus_plus"}}, "type": "repository", "name": "ign-physics", "full_name": "ignitionrobotics/ign-physics", "uuid": "{63a01c4f-5625-443b-96f0-73c4005ccada}"}, "branch": {"name": "improve_compile_times"}}, "state": "OPEN", "author": {"display_name": "Louise Poubel", "uuid": "{5cfa2075-477b-4ded-bdb9-8d2479544ec4}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D"}, "html": {"href": "https://bitbucket.org/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8/7d903d90-c5ea-4182-b7ef-0d467e9e1c74/128"}}, "nickname": "chapulina", "type": "user", "account_id": "557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8"}, "date": "2019-11-20T22:27:43.699723+00:00"}, "pull_request": {"type": "pullrequest", "id": 88, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-physics/pullrequests/88.json"}, "html": {"href": "#!/ignitionrobotics/ign-physics/pull-requests/88"}}, "title": "[Citadel] Improve compile times"}}, {"update": {"description": "This PR drastically improves the compile times of applications and libraries that use `ign-physics`. The key issue was that the length of symbol names was growing unbounded for classes that were being instantiated from templates. The itanium ABI mangles the names of template arguments into the symbol names of classes that get instantiated from templates, so the full name of each new feature that we added to a link, model, joint, world, etc, was getting mangled into all the symbol names that were being produced.\r\n\r\nThis PR mitigates this by using some class inheritance and SNFINAE tricks that allow us to easily minimize the symbol names. For example, a symbol that used to come out as\r\n\r\n```\r\n_ZTIN8ignition7physics6detail9AggregateINS1_12SelectEngineEvvE4typeIJNS0_13FeaturePolicyIdLm3EEENS0_11FeatureListIJNS8_IJNS0_26GetCylinderShapePropertiesENS0_26SetCylinderShapePropertiesENS0_26AttachCylinderShapeFeatureEEEENS8_IJNS0_26GetRevoluteJointPropertiesENS0_26SetRevoluteJointPropertiesEEEENS8_IJNS0_21GetBoxShapePropertiesENS0_21SetBoxShapePropertiesENS0_21AttachBoxShapeFeatureEEEEEEEEEE\r\n```\r\n\r\ncan now come out as\r\n\r\n```\r\n_ZTIN8ignition7physics6detail9AggregateINS1_12SelectEngineENS1_7GetNextINS4_I15FeatureSetClassvE1nEvE1nEvE4typeIJNS0_13FeaturePolicyIdLm3EEES5_EEE\r\n```\r\n\r\nWe can also add many more features into this symbol without significantly impacting the length of its name. The key is to group features into sets of features using explicit inheritance. For example, we use to do this:\r\n\r\n```\r\nusing MyFeatureList = ignition::physics::FeatureList<\r\n  /* some list of features */\r\n>;\r\n```\r\n\r\nbut now we can do this instead:\r\n\r\n```\r\nstruct MyFeatureList : ignition::physics::FeatureList<\r\n  /* some list of features */\r\n> { };\r\n```\r\n\r\nand the resulting symbol names from using `MyFeatureList` will be very lean and not have any dependence on the lengths of the feature names.\r\n\r\nThis matters primarily because the compile times on GCC seem to grow almost exponentially as the sizes of symbol names increase. Clang is also affected, but not as severely. Here are some charts of the compile times that I observed before and after these changes:\r\n\r\n| Before | -j1 | -j16 |\r\n| --- | --- | --- |\r\n| gcc | 17:59 | 15:18 |\r\n| clang | 5:30 | 1:55 |\r\n\r\n| After | -j1 | -j16 |\r\n| --- | --- | --- |\r\n| gcc | 6:58 | 2:05 |\r\n| clang | 5:11 | 1:12 |\r\n\r\nThis PR depends on an [ign-plugin PR here](#!/ignitionrobotics/ign-plugin/pull-requests/32/).", "title": "Improve compile times", "destination": {"commit": {"hash": "2f946346f959", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-physics/commit/2f946346f959.json"}, "html": {"href": "#!/ignitionrobotics/ign-physics/commits/2f946346f959"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-physics.json"}, "html": {"href": "#!/ignitionrobotics/ign-physics"}, "avatar": {"href": "data/bytebucket.org/ravatar/{63a01c4f-5625-443b-96f0-73c4005ccada}ts=c_plus_plus"}}, "type": "repository", "name": "ign-physics", "full_name": "ignitionrobotics/ign-physics", "uuid": "{63a01c4f-5625-443b-96f0-73c4005ccada}"}, "branch": {"name": "default"}}, "reason": "", "source": {"commit": {"hash": "baad7b4fbde6", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-physics/commit/baad7b4fbde6.json"}, "html": {"href": "#!/ignitionrobotics/ign-physics/commits/baad7b4fbde6"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-physics.json"}, "html": {"href": "#!/ignitionrobotics/ign-physics"}, "avatar": {"href": "data/bytebucket.org/ravatar/{63a01c4f-5625-443b-96f0-73c4005ccada}ts=c_plus_plus"}}, "type": "repository", "name": "ign-physics", "full_name": "ignitionrobotics/ign-physics", "uuid": "{63a01c4f-5625-443b-96f0-73c4005ccada}"}, "branch": {"name": "improve_compile_times"}}, "state": "OPEN", "author": {"display_name": "Steve Peters", "uuid": "{2ccfed09-18b8-4921-8d58-15ef01092802}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D"}, "html": {"href": "https://bitbucket.org/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/1fb4816dad9e68337d3096f750951f6cd=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsSP-1.png"}}, "nickname": "Steven Peters", "type": "user", "account_id": "557058:5de38267-b118-494c-aa76-4fab35448816"}, "date": "2019-06-19T17:04:07.869614+00:00"}, "pull_request": {"type": "pullrequest", "id": 88, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-physics/pullrequests/88.json"}, "html": {"href": "#!/ignitionrobotics/ign-physics/pull-requests/88"}}, "title": "[Citadel] Improve compile times"}}, {"update": {"description": "This PR drastically improves the compile times of applications and libraries that use `ign-physics`. The key issue was that the length of symbol names was growing unbounded for classes that were being instantiated from templates. The itanium ABI mangles the names of template arguments into the symbol names of classes that get instantiated from templates, so the full name of each new feature that we added to a link, model, joint, world, etc, was getting mangled into all the symbol names that were being produced.\r\n\r\nThis PR mitigates this by using some class inheritance and SNFINAE tricks that allow us to easily minimize the symbol names. For example, a symbol that used to come out as\r\n\r\n```\r\n_ZTIN8ignition7physics6detail9AggregateINS1_12SelectEngineEvvE4typeIJNS0_13FeaturePolicyIdLm3EEENS0_11FeatureListIJNS8_IJNS0_26GetCylinderShapePropertiesENS0_26SetCylinderShapePropertiesENS0_26AttachCylinderShapeFeatureEEEENS8_IJNS0_26GetRevoluteJointPropertiesENS0_26SetRevoluteJointPropertiesEEEENS8_IJNS0_21GetBoxShapePropertiesENS0_21SetBoxShapePropertiesENS0_21AttachBoxShapeFeatureEEEEEEEEEE\r\n```\r\n\r\ncan now come out as\r\n\r\n```\r\n_ZTIN8ignition7physics6detail9AggregateINS1_12SelectEngineENS1_7GetNextINS4_I15FeatureSetClassvE1nEvE1nEvE4typeIJNS0_13FeaturePolicyIdLm3EEES5_EEE\r\n```\r\n\r\nWe can also add many more features into this symbol without significantly impacting the length of its name. The key is to group features into sets of features using explicit inheritance. For example, we use to do this:\r\n\r\n```\r\nusing MyFeatureList = ignition::physics::FeatureList<\r\n  /* some list of features */\r\n>;\r\n```\r\n\r\nbut now we can do this instead:\r\n\r\n```\r\nstruct MyFeatureList : ignition::physics::FeatureList<\r\n  /* some list of features */\r\n> { };\r\n```\r\n\r\nand the resulting symbol names from using `MyFeatureList` will be very lean and not have any dependence on the lengths of the feature names.\r\n\r\nThis matters primarily because the compile times on GCC seem to grow almost exponentially as the sizes of symbol names increase. Clang is also affected, but not as severely. Here are some charts of the compile times that I observed before and after these changes:\r\n\r\n| Before | -j1 | -j16 |\r\n| --- | --- | --- |\r\n| gcc | 17:59 | 15:18 |\r\n| clang | 5:30 | 1:55 |\r\n\r\n| After | -j1 | -j16 |\r\n| --- | --- | --- |\r\n| gcc | 6:58 | 2:05 |\r\n| clang | 5:11 | 1:12 |\r\n\r\nThis PR depends on an [ign-plugin PR here](#!/ignitionrobotics/ign-plugin/pull-requests/32/).", "title": "Improve compile times", "destination": {"commit": {"hash": "2f946346f959", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-physics/commit/2f946346f959.json"}, "html": {"href": "#!/ignitionrobotics/ign-physics/commits/2f946346f959"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-physics.json"}, "html": {"href": "#!/ignitionrobotics/ign-physics"}, "avatar": {"href": "data/bytebucket.org/ravatar/{63a01c4f-5625-443b-96f0-73c4005ccada}ts=c_plus_plus"}}, "type": "repository", "name": "ign-physics", "full_name": "ignitionrobotics/ign-physics", "uuid": "{63a01c4f-5625-443b-96f0-73c4005ccada}"}, "branch": {"name": "default"}}, "reason": "", "source": {"commit": {"hash": "5a52ebecbd2a", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-physics/commit/5a52ebecbd2a.json"}, "html": {"href": "#!/ignitionrobotics/ign-physics/commits/5a52ebecbd2a"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-physics.json"}, "html": {"href": "#!/ignitionrobotics/ign-physics"}, "avatar": {"href": "data/bytebucket.org/ravatar/{63a01c4f-5625-443b-96f0-73c4005ccada}ts=c_plus_plus"}}, "type": "repository", "name": "ign-physics", "full_name": "ignitionrobotics/ign-physics", "uuid": "{63a01c4f-5625-443b-96f0-73c4005ccada}"}, "branch": {"name": "improve_compile_times"}}, "state": "OPEN", "author": {"display_name": "Steve Peters", "uuid": "{2ccfed09-18b8-4921-8d58-15ef01092802}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D"}, "html": {"href": "https://bitbucket.org/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/1fb4816dad9e68337d3096f750951f6cd=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsSP-1.png"}}, "nickname": "Steven Peters", "type": "user", "account_id": "557058:5de38267-b118-494c-aa76-4fab35448816"}, "date": "2019-06-19T17:01:56.119197+00:00"}, "pull_request": {"type": "pullrequest", "id": 88, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-physics/pullrequests/88.json"}, "html": {"href": "#!/ignitionrobotics/ign-physics/pull-requests/88"}}, "title": "[Citadel] Improve compile times"}}, {"comment": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-physics/pullrequests/88/comments/106008527.json"}, "html": {"href": "#!/ignitionrobotics/ign-physics/pull-requests/88/_/diff#comment-106008527"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 88, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-physics/pullrequests/88.json"}, "html": {"href": "#!/ignitionrobotics/ign-physics/pull-requests/88"}}, "title": "[Citadel] Improve compile times"}, "content": {"raw": "I think something about this PR also makes it more amenable to ccache, `make -j16` only takes about 11s to execute on repeat invocations. :100: ", "markup": "markdown", "html": "<p>I think something about this PR also makes it more amenable to ccache, <code>make -j16</code> only takes about 11s to execute on repeat invocations. <img class=\"emoji\" src=\"data/pf-emoji-service--cdn.us-east-1.prod.public.atl-paas.net/standard/551c9814-1d37-4573-819d-afab3afeaf32/48x48/1f4af.png\" alt=\"\ud83d\udcaf\" title=\":100:\" data-emoji-short-name=\":100:\" /> </p>", "type": "rendered"}, "created_on": "2019-06-17T20:51:48.168022+00:00", "user": {"display_name": "Michael Carroll", "uuid": "{17dbbc15-cbc0-42f0-a985-cde9061c78a0}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B17dbbc15-cbc0-42f0-a985-cde9061c78a0%7D"}, "html": {"href": "https://bitbucket.org/%7B17dbbc15-cbc0-42f0-a985-cde9061c78a0%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:65740f22-cc56-4418-9608-7e17d0ed47b7/2aa259f5-4de1-4f68-9156-eded72041d84/128"}}, "nickname": "Michael Carroll", "type": "user", "account_id": "557058:65740f22-cc56-4418-9608-7e17d0ed47b7"}, "updated_on": "2019-06-17T20:51:48.178495+00:00", "type": "pullrequest_comment", "id": 106008527}, "pull_request": {"type": "pullrequest", "id": 88, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-physics/pullrequests/88.json"}, "html": {"href": "#!/ignitionrobotics/ign-physics/pull-requests/88"}}, "title": "[Citadel] Improve compile times"}}, {"comment": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-physics/pullrequests/88/comments/103920525.json"}, "html": {"href": "#!/ignitionrobotics/ign-physics/pull-requests/88/_/diff#comment-103920525"}}, "parent": {"id": 103896942, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-physics/pullrequests/88/comments/103896942.json"}, "html": {"href": "#!/ignitionrobotics/ign-physics/pull-requests/88/_/diff#comment-103896942"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 88, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-physics/pullrequests/88.json"}, "html": {"href": "#!/ignitionrobotics/ign-physics/pull-requests/88"}}, "title": "[Citadel] Improve compile times"}, "content": {"raw": "ok, I probably had something funky in my setup, like a deb of ign-plugin installed to /usr while testing in a colcon workspace. it looks like the pipeline is passing without these problems. sorry for the distraction", "markup": "markdown", "html": "<p>ok, I probably had something funky in my setup, like a deb of ign-plugin installed to /usr while testing in a colcon workspace. it looks like the pipeline is passing without these problems. sorry for the distraction</p>", "type": "rendered"}, "created_on": "2019-05-30T08:01:58.802077+00:00", "user": {"display_name": "Steve Peters", "uuid": "{2ccfed09-18b8-4921-8d58-15ef01092802}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D"}, "html": {"href": "https://bitbucket.org/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/1fb4816dad9e68337d3096f750951f6cd=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsSP-1.png"}}, "nickname": "Steven Peters", "type": "user", "account_id": "557058:5de38267-b118-494c-aa76-4fab35448816"}, "updated_on": "2019-05-30T08:01:58.827511+00:00", "type": "pullrequest_comment", "id": 103920525}, "pull_request": {"type": "pullrequest", "id": 88, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-physics/pullrequests/88.json"}, "html": {"href": "#!/ignitionrobotics/ign-physics/pull-requests/88"}}, "title": "[Citadel] Improve compile times"}}, {"update": {"description": "This PR drastically improves the compile times of applications and libraries that use `ign-physics`. The key issue was that the length of symbol names was growing unbounded for classes that were being instantiated from templates. The itanium ABI mangles the names of template arguments into the symbol names of classes that get instantiated from templates, so the full name of each new feature that we added to a link, model, joint, world, etc, was getting mangled into all the symbol names that were being produced.\r\n\r\nThis PR mitigates this by using some class inheritance and SNFINAE tricks that allow us to easily minimize the symbol names. For example, a symbol that used to come out as\r\n\r\n```\r\n_ZTIN8ignition7physics6detail9AggregateINS1_12SelectEngineEvvE4typeIJNS0_13FeaturePolicyIdLm3EEENS0_11FeatureListIJNS8_IJNS0_26GetCylinderShapePropertiesENS0_26SetCylinderShapePropertiesENS0_26AttachCylinderShapeFeatureEEEENS8_IJNS0_26GetRevoluteJointPropertiesENS0_26SetRevoluteJointPropertiesEEEENS8_IJNS0_21GetBoxShapePropertiesENS0_21SetBoxShapePropertiesENS0_21AttachBoxShapeFeatureEEEEEEEEEE\r\n```\r\n\r\ncan now come out as\r\n\r\n```\r\n_ZTIN8ignition7physics6detail9AggregateINS1_12SelectEngineENS1_7GetNextINS4_I15FeatureSetClassvE1nEvE1nEvE4typeIJNS0_13FeaturePolicyIdLm3EEES5_EEE\r\n```\r\n\r\nWe can also add many more features into this symbol without significantly impacting the length of its name. The key is to group features into sets of features using explicit inheritance. For example, we use to do this:\r\n\r\n```\r\nusing MyFeatureList = ignition::physics::FeatureList<\r\n  /* some list of features */\r\n>;\r\n```\r\n\r\nbut now we can do this instead:\r\n\r\n```\r\nstruct MyFeatureList : ignition::physics::FeatureList<\r\n  /* some list of features */\r\n> { };\r\n```\r\n\r\nand the resulting symbol names from using `MyFeatureList` will be very lean and not have any dependence on the lengths of the feature names.\r\n\r\nThis matters primarily because the compile times on GCC seem to grow almost exponentially as the sizes of symbol names increase. Clang is also affected, but not as severely. Here are some charts of the compile times that I observed before and after these changes:\r\n\r\n| Before | -j1 | -j16 |\r\n| --- | --- | --- |\r\n| gcc | 17:59 | 15:18 |\r\n| clang | 5:30 | 1:55 |\r\n\r\n| After | -j1 | -j16 |\r\n| --- | --- | --- |\r\n| gcc | 6:58 | 2:05 |\r\n| clang | 5:11 | 1:12 |\r\n\r\nThis PR depends on an [ign-plugin PR here](#!/ignitionrobotics/ign-plugin/pull-requests/32/).", "title": "Improve compile times", "destination": {"commit": {"hash": "2f946346f959", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-physics/commit/2f946346f959.json"}, "html": {"href": "#!/ignitionrobotics/ign-physics/commits/2f946346f959"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-physics.json"}, "html": {"href": "#!/ignitionrobotics/ign-physics"}, "avatar": {"href": "data/bytebucket.org/ravatar/{63a01c4f-5625-443b-96f0-73c4005ccada}ts=c_plus_plus"}}, "type": "repository", "name": "ign-physics", "full_name": "ignitionrobotics/ign-physics", "uuid": "{63a01c4f-5625-443b-96f0-73c4005ccada}"}, "branch": {"name": "default"}}, "reason": "", "source": {"commit": {"hash": "5bd3196feb6d", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-physics/commit/5bd3196feb6d.json"}, "html": {"href": "#!/ignitionrobotics/ign-physics/commits/5bd3196feb6d"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-physics.json"}, "html": {"href": "#!/ignitionrobotics/ign-physics"}, "avatar": {"href": "data/bytebucket.org/ravatar/{63a01c4f-5625-443b-96f0-73c4005ccada}ts=c_plus_plus"}}, "type": "repository", "name": "ign-physics", "full_name": "ignitionrobotics/ign-physics", "uuid": "{63a01c4f-5625-443b-96f0-73c4005ccada}"}, "branch": {"name": "improve_compile_times"}}, "state": "OPEN", "author": {"display_name": "Steve Peters", "uuid": "{2ccfed09-18b8-4921-8d58-15ef01092802}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D"}, "html": {"href": "https://bitbucket.org/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/1fb4816dad9e68337d3096f750951f6cd=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsSP-1.png"}}, "nickname": "Steven Peters", "type": "user", "account_id": "557058:5de38267-b118-494c-aa76-4fab35448816"}, "date": "2019-05-30T07:48:00.921955+00:00"}, "pull_request": {"type": "pullrequest", "id": 88, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-physics/pullrequests/88.json"}, "html": {"href": "#!/ignitionrobotics/ign-physics/pull-requests/88"}}, "title": "[Citadel] Improve compile times"}}, {"update": {"description": "This PR drastically improves the compile times of applications and libraries that use `ign-physics`. The key issue was that the length of symbol names was growing unbounded for classes that were being instantiated from templates. The itanium ABI mangles the names of template arguments into the symbol names of classes that get instantiated from templates, so the full name of each new feature that we added to a link, model, joint, world, etc, was getting mangled into all the symbol names that were being produced.\r\n\r\nThis PR mitigates this by using some class inheritance and SNFINAE tricks that allow us to easily minimize the symbol names. For example, a symbol that used to come out as\r\n\r\n```\r\n_ZTIN8ignition7physics6detail9AggregateINS1_12SelectEngineEvvE4typeIJNS0_13FeaturePolicyIdLm3EEENS0_11FeatureListIJNS8_IJNS0_26GetCylinderShapePropertiesENS0_26SetCylinderShapePropertiesENS0_26AttachCylinderShapeFeatureEEEENS8_IJNS0_26GetRevoluteJointPropertiesENS0_26SetRevoluteJointPropertiesEEEENS8_IJNS0_21GetBoxShapePropertiesENS0_21SetBoxShapePropertiesENS0_21AttachBoxShapeFeatureEEEEEEEEEE\r\n```\r\n\r\ncan now come out as\r\n\r\n```\r\n_ZTIN8ignition7physics6detail9AggregateINS1_12SelectEngineENS1_7GetNextINS4_I15FeatureSetClassvE1nEvE1nEvE4typeIJNS0_13FeaturePolicyIdLm3EEES5_EEE\r\n```\r\n\r\nWe can also add many more features into this symbol without significantly impacting the length of its name. The key is to group features into sets of features using explicit inheritance. For example, we use to do this:\r\n\r\n```\r\nusing MyFeatureList = ignition::physics::FeatureList<\r\n  /* some list of features */\r\n>;\r\n```\r\n\r\nbut now we can do this instead:\r\n\r\n```\r\nstruct MyFeatureList : ignition::physics::FeatureList<\r\n  /* some list of features */\r\n> { };\r\n```\r\n\r\nand the resulting symbol names from using `MyFeatureList` will be very lean and not have any dependence on the lengths of the feature names.\r\n\r\nThis matters primarily because the compile times on GCC seem to grow almost exponentially as the sizes of symbol names increase. Clang is also affected, but not as severely. Here are some charts of the compile times that I observed before and after these changes:\r\n\r\n| Before | -j1 | -j16 |\r\n| --- | --- | --- |\r\n| gcc | 17:59 | 15:18 |\r\n| clang | 5:30 | 1:55 |\r\n\r\n| After | -j1 | -j16 |\r\n| --- | --- | --- |\r\n| gcc | 6:58 | 2:05 |\r\n| clang | 5:11 | 1:12 |\r\n\r\nThis PR depends on an [ign-plugin PR here](#!/ignitionrobotics/ign-plugin/pull-requests/32/).", "title": "Improve compile times", "destination": {"commit": {"hash": "2f946346f959", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-physics/commit/2f946346f959.json"}, "html": {"href": "#!/ignitionrobotics/ign-physics/commits/2f946346f959"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-physics.json"}, "html": {"href": "#!/ignitionrobotics/ign-physics"}, "avatar": {"href": "data/bytebucket.org/ravatar/{63a01c4f-5625-443b-96f0-73c4005ccada}ts=c_plus_plus"}}, "type": "repository", "name": "ign-physics", "full_name": "ignitionrobotics/ign-physics", "uuid": "{63a01c4f-5625-443b-96f0-73c4005ccada}"}, "branch": {"name": "default"}}, "reason": "", "source": {"commit": {"hash": "66105a126028", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-physics/commit/66105a126028.json"}, "html": {"href": "#!/ignitionrobotics/ign-physics/commits/66105a126028"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-physics.json"}, "html": {"href": "#!/ignitionrobotics/ign-physics"}, "avatar": {"href": "data/bytebucket.org/ravatar/{63a01c4f-5625-443b-96f0-73c4005ccada}ts=c_plus_plus"}}, "type": "repository", "name": "ign-physics", "full_name": "ignitionrobotics/ign-physics", "uuid": "{63a01c4f-5625-443b-96f0-73c4005ccada}"}, "branch": {"name": "improve_compile_times"}}, "state": "OPEN", "author": {"display_name": "Steve Peters", "uuid": "{2ccfed09-18b8-4921-8d58-15ef01092802}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D"}, "html": {"href": "https://bitbucket.org/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/1fb4816dad9e68337d3096f750951f6cd=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsSP-1.png"}}, "nickname": "Steven Peters", "type": "user", "account_id": "557058:5de38267-b118-494c-aa76-4fab35448816"}, "date": "2019-05-30T07:32:07.065963+00:00"}, "pull_request": {"type": "pullrequest", "id": 88, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-physics/pullrequests/88.json"}, "html": {"href": "#!/ignitionrobotics/ign-physics/pull-requests/88"}}, "title": "[Citadel] Improve compile times"}}, {"update": {"description": "This PR drastically improves the compile times of applications and libraries that use `ign-physics`. The key issue was that the length of symbol names was growing unbounded for classes that were being instantiated from templates. The itanium ABI mangles the names of template arguments into the symbol names of classes that get instantiated from templates, so the full name of each new feature that we added to a link, model, joint, world, etc, was getting mangled into all the symbol names that were being produced.\r\n\r\nThis PR mitigates this by using some class inheritance and SNFINAE tricks that allow us to easily minimize the symbol names. For example, a symbol that used to come out as\r\n\r\n```\r\n_ZTIN8ignition7physics6detail9AggregateINS1_12SelectEngineEvvE4typeIJNS0_13FeaturePolicyIdLm3EEENS0_11FeatureListIJNS8_IJNS0_26GetCylinderShapePropertiesENS0_26SetCylinderShapePropertiesENS0_26AttachCylinderShapeFeatureEEEENS8_IJNS0_26GetRevoluteJointPropertiesENS0_26SetRevoluteJointPropertiesEEEENS8_IJNS0_21GetBoxShapePropertiesENS0_21SetBoxShapePropertiesENS0_21AttachBoxShapeFeatureEEEEEEEEEE\r\n```\r\n\r\ncan now come out as\r\n\r\n```\r\n_ZTIN8ignition7physics6detail9AggregateINS1_12SelectEngineENS1_7GetNextINS4_I15FeatureSetClassvE1nEvE1nEvE4typeIJNS0_13FeaturePolicyIdLm3EEES5_EEE\r\n```\r\n\r\nWe can also add many more features into this symbol without significantly impacting the length of its name. The key is to group features into sets of features using explicit inheritance. For example, we use to do this:\r\n\r\n```\r\nusing MyFeatureList = ignition::physics::FeatureList<\r\n  /* some list of features */\r\n>;\r\n```\r\n\r\nbut now we can do this instead:\r\n\r\n```\r\nstruct MyFeatureList : ignition::physics::FeatureList<\r\n  /* some list of features */\r\n> { };\r\n```\r\n\r\nand the resulting symbol names from using `MyFeatureList` will be very lean and not have any dependence on the lengths of the feature names.\r\n\r\nThis matters primarily because the compile times on GCC seem to grow almost exponentially as the sizes of symbol names increase. Clang is also affected, but not as severely. Here are some charts of the compile times that I observed before and after these changes:\r\n\r\n| Before | -j1 | -j16 |\r\n| --- | --- | --- |\r\n| gcc | 17:59 | 15:18 |\r\n| clang | 5:30 | 1:55 |\r\n\r\n| After | -j1 | -j16 |\r\n| --- | --- | --- |\r\n| gcc | 6:58 | 2:05 |\r\n| clang | 5:11 | 1:12 |\r\n\r\nThis PR depends on an [ign-plugin PR here](#!/ignitionrobotics/ign-plugin/pull-requests/32/).", "title": "Improve compile times", "destination": {"commit": {"hash": "2f946346f959", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-physics/commit/2f946346f959.json"}, "html": {"href": "#!/ignitionrobotics/ign-physics/commits/2f946346f959"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-physics.json"}, "html": {"href": "#!/ignitionrobotics/ign-physics"}, "avatar": {"href": "data/bytebucket.org/ravatar/{63a01c4f-5625-443b-96f0-73c4005ccada}ts=c_plus_plus"}}, "type": "repository", "name": "ign-physics", "full_name": "ignitionrobotics/ign-physics", "uuid": "{63a01c4f-5625-443b-96f0-73c4005ccada}"}, "branch": {"name": "default"}}, "reason": "", "source": {"commit": {"hash": "1520ab0f084c", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-physics/commit/1520ab0f084c.json"}, "html": {"href": "#!/ignitionrobotics/ign-physics/commits/1520ab0f084c"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-physics.json"}, "html": {"href": "#!/ignitionrobotics/ign-physics"}, "avatar": {"href": "data/bytebucket.org/ravatar/{63a01c4f-5625-443b-96f0-73c4005ccada}ts=c_plus_plus"}}, "type": "repository", "name": "ign-physics", "full_name": "ignitionrobotics/ign-physics", "uuid": "{63a01c4f-5625-443b-96f0-73c4005ccada}"}, "branch": {"name": "improve_compile_times"}}, "state": "OPEN", "author": {"display_name": "Michael Grey", "uuid": "{c1cdfe52-2887-474c-ae99-72fdc53a59c9}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Bc1cdfe52-2887-474c-ae99-72fdc53a59c9%7D"}, "html": {"href": "https://bitbucket.org/%7Bc1cdfe52-2887-474c-ae99-72fdc53a59c9%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:67759e29-d1df-465f-868d-047738e36fc9/d42d74cf-c1bd-4431-8288-07f543bbe325/128"}}, "nickname": "mxgrey", "type": "user", "account_id": "557058:67759e29-d1df-465f-868d-047738e36fc9"}, "date": "2019-05-30T04:22:27.125204+00:00"}, "pull_request": {"type": "pullrequest", "id": 88, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-physics/pullrequests/88.json"}, "html": {"href": "#!/ignitionrobotics/ign-physics/pull-requests/88"}}, "title": "[Citadel] Improve compile times"}}, {"comment": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-physics/pullrequests/88/comments/103896942.json"}, "html": {"href": "#!/ignitionrobotics/ign-physics/pull-requests/88/_/diff#comment-103896942"}}, "parent": {"id": 103220096, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-physics/pullrequests/88/comments/103220096.json"}, "html": {"href": "#!/ignitionrobotics/ign-physics/pull-requests/88/_/diff#comment-103220096"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 88, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-physics/pullrequests/88.json"}, "html": {"href": "#!/ignitionrobotics/ign-physics/pull-requests/88"}}, "title": "[Citadel] Improve compile times"}, "content": {"raw": "Could you elaborate on what your setup is where you\u2019re seeing these errors? On Ubuntu 18.04, I\u2019ve tried building with both GCC and Clang in Debug, Release, and RelWithDebInfo modes, and none of those combinations are producing any kind of exception, seg fault, or any teardown issue on any of the tests.\n\nAlso, nothing about memory, storage, or data of any kind is being affected by these changes. The only thing that\u2019s changing is the inheritance structure, but all objects in that inheritance structure are empty.", "markup": "markdown", "html": "<p>Could you elaborate on what your setup is where you\u2019re seeing these errors? On Ubuntu 18.04, I\u2019ve tried building with both GCC and Clang in Debug, Release, and RelWithDebInfo modes, and none of those combinations are producing any kind of exception, seg fault, or any teardown issue on any of the tests.</p>\n<p>Also, nothing about memory, storage, or data of any kind is being affected by these changes. The only thing that\u2019s changing is the inheritance structure, but all objects in that inheritance structure are empty.</p>", "type": "rendered"}, "created_on": "2019-05-30T02:58:18.737867+00:00", "user": {"display_name": "Michael Grey", "uuid": "{c1cdfe52-2887-474c-ae99-72fdc53a59c9}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Bc1cdfe52-2887-474c-ae99-72fdc53a59c9%7D"}, "html": {"href": "https://bitbucket.org/%7Bc1cdfe52-2887-474c-ae99-72fdc53a59c9%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:67759e29-d1df-465f-868d-047738e36fc9/d42d74cf-c1bd-4431-8288-07f543bbe325/128"}}, "nickname": "mxgrey", "type": "user", "account_id": "557058:67759e29-d1df-465f-868d-047738e36fc9"}, "updated_on": "2019-05-30T02:58:18.748551+00:00", "type": "pullrequest_comment", "id": 103896942}, "pull_request": {"type": "pullrequest", "id": 88, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-physics/pullrequests/88.json"}, "html": {"href": "#!/ignitionrobotics/ign-physics/pull-requests/88"}}, "title": "[Citadel] Improve compile times"}}, {"comment": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-physics/pullrequests/88/comments/103896301.json"}, "html": {"href": "#!/ignitionrobotics/ign-physics/pull-requests/88/_/diff#comment-103896301"}}, "parent": {"id": 103219359, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-physics/pullrequests/88/comments/103219359.json"}, "html": {"href": "#!/ignitionrobotics/ign-physics/pull-requests/88/_/diff#comment-103219359"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 88, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-physics/pullrequests/88.json"}, "html": {"href": "#!/ignitionrobotics/ign-physics/pull-requests/88"}}, "title": "[Citadel] Improve compile times"}, "content": {"raw": "Sorry, fixed by adding a `virtual` keyword: [426166e](#!/ignitionrobotics/ign-physics/commits/426166e0c06429c4b4cbe0a7dfb5515801523093?at=default)", "markup": "markdown", "html": "<p>Sorry, fixed by adding a <code>virtual</code> keyword: <a data-is-external-link=\"true\" href=\"#!/ignitionrobotics/ign-physics/commits/426166e0c06429c4b4cbe0a7dfb5515801523093?at=default\" rel=\"nofollow\">426166e</a></p>", "type": "rendered"}, "created_on": "2019-05-30T02:44:21.324022+00:00", "user": {"display_name": "Michael Grey", "uuid": "{c1cdfe52-2887-474c-ae99-72fdc53a59c9}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Bc1cdfe52-2887-474c-ae99-72fdc53a59c9%7D"}, "html": {"href": "https://bitbucket.org/%7Bc1cdfe52-2887-474c-ae99-72fdc53a59c9%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:67759e29-d1df-465f-868d-047738e36fc9/d42d74cf-c1bd-4431-8288-07f543bbe325/128"}}, "nickname": "mxgrey", "type": "user", "account_id": "557058:67759e29-d1df-465f-868d-047738e36fc9"}, "updated_on": "2019-05-30T02:44:21.332851+00:00", "type": "pullrequest_comment", "id": 103896301}, "pull_request": {"type": "pullrequest", "id": 88, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-physics/pullrequests/88.json"}, "html": {"href": "#!/ignitionrobotics/ign-physics/pull-requests/88"}}, "title": "[Citadel] Improve compile times"}}, {"update": {"description": "This PR drastically improves the compile times of applications and libraries that use `ign-physics`. The key issue was that the length of symbol names was growing unbounded for classes that were being instantiated from templates. The itanium ABI mangles the names of template arguments into the symbol names of classes that get instantiated from templates, so the full name of each new feature that we added to a link, model, joint, world, etc, was getting mangled into all the symbol names that were being produced.\r\n\r\nThis PR mitigates this by using some class inheritance and SNFINAE tricks that allow us to easily minimize the symbol names. For example, a symbol that used to come out as\r\n\r\n```\r\n_ZTIN8ignition7physics6detail9AggregateINS1_12SelectEngineEvvE4typeIJNS0_13FeaturePolicyIdLm3EEENS0_11FeatureListIJNS8_IJNS0_26GetCylinderShapePropertiesENS0_26SetCylinderShapePropertiesENS0_26AttachCylinderShapeFeatureEEEENS8_IJNS0_26GetRevoluteJointPropertiesENS0_26SetRevoluteJointPropertiesEEEENS8_IJNS0_21GetBoxShapePropertiesENS0_21SetBoxShapePropertiesENS0_21AttachBoxShapeFeatureEEEEEEEEEE\r\n```\r\n\r\ncan now come out as\r\n\r\n```\r\n_ZTIN8ignition7physics6detail9AggregateINS1_12SelectEngineENS1_7GetNextINS4_I15FeatureSetClassvE1nEvE1nEvE4typeIJNS0_13FeaturePolicyIdLm3EEES5_EEE\r\n```\r\n\r\nWe can also add many more features into this symbol without significantly impacting the length of its name. The key is to group features into sets of features using explicit inheritance. For example, we use to do this:\r\n\r\n```\r\nusing MyFeatureList = ignition::physics::FeatureList<\r\n  /* some list of features */\r\n>;\r\n```\r\n\r\nbut now we can do this instead:\r\n\r\n```\r\nstruct MyFeatureList : ignition::physics::FeatureList<\r\n  /* some list of features */\r\n> { };\r\n```\r\n\r\nand the resulting symbol names from using `MyFeatureList` will be very lean and not have any dependence on the lengths of the feature names.\r\n\r\nThis matters primarily because the compile times on GCC seem to grow almost exponentially as the sizes of symbol names increase. Clang is also affected, but not as severely. Here are some charts of the compile times that I observed before and after these changes:\r\n\r\n| Before | -j1 | -j16 |\r\n| --- | --- | --- |\r\n| gcc | 17:59 | 15:18 |\r\n| clang | 5:30 | 1:55 |\r\n\r\n| After | -j1 | -j16 |\r\n| --- | --- | --- |\r\n| gcc | 6:58 | 2:05 |\r\n| clang | 5:11 | 1:12 |\r\n\r\nThis PR depends on an [ign-plugin PR here](#!/ignitionrobotics/ign-plugin/pull-requests/32/).", "title": "Improve compile times", "destination": {"commit": {"hash": "2f946346f959", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-physics/commit/2f946346f959.json"}, "html": {"href": "#!/ignitionrobotics/ign-physics/commits/2f946346f959"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-physics.json"}, "html": {"href": "#!/ignitionrobotics/ign-physics"}, "avatar": {"href": "data/bytebucket.org/ravatar/{63a01c4f-5625-443b-96f0-73c4005ccada}ts=c_plus_plus"}}, "type": "repository", "name": "ign-physics", "full_name": "ignitionrobotics/ign-physics", "uuid": "{63a01c4f-5625-443b-96f0-73c4005ccada}"}, "branch": {"name": "default"}}, "reason": "", "source": {"commit": {"hash": "426166e0c064", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-physics/commit/426166e0c064.json"}, "html": {"href": "#!/ignitionrobotics/ign-physics/commits/426166e0c064"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-physics.json"}, "html": {"href": "#!/ignitionrobotics/ign-physics"}, "avatar": {"href": "data/bytebucket.org/ravatar/{63a01c4f-5625-443b-96f0-73c4005ccada}ts=c_plus_plus"}}, "type": "repository", "name": "ign-physics", "full_name": "ignitionrobotics/ign-physics", "uuid": "{63a01c4f-5625-443b-96f0-73c4005ccada}"}, "branch": {"name": "improve_compile_times"}}, "state": "OPEN", "author": {"display_name": "Michael Grey", "uuid": "{c1cdfe52-2887-474c-ae99-72fdc53a59c9}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Bc1cdfe52-2887-474c-ae99-72fdc53a59c9%7D"}, "html": {"href": "https://bitbucket.org/%7Bc1cdfe52-2887-474c-ae99-72fdc53a59c9%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:67759e29-d1df-465f-868d-047738e36fc9/d42d74cf-c1bd-4431-8288-07f543bbe325/128"}}, "nickname": "mxgrey", "type": "user", "account_id": "557058:67759e29-d1df-465f-868d-047738e36fc9"}, "date": "2019-05-30T02:39:49.800031+00:00"}, "pull_request": {"type": "pullrequest", "id": 88, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-physics/pullrequests/88.json"}, "html": {"href": "#!/ignitionrobotics/ign-physics/pull-requests/88"}}, "title": "[Citadel] Improve compile times"}}, {"comment": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-physics/pullrequests/88/comments/103857546.json"}, "html": {"href": "#!/ignitionrobotics/ign-physics/pull-requests/88/_/diff#comment-103857546"}}, "parent": {"id": 103856870, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-physics/pullrequests/88/comments/103856870.json"}, "html": {"href": "#!/ignitionrobotics/ign-physics/pull-requests/88/_/diff#comment-103856870"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 88, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-physics/pullrequests/88.json"}, "html": {"href": "#!/ignitionrobotics/ign-physics/pull-requests/88"}}, "title": "[Citadel] Improve compile times"}, "content": {"raw": "In fact, I would make a pull request with just the changes to the header files, which wouldn't have any speed-up but should confirm that it's backwards compatible. Then we can target a separate pull request with the other changes that actually speed things up", "markup": "markdown", "html": "<p>In fact, I would make a pull request with just the changes to the header files, which wouldn't have any speed-up but should confirm that it's backwards compatible. Then we can target a separate pull request with the other changes that actually speed things up</p>", "type": "rendered"}, "created_on": "2019-05-29T18:07:36.177879+00:00", "user": {"display_name": "Steve Peters", "uuid": "{2ccfed09-18b8-4921-8d58-15ef01092802}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D"}, "html": {"href": "https://bitbucket.org/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/1fb4816dad9e68337d3096f750951f6cd=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsSP-1.png"}}, "nickname": "Steven Peters", "type": "user", "account_id": "557058:5de38267-b118-494c-aa76-4fab35448816"}, "updated_on": "2019-05-29T18:07:36.195842+00:00", "type": "pullrequest_comment", "id": 103857546}, "pull_request": {"type": "pullrequest", "id": 88, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-physics/pullrequests/88.json"}, "html": {"href": "#!/ignitionrobotics/ign-physics/pull-requests/88"}}, "title": "[Citadel] Improve compile times"}}, {"comment": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-physics/pullrequests/88/comments/103856870.json"}, "html": {"href": "#!/ignitionrobotics/ign-physics/pull-requests/88/_/diff#comment-103856870"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 88, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-physics/pullrequests/88.json"}, "html": {"href": "#!/ignitionrobotics/ign-physics/pull-requests/88"}}, "title": "[Citadel] Improve compile times"}, "content": {"raw": "I just applied the changes to the include folder to `ign-physics1` and built against the ign-plugin branch, and it didn't have any compilation problems. I also ran it through the abi checker with `-quick` (otherwise it runs out of memory), and it didn't have any complaints either.\n\nI think it would be safe to rebase this and target it to `ign-physics1`", "markup": "markdown", "html": "<p>I just applied the changes to the include folder to <code>ign-physics1</code> and built against the ign-plugin branch, and it didn't have any compilation problems. I also ran it through the abi checker with <code>-quick</code> (otherwise it runs out of memory), and it didn't have any complaints either.</p>\n<p>I think it would be safe to rebase this and target it to <code>ign-physics1</code></p>", "type": "rendered"}, "created_on": "2019-05-29T18:01:21.760978+00:00", "user": {"display_name": "Steve Peters", "uuid": "{2ccfed09-18b8-4921-8d58-15ef01092802}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D"}, "html": {"href": "https://bitbucket.org/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/1fb4816dad9e68337d3096f750951f6cd=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsSP-1.png"}}, "nickname": "Steven Peters", "type": "user", "account_id": "557058:5de38267-b118-494c-aa76-4fab35448816"}, "updated_on": "2019-05-29T18:01:21.806093+00:00", "type": "pullrequest_comment", "id": 103856870}, "pull_request": {"type": "pullrequest", "id": 88, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-physics/pullrequests/88.json"}, "html": {"href": "#!/ignitionrobotics/ign-physics/pull-requests/88"}}, "title": "[Citadel] Improve compile times"}}, {"comment": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-physics/pullrequests/88/comments/103220096.json"}, "html": {"href": "#!/ignitionrobotics/ign-physics/pull-requests/88/_/diff#comment-103220096"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 88, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-physics/pullrequests/88.json"}, "html": {"href": "#!/ignitionrobotics/ign-physics/pull-requests/88"}}, "title": "[Citadel] Improve compile times"}, "content": {"raw": "also, several tests appear to pass but dump a core during teardown\n\n~~~\n$ bin/UNIT_EntityManagement_TEST \n[==========] Running 2 tests from 1 test case.\n[----------] Global test environment set-up.\n[----------] 2 tests from EntityManagement_TEST\n[ RUN      ] EntityManagement_TEST.ConstructEmptyWorld\n[       OK ] EntityManagement_TEST.ConstructEmptyWorld (41 ms)\n[ RUN      ] EntityManagement_TEST.RemoveEntities\n[       OK ] EntityManagement_TEST.RemoveEntities (0 ms)\n[----------] 2 tests from EntityManagement_TEST (41 ms total)\n\n[----------] Global test environment tear-down\n[==========] 2 tests from 1 test case ran. (41 ms total)\n[  PASSED  ] 2 tests.\ndouble free or corruption (fasttop)\nAborted (core dumped)\n~~~\n\n~~~\n(gdb) r\nStarting program: build/ignition-physics2/bin/UNIT_SimulationFeatures_TEST \n[Thread debugging using libthread_db enabled]\nUsing host libthread_db library \"/lib/x86_64-linux-gnu/libthread_db.so.1\".\n[==========] Running 6 tests from 1 test case.\n[----------] Global test environment set-up.\n[----------] 6 tests from PhysicsPlugins/SimulationFeatures_TEST\n[ RUN      ] PhysicsPlugins/SimulationFeatures_TEST.Falling/0\nTesting library build/ignition-physics2/lib/libignition-physics2-dartsim-plugin.so.2.0.0~pre0\n -- Plugin name: ignition::physics::dartsim::Plugin\n[       OK ] PhysicsPlugins/SimulationFeatures_TEST.Falling/0 (984 ms)\n[ RUN      ] PhysicsPlugins/SimulationFeatures_TEST.Falling/1\n[       OK ] PhysicsPlugins/SimulationFeatures_TEST.Falling/1 (0 ms)\n[ RUN      ] PhysicsPlugins/SimulationFeatures_TEST.ShapeBoundingBox/0\n -- Plugin name: ignition::physics::dartsim::Plugin\n[       OK ] PhysicsPlugins/SimulationFeatures_TEST.ShapeBoundingBox/0 (49 ms)\n[ RUN      ] PhysicsPlugins/SimulationFeatures_TEST.ShapeBoundingBox/1\n[       OK ] PhysicsPlugins/SimulationFeatures_TEST.ShapeBoundingBox/1 (0 ms)\n[ RUN      ] PhysicsPlugins/SimulationFeatures_TEST.RetrieveContacts/0\n -- Plugin name: ignition::physics::dartsim::Plugin\n[       OK ] PhysicsPlugins/SimulationFeatures_TEST.RetrieveContacts/0 (60 ms)\n[ RUN      ] PhysicsPlugins/SimulationFeatures_TEST.RetrieveContacts/1\n[       OK ] PhysicsPlugins/SimulationFeatures_TEST.RetrieveContacts/1 (0 ms)\n[----------] 6 tests from PhysicsPlugins/SimulationFeatures_TEST (1093 ms total)\n\n[----------] Global test environment tear-down\n[==========] 6 tests from 1 test case ran. (1093 ms total)\n[  PASSED  ] 6 tests.\ndouble free or corruption (fasttop)\n\nProgram received signal SIGABRT, Aborted.\n__GI_raise (sig=sig@entry=6) at ../sysdeps/unix/sysv/linux/raise.c:51\n51\t../sysdeps/unix/sysv/linux/raise.c: No such file or directory.\n(gdb) bt\n#0  __GI_raise (sig=sig@entry=6) at ../sysdeps/unix/sysv/linux/raise.c:51\n#1  0x00007ffff5e2d801 in __GI_abort () at abort.c:79\n#2  0x00007ffff5e76897 in __libc_message (action=action@entry=do_abort, fmt=fmt@entry=0x7ffff5fa3b9a \"%s\\n\") at ../sysdeps/posix/libc_fatal.c:181\n#3  0x00007ffff5e7d90a in malloc_printerr (str=str@entry=0x7ffff5fa5828 \"double free or corruption (fasttop)\") at malloc.c:5350\n#4  0x00007ffff5e85004 in _int_free (have_lock=0, p=0x5555558a5960, av=0x7ffff61d8c40 <main_arena>) at malloc.c:4230\n#5  __GI___libc_free (mem=0x5555558a5970) at malloc.c:3124\n#6  0x00007ffff5e30041 in __run_exit_handlers (status=0, listp=0x7ffff61d8718 <__exit_funcs>, run_list_atexit=run_list_atexit@entry=true, run_dtors=run_dtors@entry=true) at exit.c:108\n#7  0x00007ffff5e3013a in __GI_exit (status=<optimized out>) at exit.c:139\n#8  0x00007ffff5e0eb9e in __libc_start_main (main=0x555555577770 <main(int, char**)>, argc=1, argv=0x7fffffffe318, init=<optimized out>, fini=<optimized out>, rtld_fini=<optimized out>, stack_end=0x7fffffffe308)\n    at ../csu/libc-start.c:344\n#9  0x0000555555577eea in _start () at /usr/include/c++/8/ext/new_allocator.h:116\n(gdb)\n~~~", "markup": "markdown", "html": "<p>also, several tests appear to pass but dump a core during teardown</p>\n<div class=\"codehilite\"><pre><span></span>$ bin/UNIT_EntityManagement_TEST \n<span class=\"o\">[==========]</span> Running <span class=\"m\">2</span> tests from <span class=\"m\">1</span> <span class=\"nb\">test</span> <span class=\"k\">case</span>.\n<span class=\"o\">[</span>----------<span class=\"o\">]</span> Global <span class=\"nb\">test</span> environment set-up.\n<span class=\"o\">[</span>----------<span class=\"o\">]</span> <span class=\"m\">2</span> tests from EntityManagement_TEST\n<span class=\"o\">[</span> RUN      <span class=\"o\">]</span> EntityManagement_TEST.ConstructEmptyWorld\n<span class=\"o\">[</span>       OK <span class=\"o\">]</span> EntityManagement_TEST.ConstructEmptyWorld <span class=\"o\">(</span><span class=\"m\">41</span> ms<span class=\"o\">)</span>\n<span class=\"o\">[</span> RUN      <span class=\"o\">]</span> EntityManagement_TEST.RemoveEntities\n<span class=\"o\">[</span>       OK <span class=\"o\">]</span> EntityManagement_TEST.RemoveEntities <span class=\"o\">(</span><span class=\"m\">0</span> ms<span class=\"o\">)</span>\n<span class=\"o\">[</span>----------<span class=\"o\">]</span> <span class=\"m\">2</span> tests from EntityManagement_TEST <span class=\"o\">(</span><span class=\"m\">41</span> ms total<span class=\"o\">)</span>\n\n<span class=\"o\">[</span>----------<span class=\"o\">]</span> Global <span class=\"nb\">test</span> environment tear-down\n<span class=\"o\">[==========]</span> <span class=\"m\">2</span> tests from <span class=\"m\">1</span> <span class=\"nb\">test</span> <span class=\"k\">case</span> ran. <span class=\"o\">(</span><span class=\"m\">41</span> ms total<span class=\"o\">)</span>\n<span class=\"o\">[</span>  PASSED  <span class=\"o\">]</span> <span class=\"m\">2</span> tests.\ndouble free or corruption <span class=\"o\">(</span>fasttop<span class=\"o\">)</span>\nAborted <span class=\"o\">(</span>core dumped<span class=\"o\">)</span>\n</pre></div>\n\n\n<div class=\"codehilite\"><pre><span></span>(gdb) r\nStarting program: build/ignition-physics2/bin/UNIT_SimulationFeatures_TEST \n[Thread debugging using libthread_db enabled]\nUsing host libthread_db library &quot;/lib/x86_64-linux-gnu/libthread_db.so.1&quot;.\n[==========] Running 6 tests from 1 test case.\n[----------] Global test environment set-up.\n[----------] 6 tests from PhysicsPlugins/SimulationFeatures_TEST\n[ RUN      ] PhysicsPlugins/SimulationFeatures_TEST.Falling/0\nTesting library build/ignition-physics2/lib/libignition-physics2-dartsim-plugin.so.2.0.0~pre0\n -- Plugin name: ignition::physics::dartsim::Plugin\n[       OK ] PhysicsPlugins/SimulationFeatures_TEST.Falling/0 (984 ms)\n[ RUN      ] PhysicsPlugins/SimulationFeatures_TEST.Falling/1\n[       OK ] PhysicsPlugins/SimulationFeatures_TEST.Falling/1 (0 ms)\n[ RUN      ] PhysicsPlugins/SimulationFeatures_TEST.ShapeBoundingBox/0\n -- Plugin name: ignition::physics::dartsim::Plugin\n[       OK ] PhysicsPlugins/SimulationFeatures_TEST.ShapeBoundingBox/0 (49 ms)\n[ RUN      ] PhysicsPlugins/SimulationFeatures_TEST.ShapeBoundingBox/1\n[       OK ] PhysicsPlugins/SimulationFeatures_TEST.ShapeBoundingBox/1 (0 ms)\n[ RUN      ] PhysicsPlugins/SimulationFeatures_TEST.RetrieveContacts/0\n -- Plugin name: ignition::physics::dartsim::Plugin\n[       OK ] PhysicsPlugins/SimulationFeatures_TEST.RetrieveContacts/0 (60 ms)\n[ RUN      ] PhysicsPlugins/SimulationFeatures_TEST.RetrieveContacts/1\n[       OK ] PhysicsPlugins/SimulationFeatures_TEST.RetrieveContacts/1 (0 ms)\n[----------] 6 tests from PhysicsPlugins/SimulationFeatures_TEST (1093 ms total)\n\n[----------] Global test environment tear-down\n[==========] 6 tests from 1 test case ran. (1093 ms total)\n[  PASSED  ] 6 tests.\ndouble free or corruption (fasttop)\n\nProgram received signal SIGABRT, Aborted.\n__GI_raise (sig=sig@entry=6) at ../sysdeps/unix/sysv/linux/raise.c:51\n51  ../sysdeps/unix/sysv/linux/raise.c: No such file or directory.\n(gdb) bt\n#0  __GI_raise (sig=sig@entry=6) at ../sysdeps/unix/sysv/linux/raise.c:51\n#1  0x00007ffff5e2d801 in __GI_abort () at abort.c:79\n#2  0x00007ffff5e76897 in __libc_message (action=action@entry=do_abort, fmt=fmt@entry=0x7ffff5fa3b9a &quot;%s\\n&quot;) at ../sysdeps/posix/libc_fatal.c:181\n#3  0x00007ffff5e7d90a in malloc_printerr (str=str@entry=0x7ffff5fa5828 &quot;double free or corruption (fasttop)&quot;) at malloc.c:5350\n#4  0x00007ffff5e85004 in _int_free (have_lock=0, p=0x5555558a5960, av=0x7ffff61d8c40 &lt;main_arena&gt;) at malloc.c:4230\n#5  __GI___libc_free (mem=0x5555558a5970) at malloc.c:3124\n#6  0x00007ffff5e30041 in __run_exit_handlers (status=0, listp=0x7ffff61d8718 &lt;__exit_funcs&gt;, run_list_atexit=run_list_atexit@entry=true, run_dtors=run_dtors@entry=true) at exit.c:108\n#7  0x00007ffff5e3013a in __GI_exit (status=&lt;optimized out&gt;) at exit.c:139\n#8  0x00007ffff5e0eb9e in __libc_start_main (main=0x555555577770 &lt;main(int, char**)&gt;, argc=1, argv=0x7fffffffe318, init=&lt;optimized out&gt;, fini=&lt;optimized out&gt;, rtld_fini=&lt;optimized out&gt;, stack_end=0x7fffffffe308)\n    at ../csu/libc-start.c:344\n#9  0x0000555555577eea in _start () at /usr/include/c++/8/ext/new_allocator.h:116\n(gdb)\n</pre></div>", "type": "rendered"}, "created_on": "2019-05-23T20:14:55.987779+00:00", "user": {"display_name": "Steve Peters", "uuid": "{2ccfed09-18b8-4921-8d58-15ef01092802}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D"}, "html": {"href": "https://bitbucket.org/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/1fb4816dad9e68337d3096f750951f6cd=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsSP-1.png"}}, "nickname": "Steven Peters", "type": "user", "account_id": "557058:5de38267-b118-494c-aa76-4fab35448816"}, "updated_on": "2019-05-23T20:14:55.997388+00:00", "type": "pullrequest_comment", "id": 103220096}, "pull_request": {"type": "pullrequest", "id": 88, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-physics/pullrequests/88.json"}, "html": {"href": "#!/ignitionrobotics/ign-physics/pull-requests/88"}}, "title": "[Citadel] Improve compile times"}}, {"comment": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-physics/pullrequests/88/comments/103219359.json"}, "html": {"href": "#!/ignitionrobotics/ign-physics/pull-requests/88/_/diff#comment-103219359"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 88, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-physics/pullrequests/88.json"}, "html": {"href": "#!/ignitionrobotics/ign-physics/pull-requests/88"}}, "title": "[Citadel] Improve compile times"}, "content": {"raw": "I get some compiler warnings:\n\n~~~\ndartsim/src/plugin.cc:48:7: warning: virtual base 'ignition::physics::detail::Aggregate<ignition::physics::detail::ImplementationSelector, ignition::physics::FeatureList<ignition::physics::dartsim::RetrieveWorld>, void>::type<ignition::physics::FeaturePolicy<double, 3> >' inaccessible in 'ignition::physics::dartsim::Plugin' due to ambiguity [-Wextra]\n class Plugin :\n       ^~~~~~\ndartsim/src/plugin.cc:48:7: warning: virtual base 'ignition::physics::detail::Aggregate<ignition::physics::detail::ImplementationSelector, ignition::physics::dartsim::EntityManagementFeatureList, void>::type<ignition::physics::FeaturePolicy<double, 3> >' inaccessible in 'ignition::physics::dartsim::Plugin' due to ambiguity [-Wextra]\ndartsim/src/plugin.cc:48:7: warning: virtual base 'ignition::physics::detail::Aggregate<ignition::physics::detail::ImplementationSelector, ignition::physics::dartsim::FreeGroupFeatureList, void>::type<ignition::physics::FeaturePolicy<double, 3> >' inaccessible in 'ignition::physics::dartsim::Plugin' due to ambiguity [-Wextra]\ndartsim/src/plugin.cc:48:7: warning: virtual base 'ignition::physics::detail::Aggregate<ignition::physics::detail::ImplementationSelector, ignition::physics::dartsim::JointFeatureList, void>::type<ignition::physics::FeaturePolicy<double, 3> >' inaccessible in 'ignition::physics::dartsim::Plugin' due to ambiguity [-Wextra]\ndartsim/src/plugin.cc:48:7: warning: virtual base 'ignition::physics::detail::Aggregate<ignition::physics::detail::ImplementationSelector, ignition::physics::dartsim::KinematicsFeatureList, void>::type<ignition::physics::FeaturePolicy<double, 3> >' inaccessible in 'ignition::physics::dartsim::Plugin' due to ambiguity [-Wextra]\ndartsim/src/plugin.cc:48:7: warning: virtual base 'ignition::physics::detail::Aggregate<ignition::physics::detail::ImplementationSelector, ignition::physics::dartsim::LinkFeatureList, void>::type<ignition::physics::FeaturePolicy<double, 3> >' inaccessible in 'ignition::physics::dartsim::Plugin' due to ambiguity [-Wextra]\ndartsim/src/plugin.cc:48:7: warning: virtual base 'ignition::physics::detail::Aggregate<ignition::physics::detail::ImplementationSelector, ignition::physics::dartsim::SDFFeatureList, void>::type<ignition::physics::FeaturePolicy<double, 3> >' inaccessible in 'ignition::physics::dartsim::Plugin' due to ambiguity [-Wextra]\ndartsim/src/plugin.cc:48:7: warning: virtual base 'ignition::physics::detail::Aggregate<ignition::physics::detail::ImplementationSelector, ignition::physics::dartsim::ShapeFeatureList, void>::type<ignition::physics::FeaturePolicy<double, 3> >' inaccessible in 'ignition::physics::dartsim::Plugin' due to ambiguity [-Wextra]\ndartsim/src/plugin.cc:48:7: warning: virtual base 'ignition::physics::detail::Aggregate<ignition::physics::detail::ImplementationSelector, ignition::physics::dartsim::SimulationFeatureList, void>::type<ignition::physics::FeaturePolicy<double, 3> >' inaccessible in 'ignition::physics::dartsim::Plugin' due to ambiguity [-Wextra]\n\n~~~", "markup": "markdown", "html": "<p>I get some compiler warnings:</p>\n<div class=\"codehilite\"><pre><span></span>dartsim/src/plugin.cc:48:7: warning: virtual base &#39;ignition::physics::detail::Aggregate&lt;ignition::physics::detail::ImplementationSelector, ignition::physics::FeatureList&lt;ignition::physics::dartsim::RetrieveWorld&gt;, void&gt;::type&lt;ignition::physics::FeaturePolicy&lt;double, 3&gt; &gt;&#39; inaccessible in &#39;ignition::physics::dartsim::Plugin&#39; due to ambiguity [-Wextra]\n class Plugin :\n       ^~~~~~\ndartsim/src/plugin.cc:48:7: warning: virtual base &#39;ignition::physics::detail::Aggregate&lt;ignition::physics::detail::ImplementationSelector, ignition::physics::dartsim::EntityManagementFeatureList, void&gt;::type&lt;ignition::physics::FeaturePolicy&lt;double, 3&gt; &gt;&#39; inaccessible in &#39;ignition::physics::dartsim::Plugin&#39; due to ambiguity [-Wextra]\ndartsim/src/plugin.cc:48:7: warning: virtual base &#39;ignition::physics::detail::Aggregate&lt;ignition::physics::detail::ImplementationSelector, ignition::physics::dartsim::FreeGroupFeatureList, void&gt;::type&lt;ignition::physics::FeaturePolicy&lt;double, 3&gt; &gt;&#39; inaccessible in &#39;ignition::physics::dartsim::Plugin&#39; due to ambiguity [-Wextra]\ndartsim/src/plugin.cc:48:7: warning: virtual base &#39;ignition::physics::detail::Aggregate&lt;ignition::physics::detail::ImplementationSelector, ignition::physics::dartsim::JointFeatureList, void&gt;::type&lt;ignition::physics::FeaturePolicy&lt;double, 3&gt; &gt;&#39; inaccessible in &#39;ignition::physics::dartsim::Plugin&#39; due to ambiguity [-Wextra]\ndartsim/src/plugin.cc:48:7: warning: virtual base &#39;ignition::physics::detail::Aggregate&lt;ignition::physics::detail::ImplementationSelector, ignition::physics::dartsim::KinematicsFeatureList, void&gt;::type&lt;ignition::physics::FeaturePolicy&lt;double, 3&gt; &gt;&#39; inaccessible in &#39;ignition::physics::dartsim::Plugin&#39; due to ambiguity [-Wextra]\ndartsim/src/plugin.cc:48:7: warning: virtual base &#39;ignition::physics::detail::Aggregate&lt;ignition::physics::detail::ImplementationSelector, ignition::physics::dartsim::LinkFeatureList, void&gt;::type&lt;ignition::physics::FeaturePolicy&lt;double, 3&gt; &gt;&#39; inaccessible in &#39;ignition::physics::dartsim::Plugin&#39; due to ambiguity [-Wextra]\ndartsim/src/plugin.cc:48:7: warning: virtual base &#39;ignition::physics::detail::Aggregate&lt;ignition::physics::detail::ImplementationSelector, ignition::physics::dartsim::SDFFeatureList, void&gt;::type&lt;ignition::physics::FeaturePolicy&lt;double, 3&gt; &gt;&#39; inaccessible in &#39;ignition::physics::dartsim::Plugin&#39; due to ambiguity [-Wextra]\ndartsim/src/plugin.cc:48:7: warning: virtual base &#39;ignition::physics::detail::Aggregate&lt;ignition::physics::detail::ImplementationSelector, ignition::physics::dartsim::ShapeFeatureList, void&gt;::type&lt;ignition::physics::FeaturePolicy&lt;double, 3&gt; &gt;&#39; inaccessible in &#39;ignition::physics::dartsim::Plugin&#39; due to ambiguity [-Wextra]\ndartsim/src/plugin.cc:48:7: warning: virtual base &#39;ignition::physics::detail::Aggregate&lt;ignition::physics::detail::ImplementationSelector, ignition::physics::dartsim::SimulationFeatureList, void&gt;::type&lt;ignition::physics::FeaturePolicy&lt;double, 3&gt; &gt;&#39; inaccessible in &#39;ignition::physics::dartsim::Plugin&#39; due to ambiguity [-Wextra]\n</pre></div>", "type": "rendered"}, "created_on": "2019-05-23T20:07:30.287900+00:00", "user": {"display_name": "Steve Peters", "uuid": "{2ccfed09-18b8-4921-8d58-15ef01092802}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D"}, "html": {"href": "https://bitbucket.org/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/1fb4816dad9e68337d3096f750951f6cd=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsSP-1.png"}}, "nickname": "Steven Peters", "type": "user", "account_id": "557058:5de38267-b118-494c-aa76-4fab35448816"}, "updated_on": "2019-05-23T20:07:30.297022+00:00", "type": "pullrequest_comment", "id": 103219359}, "pull_request": {"type": "pullrequest", "id": 88, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-physics/pullrequests/88.json"}, "html": {"href": "#!/ignitionrobotics/ign-physics/pull-requests/88"}}, "title": "[Citadel] Improve compile times"}}, {"update": {"description": "This PR drastically improves the compile times of applications and libraries that use `ign-physics`. The key issue was that the length of symbol names was growing unbounded for classes that were being instantiated from templates. The itanium ABI mangles the names of template arguments into the symbol names of classes that get instantiated from templates, so the full name of each new feature that we added to a link, model, joint, world, etc, was getting mangled into all the symbol names that were being produced.\r\n\r\nThis PR mitigates this by using some class inheritance and SNFINAE tricks that allow us to easily minimize the symbol names. For example, a symbol that used to come out as\r\n\r\n```\r\n_ZTIN8ignition7physics6detail9AggregateINS1_12SelectEngineEvvE4typeIJNS0_13FeaturePolicyIdLm3EEENS0_11FeatureListIJNS8_IJNS0_26GetCylinderShapePropertiesENS0_26SetCylinderShapePropertiesENS0_26AttachCylinderShapeFeatureEEEENS8_IJNS0_26GetRevoluteJointPropertiesENS0_26SetRevoluteJointPropertiesEEEENS8_IJNS0_21GetBoxShapePropertiesENS0_21SetBoxShapePropertiesENS0_21AttachBoxShapeFeatureEEEEEEEEEE\r\n```\r\n\r\ncan now come out as\r\n\r\n```\r\n_ZTIN8ignition7physics6detail9AggregateINS1_12SelectEngineENS1_7GetNextINS4_I15FeatureSetClassvE1nEvE1nEvE4typeIJNS0_13FeaturePolicyIdLm3EEES5_EEE\r\n```\r\n\r\nWe can also add many more features into this symbol without significantly impacting the length of its name. The key is to group features into sets of features using explicit inheritance. For example, we use to do this:\r\n\r\n```\r\nusing MyFeatureList = ignition::physics::FeatureList<\r\n  /* some list of features */\r\n>;\r\n```\r\n\r\nbut now we can do this instead:\r\n\r\n```\r\nstruct MyFeatureList : ignition::physics::FeatureList<\r\n  /* some list of features */\r\n> { };\r\n```\r\n\r\nand the resulting symbol names from using `MyFeatureList` will be very lean and not have any dependence on the lengths of the feature names.\r\n\r\nThis matters primarily because the compile times on GCC seem to grow almost exponentially as the sizes of symbol names increase. Clang is also affected, but not as severely. Here are some charts of the compile times that I observed before and after these changes:\r\n\r\n| Before | -j1 | -j16 |\r\n| --- | --- | --- |\r\n| gcc | 17:59 | 15:18 |\r\n| clang | 5:30 | 1:55 |\r\n\r\n| After | -j1 | -j16 |\r\n| --- | --- | --- |\r\n| gcc | 6:58 | 2:05 |\r\n| clang | 5:11 | 1:12 |\r\n\r\nThis PR depends on an [ign-plugin PR here](#!/ignitionrobotics/ign-plugin/pull-requests/32/).", "title": "Improve compile times", "destination": {"commit": {"hash": "28adf11b71f5", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-physics/commit/28adf11b71f5.json"}, "html": {"href": "#!/ignitionrobotics/ign-physics/commits/28adf11b71f5"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-physics.json"}, "html": {"href": "#!/ignitionrobotics/ign-physics"}, "avatar": {"href": "data/bytebucket.org/ravatar/{63a01c4f-5625-443b-96f0-73c4005ccada}ts=c_plus_plus"}}, "type": "repository", "name": "ign-physics", "full_name": "ignitionrobotics/ign-physics", "uuid": "{63a01c4f-5625-443b-96f0-73c4005ccada}"}, "branch": {"name": "default"}}, "reason": "", "source": {"commit": {"hash": "93597ef08dcd", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-physics/commit/93597ef08dcd.json"}, "html": {"href": "#!/ignitionrobotics/ign-physics/commits/93597ef08dcd"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-physics.json"}, "html": {"href": "#!/ignitionrobotics/ign-physics"}, "avatar": {"href": "data/bytebucket.org/ravatar/{63a01c4f-5625-443b-96f0-73c4005ccada}ts=c_plus_plus"}}, "type": "repository", "name": "ign-physics", "full_name": "ignitionrobotics/ign-physics", "uuid": "{63a01c4f-5625-443b-96f0-73c4005ccada}"}, "branch": {"name": "improve_compile_times"}}, "state": "OPEN", "author": {"display_name": "Michael Grey", "uuid": "{c1cdfe52-2887-474c-ae99-72fdc53a59c9}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Bc1cdfe52-2887-474c-ae99-72fdc53a59c9%7D"}, "html": {"href": "https://bitbucket.org/%7Bc1cdfe52-2887-474c-ae99-72fdc53a59c9%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:67759e29-d1df-465f-868d-047738e36fc9/d42d74cf-c1bd-4431-8288-07f543bbe325/128"}}, "nickname": "mxgrey", "type": "user", "account_id": "557058:67759e29-d1df-465f-868d-047738e36fc9"}, "date": "2019-05-14T06:43:36.023983+00:00"}, "pull_request": {"type": "pullrequest", "id": 88, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-physics/pullrequests/88.json"}, "html": {"href": "#!/ignitionrobotics/ign-physics/pull-requests/88"}}, "title": "[Citadel] Improve compile times"}}, {"update": {"description": "This PR drastically improves the compile times of applications and libraries that use `ign-physics`. The key issue was that the length of symbol names was growing unbounded for classes that were being instantiated from templates. The itanium ABI mangles the names of template arguments into the symbol names of classes that get instantiated from templates, so the full name of each new feature that we added to a link, model, joint, world, etc, was getting mangled into all the symbol names that were being produced.\r\n\r\nThis PR mitigates this by using some class inheritance and SNFINAE tricks that allow us to easily minimize the symbol names. For example, a symbol that used to come out as\r\n\r\n```\r\n_ZTIN8ignition7physics6detail9AggregateINS1_12SelectEngineEvvE4typeIJNS0_13FeaturePolicyIdLm3EEENS0_11FeatureListIJNS8_IJNS0_26GetCylinderShapePropertiesENS0_26SetCylinderShapePropertiesENS0_26AttachCylinderShapeFeatureEEEENS8_IJNS0_26GetRevoluteJointPropertiesENS0_26SetRevoluteJointPropertiesEEEENS8_IJNS0_21GetBoxShapePropertiesENS0_21SetBoxShapePropertiesENS0_21AttachBoxShapeFeatureEEEEEEEEEE\r\n```\r\n\r\ncan now come out as\r\n\r\n```\r\n_ZTIN8ignition7physics6detail9AggregateINS1_12SelectEngineENS1_7GetNextINS4_I15FeatureSetClassvE1nEvE1nEvE4typeIJNS0_13FeaturePolicyIdLm3EEES5_EEE\r\n```\r\n\r\nWe can also add many more features into this symbol without significantly impacting the length of its name. The key is to group features into sets of features using explicit inheritance. For example, we use to do this:\r\n\r\n```\r\nusing MyFeatureList = ignition::physics::FeatureList<\r\n  /* some list of features */\r\n>;\r\n```\r\n\r\nbut now we can do this instead:\r\n\r\n```\r\nstruct MyFeatureList : ignition::physics::FeatureList<\r\n  /* some list of features */\r\n> { };\r\n```\r\n\r\nand the resulting symbol names from using `MyFeatureList` will be very lean and not have any dependence on the lengths of the feature names.\r\n\r\nThis matters primarily because the compile times on GCC seem to grow almost exponentially as the sizes of symbol names increase. Clang is also affected, but not as severely. Here are some charts of the compile times that I observed before and after these changes:\r\n\r\n| Before | -j1 | -j16 |\r\n| --- | --- | --- |\r\n| gcc | 17:59 | 15:18 |\r\n| clang | 5:30 | 1:55 |\r\n\r\n| After | -j1 | -j16 |\r\n| --- | --- | --- |\r\n| gcc | 6:58 | 2:05 |\r\n| clang | 5:11 | 1:12 |\r\n\r\nThis PR depends on an [ign-plugin PR here](#!/ignitionrobotics/ign-plugin/pull-requests/32/).", "title": "Improve compile times", "destination": {"commit": {"hash": "28adf11b71f5", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-physics/commit/28adf11b71f5.json"}, "html": {"href": "#!/ignitionrobotics/ign-physics/commits/28adf11b71f5"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-physics.json"}, "html": {"href": "#!/ignitionrobotics/ign-physics"}, "avatar": {"href": "data/bytebucket.org/ravatar/{63a01c4f-5625-443b-96f0-73c4005ccada}ts=c_plus_plus"}}, "type": "repository", "name": "ign-physics", "full_name": "ignitionrobotics/ign-physics", "uuid": "{63a01c4f-5625-443b-96f0-73c4005ccada}"}, "branch": {"name": "default"}}, "reason": "", "source": {"commit": {"hash": "93597ef08dcd", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-physics/commit/93597ef08dcd.json"}, "html": {"href": "#!/ignitionrobotics/ign-physics/commits/93597ef08dcd"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-physics.json"}, "html": {"href": "#!/ignitionrobotics/ign-physics"}, "avatar": {"href": "data/bytebucket.org/ravatar/{63a01c4f-5625-443b-96f0-73c4005ccada}ts=c_plus_plus"}}, "type": "repository", "name": "ign-physics", "full_name": "ignitionrobotics/ign-physics", "uuid": "{63a01c4f-5625-443b-96f0-73c4005ccada}"}, "branch": {"name": "improve_compile_times"}}, "state": "OPEN", "author": {"display_name": "Michael Grey", "uuid": "{c1cdfe52-2887-474c-ae99-72fdc53a59c9}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Bc1cdfe52-2887-474c-ae99-72fdc53a59c9%7D"}, "html": {"href": "https://bitbucket.org/%7Bc1cdfe52-2887-474c-ae99-72fdc53a59c9%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:67759e29-d1df-465f-868d-047738e36fc9/d42d74cf-c1bd-4431-8288-07f543bbe325/128"}}, "nickname": "mxgrey", "type": "user", "account_id": "557058:67759e29-d1df-465f-868d-047738e36fc9"}, "date": "2019-05-14T06:43:35.958214+00:00"}, "pull_request": {"type": "pullrequest", "id": 88, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-physics/pullrequests/88.json"}, "html": {"href": "#!/ignitionrobotics/ign-physics/pull-requests/88"}}, "title": "[Citadel] Improve compile times"}}]}