{"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-msgs/pullrequests/151/comments/116028374.json"}, "html": {"href": "#!/ignitionrobotics/ign-msgs/pull-requests/151/_/diff#comment-116028374"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 151, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-msgs/pullrequests/151.json"}, "html": {"href": "#!/ignitionrobotics/ign-msgs/pull-requests/151"}}, "title": "Fix linking order of Protocol Buffers static libraries  on GCC"}, "content": {"raw": "When linking **static libraries** with `gcc`'s default linker, `ld` , the linking order matters \\(see [https://eli.thegreenplace.net/2013/07/09/library-order-in-static-linking](https://eli.thegreenplace.net/2013/07/09/library-order-in-static-linking), [https://stackoverflow.com/questions/45135/why-does-the-order-in-which-libraries-are-linked-sometimes-cause-errors-in-gcc](https://stackoverflow.com/questions/45135/why-does-the-order-in-which-libraries-are-linked-sometimes-cause-errors-in-gcc)\\).\n\nIn particular, unless the `--start-group` option is passed to the `ld`, the default behaviour is the following \\(see [https://sourceware.org/binutils/docs/ld/Options.html#Options](https://sourceware.org/binutils/docs/ld/Options.html#Options)\\):\n\n> Normally, an archive is searched only once in the order that it is specified on the command line. If a symbol in that archive is needed to resolve an undefined symbol referred to by an object in an archive that appears later on the command line, the linker would not be able to resolve that reference.\n\nAs for Protocol Buffers `libprotoc` depends on symbols defined by `libprotobuf` , it should come before in the link order.\n\nThis fixes compilation against static Protocol Buffers libraries on Linux.\n\nDownstream related discussion: [https://github.com/microsoft/vcpkg/pull/8044](https://github.com/microsoft/vcpkg/pull/8044) .\n\nDownstream related CI failure: [https://dev.azure.com/vcpkg/public/\\_build/results?buildId=12090&view=logs](https://dev.azure.com/vcpkg/public/_build/results?buildId=12090&view=logs) . ", "markup": "markdown", "html": "<p>When linking <strong>static libraries</strong> with <code>gcc</code>'s default linker, <code>ld</code> , the linking order matters (see <a data-is-external-link=\"true\" href=\"https://eli.thegreenplace.net/2013/07/09/library-order-in-static-linking\" rel=\"nofollow\">https://eli.thegreenplace.net/2013/07/09/library-order-in-static-linking</a>, <a data-is-external-link=\"true\" href=\"https://stackoverflow.com/questions/45135/why-does-the-order-in-which-libraries-are-linked-sometimes-cause-errors-in-gcc\" rel=\"nofollow\">https://stackoverflow.com/questions/45135/why-does-the-order-in-which-libraries-are-linked-sometimes-cause-errors-in-gcc</a>).</p>\n<p>In particular, unless the <code>--start-group</code> option is passed to the <code>ld</code>, the default behaviour is the following (see <a data-is-external-link=\"true\" href=\"https://sourceware.org/binutils/docs/ld/Options.html#Options\" rel=\"nofollow\">https://sourceware.org/binutils/docs/ld/Options.html#Options</a>):</p>\n<blockquote>\n<p>Normally, an archive is searched only once in the order that it is specified on the command line. If a symbol in that archive is needed to resolve an undefined symbol referred to by an object in an archive that appears later on the command line, the linker would not be able to resolve that reference.</p>\n</blockquote>\n<p>As for Protocol Buffers <code>libprotoc</code> depends on symbols defined by <code>libprotobuf</code> , it should come before in the link order.</p>\n<p>This fixes compilation against static Protocol Buffers libraries on Linux.</p>\n<p>Downstream related discussion: <a data-is-external-link=\"true\" href=\"https://github.com/microsoft/vcpkg/pull/8044\" rel=\"nofollow\">https://github.com/microsoft/vcpkg/pull/8044</a> .</p>\n<p>Downstream related CI failure: <a data-is-external-link=\"true\" href=\"https://dev.azure.com/vcpkg/public/_build/results?buildId=12090&amp;view=logs\" rel=\"nofollow\">https://dev.azure.com/vcpkg/public/_build/results?buildId=12090&amp;view=logs</a> . </p>", "type": "rendered"}, "created_on": "2019-09-08T12:31:45.990693+00:00", "user": {"display_name": "Silvio Traversaro", "uuid": "{34f404cb-5642-4f27-a032-e04c7143d776}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B34f404cb-5642-4f27-a032-e04c7143d776%7D"}, "html": {"href": "https://bitbucket.org/%7B34f404cb-5642-4f27-a032-e04c7143d776%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:e1c3e6a0-9a64-4e5f-a668-feebc191c5b6/578caaa1-056c-45a2-8bf9-bee94c3bebef/128"}}, "nickname": "traversaro", "type": "user", "account_id": "557058:e1c3e6a0-9a64-4e5f-a668-feebc191c5b6"}, "updated_on": "2019-09-08T12:33:57.622669+00:00", "type": "pullrequest_comment", "id": 116028374}