{"priority": "major", "kind": "bug", "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-cmake.json"}, "html": {"href": "#!/ignitionrobotics/ign-cmake"}, "avatar": {"href": "data/bytebucket.org/ravatar/{3e77bcf7-f260-4cec-a1a0-116b8e298901}ts=default"}}, "type": "repository", "name": "ign-cmake", "full_name": "ignitionrobotics/ign-cmake", "uuid": "{3e77bcf7-f260-4cec-a1a0-116b8e298901}"}, "links": {"attachments": {"href": "data/repositories/ignitionrobotics/ign-cmake/issues/49/attachments_page=1.json"}, "self": {"href": "data/repositories/ignitionrobotics/ign-cmake/issues/49.json"}, "watch": {"href": "https://api.bitbucket.org/2.0/repositories/ignitionrobotics/ign-cmake/issues/49/watch"}, "comments": {"href": "data/repositories/ignitionrobotics/ign-cmake/issues/49/comments_page=1.json"}, "html": {"href": "#!/ignitionrobotics/ign-cmake/issues/49/tinyxml2-not-found-when-required-by-two"}, "vote": {"href": "https://api.bitbucket.org/2.0/repositories/ignitionrobotics/ign-cmake/issues/49/vote"}}, "reporter": {"display_name": "Addisu Z. Taddese", "uuid": "{9d7fdc68-d270-4080-bf03-4df0d0dbf635}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B9d7fdc68-d270-4080-bf03-4df0d0dbf635%7D"}, "html": {"href": "https://bitbucket.org/%7B9d7fdc68-d270-4080-bf03-4df0d0dbf635%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:90bc87b0-2886-4377-a17c-3a6629a697ff/afbf9be5-1e4c-4810-89d4-e58831f34b11/128"}}, "nickname": "azeey", "type": "user", "account_id": "557058:90bc87b0-2886-4377-a17c-3a6629a697ff"}, "title": "tinyxml2 not found when required by two packages", "component": null, "votes": 0, "watches": 1, "content": {"raw": "# Prerequisites\r\n\r\n* [ ] Put an X between the brackets on this line if you have done all of the following:\r\n    * [X] Checked the Q&A board for common solutions: http://answers.gazebosim.org\r\n    * [X] Checked that your issue isn't already filed.\r\n    * [X] Checked that there is not already an Ignition package that provides the described functionality: https://ignitionrobotics.org/libs\r\n\r\n# Description \r\nIf `tinyxml2` is a required package for two other packages, in this case `ignition-common3::graphics` and `DART::dart-utils`, depending on the order of calls to `ign_find_package`, `tinyxml2` is reported to be not found. This a strange failure because CMake reports that it found `tinyxml2` but then subsequently reports that it's missing `TINYXML2_INCLUDE_DIRS`.\r\n\r\n\r\n# Steps to Reproduce\r\n\r\nHere are two CMakeLists.txt files that demonstrate the problem\r\n\r\n**Failing example:**\r\n\r\n\r\n```\r\n#!cmake\r\n\r\ncmake_minimum_required(VERSION 3.5.1 FATAL_ERROR)\r\nproject(test-tinyxml2 VERSION 1.0.0)\r\nfind_package(ignition-cmake2 REQUIRED)\r\n\r\nign_find_package(ignition-common3 COMPONENTS graphics)\r\n\r\nign_find_package(DART\r\n  COMPONENTS\r\n    utils\r\n  PKGCONFIG dart\r\n  PKGCONFIG_VER_COMPARISON >=)\r\n```\r\n\r\nThe result of running cmake on this:\r\n\r\n```\r\n-- The C compiler identification is GNU 8.2.0\r\n-- The CXX compiler identification is GNU 8.2.0\r\n-- Check for working C compiler: /usr/lib/ccache/cc\r\n-- Check for working C compiler: /usr/lib/ccache/cc -- works\r\n-- Detecting C compiler ABI info\r\n-- Detecting C compiler ABI info - done\r\n-- Detecting C compile features\r\n-- Detecting C compile features - done\r\n-- Check for working CXX compiler: /usr/lib/ccache/c++\r\n-- Check for working CXX compiler: /usr/lib/ccache/c++ -- works\r\n-- Detecting CXX compiler ABI info\r\n-- Detecting CXX compiler ABI info - done\r\n-- Detecting CXX compile features\r\n-- Detecting CXX compile features - done\r\n-- Looking for ignition-common3 -- found version 3.0.0~pre4\r\n-- Searching for dependencies of ignition-common3\r\n-- Looking for dlfcn.h - found\r\n-- Looking for libdl - found\r\n-- Found DL: TRUE  \r\n-- Checking for module 'uuid'\r\n--   Found uuid, version 2.31.1\r\n-- Found UUID: TRUE  \r\n-- Searching for <ignition-common3> component [graphics]\r\n-- Looking for ignition-common3-graphics -- found version 3.0.0~pre4\r\n-- Searching for dependencies of ignition-common3-graphics\r\n-- Looking for ignition-math6 -- found version 6.0.0~pre4\r\n-- Searching for dependencies of ignition-math6\r\n-- Checking for module 'tinyxml2'\r\n--   Found tinyxml2, version 6.0.0\r\n-- Found FreeImage: TRUE (Required is at least version \"3.9\") \r\n-- Checking for module 'gts'\r\n--   Found gts, version 0.7.6\r\n-- Found GTS: TRUE  \r\n-- Looking for ignition-common3 - found\r\n\r\n-- Could NOT find TINYXML2 (missing: TINYXML2_INCLUDE_DIRS) (found version \"6.0.0\")\r\nCMake Warning at /usr/local/share/dart/cmake/dart_utilsComponent.cmake:11 (message):\r\n  Cannot retrieve dart-utils because the dependency tinyxml2 could not be\r\n  found.  This usually indicates a broken installation.\r\nCall Stack (most recent call first):\r\n  /usr/local/share/dart/cmake/DARTConfig.cmake:63 (include)\r\n  /usr/local/share/dart/cmake/DARTConfig.cmake:124 (dart_traverse_components)\r\n  /usr/local/share/dart/cmake/DARTConfig.cmake:172 (dart_package_init)\r\n  /home/addisu/ws/ign_base/devel/share/cmake/ignition-cmake2/cmake2/IgnUtils.cmake:188 (find_package)\r\n  CMakeLists.txt:7 (ign_find_package)\r\n\r\n\r\n-- Found CCD: /usr/include (found version \"2.0\") \r\n-- Found FCL: /usr/include (found version \"0.5.0\") \r\n-- Found ASSIMP: /usr/include (found version \"4.1.0\") \r\n-- Found DART: /usr/local/include  found components:  utils dart \r\n-- Looking for DART - found\r\n\r\n-- Configuring done\r\n-- Generating done\r\n-- Build files have been written to: \r\n```\r\n\r\n**Working example: (`ignition-common3` comes after `DART`)**\r\n\r\n```\r\n#!cmake\r\n\r\ncmake_minimum_required(VERSION 3.5.1 FATAL_ERROR)\r\nproject(test-tinyxml2 VERSION 1.0.0)\r\nfind_package(ignition-cmake2 REQUIRED)\r\n\r\nign_find_package(DART\r\n  COMPONENTS\r\n    utils\r\n  PKGCONFIG dart\r\n  PKGCONFIG_VER_COMPARISON >=)\r\n\r\nign_find_package(ignition-common3 COMPONENTS graphics)\r\n```\r\n\r\nThe result of running cmake on this:\r\n```\r\n-- The C compiler identification is GNU 8.2.0\r\n-- The CXX compiler identification is GNU 8.2.0\r\n-- Check for working C compiler: /usr/lib/ccache/cc\r\n-- Check for working C compiler: /usr/lib/ccache/cc -- works\r\n-- Detecting C compiler ABI info\r\n-- Detecting C compiler ABI info - done\r\n-- Detecting C compile features\r\n-- Detecting C compile features - done\r\n-- Check for working CXX compiler: /usr/lib/ccache/c++\r\n-- Check for working CXX compiler: /usr/lib/ccache/c++ -- works\r\n-- Detecting CXX compiler ABI info\r\n-- Detecting CXX compiler ABI info - done\r\n-- Detecting CXX compile features\r\n-- Detecting CXX compile features - done\r\n-- Found TINYXML2: /usr/include (found version \"6.0.0\") \r\n-- Found CCD: /usr/include (found version \"2.0\") \r\n-- Found FCL: /usr/include (found version \"0.5.0\") \r\n-- Found ASSIMP: /usr/include (found version \"4.1.0\") \r\n-- Found DART: /usr/local/include  found components:  utils dart \r\n-- Looking for DART - found\r\n\r\n-- Looking for ignition-common3 -- found version 3.0.0~pre4\r\n-- Searching for dependencies of ignition-common3\r\n-- Looking for dlfcn.h - found\r\n-- Looking for libdl - found\r\n-- Found DL: TRUE  \r\n-- Checking for module 'uuid'\r\n--   Found uuid, version 2.31.1\r\n-- Found UUID: TRUE  \r\n-- Searching for <ignition-common3> component [graphics]\r\n-- Looking for ignition-common3-graphics -- found version 3.0.0~pre4\r\n-- Searching for dependencies of ignition-common3-graphics\r\n-- Looking for ignition-math6 -- found version 6.0.0~pre4\r\n-- Searching for dependencies of ignition-math6\r\n-- Checking for module 'tinyxml2'\r\n--   Found tinyxml2, version 6.0.0\r\n-- Found FreeImage: TRUE (Required is at least version \"3.9\") \r\n-- Checking for module 'gts'\r\n--   Found gts, version 0.7.6\r\n-- Found GTS: TRUE  \r\n-- Looking for ignition-common3 - found\r\n\r\n-- Configuring done\r\n-- Generating done\r\n-- Build files have been written to: \r\n```\r\n\r\n**Expected behavior:**  \r\n\r\n`tinyxml2` should be found in regardless of the order of calls to `ign_find_package`\r\n\r\n**Actual behavior:**\r\n\r\nThe order of calls to `ign_find_package` matters.\r\n\r\n**Reproduces how often:** \r\n\r\n100% of the time\r\n\r\n# Versions\r\n\r\n* `ignition-common3` (`gz11` branch)\r\n* DART v6.7.2\r\n* `ignition-cmake2` (`gz11` branch)", "markup": "markdown", "html": "<h1 id=\"markdown-header-prerequisites\">Prerequisites</h1>\n<ul>\n<li>[ ] Put an X between the brackets on this line if you have done all of the following:<ul>\n<li>[X] Checked the Q&amp;A board for common solutions: <a href=\"http://answers.gazebosim.org\" rel=\"nofollow\" class=\"ap-connect-link\">http://answers.gazebosim.org</a></li>\n<li>[X] Checked that your issue isn't already filed.</li>\n<li>[X] Checked that there is not already an Ignition package that provides the described functionality: <a href=\"https://ignitionrobotics.org/libs\" rel=\"nofollow\" class=\"ap-connect-link\">https://ignitionrobotics.org/libs</a></li>\n</ul>\n</li>\n</ul>\n<h1 id=\"markdown-header-description\">Description</h1>\n<p>If <code>tinyxml2</code> is a required package for two other packages, in this case <code>ignition-common3::graphics</code> and <code>DART::dart-utils</code>, depending on the order of calls to <code>ign_find_package</code>, <code>tinyxml2</code> is reported to be not found. This a strange failure because CMake reports that it found <code>tinyxml2</code> but then subsequently reports that it's missing <code>TINYXML2_INCLUDE_DIRS</code>.</p>\n<h1 id=\"markdown-header-steps-to-reproduce\">Steps to Reproduce</h1>\n<p>Here are two CMakeLists.txt files that demonstrate the problem</p>\n<p><strong>Failing example:</strong></p>\n<div class=\"codehilite language-cmake\"><pre><span></span><span class=\"nb\">cmake_minimum_required</span><span class=\"p\">(</span><span class=\"s\">VERSION</span> <span class=\"s\">3.5.1</span> <span class=\"s\">FATAL_ERROR</span><span class=\"p\">)</span>\n<span class=\"nb\">project</span><span class=\"p\">(</span><span class=\"s\">test-tinyxml2</span> <span class=\"s\">VERSION</span> <span class=\"s\">1.0.0</span><span class=\"p\">)</span>\n<span class=\"nb\">find_package</span><span class=\"p\">(</span><span class=\"s\">ignition-cmake2</span> <span class=\"s\">REQUIRED</span><span class=\"p\">)</span>\n\n<span class=\"nb\">ign_find_package</span><span class=\"p\">(</span><span class=\"s\">ignition-common3</span> <span class=\"s\">COMPONENTS</span> <span class=\"s\">graphics</span><span class=\"p\">)</span>\n\n<span class=\"nb\">ign_find_package</span><span class=\"p\">(</span><span class=\"s\">DART</span>\n  <span class=\"s\">COMPONENTS</span>\n    <span class=\"s\">utils</span>\n  <span class=\"s\">PKGCONFIG</span> <span class=\"s\">dart</span>\n  <span class=\"s\">PKGCONFIG_VER_COMPARISON</span> <span class=\"s\">&gt;=</span><span class=\"p\">)</span>\n</pre></div>\n\n\n<p>The result of running cmake on this:</p>\n<div class=\"codehilite\"><pre><span></span>-- The C compiler identification is GNU 8.2.0\n-- The CXX compiler identification is GNU 8.2.0\n-- Check for working C compiler: /usr/lib/ccache/cc\n-- Check for working C compiler: /usr/lib/ccache/cc -- works\n-- Detecting C compiler ABI info\n-- Detecting C compiler ABI info - done\n-- Detecting C compile features\n-- Detecting C compile features - done\n-- Check for working CXX compiler: /usr/lib/ccache/c++\n-- Check for working CXX compiler: /usr/lib/ccache/c++ -- works\n-- Detecting CXX compiler ABI info\n-- Detecting CXX compiler ABI info - done\n-- Detecting CXX compile features\n-- Detecting CXX compile features - done\n-- Looking for ignition-common3 -- found version 3.0.0~pre4\n-- Searching for dependencies of ignition-common3\n-- Looking for dlfcn.h - found\n-- Looking for libdl - found\n-- Found DL: TRUE  \n-- Checking for module &#39;uuid&#39;\n--   Found uuid, version 2.31.1\n-- Found UUID: TRUE  \n-- Searching for &lt;ignition-common3&gt; component [graphics]\n-- Looking for ignition-common3-graphics -- found version 3.0.0~pre4\n-- Searching for dependencies of ignition-common3-graphics\n-- Looking for ignition-math6 -- found version 6.0.0~pre4\n-- Searching for dependencies of ignition-math6\n-- Checking for module &#39;tinyxml2&#39;\n--   Found tinyxml2, version 6.0.0\n-- Found FreeImage: TRUE (Required is at least version &quot;3.9&quot;) \n-- Checking for module &#39;gts&#39;\n--   Found gts, version 0.7.6\n-- Found GTS: TRUE  \n-- Looking for ignition-common3 - found\n\n-- Could NOT find TINYXML2 (missing: TINYXML2_INCLUDE_DIRS) (found version &quot;6.0.0&quot;)\nCMake Warning at /usr/local/share/dart/cmake/dart_utilsComponent.cmake:11 (message):\n  Cannot retrieve dart-utils because the dependency tinyxml2 could not be\n  found.  This usually indicates a broken installation.\nCall Stack (most recent call first):\n  /usr/local/share/dart/cmake/DARTConfig.cmake:63 (include)\n  /usr/local/share/dart/cmake/DARTConfig.cmake:124 (dart_traverse_components)\n  /usr/local/share/dart/cmake/DARTConfig.cmake:172 (dart_package_init)\n  /home/addisu/ws/ign_base/devel/share/cmake/ignition-cmake2/cmake2/IgnUtils.cmake:188 (find_package)\n  CMakeLists.txt:7 (ign_find_package)\n\n\n-- Found CCD: /usr/include (found version &quot;2.0&quot;) \n-- Found FCL: /usr/include (found version &quot;0.5.0&quot;) \n-- Found ASSIMP: /usr/include (found version &quot;4.1.0&quot;) \n-- Found DART: /usr/local/include  found components:  utils dart \n-- Looking for DART - found\n\n-- Configuring done\n-- Generating done\n-- Build files have been written to: \n</pre></div>\n\n\n<p><strong>Working example: (<code>ignition-common3</code> comes after <code>DART</code>)</strong></p>\n<div class=\"codehilite language-cmake\"><pre><span></span><span class=\"nb\">cmake_minimum_required</span><span class=\"p\">(</span><span class=\"s\">VERSION</span> <span class=\"s\">3.5.1</span> <span class=\"s\">FATAL_ERROR</span><span class=\"p\">)</span>\n<span class=\"nb\">project</span><span class=\"p\">(</span><span class=\"s\">test-tinyxml2</span> <span class=\"s\">VERSION</span> <span class=\"s\">1.0.0</span><span class=\"p\">)</span>\n<span class=\"nb\">find_package</span><span class=\"p\">(</span><span class=\"s\">ignition-cmake2</span> <span class=\"s\">REQUIRED</span><span class=\"p\">)</span>\n\n<span class=\"nb\">ign_find_package</span><span class=\"p\">(</span><span class=\"s\">DART</span>\n  <span class=\"s\">COMPONENTS</span>\n    <span class=\"s\">utils</span>\n  <span class=\"s\">PKGCONFIG</span> <span class=\"s\">dart</span>\n  <span class=\"s\">PKGCONFIG_VER_COMPARISON</span> <span class=\"s\">&gt;=</span><span class=\"p\">)</span>\n\n<span class=\"nb\">ign_find_package</span><span class=\"p\">(</span><span class=\"s\">ignition-common3</span> <span class=\"s\">COMPONENTS</span> <span class=\"s\">graphics</span><span class=\"p\">)</span>\n</pre></div>\n\n\n<p>The result of running cmake on this:</p>\n<div class=\"codehilite\"><pre><span></span>-- The C compiler identification is GNU 8.2.0\n-- The CXX compiler identification is GNU 8.2.0\n-- Check for working C compiler: /usr/lib/ccache/cc\n-- Check for working C compiler: /usr/lib/ccache/cc -- works\n-- Detecting C compiler ABI info\n-- Detecting C compiler ABI info - done\n-- Detecting C compile features\n-- Detecting C compile features - done\n-- Check for working CXX compiler: /usr/lib/ccache/c++\n-- Check for working CXX compiler: /usr/lib/ccache/c++ -- works\n-- Detecting CXX compiler ABI info\n-- Detecting CXX compiler ABI info - done\n-- Detecting CXX compile features\n-- Detecting CXX compile features - done\n-- Found TINYXML2: /usr/include (found version &quot;6.0.0&quot;) \n-- Found CCD: /usr/include (found version &quot;2.0&quot;) \n-- Found FCL: /usr/include (found version &quot;0.5.0&quot;) \n-- Found ASSIMP: /usr/include (found version &quot;4.1.0&quot;) \n-- Found DART: /usr/local/include  found components:  utils dart \n-- Looking for DART - found\n\n-- Looking for ignition-common3 -- found version 3.0.0~pre4\n-- Searching for dependencies of ignition-common3\n-- Looking for dlfcn.h - found\n-- Looking for libdl - found\n-- Found DL: TRUE  \n-- Checking for module &#39;uuid&#39;\n--   Found uuid, version 2.31.1\n-- Found UUID: TRUE  \n-- Searching for &lt;ignition-common3&gt; component [graphics]\n-- Looking for ignition-common3-graphics -- found version 3.0.0~pre4\n-- Searching for dependencies of ignition-common3-graphics\n-- Looking for ignition-math6 -- found version 6.0.0~pre4\n-- Searching for dependencies of ignition-math6\n-- Checking for module &#39;tinyxml2&#39;\n--   Found tinyxml2, version 6.0.0\n-- Found FreeImage: TRUE (Required is at least version &quot;3.9&quot;) \n-- Checking for module &#39;gts&#39;\n--   Found gts, version 0.7.6\n-- Found GTS: TRUE  \n-- Looking for ignition-common3 - found\n\n-- Configuring done\n-- Generating done\n-- Build files have been written to: \n</pre></div>\n\n\n<p><strong>Expected behavior:</strong>  </p>\n<p><code>tinyxml2</code> should be found in regardless of the order of calls to <code>ign_find_package</code></p>\n<p><strong>Actual behavior:</strong></p>\n<p>The order of calls to <code>ign_find_package</code> matters.</p>\n<p><strong>Reproduces how often:</strong> </p>\n<p>100% of the time</p>\n<h1 id=\"markdown-header-versions\">Versions</h1>\n<ul>\n<li><code>ignition-common3</code> (<code>gz11</code> branch)</li>\n<li>DART v6.7.2</li>\n<li><code>ignition-cmake2</code> (<code>gz11</code> branch)</li>\n</ul>", "type": "rendered"}, "assignee": null, "state": "resolved", "version": null, "edited_on": null, "created_on": "2019-01-22T17:49:52.284439+00:00", "milestone": null, "updated_on": "2019-01-31T19:40:05.032954+00:00", "type": "issue", "id": 49}