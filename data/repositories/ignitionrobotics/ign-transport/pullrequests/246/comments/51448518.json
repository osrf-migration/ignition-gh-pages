{"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-transport/pullrequests/246/comments/51448518.json"}, "html": {"href": "#!/ignitionrobotics/ign-transport/pull-requests/246/_/diff#comment-51448518"}}, "parent": {"id": 51448441, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-transport/pullrequests/246/comments/51448441.json"}, "html": {"href": "#!/ignitionrobotics/ign-transport/pull-requests/246/_/diff#comment-51448441"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 246, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-transport/pullrequests/246.json"}, "html": {"href": "#!/ignitionrobotics/ign-transport/pull-requests/246"}}, "title": "Record proof of concept (do not merge)"}, "content": {"raw": "Test code\n\n```\nvoid onMessageReceived(\n    const google::protobuf::Message &_msg,\n    const ignition::transport::MessageInfo &_info)\n{\n  ReceivedMessage m;\n  m.time_rx = time(NULL);\n  m.topic = _info.Topic();\n  _msg.SerializeToString(&(m.message));\n  std::cout << \"Received message on \" << m.topic << \" type \" << _msg.GetTypeName() << \"\\n\";\n  std::lock_guard<std::mutex> guard(g_buffer_mutex);\n  g_message_buffer.push_back(m);\n}\n```\n\nWarning: magic detected\n```\nReceived message on /some/string type ignition.msgs.StringMsg\nReceived message on /some/float type ignition.msgs.Float\n```", "markup": "markdown", "html": "<p>Test code</p>\n<div class=\"codehilite\"><pre><span></span><span class=\"nt\">void</span> <span class=\"nt\">onMessageReceived</span><span class=\"o\">(</span>\n    <span class=\"nt\">const</span> <span class=\"nt\">google</span><span class=\"p\">::</span><span class=\"nd\">protobuf</span><span class=\"p\">::</span><span class=\"nd\">Message</span> <span class=\"o\">&amp;</span><span class=\"nt\">_msg</span><span class=\"o\">,</span>\n    <span class=\"nt\">const</span> <span class=\"nt\">ignition</span><span class=\"p\">::</span><span class=\"nd\">transport</span><span class=\"p\">::</span><span class=\"nd\">MessageInfo</span> <span class=\"o\">&amp;</span><span class=\"nt\">_info</span><span class=\"o\">)</span>\n<span class=\"p\">{</span>\n  <span class=\"err\">ReceivedMessage</span> <span class=\"err\">m</span><span class=\"p\">;</span>\n  <span class=\"err\">m.time_rx</span> <span class=\"err\">=</span> <span class=\"err\">time(NULL)</span><span class=\"p\">;</span>\n  <span class=\"err\">m.topic</span> <span class=\"err\">=</span> <span class=\"err\">_info.Topic()</span><span class=\"p\">;</span>\n  <span class=\"err\">_msg.SerializeToString(&amp;(m.message))</span><span class=\"p\">;</span>\n  <span class=\"n\">std</span><span class=\"p\">:</span><span class=\"o\">:</span><span class=\"n\">cout</span> <span class=\"o\">&lt;&lt;</span> <span class=\"s2\">&quot;Received message on &quot;</span> <span class=\"o\">&lt;&lt;</span> <span class=\"n\">m</span><span class=\"o\">.</span><span class=\"n\">topic</span> <span class=\"o\">&lt;&lt;</span> <span class=\"s2\">&quot; type &quot;</span> <span class=\"o\">&lt;&lt;</span> <span class=\"n\">_msg</span><span class=\"o\">.</span><span class=\"nf\">GetTypeName</span><span class=\"p\">()</span> <span class=\"o\">&lt;&lt;</span> <span class=\"s2\">&quot;\\n&quot;</span><span class=\"p\">;</span>\n  <span class=\"n\">std</span><span class=\"p\">:</span><span class=\"o\">:</span><span class=\"n\">lock_guard</span><span class=\"o\">&lt;</span><span class=\"n\">std</span><span class=\"o\">::</span><span class=\"n\">mutex</span><span class=\"o\">&gt;</span> <span class=\"nf\">guard</span><span class=\"p\">(</span><span class=\"n\">g_buffer_mutex</span><span class=\"p\">);</span>\n  <span class=\"err\">g_message_buffer.push_back(m)</span><span class=\"p\">;</span>\n<span class=\"p\">}</span>\n</pre></div>\n\n\n<p>Warning: magic detected</p>\n<div class=\"codehilite\"><pre><span></span>Received message on /some/string type ignition.msgs.StringMsg\nReceived message on /some/float type ignition.msgs.Float\n</pre></div>", "type": "rendered"}, "created_on": "2017-12-08T00:08:21.567502+00:00", "user": {"display_name": "Shane Loretz", "uuid": "{656e3311-aad9-45a1-aaf7-b0ee0e84b287}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B656e3311-aad9-45a1-aaf7-b0ee0e84b287%7D"}, "html": {"href": "https://bitbucket.org/%7B656e3311-aad9-45a1-aaf7-b0ee0e84b287%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:684383ab-ac95-4859-a350-4a6f41a94a22/c7a1ebf5-cade-4115-9f26-9d3facb776db/128"}}, "nickname": "Shane Loretz", "type": "user", "account_id": "557058:684383ab-ac95-4859-a350-4a6f41a94a22"}, "updated_on": "2017-12-08T00:08:21.569536+00:00", "type": "pullrequest_comment", "id": 51448518}