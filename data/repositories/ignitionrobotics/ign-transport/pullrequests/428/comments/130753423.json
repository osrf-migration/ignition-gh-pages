{"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-transport/pullrequests/428/comments/130753423.json"}, "html": {"href": "#!/ignitionrobotics/ign-transport/pull-requests/428/_/diff#comment-130753423"}}, "parent": {"id": 130728909, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-transport/pullrequests/428/comments/130728909.json"}, "html": {"href": "#!/ignitionrobotics/ign-transport/pull-requests/428/_/diff#comment-130728909"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 428, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-transport/pullrequests/428.json"}, "html": {"href": "#!/ignitionrobotics/ign-transport/pull-requests/428"}}, "title": "Write to disk from a background thread in log recorder"}, "content": {"raw": "Yes, it is definitely a valid concern, but isn't it up  to the application to set the correct queue size. For SubT, we can set a very large queue size in ign-gazebo. That being said, a good default is always desirable.\n\n> How about we take some lessons from rosbag, which specifies a queue based on MB or zero for infinite queue. Rosbag also writes in chunks, not at every message. Both of these strategies might be beneficial here.\n\nI like these ideas. I'll start working on them. I don't know if writing in chunks will improve performance though since each message is inserted into the database individually. If there is a way to do a bulk database update, that would be great.\n\nAnother idea is to put the log recorder in its own process. If we did that, it won't block other subscribers, but we would pay the cost of serialization and hitting the network. Is that something we should consider?\n\n", "markup": "markdown", "html": "<p>Yes, it is definitely a valid concern, but isn't it up  to the application to set the correct queue size. For SubT, we can set a very large queue size in ign-gazebo. That being said, a good default is always desirable.</p>\n<blockquote>\n<p>How about we take some lessons from rosbag, which specifies a queue based on MB or zero for infinite queue. Rosbag also writes in chunks, not at every message. Both of these strategies might be beneficial here.</p>\n</blockquote>\n<p>I like these ideas. I'll start working on them. I don't know if writing in chunks will improve performance though since each message is inserted into the database individually. If there is a way to do a bulk database update, that would be great.</p>\n<p>Another idea is to put the log recorder in its own process. If we did that, it won't block other subscribers, but we would pay the cost of serialization and hitting the network. Is that something we should consider?</p>", "type": "rendered"}, "created_on": "2020-01-07T20:10:07.946334+00:00", "user": {"display_name": "Addisu Z. Taddese", "uuid": "{9d7fdc68-d270-4080-bf03-4df0d0dbf635}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B9d7fdc68-d270-4080-bf03-4df0d0dbf635%7D"}, "html": {"href": "https://bitbucket.org/%7B9d7fdc68-d270-4080-bf03-4df0d0dbf635%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:90bc87b0-2886-4377-a17c-3a6629a697ff/afbf9be5-1e4c-4810-89d4-e58831f34b11/128"}}, "nickname": "azeey", "type": "user", "account_id": "557058:90bc87b0-2886-4377-a17c-3a6629a697ff"}, "updated_on": "2020-01-07T20:10:07.955139+00:00", "type": "pullrequest_comment", "id": 130753423}