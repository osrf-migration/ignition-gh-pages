{"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-transport/pullrequests/158/comments/22682557.json"}, "code": {"href": "https://api.bitbucket.org/2.0/repositories/ignitionrobotics/ign-transport/diff/nampi/ign-transport:None..None?path=src%2FNodeShared.cc"}, "html": {"href": "#!/ignitionrobotics/ign-transport/pull-requests/158/_/diff#comment-22682557"}}, "parent": {"id": 22671321, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-transport/pullrequests/158/comments/22671321.json"}, "html": {"href": "#!/ignitionrobotics/ign-transport/pull-requests/158/_/diff#comment-22671321"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 158, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-transport/pullrequests/158.json"}, "html": {"href": "#!/ignitionrobotics/ign-transport/pull-requests/158"}}, "title": "Issue_47: Wait for subscribers"}, "content": {"raw": "1) With this string: All old tests work correct, but the logic for current task is broken. I added two tests in ```test/integration/twoProcessesPubSub.cc``` file: ```WaitForSubscribersSameTypeNamesRemoteSubscribers``` and ```WaitForSubscribersDifferentTypeNamesRemoteSubscribers```. In these cases I want to have remote subscriber in ```NodeShared::remoteSubscribers```. Then I want to check this block in ```Node::WaitForSubscribers()```:\n\n\n```\n#!c++\n\n  // Remote subscribers. Check message type names.\n  if (hasRemoteSubscribers)\n  {\n    for (const auto &proc : subscribers)\n    {\n      const auto &v = proc.second;\n      for (const auto &subscriber : v)\n      {\n        if (subscriber.MsgTypeName() == _typeName)\n          return true;\n      }\n    }\n  }\n```\nIt works good.\n\n2) Without this string: I check that message types are different and I do not have a remote subscriber.\n\nCould you specify what should I describe more, please?", "markup": "markdown", "html": "<p>1) With this string: All old tests work correct, but the logic for current task is broken. I added two tests in <code>test/integration/twoProcessesPubSub.cc</code> file: <code>WaitForSubscribersSameTypeNamesRemoteSubscribers</code> and <code>WaitForSubscribersDifferentTypeNamesRemoteSubscribers</code>. In these cases I want to have remote subscriber in <code>NodeShared::remoteSubscribers</code>. Then I want to check this block in <code>Node::WaitForSubscribers()</code>:</p>\n<div class=\"codehilite language-c++\"><pre><span></span>  <span class=\"c1\">// Remote subscribers. Check message type names.</span>\n  <span class=\"k\">if</span> <span class=\"p\">(</span><span class=\"n\">hasRemoteSubscribers</span><span class=\"p\">)</span>\n  <span class=\"p\">{</span>\n    <span class=\"k\">for</span> <span class=\"p\">(</span><span class=\"k\">const</span> <span class=\"k\">auto</span> <span class=\"o\">&amp;</span><span class=\"nl\">proc</span> <span class=\"p\">:</span> <span class=\"n\">subscribers</span><span class=\"p\">)</span>\n    <span class=\"p\">{</span>\n      <span class=\"k\">const</span> <span class=\"k\">auto</span> <span class=\"o\">&amp;</span><span class=\"n\">v</span> <span class=\"o\">=</span> <span class=\"n\">proc</span><span class=\"p\">.</span><span class=\"n\">second</span><span class=\"p\">;</span>\n      <span class=\"k\">for</span> <span class=\"p\">(</span><span class=\"k\">const</span> <span class=\"k\">auto</span> <span class=\"o\">&amp;</span><span class=\"nl\">subscriber</span> <span class=\"p\">:</span> <span class=\"n\">v</span><span class=\"p\">)</span>\n      <span class=\"p\">{</span>\n        <span class=\"k\">if</span> <span class=\"p\">(</span><span class=\"n\">subscriber</span><span class=\"p\">.</span><span class=\"n\">MsgTypeName</span><span class=\"p\">()</span> <span class=\"o\">==</span> <span class=\"n\">_typeName</span><span class=\"p\">)</span>\n          <span class=\"k\">return</span> <span class=\"nb\">true</span><span class=\"p\">;</span>\n      <span class=\"p\">}</span>\n    <span class=\"p\">}</span>\n  <span class=\"p\">}</span>\n</pre></div>\n\n\n<p>It works good.</p>\n<p>2) Without this string: I check that message types are different and I do not have a remote subscriber.</p>\n<p>Could you specify what should I describe more, please?</p>", "type": "rendered"}, "created_on": "2016-08-22T21:46:47.674115+00:00", "user": {"display_name": "nampi", "uuid": "{89a67bdd-09e6-4c17-8014-48d97fa5c4c8}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B89a67bdd-09e6-4c17-8014-48d97fa5c4c8%7D"}, "html": {"href": "https://bitbucket.org/%7B89a67bdd-09e6-4c17-8014-48d97fa5c4c8%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:6509b6f8-6263-4504-9cee-d12b08b0b4e8/38230840-603b-4875-93fb-c2e81928dd69/128"}}, "nickname": "nampi", "type": "user", "account_id": "557058:6509b6f8-6263-4504-9cee-d12b08b0b4e8"}, "inline": {"to": null, "from": null, "outdated": false, "path": "src/NodeShared.cc"}, "updated_on": "2016-08-22T21:46:47.676184+00:00", "type": "pullrequest_comment", "id": 22682557}