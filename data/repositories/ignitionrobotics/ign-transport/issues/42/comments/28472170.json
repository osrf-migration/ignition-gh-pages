{"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-transport/issues/42/comments/28472170.json"}, "html": {"href": "#!/ignitionrobotics/ign-transport/issues/42#comment-28472170"}}, "issue": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-transport/issues/42.json"}}, "type": "issue", "id": 42, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-transport.json"}, "html": {"href": "#!/ignitionrobotics/ign-transport"}, "avatar": {"href": "data/bytebucket.org/ravatar/{4249390a-7f55-404b-990d-817ba94cc7ac}ts=1533306"}}, "type": "repository", "name": "ign-transport", "full_name": "ignitionrobotics/ign-transport", "uuid": "{4249390a-7f55-404b-990d-817ba94cc7ac}"}, "title": "Implement a service request from the command line using \"ign\""}, "content": {"raw": "I do not understand how to create request and response messages correctly. I tried to do the same as in topic publisher:\n\n```\n#!c++\n\n  // Create the message, and populate the field with _msgData\n  auto msg = ignition::msgs::Factory::New(_msgType, _msgData);\n  if (msg)\n  {\n    // Create the node and advertise the topic\n    ignition::transport::Node node;\n    auto pubId = node.Advertise(_topic, msg->GetTypeName());\n    node.Publish(pubId, *msg);\n```\nMy code:\n\n```\n#!c++\n\nauto req = ignition::msgs::Factory::New(_reqType, _reqData);\nauto rep = ignition::msgs::Factory::New(_repType);\nignition::transport::Node node;\nbool result;\nbool executed = node.Request(_service, *req, _timeout, *rep, result);\n```\n\n\nBut I have an error.\n\n```\n#!c++\n\n   bool executed = node.Request(_service, *req, _timeout, *rep, result);\n        ^\nIn file included from /home/user/code/issue_42/include/ignition/transport/NodeShared.hh:41:0,\n                 from /home/user/code/issue_42/include/ignition/transport/Node.hh:40,\n                 from /home/user/code/issue_42/src/ign.cc:26:\n/home/user/code/issue_42/include/ignition/transport/ReqHandler.hh: In instantiation of \u2018class ignition::transport::ReqHandler<google::protobuf::Message, google::protobuf::Message>\u2019:\n/home/user/code/issue_42/include/ignition/transport/Node.hh:586:51:   required from \u2018bool ignition::transport::Node::Request(const string&, const T1&, const unsigned int&, T2&, bool&) [with T1 = google::protobuf::Message; T2 = google::protobuf::Message; std::string = std::basic_string<char>]\u2019\n/home/user/code/issue_42/src/ign.cc:231:70:   required from here\n/home/user/code/issue_42/include/ignition/transport/ReqHandler.hh:268:20: error: cannot declare field \u2018ignition::transport::ReqHandler<google::protobuf::Message, google::protobuf::Message>::reqMsg\u2019 to be of abstract type \u2018google::protobuf::Message\u2019\n       private: Req reqMsg;\n```\nI can copy full error message if needed.", "markup": "markdown", "html": "<p>I do not understand how to create request and response messages correctly. I tried to do the same as in topic publisher:</p>\n<div class=\"codehilite language-c++\"><pre><span></span>  <span class=\"c1\">// Create the message, and populate the field with _msgData</span>\n  <span class=\"k\">auto</span> <span class=\"n\">msg</span> <span class=\"o\">=</span> <span class=\"n\">ignition</span><span class=\"o\">::</span><span class=\"n\">msgs</span><span class=\"o\">::</span><span class=\"n\">Factory</span><span class=\"o\">::</span><span class=\"n\">New</span><span class=\"p\">(</span><span class=\"n\">_msgType</span><span class=\"p\">,</span> <span class=\"n\">_msgData</span><span class=\"p\">);</span>\n  <span class=\"k\">if</span> <span class=\"p\">(</span><span class=\"n\">msg</span><span class=\"p\">)</span>\n  <span class=\"p\">{</span>\n    <span class=\"c1\">// Create the node and advertise the topic</span>\n    <span class=\"n\">ignition</span><span class=\"o\">::</span><span class=\"n\">transport</span><span class=\"o\">::</span><span class=\"n\">Node</span> <span class=\"n\">node</span><span class=\"p\">;</span>\n    <span class=\"k\">auto</span> <span class=\"n\">pubId</span> <span class=\"o\">=</span> <span class=\"n\">node</span><span class=\"p\">.</span><span class=\"n\">Advertise</span><span class=\"p\">(</span><span class=\"n\">_topic</span><span class=\"p\">,</span> <span class=\"n\">msg</span><span class=\"o\">-&gt;</span><span class=\"n\">GetTypeName</span><span class=\"p\">());</span>\n    <span class=\"n\">node</span><span class=\"p\">.</span><span class=\"n\">Publish</span><span class=\"p\">(</span><span class=\"n\">pubId</span><span class=\"p\">,</span> <span class=\"o\">*</span><span class=\"n\">msg</span><span class=\"p\">);</span>\n</pre></div>\n\n\n<p>My code:</p>\n<div class=\"codehilite language-c++\"><pre><span></span><span class=\"k\">auto</span> <span class=\"n\">req</span> <span class=\"o\">=</span> <span class=\"n\">ignition</span><span class=\"o\">::</span><span class=\"n\">msgs</span><span class=\"o\">::</span><span class=\"n\">Factory</span><span class=\"o\">::</span><span class=\"n\">New</span><span class=\"p\">(</span><span class=\"n\">_reqType</span><span class=\"p\">,</span> <span class=\"n\">_reqData</span><span class=\"p\">);</span>\n<span class=\"k\">auto</span> <span class=\"n\">rep</span> <span class=\"o\">=</span> <span class=\"n\">ignition</span><span class=\"o\">::</span><span class=\"n\">msgs</span><span class=\"o\">::</span><span class=\"n\">Factory</span><span class=\"o\">::</span><span class=\"n\">New</span><span class=\"p\">(</span><span class=\"n\">_repType</span><span class=\"p\">);</span>\n<span class=\"n\">ignition</span><span class=\"o\">::</span><span class=\"n\">transport</span><span class=\"o\">::</span><span class=\"n\">Node</span> <span class=\"n\">node</span><span class=\"p\">;</span>\n<span class=\"kt\">bool</span> <span class=\"n\">result</span><span class=\"p\">;</span>\n<span class=\"kt\">bool</span> <span class=\"n\">executed</span> <span class=\"o\">=</span> <span class=\"n\">node</span><span class=\"p\">.</span><span class=\"n\">Request</span><span class=\"p\">(</span><span class=\"n\">_service</span><span class=\"p\">,</span> <span class=\"o\">*</span><span class=\"n\">req</span><span class=\"p\">,</span> <span class=\"n\">_timeout</span><span class=\"p\">,</span> <span class=\"o\">*</span><span class=\"n\">rep</span><span class=\"p\">,</span> <span class=\"n\">result</span><span class=\"p\">);</span>\n</pre></div>\n\n\n<p>But I have an error.</p>\n<div class=\"codehilite language-c++\"><pre><span></span>   <span class=\"kt\">bool</span> <span class=\"n\">executed</span> <span class=\"o\">=</span> <span class=\"n\">node</span><span class=\"p\">.</span><span class=\"n\">Request</span><span class=\"p\">(</span><span class=\"n\">_service</span><span class=\"p\">,</span> <span class=\"o\">*</span><span class=\"n\">req</span><span class=\"p\">,</span> <span class=\"n\">_timeout</span><span class=\"p\">,</span> <span class=\"o\">*</span><span class=\"n\">rep</span><span class=\"p\">,</span> <span class=\"n\">result</span><span class=\"p\">);</span>\n        <span class=\"o\">^</span>\n<span class=\"n\">In</span> <span class=\"n\">file</span> <span class=\"n\">included</span> <span class=\"n\">from</span> <span class=\"o\">/</span><span class=\"n\">home</span><span class=\"o\">/</span><span class=\"n\">user</span><span class=\"o\">/</span><span class=\"n\">code</span><span class=\"o\">/</span><span class=\"n\">issue_42</span><span class=\"o\">/</span><span class=\"n\">include</span><span class=\"o\">/</span><span class=\"n\">ignition</span><span class=\"o\">/</span><span class=\"n\">transport</span><span class=\"o\">/</span><span class=\"n\">NodeShared</span><span class=\"p\">.</span><span class=\"nl\">hh</span><span class=\"p\">:</span><span class=\"mi\">41</span><span class=\"o\">:</span><span class=\"mi\">0</span><span class=\"p\">,</span>\n                 <span class=\"n\">from</span> <span class=\"o\">/</span><span class=\"n\">home</span><span class=\"o\">/</span><span class=\"n\">user</span><span class=\"o\">/</span><span class=\"n\">code</span><span class=\"o\">/</span><span class=\"n\">issue_42</span><span class=\"o\">/</span><span class=\"n\">include</span><span class=\"o\">/</span><span class=\"n\">ignition</span><span class=\"o\">/</span><span class=\"n\">transport</span><span class=\"o\">/</span><span class=\"n\">Node</span><span class=\"p\">.</span><span class=\"nl\">hh</span><span class=\"p\">:</span><span class=\"mi\">40</span><span class=\"p\">,</span>\n                 <span class=\"n\">from</span> <span class=\"o\">/</span><span class=\"n\">home</span><span class=\"o\">/</span><span class=\"n\">user</span><span class=\"o\">/</span><span class=\"n\">code</span><span class=\"o\">/</span><span class=\"n\">issue_42</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">ign</span><span class=\"p\">.</span><span class=\"nl\">cc</span><span class=\"p\">:</span><span class=\"mi\">26</span><span class=\"o\">:</span>\n<span class=\"o\">/</span><span class=\"n\">home</span><span class=\"o\">/</span><span class=\"n\">user</span><span class=\"o\">/</span><span class=\"n\">code</span><span class=\"o\">/</span><span class=\"n\">issue_42</span><span class=\"o\">/</span><span class=\"n\">include</span><span class=\"o\">/</span><span class=\"n\">ignition</span><span class=\"o\">/</span><span class=\"n\">transport</span><span class=\"o\">/</span><span class=\"n\">ReqHandler</span><span class=\"p\">.</span><span class=\"nl\">hh</span><span class=\"p\">:</span> <span class=\"n\">In</span> <span class=\"n\">instantiation</span> <span class=\"n\">of</span> <span class=\"err\">\u2018</span><span class=\"k\">class</span> <span class=\"nc\">ignition</span><span class=\"o\">::</span><span class=\"n\">transport</span><span class=\"o\">::</span><span class=\"n\">ReqHandler</span><span class=\"o\">&lt;</span><span class=\"n\">google</span><span class=\"o\">::</span><span class=\"n\">protobuf</span><span class=\"o\">::</span><span class=\"n\">Message</span><span class=\"p\">,</span> <span class=\"n\">google</span><span class=\"o\">::</span><span class=\"n\">protobuf</span><span class=\"o\">::</span><span class=\"n\">Message</span><span class=\"o\">&gt;</span><span class=\"err\">\u2019</span><span class=\"o\">:</span>\n<span class=\"o\">/</span><span class=\"n\">home</span><span class=\"o\">/</span><span class=\"n\">user</span><span class=\"o\">/</span><span class=\"n\">code</span><span class=\"o\">/</span><span class=\"n\">issue_42</span><span class=\"o\">/</span><span class=\"n\">include</span><span class=\"o\">/</span><span class=\"n\">ignition</span><span class=\"o\">/</span><span class=\"n\">transport</span><span class=\"o\">/</span><span class=\"n\">Node</span><span class=\"p\">.</span><span class=\"nl\">hh</span><span class=\"p\">:</span><span class=\"mi\">586</span><span class=\"o\">:</span><span class=\"mi\">51</span><span class=\"o\">:</span>   <span class=\"n\">required</span> <span class=\"n\">from</span> <span class=\"err\">\u2018</span><span class=\"kt\">bool</span> <span class=\"n\">ignition</span><span class=\"o\">::</span><span class=\"n\">transport</span><span class=\"o\">::</span><span class=\"n\">Node</span><span class=\"o\">::</span><span class=\"n\">Request</span><span class=\"p\">(</span><span class=\"k\">const</span> <span class=\"n\">string</span><span class=\"o\">&amp;</span><span class=\"p\">,</span> <span class=\"k\">const</span> <span class=\"n\">T1</span><span class=\"o\">&amp;</span><span class=\"p\">,</span> <span class=\"k\">const</span> <span class=\"kt\">unsigned</span> <span class=\"kt\">int</span><span class=\"o\">&amp;</span><span class=\"p\">,</span> <span class=\"n\">T2</span><span class=\"o\">&amp;</span><span class=\"p\">,</span> <span class=\"kt\">bool</span><span class=\"o\">&amp;</span><span class=\"p\">)</span> <span class=\"p\">[</span><span class=\"n\">with</span> <span class=\"n\">T1</span> <span class=\"o\">=</span> <span class=\"n\">google</span><span class=\"o\">::</span><span class=\"n\">protobuf</span><span class=\"o\">::</span><span class=\"n\">Message</span><span class=\"p\">;</span> <span class=\"n\">T2</span> <span class=\"o\">=</span> <span class=\"n\">google</span><span class=\"o\">::</span><span class=\"n\">protobuf</span><span class=\"o\">::</span><span class=\"n\">Message</span><span class=\"p\">;</span> <span class=\"n\">std</span><span class=\"o\">::</span><span class=\"n\">string</span> <span class=\"o\">=</span> <span class=\"n\">std</span><span class=\"o\">::</span><span class=\"n\">basic_string</span><span class=\"o\">&lt;</span><span class=\"kt\">char</span><span class=\"o\">&gt;</span><span class=\"p\">]</span><span class=\"err\">\u2019</span>\n<span class=\"o\">/</span><span class=\"n\">home</span><span class=\"o\">/</span><span class=\"n\">user</span><span class=\"o\">/</span><span class=\"n\">code</span><span class=\"o\">/</span><span class=\"n\">issue_42</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">ign</span><span class=\"p\">.</span><span class=\"nl\">cc</span><span class=\"p\">:</span><span class=\"mi\">231</span><span class=\"o\">:</span><span class=\"mi\">70</span><span class=\"o\">:</span>   <span class=\"n\">required</span> <span class=\"n\">from</span> <span class=\"n\">here</span>\n<span class=\"o\">/</span><span class=\"n\">home</span><span class=\"o\">/</span><span class=\"n\">user</span><span class=\"o\">/</span><span class=\"n\">code</span><span class=\"o\">/</span><span class=\"n\">issue_42</span><span class=\"o\">/</span><span class=\"n\">include</span><span class=\"o\">/</span><span class=\"n\">ignition</span><span class=\"o\">/</span><span class=\"n\">transport</span><span class=\"o\">/</span><span class=\"n\">ReqHandler</span><span class=\"p\">.</span><span class=\"nl\">hh</span><span class=\"p\">:</span><span class=\"mi\">268</span><span class=\"o\">:</span><span class=\"mi\">20</span><span class=\"o\">:</span> <span class=\"nl\">error</span><span class=\"p\">:</span> <span class=\"n\">cannot</span> <span class=\"n\">declare</span> <span class=\"n\">field</span> <span class=\"err\">\u2018</span><span class=\"n\">ignition</span><span class=\"o\">::</span><span class=\"n\">transport</span><span class=\"o\">::</span><span class=\"n\">ReqHandler</span><span class=\"o\">&lt;</span><span class=\"n\">google</span><span class=\"o\">::</span><span class=\"n\">protobuf</span><span class=\"o\">::</span><span class=\"n\">Message</span><span class=\"p\">,</span> <span class=\"n\">google</span><span class=\"o\">::</span><span class=\"n\">protobuf</span><span class=\"o\">::</span><span class=\"n\">Message</span><span class=\"o\">&gt;::</span><span class=\"n\">reqMsg</span><span class=\"err\">\u2019</span> <span class=\"n\">to</span> <span class=\"n\">be</span> <span class=\"n\">of</span> <span class=\"n\">abstract</span> <span class=\"n\">type</span> <span class=\"err\">\u2018</span><span class=\"n\">google</span><span class=\"o\">::</span><span class=\"n\">protobuf</span><span class=\"o\">::</span><span class=\"n\">Message</span><span class=\"err\">\u2019</span>\n       <span class=\"k\">private</span><span class=\"o\">:</span> <span class=\"n\">Req</span> <span class=\"n\">reqMsg</span><span class=\"p\">;</span>\n</pre></div>\n\n\n<p>I can copy full error message if needed.</p>", "type": "rendered"}, "created_on": "2016-06-13T17:42:57.561955+00:00", "user": {"display_name": "nampi", "uuid": "{89a67bdd-09e6-4c17-8014-48d97fa5c4c8}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B89a67bdd-09e6-4c17-8014-48d97fa5c4c8%7D"}, "html": {"href": "https://bitbucket.org/%7B89a67bdd-09e6-4c17-8014-48d97fa5c4c8%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:6509b6f8-6263-4504-9cee-d12b08b0b4e8/38230840-603b-4875-93fb-c2e81928dd69/128"}}, "nickname": "nampi", "type": "user", "account_id": "557058:6509b6f8-6263-4504-9cee-d12b08b0b4e8"}, "updated_on": "2016-06-13T17:50:26.829443+00:00", "type": "issue_comment", "id": 28472170}