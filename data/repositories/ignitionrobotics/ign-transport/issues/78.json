{"priority": "major", "kind": "bug", "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-transport.json"}, "html": {"href": "#!/ignitionrobotics/ign-transport"}, "avatar": {"href": "data/bytebucket.org/ravatar/{4249390a-7f55-404b-990d-817ba94cc7ac}ts=1533306"}}, "type": "repository", "name": "ign-transport", "full_name": "ignitionrobotics/ign-transport", "uuid": "{4249390a-7f55-404b-990d-817ba94cc7ac}"}, "links": {"attachments": {"href": "data/repositories/ignitionrobotics/ign-transport/issues/78/attachments_page=1.json"}, "self": {"href": "data/repositories/ignitionrobotics/ign-transport/issues/78.json"}, "watch": {"href": "https://api.bitbucket.org/2.0/repositories/ignitionrobotics/ign-transport/issues/78/watch"}, "comments": {"href": "data/repositories/ignitionrobotics/ign-transport/issues/78/comments_page=1.json"}, "html": {"href": "#!/ignitionrobotics/ign-transport/issues/78/segfault-in-standalone-gazebo-tool-gz"}, "vote": {"href": "https://api.bitbucket.org/2.0/repositories/ignitionrobotics/ign-transport/issues/78/vote"}}, "reporter": {"display_name": "Steve Peters", "uuid": "{2ccfed09-18b8-4921-8d58-15ef01092802}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D"}, "html": {"href": "https://bitbucket.org/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/1fb4816dad9e68337d3096f750951f6cd=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsSP-1.png"}}, "nickname": "Steven Peters", "type": "user", "account_id": "557058:5de38267-b118-494c-aa76-4fab35448816"}, "title": "Segfault in standalone gazebo tool (gz) during teardown", "component": null, "votes": 0, "watches": 1, "content": {"raw": "I've been observing some occasional seg-faults of the gz tool in my overnight gazebo testing and in jenkins results. It seems to happen most often on homebrew. I've managed to catch some backtraces that look pretty similar. The following backtrace is built from a2702b1a5604 (ign-transport4 branch).\r\n\r\n* https://gist.github.com/scpeters/8bc0037c8e14e64eb972deeb6c0b5383\r\n\r\nDuring teardown, one of the threads is destructing [~NodeShared](https://gist.github.com/scpeters/8bc0037c8e14e64eb972deeb6c0b5383#file-backtrace-txt-L15), [~NodeSharedPrivate](https://gist.github.com/scpeters/8bc0037c8e14e64eb972deeb6c0b5383#file-backtrace-txt-L10), and [Discovery<ignition::transport::ServicePublisher>::~Discovery](https://gist.github.com/scpeters/8bc0037c8e14e64eb972deeb6c0b5383#file-backtrace-txt-L7). Meanwhile in another thread, a callback [NodeShared::OnNewSrvConnection](https://gist.github.com/scpeters/8bc0037c8e14e64eb972deeb6c0b5383#file-full_backtrace-txt-L163) is running. I don't know what is causing the segfaults.\r\n\r\nLet me know if more information is required. I can add debugging print statements if needed.", "markup": "markdown", "html": "<p>I've been observing some occasional seg-faults of the gz tool in my overnight gazebo testing and in jenkins results. It seems to happen most often on homebrew. I've managed to catch some backtraces that look pretty similar. The following backtrace is built from <a href=\"#!/ignitionrobotics/ign-transport/commits/a2702b1a5604\" rel=\"nofollow\" class=\"ap-connect-link\">a2702b1a5604</a> (ign-transport4 branch).</p>\n<ul>\n<li><a href=\"https://gist.github.com/scpeters/8bc0037c8e14e64eb972deeb6c0b5383\" rel=\"nofollow\" class=\"ap-connect-link\">https://gist.github.com/scpeters/8bc0037c8e14e64eb972deeb6c0b5383</a></li>\n</ul>\n<p>During teardown, one of the threads is destructing <a data-is-external-link=\"true\" href=\"https://gist.github.com/scpeters/8bc0037c8e14e64eb972deeb6c0b5383#file-backtrace-txt-L15\" rel=\"nofollow\">~NodeShared</a>, <a data-is-external-link=\"true\" href=\"https://gist.github.com/scpeters/8bc0037c8e14e64eb972deeb6c0b5383#file-backtrace-txt-L10\" rel=\"nofollow\">~NodeSharedPrivate</a>, and <a data-is-external-link=\"true\" href=\"https://gist.github.com/scpeters/8bc0037c8e14e64eb972deeb6c0b5383#file-backtrace-txt-L7\" rel=\"nofollow\">Discovery&lt;ignition::transport::ServicePublisher&gt;::~Discovery</a>. Meanwhile in another thread, a callback <a data-is-external-link=\"true\" href=\"https://gist.github.com/scpeters/8bc0037c8e14e64eb972deeb6c0b5383#file-full_backtrace-txt-L163\" rel=\"nofollow\">NodeShared::OnNewSrvConnection</a> is running. I don't know what is causing the segfaults.</p>\n<p>Let me know if more information is required. I can add debugging print statements if needed.</p>", "type": "rendered"}, "assignee": null, "state": "closed", "version": null, "edited_on": null, "created_on": "2018-02-16T02:00:43.469422+00:00", "milestone": null, "updated_on": "2018-05-17T04:35:35.407550+00:00", "type": "issue", "id": 78}