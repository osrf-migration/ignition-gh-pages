{"rendered": {"description": {"raw": "There were two potential bugs in the way that the SIGCHLD handler was written previously. In one case, the mutex would be locked when the signal was handled, and the handler could not get a lock. In other cases, some of the operations we were doing in the handler were not strictly safe.\r\n\r\nAs a fix, I have introduced a queue that is populated by the handler and consumed via a worker thread. These use a semaphore to signal \\(which is safe\\).\r\n\r\nThis addresses #6 and likely resolves remaining issues in osrf/subt#95\r\n\r\n\u200c\r\n\r\nTest with the launch file from #6.  Without this fix, the launch process will lock and not respond correctly to ctrl-c.  With the fix, startup and shutdown should proceed normally.", "markup": "markdown", "html": "<p>There were two potential bugs in the way that the SIGCHLD handler was written previously. In one case, the mutex would be locked when the signal was handled, and the handler could not get a lock. In other cases, some of the operations we were doing in the handler were not strictly safe.</p>\n<p>As a fix, I have introduced a queue that is populated by the handler and consumed via a worker thread. These use a semaphore to signal (which is safe).</p>\n<p>This addresses <a href=\"#!/ignitionrobotics/ign-launch/issues/6/deadlock-at-startup-due-to-sigchild\" rel=\"nofollow\" title=\"Deadlock at startup due to SIGCHILD\" class=\"ap-connect-link\">#6</a> and likely resolves remaining issues in <a href=\"https://bitbucket.org/osrf/subt\" rel=\"nofollow\" class=\"ap-connect-link\">osrf/subt</a>#95</p>\n<p>\u200c</p>\n<p>Test with the launch file from <a href=\"#!/ignitionrobotics/ign-launch/issues/6/deadlock-at-startup-due-to-sigchild\" rel=\"nofollow\" title=\"Deadlock at startup due to SIGCHILD\" class=\"ap-connect-link\">#6</a>.  Without this fix, the launch process will lock and not respond correctly to ctrl-c.  With the fix, startup and shutdown should proceed normally.</p>", "type": "rendered"}, "title": {"raw": "Eliminate potential deadlock from SIGCHLD signal handler", "markup": "markdown", "html": "<p>Eliminate potential deadlock from SIGCHLD signal handler</p>", "type": "rendered"}}, "type": "pullrequest", "description": "There were two potential bugs in the way that the SIGCHLD handler was written previously. In one case, the mutex would be locked when the signal was handled, and the handler could not get a lock. In other cases, some of the operations we were doing in the handler were not strictly safe.\r\n\r\nAs a fix, I have introduced a queue that is populated by the handler and consumed via a worker thread. These use a semaphore to signal \\(which is safe\\).\r\n\r\nThis addresses #6 and likely resolves remaining issues in osrf/subt#95\r\n\r\n\u200c\r\n\r\nTest with the launch file from #6.  Without this fix, the launch process will lock and not respond correctly to ctrl-c.  With the fix, startup and shutdown should proceed normally.", "links": {"decline": {"href": "https://api.bitbucket.org/2.0/repositories/ignitionrobotics/ign-launch/pullrequests/36/decline"}, "diffstat": {"href": "https://api.bitbucket.org/2.0/repositories/ignitionrobotics/ign-launch/diffstat/ignitionrobotics/ign-launch:c8e57a9515d8%0Dc1d633e4733f?from_pullrequest_id=36"}, "commits": {"href": "data/repositories/ignitionrobotics/ign-launch/pullrequests/36/commits.json"}, "self": {"href": "data/repositories/ignitionrobotics/ign-launch/pullrequests/36.json"}, "comments": {"href": "data/repositories/ignitionrobotics/ign-launch/pullrequests/36/comments_page=1.json"}, "merge": {"href": "https://api.bitbucket.org/2.0/repositories/ignitionrobotics/ign-launch/pullrequests/36/merge"}, "html": {"href": "#!/ignitionrobotics/ign-launch/pull-requests/36"}, "activity": {"href": "data/repositories/ignitionrobotics/ign-launch/pullrequests/36/activity.json"}, "diff": {"href": "https://api.bitbucket.org/2.0/repositories/ignitionrobotics/ign-launch/diff/ignitionrobotics/ign-launch:c8e57a9515d8%0Dc1d633e4733f?from_pullrequest_id=36"}, "approve": {"href": "https://api.bitbucket.org/2.0/repositories/ignitionrobotics/ign-launch/pullrequests/36/approve"}, "statuses": {"href": "data/repositories/ignitionrobotics/ign-launch/pullrequests/36/statuses_page=1.json"}}, "title": "Eliminate potential deadlock from SIGCHLD signal handler", "close_source_branch": true, "reviewers": [{"display_name": "Addisu Z. Taddese", "uuid": "{9d7fdc68-d270-4080-bf03-4df0d0dbf635}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B9d7fdc68-d270-4080-bf03-4df0d0dbf635%7D"}, "html": {"href": "https://bitbucket.org/%7B9d7fdc68-d270-4080-bf03-4df0d0dbf635%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:90bc87b0-2886-4377-a17c-3a6629a697ff/afbf9be5-1e4c-4810-89d4-e58831f34b11/128"}}, "nickname": "azeey", "type": "user", "account_id": "557058:90bc87b0-2886-4377-a17c-3a6629a697ff"}], "id": 36, "destination": {"commit": {"hash": "c1d633e4733f", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-launch/commit/c1d633e4733f.json"}, "html": {"href": "#!/ignitionrobotics/ign-launch/commits/c1d633e4733f"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-launch.json"}, "html": {"href": "#!/ignitionrobotics/ign-launch"}, "avatar": {"href": "data/bytebucket.org/ravatar/{b6981a69-ba64-447a-9739-662a89b25082}ts=2278389"}}, "type": "repository", "name": "ign-launch", "full_name": "ignitionrobotics/ign-launch", "uuid": "{b6981a69-ba64-447a-9739-662a89b25082}"}, "branch": {"name": "ign-launch1"}}, "created_on": "2019-07-17T19:43:45.381361+00:00", "summary": {"raw": "There were two potential bugs in the way that the SIGCHLD handler was written previously. In one case, the mutex would be locked when the signal was handled, and the handler could not get a lock. In other cases, some of the operations we were doing in the handler were not strictly safe.\r\n\r\nAs a fix, I have introduced a queue that is populated by the handler and consumed via a worker thread. These use a semaphore to signal \\(which is safe\\).\r\n\r\nThis addresses #6 and likely resolves remaining issues in osrf/subt#95\r\n\r\n\u200c\r\n\r\nTest with the launch file from #6.  Without this fix, the launch process will lock and not respond correctly to ctrl-c.  With the fix, startup and shutdown should proceed normally.", "markup": "markdown", "html": "<p>There were two potential bugs in the way that the SIGCHLD handler was written previously. In one case, the mutex would be locked when the signal was handled, and the handler could not get a lock. In other cases, some of the operations we were doing in the handler were not strictly safe.</p>\n<p>As a fix, I have introduced a queue that is populated by the handler and consumed via a worker thread. These use a semaphore to signal (which is safe).</p>\n<p>This addresses <a href=\"#!/ignitionrobotics/ign-launch/issues/6/deadlock-at-startup-due-to-sigchild\" rel=\"nofollow\" title=\"Deadlock at startup due to SIGCHILD\" class=\"ap-connect-link\">#6</a> and likely resolves remaining issues in <a href=\"https://bitbucket.org/osrf/subt\" rel=\"nofollow\" class=\"ap-connect-link\">osrf/subt</a>#95</p>\n<p>\u200c</p>\n<p>Test with the launch file from <a href=\"#!/ignitionrobotics/ign-launch/issues/6/deadlock-at-startup-due-to-sigchild\" rel=\"nofollow\" title=\"Deadlock at startup due to SIGCHILD\" class=\"ap-connect-link\">#6</a>.  Without this fix, the launch process will lock and not respond correctly to ctrl-c.  With the fix, startup and shutdown should proceed normally.</p>", "type": "rendered"}, "source": {"commit": {"hash": "6a04274ac1b0", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-launch/commit/6a04274ac1b0.json"}, "html": {"href": "#!/ignitionrobotics/ign-launch/commits/6a04274ac1b0"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-launch.json"}, "html": {"href": "#!/ignitionrobotics/ign-launch"}, "avatar": {"href": "data/bytebucket.org/ravatar/{b6981a69-ba64-447a-9739-662a89b25082}ts=2278389"}}, "type": "repository", "name": "ign-launch", "full_name": "ignitionrobotics/ign-launch", "uuid": "{b6981a69-ba64-447a-9739-662a89b25082}"}, "branch": {"name": "sigchld_deadlock_fix"}}, "comment_count": 9, "state": "MERGED", "task_count": 0, "participants": [{"role": "PARTICIPANT", "participated_on": "2019-07-17T21:08:05.023195+00:00", "type": "participant", "approved": false, "user": {"display_name": "Michael Carroll", "uuid": "{17dbbc15-cbc0-42f0-a985-cde9061c78a0}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B17dbbc15-cbc0-42f0-a985-cde9061c78a0%7D"}, "html": {"href": "https://bitbucket.org/%7B17dbbc15-cbc0-42f0-a985-cde9061c78a0%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:65740f22-cc56-4418-9608-7e17d0ed47b7/2aa259f5-4de1-4f68-9156-eded72041d84/128"}}, "nickname": "Michael Carroll", "type": "user", "account_id": "557058:65740f22-cc56-4418-9608-7e17d0ed47b7"}}, {"role": "PARTICIPANT", "participated_on": "2019-07-19T17:33:01.579282+00:00", "type": "participant", "approved": false, "user": {"display_name": "Ian Chen", "uuid": "{eaa6fca5-6deb-43f6-907f-971c144735dd}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Beaa6fca5-6deb-43f6-907f-971c144735dd%7D"}, "html": {"href": "https://bitbucket.org/%7Beaa6fca5-6deb-43f6-907f-971c144735dd%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:10b01d41-a2e9-4a41-a907-e6e2f03b6cd5/1e4adcdf-1946-4280-9aea-eb5f15a7f912/128"}}, "nickname": "Ian Chen", "type": "user", "account_id": "557058:10b01d41-a2e9-4a41-a907-e6e2f03b6cd5"}}, {"role": "REVIEWER", "participated_on": "2019-07-19T16:52:58.799846+00:00", "type": "participant", "approved": false, "user": {"display_name": "Addisu Z. Taddese", "uuid": "{9d7fdc68-d270-4080-bf03-4df0d0dbf635}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B9d7fdc68-d270-4080-bf03-4df0d0dbf635%7D"}, "html": {"href": "https://bitbucket.org/%7B9d7fdc68-d270-4080-bf03-4df0d0dbf635%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:90bc87b0-2886-4377-a17c-3a6629a697ff/afbf9be5-1e4c-4810-89d4-e58831f34b11/128"}}, "nickname": "azeey", "type": "user", "account_id": "557058:90bc87b0-2886-4377-a17c-3a6629a697ff"}}, {"role": "PARTICIPANT", "participated_on": "2019-07-20T17:02:16.497159+00:00", "type": "participant", "approved": true, "user": {"display_name": "Nate Koenig", "uuid": "{c862cdd9-fcc8-4419-9fc7-e20db14b8fcb}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Bc862cdd9-fcc8-4419-9fc7-e20db14b8fcb%7D"}, "html": {"href": "https://bitbucket.org/%7Bc862cdd9-fcc8-4419-9fc7-e20db14b8fcb%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:095b1e12-74ed-4e20-b44f-2f0745b616e0/ca24bb11-4787-4b14-a20d-d91835e9bde2/128"}}, "nickname": "Nathan Koenig", "type": "user", "account_id": "557058:095b1e12-74ed-4e20-b44f-2f0745b616e0"}}], "reason": "", "updated_on": "2019-07-20T17:02:21.149743+00:00", "author": {"display_name": "Michael Carroll", "uuid": "{17dbbc15-cbc0-42f0-a985-cde9061c78a0}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B17dbbc15-cbc0-42f0-a985-cde9061c78a0%7D"}, "html": {"href": "https://bitbucket.org/%7B17dbbc15-cbc0-42f0-a985-cde9061c78a0%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:65740f22-cc56-4418-9608-7e17d0ed47b7/2aa259f5-4de1-4f68-9156-eded72041d84/128"}}, "nickname": "Michael Carroll", "type": "user", "account_id": "557058:65740f22-cc56-4418-9608-7e17d0ed47b7"}, "merge_commit": {"hash": "c8e57a9515d8", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-launch/commit/c8e57a9515d8.json"}, "html": {"href": "#!/ignitionrobotics/ign-launch/commits/c8e57a9515d8"}}}, "closed_by": {"display_name": "Nate Koenig", "uuid": "{c862cdd9-fcc8-4419-9fc7-e20db14b8fcb}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Bc862cdd9-fcc8-4419-9fc7-e20db14b8fcb%7D"}, "html": {"href": "https://bitbucket.org/%7Bc862cdd9-fcc8-4419-9fc7-e20db14b8fcb%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:095b1e12-74ed-4e20-b44f-2f0745b616e0/ca24bb11-4787-4b14-a20d-d91835e9bde2/128"}}, "nickname": "Nathan Koenig", "type": "user", "account_id": "557058:095b1e12-74ed-4e20-b44f-2f0745b616e0"}}