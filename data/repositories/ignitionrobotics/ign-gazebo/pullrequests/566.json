{"rendered": {"description": {"raw": "When moving a static model that has a canonical link at a pose offset, the model appears to \u2018jump\u2019 by the offset amount after it\u2019s moved.\r\n\r\n![](data/bitbucket.org/repo/8zodKzn/images/276981913-transform_pose_offset.gif)\r\n\u200c\r\n\r\nTurns out that the visual pose becomes inconsistent with the physics pose. The problem was that the state published back to to the scene by the system is the canonical link pose instead of the model entity pose.\r\n\r\nHere\u2019s the sdf of the box I used for testing:\r\n\r\n```\r\n    <model name=\"box\">\r\n      <static>true</static>\r\n      <pose>0 0 0.0 0 0 0</pose>\r\n      <link name=\"box_link\">\r\n        <pose>0 0 0.5 0 0 0</pose>\r\n        <collision name=\"box_collision\">\r\n          <geometry>\r\n            <box>\r\n              <size>1 1 1</size>\r\n            </box>\r\n          </geometry>\r\n        </collision>\r\n        <visual name=\"box_visual\">\r\n          <geometry>\r\n            <box>\r\n              <size>1 1 1</size>\r\n            </box>\r\n          </geometry>\r\n          <material>\r\n            <ambient>1 0 0 1.0</ambient>\r\n            <diffuse>1 0 0 1.0</diffuse>\r\n            <specular>1 0 0 1.0</specular>\r\n          </material>\r\n        </visual>\r\n      </link>\r\n    </model>\r\n```\r\n\r\n\u200c", "markup": "markdown", "html": "<p>When moving a static model that has a canonical link at a pose offset, the model appears to \u2018jump\u2019 by the offset amount after it\u2019s moved.</p>\n<p><img alt=\"\" src=\"data/bitbucket.org/repo/8zodKzn/images/276981913-transform_pose_offset.gif\" />\n\u200c</p>\n<p>Turns out that the visual pose becomes inconsistent with the physics pose. The problem was that the state published back to to the scene by the system is the canonical link pose instead of the model entity pose.</p>\n<p>Here\u2019s the sdf of the box I used for testing:</p>\n<div class=\"codehilite\"><pre><span></span>    <span class=\"nt\">&lt;model</span> <span class=\"na\">name=</span><span class=\"s\">&quot;box&quot;</span><span class=\"nt\">&gt;</span>\n      <span class=\"nt\">&lt;static&gt;</span>true<span class=\"nt\">&lt;/static&gt;</span>\n      <span class=\"nt\">&lt;pose&gt;</span>0 0 0.0 0 0 0<span class=\"nt\">&lt;/pose&gt;</span>\n      <span class=\"nt\">&lt;link</span> <span class=\"na\">name=</span><span class=\"s\">&quot;box_link&quot;</span><span class=\"nt\">&gt;</span>\n        <span class=\"nt\">&lt;pose&gt;</span>0 0 0.5 0 0 0<span class=\"nt\">&lt;/pose&gt;</span>\n        <span class=\"nt\">&lt;collision</span> <span class=\"na\">name=</span><span class=\"s\">&quot;box_collision&quot;</span><span class=\"nt\">&gt;</span>\n          <span class=\"nt\">&lt;geometry&gt;</span>\n            <span class=\"nt\">&lt;box&gt;</span>\n              <span class=\"nt\">&lt;size&gt;</span>1 1 1<span class=\"nt\">&lt;/size&gt;</span>\n            <span class=\"nt\">&lt;/box&gt;</span>\n          <span class=\"nt\">&lt;/geometry&gt;</span>\n        <span class=\"nt\">&lt;/collision&gt;</span>\n        <span class=\"nt\">&lt;visual</span> <span class=\"na\">name=</span><span class=\"s\">&quot;box_visual&quot;</span><span class=\"nt\">&gt;</span>\n          <span class=\"nt\">&lt;geometry&gt;</span>\n            <span class=\"nt\">&lt;box&gt;</span>\n              <span class=\"nt\">&lt;size&gt;</span>1 1 1<span class=\"nt\">&lt;/size&gt;</span>\n            <span class=\"nt\">&lt;/box&gt;</span>\n          <span class=\"nt\">&lt;/geometry&gt;</span>\n          <span class=\"nt\">&lt;material&gt;</span>\n            <span class=\"nt\">&lt;ambient&gt;</span>1 0 0 1.0<span class=\"nt\">&lt;/ambient&gt;</span>\n            <span class=\"nt\">&lt;diffuse&gt;</span>1 0 0 1.0<span class=\"nt\">&lt;/diffuse&gt;</span>\n            <span class=\"nt\">&lt;specular&gt;</span>1 0 0 1.0<span class=\"nt\">&lt;/specular&gt;</span>\n          <span class=\"nt\">&lt;/material&gt;</span>\n        <span class=\"nt\">&lt;/visual&gt;</span>\n      <span class=\"nt\">&lt;/link&gt;</span>\n    <span class=\"nt\">&lt;/model&gt;</span>\n</pre></div>\n\n\n<p>\u200c</p>", "type": "rendered"}, "title": {"raw": "Fix moving static model with link offset", "markup": "markdown", "html": "<p>Fix moving static model with link offset</p>", "type": "rendered"}}, "type": "pullrequest", "description": "When moving a static model that has a canonical link at a pose offset, the model appears to \u2018jump\u2019 by the offset amount after it\u2019s moved.\r\n\r\n![](data/bitbucket.org/repo/8zodKzn/images/276981913-transform_pose_offset.gif)\r\n\u200c\r\n\r\nTurns out that the visual pose becomes inconsistent with the physics pose. The problem was that the state published back to to the scene by the system is the canonical link pose instead of the model entity pose.\r\n\r\nHere\u2019s the sdf of the box I used for testing:\r\n\r\n```\r\n    <model name=\"box\">\r\n      <static>true</static>\r\n      <pose>0 0 0.0 0 0 0</pose>\r\n      <link name=\"box_link\">\r\n        <pose>0 0 0.5 0 0 0</pose>\r\n        <collision name=\"box_collision\">\r\n          <geometry>\r\n            <box>\r\n              <size>1 1 1</size>\r\n            </box>\r\n          </geometry>\r\n        </collision>\r\n        <visual name=\"box_visual\">\r\n          <geometry>\r\n            <box>\r\n              <size>1 1 1</size>\r\n            </box>\r\n          </geometry>\r\n          <material>\r\n            <ambient>1 0 0 1.0</ambient>\r\n            <diffuse>1 0 0 1.0</diffuse>\r\n            <specular>1 0 0 1.0</specular>\r\n          </material>\r\n        </visual>\r\n      </link>\r\n    </model>\r\n```\r\n\r\n\u200c", "links": {"decline": {"href": "https://api.bitbucket.org/2.0/repositories/ignitionrobotics/ign-gazebo/pullrequests/566/decline"}, "diffstat": {"href": "https://api.bitbucket.org/2.0/repositories/ignitionrobotics/ign-gazebo/diffstat/ignitionrobotics/ign-gazebo:80ec42737b5a%0Df0e9d7d13508?from_pullrequest_id=566"}, "commits": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/566/commits.json"}, "self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/566.json"}, "comments": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/566/comments_page=1.json"}, "merge": {"href": "https://api.bitbucket.org/2.0/repositories/ignitionrobotics/ign-gazebo/pullrequests/566/merge"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/566"}, "activity": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/566/activity.json"}, "diff": {"href": "https://api.bitbucket.org/2.0/repositories/ignitionrobotics/ign-gazebo/diff/ignitionrobotics/ign-gazebo:80ec42737b5a%0Df0e9d7d13508?from_pullrequest_id=566"}, "approve": {"href": "https://api.bitbucket.org/2.0/repositories/ignitionrobotics/ign-gazebo/pullrequests/566/approve"}, "statuses": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/566/statuses_page=1.json"}}, "title": "Fix moving static model with link offset", "close_source_branch": true, "reviewers": [{"display_name": "Steve Peters", "uuid": "{2ccfed09-18b8-4921-8d58-15ef01092802}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D"}, "html": {"href": "https://bitbucket.org/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/1fb4816dad9e68337d3096f750951f6cd=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsSP-1.png"}}, "nickname": "Steven Peters", "type": "user", "account_id": "557058:5de38267-b118-494c-aa76-4fab35448816"}, {"display_name": "Addisu Z. Taddese", "uuid": "{9d7fdc68-d270-4080-bf03-4df0d0dbf635}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B9d7fdc68-d270-4080-bf03-4df0d0dbf635%7D"}, "html": {"href": "https://bitbucket.org/%7B9d7fdc68-d270-4080-bf03-4df0d0dbf635%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:90bc87b0-2886-4377-a17c-3a6629a697ff/afbf9be5-1e4c-4810-89d4-e58831f34b11/128"}}, "nickname": "azeey", "type": "user", "account_id": "557058:90bc87b0-2886-4377-a17c-3a6629a697ff"}], "id": 566, "destination": {"commit": {"hash": "f0e9d7d13508", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/commit/f0e9d7d13508.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/commits/f0e9d7d13508"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{f98d11fe-f287-4dfb-99c3-e2b76a13232e}ts=2082645"}}, "type": "repository", "name": "ign-gazebo", "full_name": "ignitionrobotics/ign-gazebo", "uuid": "{f98d11fe-f287-4dfb-99c3-e2b76a13232e}"}, "branch": {"name": "ign-gazebo2"}}, "created_on": "2020-03-20T20:54:08.413541+00:00", "summary": {"raw": "When moving a static model that has a canonical link at a pose offset, the model appears to \u2018jump\u2019 by the offset amount after it\u2019s moved.\r\n\r\n![](data/bitbucket.org/repo/8zodKzn/images/276981913-transform_pose_offset.gif)\r\n\u200c\r\n\r\nTurns out that the visual pose becomes inconsistent with the physics pose. The problem was that the state published back to to the scene by the system is the canonical link pose instead of the model entity pose.\r\n\r\nHere\u2019s the sdf of the box I used for testing:\r\n\r\n```\r\n    <model name=\"box\">\r\n      <static>true</static>\r\n      <pose>0 0 0.0 0 0 0</pose>\r\n      <link name=\"box_link\">\r\n        <pose>0 0 0.5 0 0 0</pose>\r\n        <collision name=\"box_collision\">\r\n          <geometry>\r\n            <box>\r\n              <size>1 1 1</size>\r\n            </box>\r\n          </geometry>\r\n        </collision>\r\n        <visual name=\"box_visual\">\r\n          <geometry>\r\n            <box>\r\n              <size>1 1 1</size>\r\n            </box>\r\n          </geometry>\r\n          <material>\r\n            <ambient>1 0 0 1.0</ambient>\r\n            <diffuse>1 0 0 1.0</diffuse>\r\n            <specular>1 0 0 1.0</specular>\r\n          </material>\r\n        </visual>\r\n      </link>\r\n    </model>\r\n```\r\n\r\n\u200c", "markup": "markdown", "html": "<p>When moving a static model that has a canonical link at a pose offset, the model appears to \u2018jump\u2019 by the offset amount after it\u2019s moved.</p>\n<p><img alt=\"\" src=\"data/bitbucket.org/repo/8zodKzn/images/276981913-transform_pose_offset.gif\" />\n\u200c</p>\n<p>Turns out that the visual pose becomes inconsistent with the physics pose. The problem was that the state published back to to the scene by the system is the canonical link pose instead of the model entity pose.</p>\n<p>Here\u2019s the sdf of the box I used for testing:</p>\n<div class=\"codehilite\"><pre><span></span>    <span class=\"nt\">&lt;model</span> <span class=\"na\">name=</span><span class=\"s\">&quot;box&quot;</span><span class=\"nt\">&gt;</span>\n      <span class=\"nt\">&lt;static&gt;</span>true<span class=\"nt\">&lt;/static&gt;</span>\n      <span class=\"nt\">&lt;pose&gt;</span>0 0 0.0 0 0 0<span class=\"nt\">&lt;/pose&gt;</span>\n      <span class=\"nt\">&lt;link</span> <span class=\"na\">name=</span><span class=\"s\">&quot;box_link&quot;</span><span class=\"nt\">&gt;</span>\n        <span class=\"nt\">&lt;pose&gt;</span>0 0 0.5 0 0 0<span class=\"nt\">&lt;/pose&gt;</span>\n        <span class=\"nt\">&lt;collision</span> <span class=\"na\">name=</span><span class=\"s\">&quot;box_collision&quot;</span><span class=\"nt\">&gt;</span>\n          <span class=\"nt\">&lt;geometry&gt;</span>\n            <span class=\"nt\">&lt;box&gt;</span>\n              <span class=\"nt\">&lt;size&gt;</span>1 1 1<span class=\"nt\">&lt;/size&gt;</span>\n            <span class=\"nt\">&lt;/box&gt;</span>\n          <span class=\"nt\">&lt;/geometry&gt;</span>\n        <span class=\"nt\">&lt;/collision&gt;</span>\n        <span class=\"nt\">&lt;visual</span> <span class=\"na\">name=</span><span class=\"s\">&quot;box_visual&quot;</span><span class=\"nt\">&gt;</span>\n          <span class=\"nt\">&lt;geometry&gt;</span>\n            <span class=\"nt\">&lt;box&gt;</span>\n              <span class=\"nt\">&lt;size&gt;</span>1 1 1<span class=\"nt\">&lt;/size&gt;</span>\n            <span class=\"nt\">&lt;/box&gt;</span>\n          <span class=\"nt\">&lt;/geometry&gt;</span>\n          <span class=\"nt\">&lt;material&gt;</span>\n            <span class=\"nt\">&lt;ambient&gt;</span>1 0 0 1.0<span class=\"nt\">&lt;/ambient&gt;</span>\n            <span class=\"nt\">&lt;diffuse&gt;</span>1 0 0 1.0<span class=\"nt\">&lt;/diffuse&gt;</span>\n            <span class=\"nt\">&lt;specular&gt;</span>1 0 0 1.0<span class=\"nt\">&lt;/specular&gt;</span>\n          <span class=\"nt\">&lt;/material&gt;</span>\n        <span class=\"nt\">&lt;/visual&gt;</span>\n      <span class=\"nt\">&lt;/link&gt;</span>\n    <span class=\"nt\">&lt;/model&gt;</span>\n</pre></div>\n\n\n<p>\u200c</p>", "type": "rendered"}, "source": {"commit": {"hash": "0bc2336d0862", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/commit/0bc2336d0862.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/commits/0bc2336d0862"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{f98d11fe-f287-4dfb-99c3-e2b76a13232e}ts=2082645"}}, "type": "repository", "name": "ign-gazebo", "full_name": "ignitionrobotics/ign-gazebo", "uuid": "{f98d11fe-f287-4dfb-99c3-e2b76a13232e}"}, "branch": {"name": "static_posecmd"}}, "comment_count": 2, "state": "MERGED", "task_count": 0, "participants": [{"role": "REVIEWER", "participated_on": "2020-03-20T22:10:31.247478+00:00", "type": "participant", "approved": true, "user": {"display_name": "Steve Peters", "uuid": "{2ccfed09-18b8-4921-8d58-15ef01092802}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D"}, "html": {"href": "https://bitbucket.org/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/1fb4816dad9e68337d3096f750951f6cd=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsSP-1.png"}}, "nickname": "Steven Peters", "type": "user", "account_id": "557058:5de38267-b118-494c-aa76-4fab35448816"}}, {"role": "PARTICIPANT", "participated_on": "2020-03-21T00:39:42.122449+00:00", "type": "participant", "approved": true, "user": {"display_name": "Louise Poubel", "uuid": "{5cfa2075-477b-4ded-bdb9-8d2479544ec4}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D"}, "html": {"href": "https://bitbucket.org/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8/7d903d90-c5ea-4182-b7ef-0d467e9e1c74/128"}}, "nickname": "chapulina", "type": "user", "account_id": "557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8"}}, {"role": "REVIEWER", "participated_on": "2020-03-21T18:32:09.834639+00:00", "type": "participant", "approved": true, "user": {"display_name": "Addisu Z. Taddese", "uuid": "{9d7fdc68-d270-4080-bf03-4df0d0dbf635}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B9d7fdc68-d270-4080-bf03-4df0d0dbf635%7D"}, "html": {"href": "https://bitbucket.org/%7B9d7fdc68-d270-4080-bf03-4df0d0dbf635%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:90bc87b0-2886-4377-a17c-3a6629a697ff/afbf9be5-1e4c-4810-89d4-e58831f34b11/128"}}, "nickname": "azeey", "type": "user", "account_id": "557058:90bc87b0-2886-4377-a17c-3a6629a697ff"}}], "reason": "", "updated_on": "2020-03-21T18:32:09.834639+00:00", "author": {"display_name": "Ian Chen", "uuid": "{eaa6fca5-6deb-43f6-907f-971c144735dd}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Beaa6fca5-6deb-43f6-907f-971c144735dd%7D"}, "html": {"href": "https://bitbucket.org/%7Beaa6fca5-6deb-43f6-907f-971c144735dd%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:10b01d41-a2e9-4a41-a907-e6e2f03b6cd5/1e4adcdf-1946-4280-9aea-eb5f15a7f912/128"}}, "nickname": "Ian Chen", "type": "user", "account_id": "557058:10b01d41-a2e9-4a41-a907-e6e2f03b6cd5"}, "merge_commit": {"hash": "80ec42737b5a", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/commit/80ec42737b5a.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/commits/80ec42737b5a"}}}, "closed_by": {"display_name": "Louise Poubel", "uuid": "{5cfa2075-477b-4ded-bdb9-8d2479544ec4}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D"}, "html": {"href": "https://bitbucket.org/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8/7d903d90-c5ea-4182-b7ef-0d467e9e1c74/128"}}, "nickname": "chapulina", "type": "user", "account_id": "557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8"}}