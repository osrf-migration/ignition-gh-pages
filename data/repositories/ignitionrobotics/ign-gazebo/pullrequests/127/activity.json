{"pagelen": 50, "values": [{"comment": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/127/comments/88606956.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/127/_/diff#comment-88606956"}}, "parent": {"id": 88172465, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/127/comments/88172465.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/127/_/diff#comment-88172465"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 127, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/127.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/127"}}, "title": "[Proposal] Store entity graph in ECM"}, "content": {"raw": "Pull request #130 implements the alternative we talked about, where both the component and the graph are kept in sync by a dedicated class.", "markup": "markdown", "html": "<p><a href=\"#!/ignitionrobotics/ign-gazebo/pull-requests/130/a-6-entity-graph-factory\" rel=\"nofollow\" class=\"ap-connect-link\">Pull request #130</a> implements the alternative we talked about, where both the component and the graph are kept in sync by a dedicated class.</p>", "type": "rendered"}, "created_on": "2019-01-18T19:41:05.841828+00:00", "user": {"display_name": "Louise Poubel", "uuid": "{5cfa2075-477b-4ded-bdb9-8d2479544ec4}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D"}, "html": {"href": "https://bitbucket.org/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8/7d903d90-c5ea-4182-b7ef-0d467e9e1c74/128"}}, "nickname": "chapulina", "type": "user", "account_id": "557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8"}, "updated_on": "2019-01-18T19:41:05.851603+00:00", "type": "pullrequest_comment", "id": 88606956}, "pull_request": {"type": "pullrequest", "id": 127, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/127.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/127"}}, "title": "[Proposal] Store entity graph in ECM"}}, {"update": {"description": "After having some experience with the new architecture, it felt like it would be more convenient to store the entity hierarchy as a graph in the manager, than to use the `ParentEntity` component.\r\n\r\nSee [these comments](#!/ignitionrobotics/ign-gazebo/pull-requests/111/wip-levels/activity#comment-87433928) for more context.\r\n\r\n---\r\n\r\n## Summary\r\n\r\n* Changes `EntityComponentManager::entities` from a vector to a graph.\r\n* Adds a few convenience functions to the manager, like `ParentEntity`, `ChildByComponents` and `Entities`.\r\n* Changes `CreateEntity` so the parent needs to be passed.\r\n* Changes `RequestEraseEntity` so it erases all descendants recursively.\r\n* Unlike the component, which could be rewritten, now it's impossible to reparent an entity until we explicitly implement this.\r\n\r\n---\r\n\r\n## Migration\r\n\r\n### Querying for the parent\r\n\r\nBefore:\r\n\r\n`auto parentEntity = ecm.Component<components::ParentEntity>(entity);`\r\n\r\nNow:\r\n\r\n`auto parentEntity = ecm.ParentEntity(entity)`\r\n\r\n### Setting a parent\r\n\r\nBefore:\r\n\r\n~~~\r\n    auto entity = this->CreateEntities(light);\r\n\r\n    this->entityCompMgr.CreateComponent(entity,\r\n        components::ParentEntity(parentEntity));\r\n~~~\r\n\r\nNow:\r\n\r\n~~~\r\n    auto entity = this->entityCompMgr.CreateEntity(parentEntity);\r\n    this->CreateEntities(light, entity);\r\n~~~\r\n\r\n---\r\n\r\n@azeey , I'm testing integrating this into pull request #111 on branch `entity_graph_levels`.", "title": "[Proposal] Store entity graph in ECM", "destination": {"commit": {"hash": "2449115ae0f7", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/commit/2449115ae0f7.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/commits/2449115ae0f7"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{f98d11fe-f287-4dfb-99c3-e2b76a13232e}ts=2082645"}}, "type": "repository", "name": "ign-gazebo", "full_name": "ignitionrobotics/ign-gazebo", "uuid": "{f98d11fe-f287-4dfb-99c3-e2b76a13232e}"}, "branch": {"name": "default"}}, "reason": "", "source": {"commit": {"hash": "01ac6e8a4ade", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/commit/01ac6e8a4ade.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/commits/01ac6e8a4ade"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{f98d11fe-f287-4dfb-99c3-e2b76a13232e}ts=2082645"}}, "type": "repository", "name": "ign-gazebo", "full_name": "ignitionrobotics/ign-gazebo", "uuid": "{f98d11fe-f287-4dfb-99c3-e2b76a13232e}"}, "branch": {"name": "entity_graph"}}, "state": "DECLINED", "author": {"display_name": "Louise Poubel", "uuid": "{5cfa2075-477b-4ded-bdb9-8d2479544ec4}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D"}, "html": {"href": "https://bitbucket.org/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8/7d903d90-c5ea-4182-b7ef-0d467e9e1c74/128"}}, "nickname": "chapulina", "type": "user", "account_id": "557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8"}, "date": "2019-01-16T00:30:16.648978+00:00"}, "pull_request": {"type": "pullrequest", "id": 127, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/127.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/127"}}, "title": "[Proposal] Store entity graph in ECM"}}, {"comment": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/127/comments/88172465.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/127/_/diff#comment-88172465"}}, "parent": {"id": 88033631, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/127/comments/88033631.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/127/_/diff#comment-88033631"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 127, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/127.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/127"}}, "title": "[Proposal] Store entity graph in ECM"}, "content": {"raw": "~~Ok, so for now I'll add the `ParentEntity` back, but keep the ECM so it can conveniently do things like deleting an entity tree recursively, which will be used by the `LevelManager` for example.~~\n\nScratch that, not a good idea because we would either need to give the ECM knowledge of a specific component, or force entity creators to define the parent twice (once for the ECM and once with the component). Declining this PR altogether.", "markup": "markdown", "html": "<p><del>Ok, so for now I'll add the <code>ParentEntity</code> back, but keep the ECM so it can conveniently do things like deleting an entity tree recursively, which will be used by the <code>LevelManager</code> for example.</del></p>\n<p>Scratch that, not a good idea because we would either need to give the ECM knowledge of a specific component, or force entity creators to define the parent twice (once for the ECM and once with the component). Declining this PR altogether.</p>", "type": "rendered"}, "created_on": "2019-01-15T22:57:51.184807+00:00", "user": {"display_name": "Louise Poubel", "uuid": "{5cfa2075-477b-4ded-bdb9-8d2479544ec4}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D"}, "html": {"href": "https://bitbucket.org/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8/7d903d90-c5ea-4182-b7ef-0d467e9e1c74/128"}}, "nickname": "chapulina", "type": "user", "account_id": "557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8"}, "updated_on": "2019-01-16T00:30:05.154337+00:00", "type": "pullrequest_comment", "id": 88172465}, "pull_request": {"type": "pullrequest", "id": 127, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/127.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/127"}}, "title": "[Proposal] Store entity graph in ECM"}}, {"update": {"description": "After having some experience with the new architecture, it felt like it would be more convenient to store the entity hierarchy as a graph in the manager, than to use the `ParentEntity` component.\r\n\r\nSee [these comments](#!/ignitionrobotics/ign-gazebo/pull-requests/111/wip-levels/activity#comment-87433928) for more context.\r\n\r\n---\r\n\r\n## Summary\r\n\r\n* Changes `EntityComponentManager::entities` from a vector to a graph.\r\n* Adds a few convenience functions to the manager, like `ParentEntity`, `ChildByComponents` and `Entities`.\r\n* Changes `CreateEntity` so the parent needs to be passed.\r\n* Changes `RequestEraseEntity` so it erases all descendants recursively.\r\n* Unlike the component, which could be rewritten, now it's impossible to reparent an entity until we explicitly implement this.\r\n\r\n---\r\n\r\n## Migration\r\n\r\n### Querying for the parent\r\n\r\nBefore:\r\n\r\n`auto parentEntity = ecm.Component<components::ParentEntity>(entity);`\r\n\r\nNow:\r\n\r\n`auto parentEntity = ecm.ParentEntity(entity)`\r\n\r\n### Setting a parent\r\n\r\nBefore:\r\n\r\n~~~\r\n    auto entity = this->CreateEntities(light);\r\n\r\n    this->entityCompMgr.CreateComponent(entity,\r\n        components::ParentEntity(parentEntity));\r\n~~~\r\n\r\nNow:\r\n\r\n~~~\r\n    auto entity = this->entityCompMgr.CreateEntity(parentEntity);\r\n    this->CreateEntities(light, entity);\r\n~~~\r\n\r\n---\r\n\r\n@azeey , I'm testing integrating this into pull request #111 on branch `entity_graph_levels`.", "title": "[Proposal] Store entity graph in ECM", "destination": {"commit": {"hash": "2449115ae0f7", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/commit/2449115ae0f7.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/commits/2449115ae0f7"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{f98d11fe-f287-4dfb-99c3-e2b76a13232e}ts=2082645"}}, "type": "repository", "name": "ign-gazebo", "full_name": "ignitionrobotics/ign-gazebo", "uuid": "{f98d11fe-f287-4dfb-99c3-e2b76a13232e}"}, "branch": {"name": "default"}}, "reason": "", "source": {"commit": {"hash": "01ac6e8a4ade", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/commit/01ac6e8a4ade.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/commits/01ac6e8a4ade"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{f98d11fe-f287-4dfb-99c3-e2b76a13232e}ts=2082645"}}, "type": "repository", "name": "ign-gazebo", "full_name": "ignitionrobotics/ign-gazebo", "uuid": "{f98d11fe-f287-4dfb-99c3-e2b76a13232e}"}, "branch": {"name": "entity_graph"}}, "state": "OPEN", "author": {"display_name": "Louise Poubel", "uuid": "{5cfa2075-477b-4ded-bdb9-8d2479544ec4}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D"}, "html": {"href": "https://bitbucket.org/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8/7d903d90-c5ea-4182-b7ef-0d467e9e1c74/128"}}, "nickname": "chapulina", "type": "user", "account_id": "557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8"}, "date": "2019-01-16T00:25:34.196277+00:00"}, "pull_request": {"type": "pullrequest", "id": 127, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/127.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/127"}}, "title": "[Proposal] Store entity graph in ECM"}}, {"comment": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/127/comments/88033631.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/127/_/diff#comment-88033631"}}, "parent": {"id": 88031117, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/127/comments/88031117.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/127/_/diff#comment-88031117"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 127, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/127.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/127"}}, "title": "[Proposal] Store entity graph in ECM"}, "content": {"raw": "Oh that's a completely valid point, I forgot about that", "markup": "markdown", "html": "<p>Oh that's a completely valid point, I forgot about that</p>", "type": "rendered"}, "created_on": "2019-01-15T03:29:41.943151+00:00", "user": {"display_name": "Louise Poubel", "uuid": "{5cfa2075-477b-4ded-bdb9-8d2479544ec4}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D"}, "html": {"href": "https://bitbucket.org/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8/7d903d90-c5ea-4182-b7ef-0d467e9e1c74/128"}}, "nickname": "chapulina", "type": "user", "account_id": "557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8"}, "updated_on": "2019-01-15T03:29:41.952127+00:00", "type": "pullrequest_comment", "id": 88033631}, "pull_request": {"type": "pullrequest", "id": 127, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/127.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/127"}}, "title": "[Proposal] Store entity graph in ECM"}}, {"comment": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/127/comments/88031117.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/127/_/diff#comment-88031117"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 127, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/127.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/127"}}, "title": "[Proposal] Store entity graph in ECM"}, "content": {"raw": "My only concern with this is that the structural state of the overall system is no longer captured by just entities and their components. So for things like logging, we will have to store the graph structure.", "markup": "markdown", "html": "<p>My only concern with this is that the structural state of the overall system is no longer captured by just entities and their components. So for things like logging, we will have to store the graph structure.</p>", "type": "rendered"}, "created_on": "2019-01-15T02:27:28.562012+00:00", "user": {"display_name": "Addisu Z. Taddese", "uuid": "{9d7fdc68-d270-4080-bf03-4df0d0dbf635}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B9d7fdc68-d270-4080-bf03-4df0d0dbf635%7D"}, "html": {"href": "https://bitbucket.org/%7B9d7fdc68-d270-4080-bf03-4df0d0dbf635%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:90bc87b0-2886-4377-a17c-3a6629a697ff/afbf9be5-1e4c-4810-89d4-e58831f34b11/128"}}, "nickname": "azeey", "type": "user", "account_id": "557058:90bc87b0-2886-4377-a17c-3a6629a697ff"}, "updated_on": "2019-01-15T02:27:28.570364+00:00", "type": "pullrequest_comment", "id": 88031117}, "pull_request": {"type": "pullrequest", "id": 127, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/127.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/127"}}, "title": "[Proposal] Store entity graph in ECM"}}, {"comment": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/127/comments/88025360.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/127/_/diff#comment-88025360"}}, "parent": {"id": 88006561, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/127/comments/88006561.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/127/_/diff#comment-88006561"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 127, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/127.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/127"}}, "title": "[Proposal] Store entity graph in ECM"}, "content": {"raw": "Done in 8de0e4c", "markup": "markdown", "html": "<p>Done in <a href=\"#!/ignitionrobotics/ign-gazebo/commits/8de0e4c\" rel=\"nofollow\" class=\"ap-connect-link\">8de0e4c</a></p>", "type": "rendered"}, "created_on": "2019-01-15T00:22:37.872943+00:00", "user": {"display_name": "Louise Poubel", "uuid": "{5cfa2075-477b-4ded-bdb9-8d2479544ec4}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D"}, "html": {"href": "https://bitbucket.org/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8/7d903d90-c5ea-4182-b7ef-0d467e9e1c74/128"}}, "nickname": "chapulina", "type": "user", "account_id": "557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8"}, "inline": {}, "updated_on": "2019-01-15T00:22:37.883681+00:00", "type": "pullrequest_comment", "id": 88025360}, "pull_request": {"type": "pullrequest", "id": 127, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/127.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/127"}}, "title": "[Proposal] Store entity graph in ECM"}}, {"comment": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/127/comments/88025357.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/127/_/diff#comment-88025357"}}, "parent": {"id": 88006698, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/127/comments/88006698.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/127/_/diff#comment-88006698"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 127, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/127.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/127"}}, "title": "[Proposal] Store entity graph in ECM"}, "content": {"raw": "Thank you for spotting my copy/paste errors :) 8de0e4c", "markup": "markdown", "html": "<p>Thank you for spotting my copy/paste errors :) <a href=\"#!/ignitionrobotics/ign-gazebo/commits/8de0e4c\" rel=\"nofollow\" class=\"ap-connect-link\">8de0e4c</a></p>", "type": "rendered"}, "created_on": "2019-01-15T00:22:33.142086+00:00", "user": {"display_name": "Louise Poubel", "uuid": "{5cfa2075-477b-4ded-bdb9-8d2479544ec4}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D"}, "html": {"href": "https://bitbucket.org/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8/7d903d90-c5ea-4182-b7ef-0d467e9e1c74/128"}}, "nickname": "chapulina", "type": "user", "account_id": "557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8"}, "inline": {}, "updated_on": "2019-01-15T00:22:33.151320+00:00", "type": "pullrequest_comment", "id": 88025357}, "pull_request": {"type": "pullrequest", "id": 127, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/127.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/127"}}, "title": "[Proposal] Store entity graph in ECM"}}, {"update": {"description": "After having some experience with the new architecture, it felt like it would be more convenient to store the entity hierarchy as a graph in the manager, than to use the `ParentEntity` component.\r\n\r\nSee [these comments](#!/ignitionrobotics/ign-gazebo/pull-requests/111/wip-levels/activity#comment-87433928) for more context.\r\n\r\n---\r\n\r\n## Summary\r\n\r\n* Changes `EntityComponentManager::entities` from a vector to a graph.\r\n* Adds a few convenience functions to the manager, like `ParentEntity`, `ChildByComponents` and `Entities`.\r\n* Changes `CreateEntity` so the parent needs to be passed.\r\n* Changes `RequestEraseEntity` so it erases all descendants recursively.\r\n* Unlike the component, which could be rewritten, now it's impossible to reparent an entity until we explicitly implement this.\r\n\r\n---\r\n\r\n## Migration\r\n\r\n### Querying for the parent\r\n\r\nBefore:\r\n\r\n`auto parentEntity = ecm.Component<components::ParentEntity>(entity);`\r\n\r\nNow:\r\n\r\n`auto parentEntity = ecm.ParentEntity(entity)`\r\n\r\n### Setting a parent\r\n\r\nBefore:\r\n\r\n~~~\r\n    auto entity = this->CreateEntities(light);\r\n\r\n    this->entityCompMgr.CreateComponent(entity,\r\n        components::ParentEntity(parentEntity));\r\n~~~\r\n\r\nNow:\r\n\r\n~~~\r\n    auto entity = this->entityCompMgr.CreateEntity(parentEntity);\r\n    this->CreateEntities(light, entity);\r\n~~~\r\n\r\n---\r\n\r\n@azeey , I'm testing integrating this into pull request #111 on branch `entity_graph_levels`.", "title": "[Proposal] Store entity graph in ECM", "destination": {"commit": {"hash": "4d6043ba42ce", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/commit/4d6043ba42ce.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/commits/4d6043ba42ce"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{f98d11fe-f287-4dfb-99c3-e2b76a13232e}ts=2082645"}}, "type": "repository", "name": "ign-gazebo", "full_name": "ignitionrobotics/ign-gazebo", "uuid": "{f98d11fe-f287-4dfb-99c3-e2b76a13232e}"}, "branch": {"name": "default"}}, "reason": "", "source": {"commit": {"hash": "8de0e4ce72d3", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/commit/8de0e4ce72d3.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/commits/8de0e4ce72d3"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{f98d11fe-f287-4dfb-99c3-e2b76a13232e}ts=2082645"}}, "type": "repository", "name": "ign-gazebo", "full_name": "ignitionrobotics/ign-gazebo", "uuid": "{f98d11fe-f287-4dfb-99c3-e2b76a13232e}"}, "branch": {"name": "entity_graph"}}, "state": "OPEN", "author": {"display_name": "Louise Poubel", "uuid": "{5cfa2075-477b-4ded-bdb9-8d2479544ec4}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D"}, "html": {"href": "https://bitbucket.org/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8/7d903d90-c5ea-4182-b7ef-0d467e9e1c74/128"}}, "nickname": "chapulina", "type": "user", "account_id": "557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8"}, "date": "2019-01-15T00:22:08.231002+00:00"}, "pull_request": {"type": "pullrequest", "id": 127, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/127.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/127"}}, "title": "[Proposal] Store entity graph in ECM"}}, {"comment": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/127/comments/88006698.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/127/_/diff#comment-88006698"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 127, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/127.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/127"}}, "title": "[Proposal] Store entity graph in ECM"}, "content": {"raw": "update doxygen\n\n`_worldEntity` also becomes `_modelEntity`. Same goes for the other `CreateEntities` functions", "markup": "markdown", "html": "<p>update doxygen</p>\n<p><code>_worldEntity</code> also becomes <code>_modelEntity</code>. Same goes for the other <code>CreateEntities</code> functions</p>", "type": "rendered"}, "created_on": "2019-01-14T20:26:58.425200+00:00", "user": {"display_name": "Ian Chen", "uuid": "{eaa6fca5-6deb-43f6-907f-971c144735dd}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Beaa6fca5-6deb-43f6-907f-971c144735dd%7D"}, "html": {"href": "https://bitbucket.org/%7Beaa6fca5-6deb-43f6-907f-971c144735dd%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:10b01d41-a2e9-4a41-a907-e6e2f03b6cd5/1e4adcdf-1946-4280-9aea-eb5f15a7f912/128"}}, "nickname": "Ian Chen", "type": "user", "account_id": "557058:10b01d41-a2e9-4a41-a907-e6e2f03b6cd5"}, "inline": {}, "updated_on": "2019-01-14T20:26:58.434515+00:00", "type": "pullrequest_comment", "id": 88006698}, "pull_request": {"type": "pullrequest", "id": 127, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/127.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/127"}}, "title": "[Proposal] Store entity graph in ECM"}}, {"comment": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/127/comments/88006561.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/127/_/diff#comment-88006561"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 127, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/127.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/127"}}, "title": "[Proposal] Store entity graph in ECM"}, "content": {"raw": "`\\return` -> `param[in]` ?", "markup": "markdown", "html": "<p><code>\\return</code> -&gt; <code>param[in]</code> ?</p>", "type": "rendered"}, "created_on": "2019-01-14T20:25:43.846584+00:00", "user": {"display_name": "Ian Chen", "uuid": "{eaa6fca5-6deb-43f6-907f-971c144735dd}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Beaa6fca5-6deb-43f6-907f-971c144735dd%7D"}, "html": {"href": "https://bitbucket.org/%7Beaa6fca5-6deb-43f6-907f-971c144735dd%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:10b01d41-a2e9-4a41-a907-e6e2f03b6cd5/1e4adcdf-1946-4280-9aea-eb5f15a7f912/128"}}, "nickname": "Ian Chen", "type": "user", "account_id": "557058:10b01d41-a2e9-4a41-a907-e6e2f03b6cd5"}, "inline": {}, "updated_on": "2019-01-14T20:25:43.853721+00:00", "type": "pullrequest_comment", "id": 88006561}, "pull_request": {"type": "pullrequest", "id": 127, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/127.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/127"}}, "title": "[Proposal] Store entity graph in ECM"}}, {"update": {"description": "After having some experience with the new architecture, it felt like it would be more convenient to store the entity hierarchy as a graph in the manager, than to use the `ParentEntity` component.\r\n\r\nSee [these comments](#!/ignitionrobotics/ign-gazebo/pull-requests/111/wip-levels/activity#comment-87433928) for more context.\r\n\r\n---\r\n\r\n## Summary\r\n\r\n* Changes `EntityComponentManager::entities` from a vector to a graph.\r\n* Adds a few convenience functions to the manager, like `ParentEntity`, `ChildByComponents` and `Entities`.\r\n* Changes `CreateEntity` so the parent needs to be passed.\r\n* Changes `RequestEraseEntity` so it erases all descendants recursively.\r\n* Unlike the component, which could be rewritten, now it's impossible to reparent an entity until we explicitly implement this.\r\n\r\n---\r\n\r\n## Migration\r\n\r\n### Querying for the parent\r\n\r\nBefore:\r\n\r\n`auto parentEntity = ecm.Component<components::ParentEntity>(entity);`\r\n\r\nNow:\r\n\r\n`auto parentEntity = ecm.ParentEntity(entity)`\r\n\r\n### Setting a parent\r\n\r\nBefore:\r\n\r\n~~~\r\n    auto entity = this->CreateEntities(light);\r\n\r\n    this->entityCompMgr.CreateComponent(entity,\r\n        components::ParentEntity(parentEntity));\r\n~~~\r\n\r\nNow:\r\n\r\n~~~\r\n    auto entity = this->entityCompMgr.CreateEntity(parentEntity);\r\n    this->CreateEntities(light, entity);\r\n~~~\r\n\r\n---\r\n\r\n@azeey , I'm testing integrating this into pull request #111 on branch `entity_graph_levels`.", "title": "[Proposal] Store entity graph in ECM", "destination": {"commit": {"hash": "4d6043ba42ce", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/commit/4d6043ba42ce.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/commits/4d6043ba42ce"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{f98d11fe-f287-4dfb-99c3-e2b76a13232e}ts=2082645"}}, "type": "repository", "name": "ign-gazebo", "full_name": "ignitionrobotics/ign-gazebo", "uuid": "{f98d11fe-f287-4dfb-99c3-e2b76a13232e}"}, "branch": {"name": "default"}}, "reason": "", "source": {"commit": {"hash": "76e09f1e2001", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/commit/76e09f1e2001.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/commits/76e09f1e2001"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{f98d11fe-f287-4dfb-99c3-e2b76a13232e}ts=2082645"}}, "type": "repository", "name": "ign-gazebo", "full_name": "ignitionrobotics/ign-gazebo", "uuid": "{f98d11fe-f287-4dfb-99c3-e2b76a13232e}"}, "branch": {"name": "entity_graph"}}, "state": "OPEN", "author": {"display_name": "Louise Poubel", "uuid": "{5cfa2075-477b-4ded-bdb9-8d2479544ec4}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D"}, "html": {"href": "https://bitbucket.org/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8/7d903d90-c5ea-4182-b7ef-0d467e9e1c74/128"}}, "nickname": "chapulina", "type": "user", "account_id": "557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8"}, "date": "2019-01-12T03:53:35.804867+00:00"}, "pull_request": {"type": "pullrequest", "id": 127, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/127.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/127"}}, "title": "[Proposal] Store entity graph in ECM"}}, {"update": {"description": "After having some experience with the new architecture, it felt like it would be more convenient to store the entity hierarchy as a graph in the manager, than to use the `ParentEntity` component.\r\n\r\nSee [these comments](#!/ignitionrobotics/ign-gazebo/pull-requests/111/wip-levels/activity#comment-87433928) for more context.\r\n\r\n---\r\n\r\n## Summary\r\n\r\n* Changes `EntityComponentManager::entities` from a vector to a graph.\r\n* Adds a few convenience functions to the manager, like `ParentEntity`, `ChildByComponents` and `Entities`.\r\n* Changes `CreateEntity` so the parent needs to be passed.\r\n* Changes `RequestEraseEntity` so it erases all descendants recursively.\r\n* Unlike the component, which could be rewritten, now it's impossible to reparent an entity until we explicitly implement this.\r\n\r\n---\r\n\r\n## Migration\r\n\r\n### Querying for the parent\r\n\r\nBefore:\r\n\r\n`auto parentEntity = ecm.Component<components::ParentEntity>(entity);`\r\n\r\nNow:\r\n\r\n`auto parentEntity = ecm.ParentEntity(entity)`\r\n\r\n### Setting a parent\r\n\r\nBefore:\r\n\r\n~~~\r\n    auto entity = this->CreateEntities(light);\r\n\r\n    this->entityCompMgr.CreateComponent(entity,\r\n        components::ParentEntity(parentEntity));\r\n~~~\r\n\r\nNow:\r\n\r\n~~~\r\n    auto entity = this->entityCompMgr.CreateEntity(parentEntity);\r\n    this->CreateEntities(light, entity);\r\n~~~\r\n\r\n---\r\n\r\n@azeey , I'm testing integrating this into pull request #111 on branch `entity_graph_levels`.", "title": "[Proposal] Store entity graph in ECM", "destination": {"commit": {"hash": "4d6043ba42ce", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/commit/4d6043ba42ce.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/commits/4d6043ba42ce"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{f98d11fe-f287-4dfb-99c3-e2b76a13232e}ts=2082645"}}, "type": "repository", "name": "ign-gazebo", "full_name": "ignitionrobotics/ign-gazebo", "uuid": "{f98d11fe-f287-4dfb-99c3-e2b76a13232e}"}, "branch": {"name": "default"}}, "reason": "", "source": {"commit": {"hash": "76e09f1e2001", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/commit/76e09f1e2001.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/commits/76e09f1e2001"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{f98d11fe-f287-4dfb-99c3-e2b76a13232e}ts=2082645"}}, "type": "repository", "name": "ign-gazebo", "full_name": "ignitionrobotics/ign-gazebo", "uuid": "{f98d11fe-f287-4dfb-99c3-e2b76a13232e}"}, "branch": {"name": "entity_graph"}}, "state": "OPEN", "author": {"display_name": "Louise Poubel", "uuid": "{5cfa2075-477b-4ded-bdb9-8d2479544ec4}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D"}, "html": {"href": "https://bitbucket.org/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8/7d903d90-c5ea-4182-b7ef-0d467e9e1c74/128"}}, "nickname": "chapulina", "type": "user", "account_id": "557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8"}, "date": "2019-01-12T03:53:35.775418+00:00"}, "pull_request": {"type": "pullrequest", "id": 127, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/127.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/127"}}, "title": "[Proposal] Store entity graph in ECM"}}]}