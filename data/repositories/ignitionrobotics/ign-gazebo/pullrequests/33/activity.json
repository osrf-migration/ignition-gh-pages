{"pagelen": 50, "values": [{"comment": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/33/comments/75229049.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/33/_/diff#comment-75229049"}}, "parent": {"id": 75225059, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/33/comments/75225059.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/33/_/diff#comment-75225059"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 33, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/33.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/33"}}, "title": "Refactor stats and support play / pause / step"}, "content": {"raw": "pull request #37", "markup": "markdown", "html": "<p><a href=\"#!/ignitionrobotics/ign-gazebo/pull-requests/37/reuse-time-info-object\" rel=\"nofollow\" class=\"ap-connect-link\">pull request #37</a></p>", "type": "rendered"}, "created_on": "2018-09-06T17:01:38.468570+00:00", "user": {"display_name": "Louise Poubel", "uuid": "{5cfa2075-477b-4ded-bdb9-8d2479544ec4}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D"}, "html": {"href": "https://bitbucket.org/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8/7d903d90-c5ea-4182-b7ef-0d467e9e1c74/128"}}, "nickname": "chapulina", "type": "user", "account_id": "557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8"}, "inline": {}, "updated_on": "2018-09-06T17:01:38.474799+00:00", "type": "pullrequest_comment", "id": 75229049}, "pull_request": {"type": "pullrequest", "id": 33, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/33.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/33"}}, "title": "Refactor stats and support play / pause / step"}}, {"comment": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/33/comments/75225059.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/33/_/diff#comment-75225059"}}, "parent": {"id": 75217452, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/33/comments/75217452.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/33/_/diff#comment-75217452"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 33, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/33.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/33"}}, "title": "Refactor stats and support play / pause / step"}, "content": {"raw": "Oh sorry I was going to address this. I'll make a new PR shortly.", "markup": "markdown", "html": "<p>Oh sorry I was going to address this. I'll make a new PR shortly.</p>", "type": "rendered"}, "created_on": "2018-09-06T16:27:17.868442+00:00", "user": {"display_name": "Louise Poubel", "uuid": "{5cfa2075-477b-4ded-bdb9-8d2479544ec4}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D"}, "html": {"href": "https://bitbucket.org/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8/7d903d90-c5ea-4182-b7ef-0d467e9e1c74/128"}}, "nickname": "chapulina", "type": "user", "account_id": "557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8"}, "inline": {}, "updated_on": "2018-09-06T16:27:17.876526+00:00", "type": "pullrequest_comment", "id": 75225059}, "pull_request": {"type": "pullrequest", "id": 33, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/33.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/33"}}, "title": "Refactor stats and support play / pause / step"}}, {"update": {"description": "Move time handling to `SimulationRunner`, which means:\r\n\r\n* Remove `WorldStatistics` component and system\r\n* `World` component now is just an identifier like `components::Model` or `components::Link`\r\n* Systems receive `UpdateInfo` at the update callback, which contains info about time and iterations.\r\n* World statistics are published by `SimulationRunner`\r\n* World controls service is provided by `SimulationRunner`\r\n\r\n---\r\n\r\n# Concepts\r\n\r\nSome important ideas, which are open to discussion, are:\r\n\r\n* ECS systems are updated even while paused. This is important for interacting with the GUI.\r\n* While paused, sim iterations and sim time don't increase.\r\n* While paused, the step size (`dt`) passed to each system is zero. Right now, it is up to the system to check that and behave accordingly.\r\n* The step size is 10ms by default (placeholder) and can be overridden from the SDF (`<max_step_size>`).\r\n* The ECS period is calculated based on the step size and the desired RTF, see calculation comments on `SimulationRunner.cc`; it can be overridden from the command line with `-z`\r\n\r\nThe image below summarizes some of these ideas:\r\n\r\n![ECSRTF.png](https://bitbucket.org/repo/8zodKzn/images/1055788081-ECSRTF.png)\r\n\r\n---\r\n\r\n# Demo\r\n\r\n`ign-gazebo -f test/worlds/shapes.sdf  -v 4 -z 3`\r\n\r\n![playpause_pot.gif](https://bitbucket.org/repo/8zodKzn/images/4020974896-playpause_pot.gif)\r\n\r\n---\r\n\r\n---\r\n\r\n# Future work\r\n\r\n* Even if I try to run faster than real time, with `-z 10000` for example, the maximum RTF I get is less than 160%. It would be good to port `gazebo_experimental`'s [DiagnosticsManager](https://bitbucket.org/osrf/gazebo_experimental/src/d828f7845f99ecb5da097f1c89b32da809bd9fd9/include/gazebo/util/DiagnosticsManager.hh?fileviewer=file-view-default) here to see what's going on\r\n* Add command line option to start paused\r\n* `--iterations` should set sim iterations, not ECS (usually only relevant if you start paused)", "title": "Refactor stats and support play / pause / step", "destination": {"commit": {"hash": "704323aad6f3", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/commit/704323aad6f3.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/commits/704323aad6f3"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{f98d11fe-f287-4dfb-99c3-e2b76a13232e}ts=2082645"}}, "type": "repository", "name": "ign-gazebo", "full_name": "ignitionrobotics/ign-gazebo", "uuid": "{f98d11fe-f287-4dfb-99c3-e2b76a13232e}"}, "branch": {"name": "default"}}, "reason": "", "source": {"commit": {"hash": "fd218cfbc2a4", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/commit/fd218cfbc2a4.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/commits/fd218cfbc2a4"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{f98d11fe-f287-4dfb-99c3-e2b76a13232e}ts=2082645"}}, "type": "repository", "name": "ign-gazebo", "full_name": "ignitionrobotics/ign-gazebo", "uuid": "{f98d11fe-f287-4dfb-99c3-e2b76a13232e}"}, "branch": {"name": "runner_stats"}}, "state": "MERGED", "author": {"display_name": "Nate Koenig", "uuid": "{c862cdd9-fcc8-4419-9fc7-e20db14b8fcb}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Bc862cdd9-fcc8-4419-9fc7-e20db14b8fcb%7D"}, "html": {"href": "https://bitbucket.org/%7Bc862cdd9-fcc8-4419-9fc7-e20db14b8fcb%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:095b1e12-74ed-4e20-b44f-2f0745b616e0/ca24bb11-4787-4b14-a20d-d91835e9bde2/128"}}, "nickname": "Nathan Koenig", "type": "user", "account_id": "557058:095b1e12-74ed-4e20-b44f-2f0745b616e0"}, "date": "2018-09-06T15:29:38.167359+00:00"}, "pull_request": {"type": "pullrequest", "id": 33, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/33.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/33"}}, "title": "Refactor stats and support play / pause / step"}}, {"approval": {"date": "2018-09-06T15:29:34.428975+00:00", "pullrequest": {"type": "pullrequest", "id": 33, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/33.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/33"}}, "title": "Refactor stats and support play / pause / step"}, "user": {"display_name": "Nate Koenig", "uuid": "{c862cdd9-fcc8-4419-9fc7-e20db14b8fcb}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Bc862cdd9-fcc8-4419-9fc7-e20db14b8fcb%7D"}, "html": {"href": "https://bitbucket.org/%7Bc862cdd9-fcc8-4419-9fc7-e20db14b8fcb%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:095b1e12-74ed-4e20-b44f-2f0745b616e0/ca24bb11-4787-4b14-a20d-d91835e9bde2/128"}}, "nickname": "Nathan Koenig", "type": "user", "account_id": "557058:095b1e12-74ed-4e20-b44f-2f0745b616e0"}}, "pull_request": {"type": "pullrequest", "id": 33, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/33.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/33"}}, "title": "Refactor stats and support play / pause / step"}}, {"comment": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/33/comments/75217452.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/33/_/diff#comment-75217452"}}, "parent": {"id": 75097897, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/33/comments/75097897.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/33/_/diff#comment-75097897"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 33, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/33.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/33"}}, "title": "Refactor stats and support play / pause / step"}, "content": {"raw": "Added todo: [fd218cf](#!/ignitionrobotics/ign-gazebo/commits/fd218cfbc2a41a71eb78970489465001cf72d3a3?at=default)\u00a0", "markup": "markdown", "html": "<p>Added todo: <a data-is-external-link=\"true\" href=\"#!/ignitionrobotics/ign-gazebo/commits/fd218cfbc2a41a71eb78970489465001cf72d3a3?at=default\" rel=\"nofollow\">fd218cf</a>\u00a0</p>", "type": "rendered"}, "created_on": "2018-09-06T15:29:32.700343+00:00", "user": {"display_name": "Nate Koenig", "uuid": "{c862cdd9-fcc8-4419-9fc7-e20db14b8fcb}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Bc862cdd9-fcc8-4419-9fc7-e20db14b8fcb%7D"}, "html": {"href": "https://bitbucket.org/%7Bc862cdd9-fcc8-4419-9fc7-e20db14b8fcb%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:095b1e12-74ed-4e20-b44f-2f0745b616e0/ca24bb11-4787-4b14-a20d-d91835e9bde2/128"}}, "nickname": "Nathan Koenig", "type": "user", "account_id": "557058:095b1e12-74ed-4e20-b44f-2f0745b616e0"}, "inline": {}, "updated_on": "2018-09-06T15:29:32.708479+00:00", "type": "pullrequest_comment", "id": 75217452}, "pull_request": {"type": "pullrequest", "id": 33, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/33.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/33"}}, "title": "Refactor stats and support play / pause / step"}}, {"update": {"description": "Move time handling to `SimulationRunner`, which means:\r\n\r\n* Remove `WorldStatistics` component and system\r\n* `World` component now is just an identifier like `components::Model` or `components::Link`\r\n* Systems receive `UpdateInfo` at the update callback, which contains info about time and iterations.\r\n* World statistics are published by `SimulationRunner`\r\n* World controls service is provided by `SimulationRunner`\r\n\r\n---\r\n\r\n# Concepts\r\n\r\nSome important ideas, which are open to discussion, are:\r\n\r\n* ECS systems are updated even while paused. This is important for interacting with the GUI.\r\n* While paused, sim iterations and sim time don't increase.\r\n* While paused, the step size (`dt`) passed to each system is zero. Right now, it is up to the system to check that and behave accordingly.\r\n* The step size is 10ms by default (placeholder) and can be overridden from the SDF (`<max_step_size>`).\r\n* The ECS period is calculated based on the step size and the desired RTF, see calculation comments on `SimulationRunner.cc`; it can be overridden from the command line with `-z`\r\n\r\nThe image below summarizes some of these ideas:\r\n\r\n![ECSRTF.png](https://bitbucket.org/repo/8zodKzn/images/1055788081-ECSRTF.png)\r\n\r\n---\r\n\r\n# Demo\r\n\r\n`ign-gazebo -f test/worlds/shapes.sdf  -v 4 -z 3`\r\n\r\n![playpause_pot.gif](https://bitbucket.org/repo/8zodKzn/images/4020974896-playpause_pot.gif)\r\n\r\n---\r\n\r\n---\r\n\r\n# Future work\r\n\r\n* Even if I try to run faster than real time, with `-z 10000` for example, the maximum RTF I get is less than 160%. It would be good to port `gazebo_experimental`'s [DiagnosticsManager](https://bitbucket.org/osrf/gazebo_experimental/src/d828f7845f99ecb5da097f1c89b32da809bd9fd9/include/gazebo/util/DiagnosticsManager.hh?fileviewer=file-view-default) here to see what's going on\r\n* Add command line option to start paused\r\n* `--iterations` should set sim iterations, not ECS (usually only relevant if you start paused)", "title": "Refactor stats and support play / pause / step", "destination": {"commit": {"hash": "704323aad6f3", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/commit/704323aad6f3.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/commits/704323aad6f3"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{f98d11fe-f287-4dfb-99c3-e2b76a13232e}ts=2082645"}}, "type": "repository", "name": "ign-gazebo", "full_name": "ignitionrobotics/ign-gazebo", "uuid": "{f98d11fe-f287-4dfb-99c3-e2b76a13232e}"}, "branch": {"name": "default"}}, "reason": "", "source": {"commit": {"hash": "fd218cfbc2a4", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/commit/fd218cfbc2a4.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/commits/fd218cfbc2a4"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{f98d11fe-f287-4dfb-99c3-e2b76a13232e}ts=2082645"}}, "type": "repository", "name": "ign-gazebo", "full_name": "ignitionrobotics/ign-gazebo", "uuid": "{f98d11fe-f287-4dfb-99c3-e2b76a13232e}"}, "branch": {"name": "runner_stats"}}, "state": "OPEN", "author": {"display_name": "Nate Koenig", "uuid": "{c862cdd9-fcc8-4419-9fc7-e20db14b8fcb}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Bc862cdd9-fcc8-4419-9fc7-e20db14b8fcb%7D"}, "html": {"href": "https://bitbucket.org/%7Bc862cdd9-fcc8-4419-9fc7-e20db14b8fcb%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:095b1e12-74ed-4e20-b44f-2f0745b616e0/ca24bb11-4787-4b14-a20d-d91835e9bde2/128"}}, "nickname": "Nathan Koenig", "type": "user", "account_id": "557058:095b1e12-74ed-4e20-b44f-2f0745b616e0"}, "date": "2018-09-06T15:29:18.735860+00:00"}, "pull_request": {"type": "pullrequest", "id": 33, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/33.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/33"}}, "title": "Refactor stats and support play / pause / step"}}, {"comment": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/33/comments/75097897.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/33/_/diff#comment-75097897"}}, "parent": {"id": 74969495, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/33/comments/74969495.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/33/_/diff#comment-74969495"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 33, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/33.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/33"}}, "title": "Refactor stats and support play / pause / step"}, "content": {"raw": "If this is a lot of work, then maybe you can create an issue/todo item for this instead.", "markup": "markdown", "html": "<p>If this is a lot of work, then maybe you can create an issue/todo item for this instead.</p>", "type": "rendered"}, "created_on": "2018-09-05T18:52:12.618748+00:00", "user": {"display_name": "Nate Koenig", "uuid": "{c862cdd9-fcc8-4419-9fc7-e20db14b8fcb}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Bc862cdd9-fcc8-4419-9fc7-e20db14b8fcb%7D"}, "html": {"href": "https://bitbucket.org/%7Bc862cdd9-fcc8-4419-9fc7-e20db14b8fcb%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:095b1e12-74ed-4e20-b44f-2f0745b616e0/ca24bb11-4787-4b14-a20d-d91835e9bde2/128"}}, "nickname": "Nathan Koenig", "type": "user", "account_id": "557058:095b1e12-74ed-4e20-b44f-2f0745b616e0"}, "inline": {}, "updated_on": "2018-09-05T18:52:12.630215+00:00", "type": "pullrequest_comment", "id": 75097897}, "pull_request": {"type": "pullrequest", "id": 33, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/33.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/33"}}, "title": "Refactor stats and support play / pause / step"}}, {"comment": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/33/comments/75088409.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/33/_/diff#comment-75088409"}}, "parent": {"id": 74969059, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/33/comments/74969059.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/33/_/diff#comment-74969059"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 33, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/33.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/33"}}, "title": "Refactor stats and support play / pause / step"}, "content": {"raw": "Suppressed, but I think we should consider not passing headers through cppcheck, see [this](https://stackoverflow.com/a/37112132)", "markup": "markdown", "html": "<p>Suppressed, but I think we should consider not passing headers through cppcheck, see <a data-is-external-link=\"true\" href=\"https://stackoverflow.com/a/37112132\" rel=\"nofollow\">this</a></p>", "type": "rendered"}, "created_on": "2018-09-05T17:15:31.310277+00:00", "user": {"display_name": "Louise Poubel", "uuid": "{5cfa2075-477b-4ded-bdb9-8d2479544ec4}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D"}, "html": {"href": "https://bitbucket.org/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8/7d903d90-c5ea-4182-b7ef-0d467e9e1c74/128"}}, "nickname": "chapulina", "type": "user", "account_id": "557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8"}, "updated_on": "2018-09-05T17:15:31.316701+00:00", "type": "pullrequest_comment", "id": 75088409}, "pull_request": {"type": "pullrequest", "id": 33, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/33.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/33"}}, "title": "Refactor stats and support play / pause / step"}}, {"update": {"description": "Move time handling to `SimulationRunner`, which means:\r\n\r\n* Remove `WorldStatistics` component and system\r\n* `World` component now is just an identifier like `components::Model` or `components::Link`\r\n* Systems receive `UpdateInfo` at the update callback, which contains info about time and iterations.\r\n* World statistics are published by `SimulationRunner`\r\n* World controls service is provided by `SimulationRunner`\r\n\r\n---\r\n\r\n# Concepts\r\n\r\nSome important ideas, which are open to discussion, are:\r\n\r\n* ECS systems are updated even while paused. This is important for interacting with the GUI.\r\n* While paused, sim iterations and sim time don't increase.\r\n* While paused, the step size (`dt`) passed to each system is zero. Right now, it is up to the system to check that and behave accordingly.\r\n* The step size is 10ms by default (placeholder) and can be overridden from the SDF (`<max_step_size>`).\r\n* The ECS period is calculated based on the step size and the desired RTF, see calculation comments on `SimulationRunner.cc`; it can be overridden from the command line with `-z`\r\n\r\nThe image below summarizes some of these ideas:\r\n\r\n![ECSRTF.png](https://bitbucket.org/repo/8zodKzn/images/1055788081-ECSRTF.png)\r\n\r\n---\r\n\r\n# Demo\r\n\r\n`ign-gazebo -f test/worlds/shapes.sdf  -v 4 -z 3`\r\n\r\n![playpause_pot.gif](https://bitbucket.org/repo/8zodKzn/images/4020974896-playpause_pot.gif)\r\n\r\n---\r\n\r\n---\r\n\r\n# Future work\r\n\r\n* Even if I try to run faster than real time, with `-z 10000` for example, the maximum RTF I get is less than 160%. It would be good to port `gazebo_experimental`'s [DiagnosticsManager](https://bitbucket.org/osrf/gazebo_experimental/src/d828f7845f99ecb5da097f1c89b32da809bd9fd9/include/gazebo/util/DiagnosticsManager.hh?fileviewer=file-view-default) here to see what's going on\r\n* Add command line option to start paused\r\n* `--iterations` should set sim iterations, not ECS (usually only relevant if you start paused)", "title": "Refactor stats and support play / pause / step", "destination": {"commit": {"hash": "704323aad6f3", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/commit/704323aad6f3.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/commits/704323aad6f3"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{f98d11fe-f287-4dfb-99c3-e2b76a13232e}ts=2082645"}}, "type": "repository", "name": "ign-gazebo", "full_name": "ignitionrobotics/ign-gazebo", "uuid": "{f98d11fe-f287-4dfb-99c3-e2b76a13232e}"}, "branch": {"name": "default"}}, "reason": "", "source": {"commit": {"hash": "24fe828fdf54", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/commit/24fe828fdf54.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/commits/24fe828fdf54"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{f98d11fe-f287-4dfb-99c3-e2b76a13232e}ts=2082645"}}, "type": "repository", "name": "ign-gazebo", "full_name": "ignitionrobotics/ign-gazebo", "uuid": "{f98d11fe-f287-4dfb-99c3-e2b76a13232e}"}, "branch": {"name": "runner_stats"}}, "state": "OPEN", "author": {"display_name": "Louise Poubel", "uuid": "{5cfa2075-477b-4ded-bdb9-8d2479544ec4}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D"}, "html": {"href": "https://bitbucket.org/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8/7d903d90-c5ea-4182-b7ef-0d467e9e1c74/128"}}, "nickname": "chapulina", "type": "user", "account_id": "557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8"}, "date": "2018-09-05T17:14:38.798046+00:00"}, "pull_request": {"type": "pullrequest", "id": 33, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/33.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/33"}}, "title": "Refactor stats and support play / pause / step"}}, {"update": {"description": "Move time handling to `SimulationRunner`, which means:\r\n\r\n* Remove `WorldStatistics` component and system\r\n* `World` component now is just an identifier like `components::Model` or `components::Link`\r\n* Systems receive `UpdateInfo` at the update callback, which contains info about time and iterations.\r\n* World statistics are published by `SimulationRunner`\r\n* World controls service is provided by `SimulationRunner`\r\n\r\n---\r\n\r\n# Concepts\r\n\r\nSome important ideas, which are open to discussion, are:\r\n\r\n* ECS systems are updated even while paused. This is important for interacting with the GUI.\r\n* While paused, sim iterations and sim time don't increase.\r\n* While paused, the step size (`dt`) passed to each system is zero. Right now, it is up to the system to check that and behave accordingly.\r\n* The step size is 10ms by default (placeholder) and can be overridden from the SDF (`<max_step_size>`).\r\n* The ECS period is calculated based on the step size and the desired RTF, see calculation comments on `SimulationRunner.cc`; it can be overridden from the command line with `-z`\r\n\r\nThe image below summarizes some of these ideas:\r\n\r\n![ECSRTF.png](https://bitbucket.org/repo/8zodKzn/images/1055788081-ECSRTF.png)\r\n\r\n---\r\n\r\n# Demo\r\n\r\n`ign-gazebo -f test/worlds/shapes.sdf  -v 4 -z 3`\r\n\r\n![playpause_pot.gif](https://bitbucket.org/repo/8zodKzn/images/4020974896-playpause_pot.gif)\r\n\r\n---\r\n\r\n---\r\n\r\n# Future work\r\n\r\n* Even if I try to run faster than real time, with `-z 10000` for example, the maximum RTF I get is less than 160%. It would be good to port `gazebo_experimental`'s [DiagnosticsManager](https://bitbucket.org/osrf/gazebo_experimental/src/d828f7845f99ecb5da097f1c89b32da809bd9fd9/include/gazebo/util/DiagnosticsManager.hh?fileviewer=file-view-default) here to see what's going on\r\n* Add command line option to start paused\r\n* `--iterations` should set sim iterations, not ECS (usually only relevant if you start paused)", "title": "Refactor stats and support play / pause / step", "destination": {"commit": {"hash": "be8630419a48", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/commit/be8630419a48.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/commits/be8630419a48"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{f98d11fe-f287-4dfb-99c3-e2b76a13232e}ts=2082645"}}, "type": "repository", "name": "ign-gazebo", "full_name": "ignitionrobotics/ign-gazebo", "uuid": "{f98d11fe-f287-4dfb-99c3-e2b76a13232e}"}, "branch": {"name": "default"}}, "reason": "", "source": {"commit": {"hash": "39935d2a53aa", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/commit/39935d2a53aa.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/commits/39935d2a53aa"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{f98d11fe-f287-4dfb-99c3-e2b76a13232e}ts=2082645"}}, "type": "repository", "name": "ign-gazebo", "full_name": "ignitionrobotics/ign-gazebo", "uuid": "{f98d11fe-f287-4dfb-99c3-e2b76a13232e}"}, "branch": {"name": "runner_stats"}}, "state": "OPEN", "author": {"display_name": "Nate Koenig", "uuid": "{c862cdd9-fcc8-4419-9fc7-e20db14b8fcb}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Bc862cdd9-fcc8-4419-9fc7-e20db14b8fcb%7D"}, "html": {"href": "https://bitbucket.org/%7Bc862cdd9-fcc8-4419-9fc7-e20db14b8fcb%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:095b1e12-74ed-4e20-b44f-2f0745b616e0/ca24bb11-4787-4b14-a20d-d91835e9bde2/128"}}, "nickname": "Nathan Koenig", "type": "user", "account_id": "557058:095b1e12-74ed-4e20-b44f-2f0745b616e0"}, "date": "2018-09-04T22:29:32.175452+00:00"}, "pull_request": {"type": "pullrequest", "id": 33, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/33.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/33"}}, "title": "Refactor stats and support play / pause / step"}}, {"comment": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/33/comments/74969495.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/33/_/diff#comment-74969495"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 33, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/33.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/33"}}, "title": "Refactor stats and support play / pause / step"}, "content": {"raw": "Is it possible to use and update a class member variable that is an instance of UpdateInfo, instead of creating a new object each iteration?", "markup": "markdown", "html": "<p>Is it possible to use and update a class member variable that is an instance of UpdateInfo, instead of creating a new object each iteration?</p>", "type": "rendered"}, "created_on": "2018-09-04T22:27:58.112080+00:00", "user": {"display_name": "Nate Koenig", "uuid": "{c862cdd9-fcc8-4419-9fc7-e20db14b8fcb}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Bc862cdd9-fcc8-4419-9fc7-e20db14b8fcb%7D"}, "html": {"href": "https://bitbucket.org/%7Bc862cdd9-fcc8-4419-9fc7-e20db14b8fcb%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:095b1e12-74ed-4e20-b44f-2f0745b616e0/ca24bb11-4787-4b14-a20d-d91835e9bde2/128"}}, "nickname": "Nathan Koenig", "type": "user", "account_id": "557058:095b1e12-74ed-4e20-b44f-2f0745b616e0"}, "inline": {}, "updated_on": "2018-09-04T22:27:58.119004+00:00", "type": "pullrequest_comment", "id": 74969495}, "pull_request": {"type": "pullrequest", "id": 33, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/33.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/33"}}, "title": "Refactor stats and support play / pause / step"}}, {"comment": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/33/comments/74969059.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/33/_/diff#comment-74969059"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 33, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/33.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/33"}}, "title": "Refactor stats and support play / pause / step"}, "content": {"raw": "Codecheck error:\n\n\\[/data/ignition/ign-gazebo/include/ignition/gazebo/Types.hh:52\\]: \\(style\\) struct member 'UpdateInfo::iterations' is never used.", "markup": "markdown", "html": "<p>Codecheck error:</p>\n<p>[/data/ignition/ign-gazebo/include/ignition/gazebo/Types.hh:52]: (style) struct member 'UpdateInfo::iterations' is never used.</p>", "type": "rendered"}, "created_on": "2018-09-04T22:19:20.847900+00:00", "user": {"display_name": "Nate Koenig", "uuid": "{c862cdd9-fcc8-4419-9fc7-e20db14b8fcb}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Bc862cdd9-fcc8-4419-9fc7-e20db14b8fcb%7D"}, "html": {"href": "https://bitbucket.org/%7Bc862cdd9-fcc8-4419-9fc7-e20db14b8fcb%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:095b1e12-74ed-4e20-b44f-2f0745b616e0/ca24bb11-4787-4b14-a20d-d91835e9bde2/128"}}, "nickname": "Nathan Koenig", "type": "user", "account_id": "557058:095b1e12-74ed-4e20-b44f-2f0745b616e0"}, "updated_on": "2018-09-04T22:19:20.854400+00:00", "type": "pullrequest_comment", "id": 74969059}, "pull_request": {"type": "pullrequest", "id": 33, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/33.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/33"}}, "title": "Refactor stats and support play / pause / step"}}, {"comment": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/33/comments/74968895.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/33/_/diff#comment-74968895"}}, "parent": {"id": 74952099, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/33/comments/74952099.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/33/_/diff#comment-74952099"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 33, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/33.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/33"}}, "title": "Refactor stats and support play / pause / step"}, "content": {"raw": "Sounds good. Thanks.", "markup": "markdown", "html": "<p>Sounds good. Thanks.</p>", "type": "rendered"}, "created_on": "2018-09-04T22:16:12.036872+00:00", "user": {"display_name": "Nate Koenig", "uuid": "{c862cdd9-fcc8-4419-9fc7-e20db14b8fcb}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Bc862cdd9-fcc8-4419-9fc7-e20db14b8fcb%7D"}, "html": {"href": "https://bitbucket.org/%7Bc862cdd9-fcc8-4419-9fc7-e20db14b8fcb%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:095b1e12-74ed-4e20-b44f-2f0745b616e0/ca24bb11-4787-4b14-a20d-d91835e9bde2/128"}}, "nickname": "Nathan Koenig", "type": "user", "account_id": "557058:095b1e12-74ed-4e20-b44f-2f0745b616e0"}, "updated_on": "2018-09-04T22:16:12.042750+00:00", "type": "pullrequest_comment", "id": 74968895}, "pull_request": {"type": "pullrequest", "id": 33, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/33.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/33"}}, "title": "Refactor stats and support play / pause / step"}}, {"comment": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/33/comments/74952099.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/33/_/diff#comment-74952099"}}, "parent": {"id": 74947678, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/33/comments/74947678.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/33/_/diff#comment-74947678"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 33, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/33.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/33"}}, "title": "Refactor stats and support play / pause / step"}, "content": {"raw": "The evolution of time is deeply linked to updates and iterations, which are handled by `Server` and `SimulationRunner`, so it seemed like time should be handled on a higher level too.\n\nOther benefits:\n\n* Single authority on time - no system can change time and cause iterations and time to mismatch, nor can two systems try to change time at the same time (pun intended :smile: )\n\n* The real time update rate needs to be handled on the server so it can sleep appropriately between updates, and for that it needs the world step size, which could be variable. Keeping all this in the same place seemed cleaner. See your note [here](#!/ignitionrobotics/ign-gazebo/pull-requests/33/refactor-stats-and-support-play-pause-step/diff#Lsrc/SimulationRunner.ccF179).\n\n* This removes the logic which was taking the \"first\" World and WorldStatistics components, which assumed the order in which components are created is important, and that components have a meaning outside their entities.\n\nThat said, I can see the advantage of keeping the statistics publishing into a system. This way, users could turn off the publishing by removing the system and RTF computation can be moved to a separate thread. Handling world controls from a system would not be possible though, since systems curently can't affect time.", "markup": "markdown", "html": "<p>The evolution of time is deeply linked to updates and iterations, which are handled by <code>Server</code> and <code>SimulationRunner</code>, so it seemed like time should be handled on a higher level too.</p>\n<p>Other benefits:</p>\n<ul>\n<li>\n<p>Single authority on time - no system can change time and cause iterations and time to mismatch, nor can two systems try to change time at the same time (pun intended <img class=\"emoji\" src=\"data/pf-emoji-service--cdn.us-east-1.prod.public.atl-paas.net/standard/551c9814-1d37-4573-819d-afab3afeaf32/48x48/1f604.png\" alt=\"\ud83d\ude04\" title=\":smile:\" data-emoji-short-name=\":smile:\" /> )</p>\n</li>\n<li>\n<p>The real time update rate needs to be handled on the server so it can sleep appropriately between updates, and for that it needs the world step size, which could be variable. Keeping all this in the same place seemed cleaner. See your note <a data-is-external-link=\"true\" href=\"#!/ignitionrobotics/ign-gazebo/pull-requests/33/refactor-stats-and-support-play-pause-step/diff#Lsrc/SimulationRunner.ccF179\" rel=\"nofollow\">here</a>.</p>\n</li>\n<li>\n<p>This removes the logic which was taking the \"first\" World and WorldStatistics components, which assumed the order in which components are created is important, and that components have a meaning outside their entities.</p>\n</li>\n</ul>\n<p>That said, I can see the advantage of keeping the statistics publishing into a system. This way, users could turn off the publishing by removing the system and RTF computation can be moved to a separate thread. Handling world controls from a system would not be possible though, since systems curently can't affect time.</p>", "type": "rendered"}, "created_on": "2018-09-04T18:49:39.422812+00:00", "user": {"display_name": "Louise Poubel", "uuid": "{5cfa2075-477b-4ded-bdb9-8d2479544ec4}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D"}, "html": {"href": "https://bitbucket.org/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8/7d903d90-c5ea-4182-b7ef-0d467e9e1c74/128"}}, "nickname": "chapulina", "type": "user", "account_id": "557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8"}, "updated_on": "2018-09-04T18:49:59.613267+00:00", "type": "pullrequest_comment", "id": 74952099}, "pull_request": {"type": "pullrequest", "id": 33, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/33.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/33"}}, "title": "Refactor stats and support play / pause / step"}}, {"comment": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/33/comments/74950237.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/33/_/diff#comment-74950237"}}, "parent": {"id": 74949192, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/33/comments/74949192.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/33/_/diff#comment-74949192"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 33, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/33.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/33"}}, "title": "Refactor stats and support play / pause / step"}, "content": {"raw": "Removed more in 910bf23", "markup": "markdown", "html": "<p>Removed more in <a href=\"#!/ignitionrobotics/ign-gazebo/commits/910bf23\" rel=\"nofollow\" class=\"ap-connect-link\">910bf23</a></p>", "type": "rendered"}, "created_on": "2018-09-04T18:32:21.956091+00:00", "user": {"display_name": "Louise Poubel", "uuid": "{5cfa2075-477b-4ded-bdb9-8d2479544ec4}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D"}, "html": {"href": "https://bitbucket.org/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8/7d903d90-c5ea-4182-b7ef-0d467e9e1c74/128"}}, "nickname": "chapulina", "type": "user", "account_id": "557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8"}, "inline": {}, "updated_on": "2018-09-04T18:32:21.963614+00:00", "type": "pullrequest_comment", "id": 74950237}, "pull_request": {"type": "pullrequest", "id": 33, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/33.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/33"}}, "title": "Refactor stats and support play / pause / step"}}, {"update": {"description": "Move time handling to `SimulationRunner`, which means:\r\n\r\n* Remove `WorldStatistics` component and system\r\n* `World` component now is just an identifier like `components::Model` or `components::Link`\r\n* Systems receive `UpdateInfo` at the update callback, which contains info about time and iterations.\r\n* World statistics are published by `SimulationRunner`\r\n* World controls service is provided by `SimulationRunner`\r\n\r\n---\r\n\r\n# Concepts\r\n\r\nSome important ideas, which are open to discussion, are:\r\n\r\n* ECS systems are updated even while paused. This is important for interacting with the GUI.\r\n* While paused, sim iterations and sim time don't increase.\r\n* While paused, the step size (`dt`) passed to each system is zero. Right now, it is up to the system to check that and behave accordingly.\r\n* The step size is 10ms by default (placeholder) and can be overridden from the SDF (`<max_step_size>`).\r\n* The ECS period is calculated based on the step size and the desired RTF, see calculation comments on `SimulationRunner.cc`; it can be overridden from the command line with `-z`\r\n\r\nThe image below summarizes some of these ideas:\r\n\r\n![ECSRTF.png](https://bitbucket.org/repo/8zodKzn/images/1055788081-ECSRTF.png)\r\n\r\n---\r\n\r\n# Demo\r\n\r\n`ign-gazebo -f test/worlds/shapes.sdf  -v 4 -z 3`\r\n\r\n![playpause_pot.gif](https://bitbucket.org/repo/8zodKzn/images/4020974896-playpause_pot.gif)\r\n\r\n---\r\n\r\n---\r\n\r\n# Future work\r\n\r\n* Even if I try to run faster than real time, with `-z 10000` for example, the maximum RTF I get is less than 160%. It would be good to port `gazebo_experimental`'s [DiagnosticsManager](https://bitbucket.org/osrf/gazebo_experimental/src/d828f7845f99ecb5da097f1c89b32da809bd9fd9/include/gazebo/util/DiagnosticsManager.hh?fileviewer=file-view-default) here to see what's going on\r\n* Add command line option to start paused\r\n* `--iterations` should set sim iterations, not ECS (usually only relevant if you start paused)", "title": "Refactor stats and support play / pause / step", "destination": {"commit": {"hash": "be8630419a48", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/commit/be8630419a48.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/commits/be8630419a48"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{f98d11fe-f287-4dfb-99c3-e2b76a13232e}ts=2082645"}}, "type": "repository", "name": "ign-gazebo", "full_name": "ignitionrobotics/ign-gazebo", "uuid": "{f98d11fe-f287-4dfb-99c3-e2b76a13232e}"}, "branch": {"name": "default"}}, "reason": "", "source": {"commit": {"hash": "910bf235a7e9", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/commit/910bf235a7e9.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/commits/910bf235a7e9"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{f98d11fe-f287-4dfb-99c3-e2b76a13232e}ts=2082645"}}, "type": "repository", "name": "ign-gazebo", "full_name": "ignitionrobotics/ign-gazebo", "uuid": "{f98d11fe-f287-4dfb-99c3-e2b76a13232e}"}, "branch": {"name": "runner_stats"}}, "state": "OPEN", "author": {"display_name": "Louise Poubel", "uuid": "{5cfa2075-477b-4ded-bdb9-8d2479544ec4}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D"}, "html": {"href": "https://bitbucket.org/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8/7d903d90-c5ea-4182-b7ef-0d467e9e1c74/128"}}, "nickname": "chapulina", "type": "user", "account_id": "557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8"}, "date": "2018-09-04T18:32:06.883534+00:00"}, "pull_request": {"type": "pullrequest", "id": 33, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/33.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/33"}}, "title": "Refactor stats and support play / pause / step"}}, {"comment": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/33/comments/74949215.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/33/_/diff#comment-74949215"}}, "parent": {"id": 74948401, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/33/comments/74948401.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/33/_/diff#comment-74948401"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 33, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/33.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/33"}}, "title": "Refactor stats and support play / pause / step"}, "content": {"raw": "Renamed to `iterations` in  cbf8263", "markup": "markdown", "html": "<p>Renamed to <code>iterations</code> in  <a href=\"#!/ignitionrobotics/ign-gazebo/commits/cbf8263\" rel=\"nofollow\" class=\"ap-connect-link\">cbf8263</a></p>", "type": "rendered"}, "created_on": "2018-09-04T18:22:11.217195+00:00", "user": {"display_name": "Louise Poubel", "uuid": "{5cfa2075-477b-4ded-bdb9-8d2479544ec4}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D"}, "html": {"href": "https://bitbucket.org/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8/7d903d90-c5ea-4182-b7ef-0d467e9e1c74/128"}}, "nickname": "chapulina", "type": "user", "account_id": "557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8"}, "inline": {}, "updated_on": "2018-09-04T18:22:11.224987+00:00", "type": "pullrequest_comment", "id": 74949215}, "pull_request": {"type": "pullrequest", "id": 33, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/33.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/33"}}, "title": "Refactor stats and support play / pause / step"}}, {"comment": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/33/comments/74949192.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/33/_/diff#comment-74949192"}}, "parent": {"id": 74947190, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/33/comments/74947190.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/33/_/diff#comment-74947190"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 33, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/33.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/33"}}, "title": "Refactor stats and support play / pause / step"}, "content": {"raw": "Removed:  cbf8263", "markup": "markdown", "html": "<p>Removed:  <a href=\"#!/ignitionrobotics/ign-gazebo/commits/cbf8263\" rel=\"nofollow\" class=\"ap-connect-link\">cbf8263</a></p>", "type": "rendered"}, "created_on": "2018-09-04T18:21:58.863797+00:00", "user": {"display_name": "Louise Poubel", "uuid": "{5cfa2075-477b-4ded-bdb9-8d2479544ec4}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D"}, "html": {"href": "https://bitbucket.org/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8/7d903d90-c5ea-4182-b7ef-0d467e9e1c74/128"}}, "nickname": "chapulina", "type": "user", "account_id": "557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8"}, "inline": {}, "updated_on": "2018-09-04T18:21:58.871201+00:00", "type": "pullrequest_comment", "id": 74949192}, "pull_request": {"type": "pullrequest", "id": 33, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/33.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/33"}}, "title": "Refactor stats and support play / pause / step"}}, {"comment": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/33/comments/74949174.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/33/_/diff#comment-74949174"}}, "parent": {"id": 74946875, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/33/comments/74946875.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/33/_/diff#comment-74946875"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 33, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/33.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/33"}}, "title": "Refactor stats and support play / pause / step"}, "content": {"raw": "Removed:  cbf8263", "markup": "markdown", "html": "<p>Removed:  <a href=\"#!/ignitionrobotics/ign-gazebo/commits/cbf8263\" rel=\"nofollow\" class=\"ap-connect-link\">cbf8263</a></p>", "type": "rendered"}, "created_on": "2018-09-04T18:21:52.974459+00:00", "user": {"display_name": "Louise Poubel", "uuid": "{5cfa2075-477b-4ded-bdb9-8d2479544ec4}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D"}, "html": {"href": "https://bitbucket.org/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8/7d903d90-c5ea-4182-b7ef-0d467e9e1c74/128"}}, "nickname": "chapulina", "type": "user", "account_id": "557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8"}, "inline": {}, "updated_on": "2018-09-04T18:21:52.981963+00:00", "type": "pullrequest_comment", "id": 74949174}, "pull_request": {"type": "pullrequest", "id": 33, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/33.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/33"}}, "title": "Refactor stats and support play / pause / step"}}, {"comment": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/33/comments/74949109.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/33/_/diff#comment-74949109"}}, "parent": {"id": 74945039, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/33/comments/74945039.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/33/_/diff#comment-74945039"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 33, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/33.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/33"}}, "title": "Refactor stats and support play / pause / step"}, "content": {"raw": "As mentioned on a previous comment, I don't think developers looking at this documentation would be unaware of the ECS, but I removed it from the documentation as requested:  cbf8263", "markup": "markdown", "html": "<p>As mentioned on a previous comment, I don't think developers looking at this documentation would be unaware of the ECS, but I removed it from the documentation as requested:  <a href=\"#!/ignitionrobotics/ign-gazebo/commits/cbf8263\" rel=\"nofollow\" class=\"ap-connect-link\">cbf8263</a></p>", "type": "rendered"}, "created_on": "2018-09-04T18:21:10.459449+00:00", "user": {"display_name": "Louise Poubel", "uuid": "{5cfa2075-477b-4ded-bdb9-8d2479544ec4}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D"}, "html": {"href": "https://bitbucket.org/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8/7d903d90-c5ea-4182-b7ef-0d467e9e1c74/128"}}, "nickname": "chapulina", "type": "user", "account_id": "557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8"}, "inline": {}, "updated_on": "2018-09-04T18:21:10.467273+00:00", "type": "pullrequest_comment", "id": 74949109}, "pull_request": {"type": "pullrequest", "id": 33, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/33.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/33"}}, "title": "Refactor stats and support play / pause / step"}}, {"update": {"description": "Move time handling to `SimulationRunner`, which means:\r\n\r\n* Remove `WorldStatistics` component and system\r\n* `World` component now is just an identifier like `components::Model` or `components::Link`\r\n* Systems receive `UpdateInfo` at the update callback, which contains info about time and iterations.\r\n* World statistics are published by `SimulationRunner`\r\n* World controls service is provided by `SimulationRunner`\r\n\r\n---\r\n\r\n# Concepts\r\n\r\nSome important ideas, which are open to discussion, are:\r\n\r\n* ECS systems are updated even while paused. This is important for interacting with the GUI.\r\n* While paused, sim iterations and sim time don't increase.\r\n* While paused, the step size (`dt`) passed to each system is zero. Right now, it is up to the system to check that and behave accordingly.\r\n* The step size is 10ms by default (placeholder) and can be overridden from the SDF (`<max_step_size>`).\r\n* The ECS period is calculated based on the step size and the desired RTF, see calculation comments on `SimulationRunner.cc`; it can be overridden from the command line with `-z`\r\n\r\nThe image below summarizes some of these ideas:\r\n\r\n![ECSRTF.png](https://bitbucket.org/repo/8zodKzn/images/1055788081-ECSRTF.png)\r\n\r\n---\r\n\r\n# Demo\r\n\r\n`ign-gazebo -f test/worlds/shapes.sdf  -v 4 -z 3`\r\n\r\n![playpause_pot.gif](https://bitbucket.org/repo/8zodKzn/images/4020974896-playpause_pot.gif)\r\n\r\n---\r\n\r\n---\r\n\r\n# Future work\r\n\r\n* Even if I try to run faster than real time, with `-z 10000` for example, the maximum RTF I get is less than 160%. It would be good to port `gazebo_experimental`'s [DiagnosticsManager](https://bitbucket.org/osrf/gazebo_experimental/src/d828f7845f99ecb5da097f1c89b32da809bd9fd9/include/gazebo/util/DiagnosticsManager.hh?fileviewer=file-view-default) here to see what's going on\r\n* Add command line option to start paused\r\n* `--iterations` should set sim iterations, not ECS (usually only relevant if you start paused)", "title": "Refactor stats and support play / pause / step", "destination": {"commit": {"hash": "be8630419a48", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/commit/be8630419a48.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/commits/be8630419a48"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{f98d11fe-f287-4dfb-99c3-e2b76a13232e}ts=2082645"}}, "type": "repository", "name": "ign-gazebo", "full_name": "ignitionrobotics/ign-gazebo", "uuid": "{f98d11fe-f287-4dfb-99c3-e2b76a13232e}"}, "branch": {"name": "default"}}, "reason": "", "source": {"commit": {"hash": "cbf8263cc04b", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/commit/cbf8263cc04b.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/commits/cbf8263cc04b"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{f98d11fe-f287-4dfb-99c3-e2b76a13232e}ts=2082645"}}, "type": "repository", "name": "ign-gazebo", "full_name": "ignitionrobotics/ign-gazebo", "uuid": "{f98d11fe-f287-4dfb-99c3-e2b76a13232e}"}, "branch": {"name": "runner_stats"}}, "state": "OPEN", "author": {"display_name": "Louise Poubel", "uuid": "{5cfa2075-477b-4ded-bdb9-8d2479544ec4}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D"}, "html": {"href": "https://bitbucket.org/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8/7d903d90-c5ea-4182-b7ef-0d467e9e1c74/128"}}, "nickname": "chapulina", "type": "user", "account_id": "557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8"}, "date": "2018-09-04T18:19:48.337649+00:00"}, "pull_request": {"type": "pullrequest", "id": 33, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/33.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/33"}}, "title": "Refactor stats and support play / pause / step"}}, {"comment": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/33/comments/74948401.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/33/_/diff#comment-74948401"}}, "parent": {"id": 74947028, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/33/comments/74947028.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/33/_/diff#comment-74947028"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 33, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/33.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/33"}}, "title": "Refactor stats and support play / pause / step"}, "content": {"raw": "The intention was to make a clear differentiation between the `ecsIterations` and `simIterations`, since they may be different if the simulation is paused. \n\nI can change the ECS one back to `iterations` and leave the other one as `simIterations` if you think that's clear enough, but I don't agree with the statement that downstream developers will not / should not be aware of the ECS. If we expect them to write system plugins which interact with entities and components, they will need to understand these concepts. That's especially true for someone using the `Server` and `SimulationRunner` APIs.", "markup": "markdown", "html": "<p>The intention was to make a clear differentiation between the <code>ecsIterations</code> and <code>simIterations</code>, since they may be different if the simulation is paused. </p>\n<p>I can change the ECS one back to <code>iterations</code> and leave the other one as <code>simIterations</code> if you think that's clear enough, but I don't agree with the statement that downstream developers will not / should not be aware of the ECS. If we expect them to write system plugins which interact with entities and components, they will need to understand these concepts. That's especially true for someone using the <code>Server</code> and <code>SimulationRunner</code> APIs.</p>", "type": "rendered"}, "created_on": "2018-09-04T18:14:35.509997+00:00", "user": {"display_name": "Louise Poubel", "uuid": "{5cfa2075-477b-4ded-bdb9-8d2479544ec4}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D"}, "html": {"href": "https://bitbucket.org/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8/7d903d90-c5ea-4182-b7ef-0d467e9e1c74/128"}}, "nickname": "chapulina", "type": "user", "account_id": "557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8"}, "inline": {}, "updated_on": "2018-09-04T18:14:35.518207+00:00", "type": "pullrequest_comment", "id": 74948401}, "pull_request": {"type": "pullrequest", "id": 33, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/33.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/33"}}, "title": "Refactor stats and support play / pause / step"}}, {"comment": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/33/comments/74947678.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/33/_/diff#comment-74947678"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 33, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/33.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/33"}}, "title": "Refactor stats and support play / pause / step"}, "content": {"raw": "What is the purpose behind moving time handling?", "markup": "markdown", "html": "<p>What is the purpose behind moving time handling?</p>", "type": "rendered"}, "created_on": "2018-09-04T18:07:14.206054+00:00", "user": {"display_name": "Nate Koenig", "uuid": "{c862cdd9-fcc8-4419-9fc7-e20db14b8fcb}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Bc862cdd9-fcc8-4419-9fc7-e20db14b8fcb%7D"}, "html": {"href": "https://bitbucket.org/%7Bc862cdd9-fcc8-4419-9fc7-e20db14b8fcb%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:095b1e12-74ed-4e20-b44f-2f0745b616e0/ca24bb11-4787-4b14-a20d-d91835e9bde2/128"}}, "nickname": "Nathan Koenig", "type": "user", "account_id": "557058:095b1e12-74ed-4e20-b44f-2f0745b616e0"}, "updated_on": "2018-09-04T18:07:14.212343+00:00", "type": "pullrequest_comment", "id": 74947678}, "pull_request": {"type": "pullrequest", "id": 33, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/33.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/33"}}, "title": "Refactor stats and support play / pause / step"}}, {"comment": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/33/comments/74947190.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/33/_/diff#comment-74947190"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 33, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/33.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/33"}}, "title": "Refactor stats and support play / pause / step"}, "content": {"raw": "Remove \u201cECS\u201d from all documentation.", "markup": "markdown", "html": "<p>Remove \u201cECS\u201d from all documentation.</p>", "type": "rendered"}, "created_on": "2018-09-04T18:02:26.110621+00:00", "user": {"display_name": "Nate Koenig", "uuid": "{c862cdd9-fcc8-4419-9fc7-e20db14b8fcb}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Bc862cdd9-fcc8-4419-9fc7-e20db14b8fcb%7D"}, "html": {"href": "https://bitbucket.org/%7Bc862cdd9-fcc8-4419-9fc7-e20db14b8fcb%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:095b1e12-74ed-4e20-b44f-2f0745b616e0/ca24bb11-4787-4b14-a20d-d91835e9bde2/128"}}, "nickname": "Nathan Koenig", "type": "user", "account_id": "557058:095b1e12-74ed-4e20-b44f-2f0745b616e0"}, "inline": {}, "updated_on": "2018-09-04T18:02:26.119057+00:00", "type": "pullrequest_comment", "id": 74947190}, "pull_request": {"type": "pullrequest", "id": 33, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/33.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/33"}}, "title": "Refactor stats and support play / pause / step"}}, {"comment": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/33/comments/74947028.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/33/_/diff#comment-74947028"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 33, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/33.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/33"}}, "title": "Refactor stats and support play / pause / step"}, "content": {"raw": "Remove \u201cecs\u201d from \u201cecsIterations\u201d. And all remaining occurrences.", "markup": "markdown", "html": "<p>Remove \u201cecs\u201d from \u201cecsIterations\u201d. And all remaining occurrences.</p>", "type": "rendered"}, "created_on": "2018-09-04T18:00:44.456511+00:00", "user": {"display_name": "Nate Koenig", "uuid": "{c862cdd9-fcc8-4419-9fc7-e20db14b8fcb}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Bc862cdd9-fcc8-4419-9fc7-e20db14b8fcb%7D"}, "html": {"href": "https://bitbucket.org/%7Bc862cdd9-fcc8-4419-9fc7-e20db14b8fcb%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:095b1e12-74ed-4e20-b44f-2f0745b616e0/ca24bb11-4787-4b14-a20d-d91835e9bde2/128"}}, "nickname": "Nathan Koenig", "type": "user", "account_id": "557058:095b1e12-74ed-4e20-b44f-2f0745b616e0"}, "inline": {}, "updated_on": "2018-09-04T18:01:00.326405+00:00", "type": "pullrequest_comment", "id": 74947028}, "pull_request": {"type": "pullrequest", "id": 33, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/33.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/33"}}, "title": "Refactor stats and support play / pause / step"}}, {"comment": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/33/comments/74946875.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/33/_/diff#comment-74946875"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 33, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/33.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/33"}}, "title": "Refactor stats and support play / pause / step"}, "content": {"raw": "Don\u2019t use the phrase \u201cecs\u201d here.", "markup": "markdown", "html": "<p>Don\u2019t use the phrase \u201cecs\u201d here.</p>", "type": "rendered"}, "created_on": "2018-09-04T17:59:24.951341+00:00", "user": {"display_name": "Nate Koenig", "uuid": "{c862cdd9-fcc8-4419-9fc7-e20db14b8fcb}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Bc862cdd9-fcc8-4419-9fc7-e20db14b8fcb%7D"}, "html": {"href": "https://bitbucket.org/%7Bc862cdd9-fcc8-4419-9fc7-e20db14b8fcb%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:095b1e12-74ed-4e20-b44f-2f0745b616e0/ca24bb11-4787-4b14-a20d-d91835e9bde2/128"}}, "nickname": "Nathan Koenig", "type": "user", "account_id": "557058:095b1e12-74ed-4e20-b44f-2f0745b616e0"}, "inline": {}, "updated_on": "2018-09-04T17:59:24.958324+00:00", "type": "pullrequest_comment", "id": 74946875}, "pull_request": {"type": "pullrequest", "id": 33, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/33.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/33"}}, "title": "Refactor stats and support play / pause / step"}}, {"comment": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/33/comments/74945039.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/33/_/diff#comment-74945039"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 33, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/33.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/33"}}, "title": "Refactor stats and support play / pause / step"}, "content": {"raw": "I\u2019d like to stop directly using the phrase \u201cECS\u201d in code and documentation. ECS has meaning to us \\(OSRF\\), but readers of documentation will get confused. In this case you can replace \u201cECS\u201d with \u201csimulation\u201d.", "markup": "markdown", "html": "<p>I\u2019d like to stop directly using the phrase \u201cECS\u201d in code and documentation. ECS has meaning to us (OSRF), but readers of documentation will get confused. In this case you can replace \u201cECS\u201d with \u201csimulation\u201d.</p>", "type": "rendered"}, "created_on": "2018-09-04T17:41:54.944814+00:00", "user": {"display_name": "Nate Koenig", "uuid": "{c862cdd9-fcc8-4419-9fc7-e20db14b8fcb}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Bc862cdd9-fcc8-4419-9fc7-e20db14b8fcb%7D"}, "html": {"href": "https://bitbucket.org/%7Bc862cdd9-fcc8-4419-9fc7-e20db14b8fcb%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:095b1e12-74ed-4e20-b44f-2f0745b616e0/ca24bb11-4787-4b14-a20d-d91835e9bde2/128"}}, "nickname": "Nathan Koenig", "type": "user", "account_id": "557058:095b1e12-74ed-4e20-b44f-2f0745b616e0"}, "inline": {}, "updated_on": "2018-09-04T17:41:54.951315+00:00", "type": "pullrequest_comment", "id": 74945039}, "pull_request": {"type": "pullrequest", "id": 33, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/33.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/33"}}, "title": "Refactor stats and support play / pause / step"}}, {"comment": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/33/comments/74701237.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/33/_/diff#comment-74701237"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 33, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/33.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/33"}}, "title": "Refactor stats and support play / pause / step"}, "content": {"raw": "@carromj @azeey , this is now ready for review", "markup": "markdown", "html": "<p>@carromj @azeey , this is now ready for review</p>", "type": "rendered"}, "created_on": "2018-08-31T18:21:20.773226+00:00", "user": {"display_name": "Louise Poubel", "uuid": "{5cfa2075-477b-4ded-bdb9-8d2479544ec4}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D"}, "html": {"href": "https://bitbucket.org/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8/7d903d90-c5ea-4182-b7ef-0d467e9e1c74/128"}}, "nickname": "chapulina", "type": "user", "account_id": "557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8"}, "updated_on": "2018-08-31T18:21:20.792448+00:00", "type": "pullrequest_comment", "id": 74701237}, "pull_request": {"type": "pullrequest", "id": 33, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/33.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/33"}}, "title": "Refactor stats and support play / pause / step"}}, {"update": {"description": "Move time handling to `SimulationRunner`, which means:\r\n\r\n* Remove `WorldStatistics` component and system\r\n* `World` component now is just an identifier like `components::Model` or `components::Link`\r\n* Systems receive `UpdateInfo` at the update callback, which contains info about time and iterations.\r\n* World statistics are published by `SimulationRunner`\r\n* World controls service is provided by `SimulationRunner`\r\n\r\n---\r\n\r\n# Concepts\r\n\r\nSome important ideas, which are open to discussion, are:\r\n\r\n* ECS systems are updated even while paused. This is important for interacting with the GUI.\r\n* While paused, sim iterations and sim time don't increase.\r\n* While paused, the step size (`dt`) passed to each system is zero. Right now, it is up to the system to check that and behave accordingly.\r\n* The step size is 10ms by default (placeholder) and can be overridden from the SDF (`<max_step_size>`).\r\n* The ECS period is calculated based on the step size and the desired RTF, see calculation comments on `SimulationRunner.cc`; it can be overridden from the command line with `-z`\r\n\r\nThe image below summarizes some of these ideas:\r\n\r\n![ECSRTF.png](https://bitbucket.org/repo/8zodKzn/images/1055788081-ECSRTF.png)\r\n\r\n---\r\n\r\n# Demo\r\n\r\n`ign-gazebo -f test/worlds/shapes.sdf  -v 4 -z 3`\r\n\r\n![playpause_pot.gif](https://bitbucket.org/repo/8zodKzn/images/4020974896-playpause_pot.gif)\r\n\r\n---\r\n\r\n---\r\n\r\n# Future work\r\n\r\n* Even if I try to run faster than real time, with `-z 10000` for example, the maximum RTF I get is less than 160%. It would be good to port `gazebo_experimental`'s [DiagnosticsManager](https://bitbucket.org/osrf/gazebo_experimental/src/d828f7845f99ecb5da097f1c89b32da809bd9fd9/include/gazebo/util/DiagnosticsManager.hh?fileviewer=file-view-default) here to see what's going on\r\n* Add command line option to start paused\r\n* `--iterations` should set sim iterations, not ECS (usually only relevant if you start paused)", "title": "Refactor stats and support play / pause / step", "destination": {"commit": {"hash": "03da0be720cd", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/commit/03da0be720cd.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/commits/03da0be720cd"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{f98d11fe-f287-4dfb-99c3-e2b76a13232e}ts=2082645"}}, "type": "repository", "name": "ign-gazebo", "full_name": "ignitionrobotics/ign-gazebo", "uuid": "{f98d11fe-f287-4dfb-99c3-e2b76a13232e}"}, "branch": {"name": "default"}}, "reason": "", "source": {"commit": {"hash": "6083a009954e", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/commit/6083a009954e.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/commits/6083a009954e"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{f98d11fe-f287-4dfb-99c3-e2b76a13232e}ts=2082645"}}, "type": "repository", "name": "ign-gazebo", "full_name": "ignitionrobotics/ign-gazebo", "uuid": "{f98d11fe-f287-4dfb-99c3-e2b76a13232e}"}, "branch": {"name": "runner_stats"}}, "state": "OPEN", "author": {"display_name": "Louise Poubel", "uuid": "{5cfa2075-477b-4ded-bdb9-8d2479544ec4}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D"}, "html": {"href": "https://bitbucket.org/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8/7d903d90-c5ea-4182-b7ef-0d467e9e1c74/128"}}, "nickname": "chapulina", "type": "user", "account_id": "557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8"}, "date": "2018-08-31T18:20:49.761401+00:00"}, "pull_request": {"type": "pullrequest", "id": 33, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/33.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/33"}}, "title": "Refactor stats and support play / pause / step"}}, {"update": {"description": "Move time handling to `SimulationRunner`, which means:\r\n\r\n* Remove `WorldStatistics` component and system\r\n* `World` component now is just an identifier like `components::Model` or `components::Link`\r\n* Systems receive `UpdateInfo` at the update callback, which contains info about time and iterations.\r\n* World statistics are published by `SimulationRunner`\r\n* World controls service is provided by `SimulationRunner`\r\n\r\n---\r\n\r\n# Concepts\r\n\r\nSome important ideas, which are open to discussion, are:\r\n\r\n* ECS systems are updated even while paused. This is important for interacting with the GUI.\r\n* While paused, sim iterations and sim time don't increase.\r\n* While paused, the step size (`dt`) passed to each system is zero. Right now, it is up to the system to check that and behave accordingly.\r\n* The step size is 10ms by default (placeholder) and can be overridden from the SDF (`<max_step_size>`).\r\n* The ECS period is calculated based on the step size and the desired RTF, see calculation comments on `SimulationRunner.cc`; it can be overridden from the command line with `-z`\r\n\r\nThe image below summarizes some of these ideas:\r\n\r\n![ECSRTF.png](https://bitbucket.org/repo/8zodKzn/images/1055788081-ECSRTF.png)\r\n\r\n---\r\n\r\n# Demo\r\n\r\n`ign-gazebo -f test/worlds/shapes.sdf  -v 4 -z 3`\r\n\r\n![playpause_pot.gif](https://bitbucket.org/repo/8zodKzn/images/4020974896-playpause_pot.gif)\r\n\r\n---\r\n\r\n---\r\n\r\n# Future work\r\n\r\n* Even if I try to run faster than real time, with `-z 10000` for example, the maximum RTF I get is less than 160%. It would be good to port `gazebo_experimental`'s [DiagnosticsManager](https://bitbucket.org/osrf/gazebo_experimental/src/d828f7845f99ecb5da097f1c89b32da809bd9fd9/include/gazebo/util/DiagnosticsManager.hh?fileviewer=file-view-default) here to see what's going on\r\n* Add command line option to start paused\r\n* `--iterations` should set sim iterations, not ECS (usually only relevant if you start paused)", "title": "[WIP] Refactor stats and support play / pause / step", "destination": {"commit": {"hash": "03da0be720cd", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/commit/03da0be720cd.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/commits/03da0be720cd"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{f98d11fe-f287-4dfb-99c3-e2b76a13232e}ts=2082645"}}, "type": "repository", "name": "ign-gazebo", "full_name": "ignitionrobotics/ign-gazebo", "uuid": "{f98d11fe-f287-4dfb-99c3-e2b76a13232e}"}, "branch": {"name": "default"}}, "reason": "", "source": {"commit": {"hash": "6083a009954e", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/commit/6083a009954e.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/commits/6083a009954e"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{f98d11fe-f287-4dfb-99c3-e2b76a13232e}ts=2082645"}}, "type": "repository", "name": "ign-gazebo", "full_name": "ignitionrobotics/ign-gazebo", "uuid": "{f98d11fe-f287-4dfb-99c3-e2b76a13232e}"}, "branch": {"name": "runner_stats"}}, "state": "OPEN", "author": {"display_name": "Louise Poubel", "uuid": "{5cfa2075-477b-4ded-bdb9-8d2479544ec4}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D"}, "html": {"href": "https://bitbucket.org/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8/7d903d90-c5ea-4182-b7ef-0d467e9e1c74/128"}}, "nickname": "chapulina", "type": "user", "account_id": "557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8"}, "date": "2018-08-31T18:19:14.160412+00:00"}, "pull_request": {"type": "pullrequest", "id": 33, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/33.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/33"}}, "title": "Refactor stats and support play / pause / step"}}, {"update": {"description": "Move time handling to `SimulationRunner`, which means:\r\n\r\n* Remove `WorldStatistics` component and system\r\n* `World` component now is just an identifier like `components::Model` or `components::Link`\r\n* Systems receive `UpdateInfo` at the update callback, which contains info about time and iterations.\r\n* World statistics are published by `SimulationRunner`\r\n* World controls service is provided by `SimulationRunner`\r\n\r\n---\r\n\r\n# Concepts\r\n\r\nSome important ideas, which are open to discussion, are:\r\n\r\n* ECS systems are updated even while paused. This is important for interacting with the GUI.\r\n* While paused, sim iterations and sim time don't increase.\r\n* While paused, the step size (`dt`) passed to each system is zero. Right now, it is up to the system to check that and behave accordingly.\r\n* The step size is 10ms by default (placeholder) and can be overridden from the SDF (`<max_step_size>`).\r\n* The ECS period is calculated based on the step size and the desired RTF, see calculation comments on `SimulationRunner.cc`; it can be overridden from the command line with `-z`\r\n\r\nThe image below summarizes some of these ideas:\r\n\r\n![ECSRTF.png](https://bitbucket.org/repo/8zodKzn/images/1055788081-ECSRTF.png)\r\n\r\n---\r\n\r\n# Demo\r\n\r\n`ign-gazebo -f test/worlds/shapes.sdf  -v 4 -z 3`\r\n\r\n![playpause_pot.gif](https://bitbucket.org/repo/8zodKzn/images/4020974896-playpause_pot.gif)\r\n\r\n---\r\n\r\n---\r\n\r\n# Future work\r\n\r\n* Even if I try to run faster than real time, with `-z 10000` for example, the maximum RTF I get is less than 160%. It would be good to port `gazebo_experimental`'s [DiagnosticsManager](https://bitbucket.org/osrf/gazebo_experimental/src/d828f7845f99ecb5da097f1c89b32da809bd9fd9/include/gazebo/util/DiagnosticsManager.hh?fileviewer=file-view-default) here to see what's going on\r\n* Add command line option to start paused\r\n* `--iterations` should set sim iterations, not ECS (usually only relevant if you start paused)", "title": "[WIP] Refactor stats and support play / pause / step", "destination": {"commit": {"hash": "03da0be720cd", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/commit/03da0be720cd.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/commits/03da0be720cd"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{f98d11fe-f287-4dfb-99c3-e2b76a13232e}ts=2082645"}}, "type": "repository", "name": "ign-gazebo", "full_name": "ignitionrobotics/ign-gazebo", "uuid": "{f98d11fe-f287-4dfb-99c3-e2b76a13232e}"}, "branch": {"name": "default"}}, "reason": "", "source": {"commit": {"hash": "b116dc158f14", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/commit/b116dc158f14.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/commits/b116dc158f14"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{f98d11fe-f287-4dfb-99c3-e2b76a13232e}ts=2082645"}}, "type": "repository", "name": "ign-gazebo", "full_name": "ignitionrobotics/ign-gazebo", "uuid": "{f98d11fe-f287-4dfb-99c3-e2b76a13232e}"}, "branch": {"name": "runner_stats"}}, "state": "OPEN", "author": {"display_name": "Louise Poubel", "uuid": "{5cfa2075-477b-4ded-bdb9-8d2479544ec4}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D"}, "html": {"href": "https://bitbucket.org/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8/7d903d90-c5ea-4182-b7ef-0d467e9e1c74/128"}}, "nickname": "chapulina", "type": "user", "account_id": "557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8"}, "date": "2018-08-31T18:17:00.579864+00:00"}, "pull_request": {"type": "pullrequest", "id": 33, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/33.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/33"}}, "title": "Refactor stats and support play / pause / step"}}, {"comment": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/33/comments/74700743.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/33/_/diff#comment-74700743"}}, "parent": {"id": 74699609, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/33/comments/74699609.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/33/_/diff#comment-74699609"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 33, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/33.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/33"}}, "title": "Refactor stats and support play / pause / step"}, "content": {"raw": "Ahhhh thanks @caguero for reminding me that proto3 doesn't print a field's default value - in this case `paused == false` is not printed, but `paused == true` is. I had ticketed an [issue](#!/ignitionrobotics/ign-msgs/issues/22/optional-fields-in-proto-3) about this exactly 2 months ago.\n\n![](https://i.gifer.com/EIO1.gif)", "markup": "markdown", "html": "<p>Ahhhh thanks @caguero for reminding me that proto3 doesn't print a field's default value - in this case <code>paused == false</code> is not printed, but <code>paused == true</code> is. I had ticketed an <a data-is-external-link=\"true\" href=\"#!/ignitionrobotics/ign-msgs/issues/22/optional-fields-in-proto-3\" rel=\"nofollow\">issue</a> about this exactly 2 months ago.</p>\n<p><img alt=\"\" src=\"https://i.gifer.com/EIO1.gif\" /></p>", "type": "rendered"}, "created_on": "2018-08-31T18:14:53.546780+00:00", "user": {"display_name": "Louise Poubel", "uuid": "{5cfa2075-477b-4ded-bdb9-8d2479544ec4}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D"}, "html": {"href": "https://bitbucket.org/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8/7d903d90-c5ea-4182-b7ef-0d467e9e1c74/128"}}, "nickname": "chapulina", "type": "user", "account_id": "557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8"}, "updated_on": "2018-08-31T18:14:53.560467+00:00", "type": "pullrequest_comment", "id": 74700743}, "pull_request": {"type": "pullrequest", "id": 33, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/33.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/33"}}, "title": "Refactor stats and support play / pause / step"}}, {"comment": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/33/comments/74699609.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/33/_/diff#comment-74699609"}}, "parent": {"id": 74694208, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/33/comments/74694208.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/33/_/diff#comment-74694208"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 33, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/33.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/33"}}, "title": "Refactor stats and support play / pause / step"}, "content": {"raw": "So you were right that the QML version of the plugin was not responding correctly to world stats. [This ign-gui PR](#!/ignitionrobotics/ign-gui/pull-requests/152/gz11-connect-play-pause-button-to-world/diff) fixes that. Now the button's initial state and following states respond to the `paused` flag on the `/world/default/stats`.\n\nBut I still haven't figured out the issue with the boolean values. Even though the message seems to go through correctly, the field is not printed either on `ign topic -e` or using `msg.DebugString()` :confused: ", "markup": "markdown", "html": "<p>So you were right that the QML version of the plugin was not responding correctly to world stats. <a data-is-external-link=\"true\" href=\"#!/ignitionrobotics/ign-gui/pull-requests/152/gz11-connect-play-pause-button-to-world/diff\" rel=\"nofollow\">This ign-gui PR</a> fixes that. Now the button's initial state and following states respond to the <code>paused</code> flag on the <code>/world/default/stats</code>.</p>\n<p>But I still haven't figured out the issue with the boolean values. Even though the message seems to go through correctly, the field is not printed either on <code>ign topic -e</code> or using <code>msg.DebugString()</code> <img class=\"emoji\" src=\"data/pf-emoji-service--cdn.us-east-1.prod.public.atl-paas.net/standard/551c9814-1d37-4573-819d-afab3afeaf32/48x48/1f615.png\" alt=\"\ud83d\ude15\" title=\":confused:\" data-emoji-short-name=\":confused:\" /> </p>", "type": "rendered"}, "created_on": "2018-08-31T18:00:00.438198+00:00", "user": {"display_name": "Louise Poubel", "uuid": "{5cfa2075-477b-4ded-bdb9-8d2479544ec4}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D"}, "html": {"href": "https://bitbucket.org/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8/7d903d90-c5ea-4182-b7ef-0d467e9e1c74/128"}}, "nickname": "chapulina", "type": "user", "account_id": "557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8"}, "updated_on": "2018-08-31T18:00:00.445390+00:00", "type": "pullrequest_comment", "id": 74699609}, "pull_request": {"type": "pullrequest", "id": 33, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/33.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/33"}}, "title": "Refactor stats and support play / pause / step"}}, {"comment": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/33/comments/74694208.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/33/_/diff#comment-74694208"}}, "parent": {"id": 74691909, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/33/comments/74691909.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/33/_/diff#comment-74691909"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 33, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/33.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/33"}}, "title": "Refactor stats and support play / pause / step"}, "content": {"raw": "We talked offline, but just some more context for everybody else. The play/pause button's state is already supposed to change according to the world statistics topic. However, it's not working for me locally due to an issue I've had before and showed to @caguero, where boolean fields in messages don't get received. When this happened before, we narrowed the problem to conflicting ign-msgs / transport versions and after a complete system cleanup everything worked. I'm going to rebuild my workspace in a clean container and see if the problem is solved.", "markup": "markdown", "html": "<p>We talked offline, but just some more context for everybody else. The play/pause button's state is already supposed to change according to the world statistics topic. However, it's not working for me locally due to an issue I've had before and showed to @caguero, where boolean fields in messages don't get received. When this happened before, we narrowed the problem to conflicting ign-msgs / transport versions and after a complete system cleanup everything worked. I'm going to rebuild my workspace in a clean container and see if the problem is solved.</p>", "type": "rendered"}, "created_on": "2018-08-31T16:56:39.958916+00:00", "user": {"display_name": "Louise Poubel", "uuid": "{5cfa2075-477b-4ded-bdb9-8d2479544ec4}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D"}, "html": {"href": "https://bitbucket.org/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8/7d903d90-c5ea-4182-b7ef-0d467e9e1c74/128"}}, "nickname": "chapulina", "type": "user", "account_id": "557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8"}, "updated_on": "2018-08-31T16:56:39.971534+00:00", "type": "pullrequest_comment", "id": 74694208}, "pull_request": {"type": "pullrequest", "id": 33, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/33.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/33"}}, "title": "Refactor stats and support play / pause / step"}}, {"comment": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/33/comments/74691909.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/33/_/diff#comment-74691909"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 33, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/33.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/33"}}, "title": "Refactor stats and support play / pause / step"}, "content": {"raw": "Disclaimer: I'm not familiar with `ign-gazebo` yet but wanted to mention this because was relevant during Delphyne development. Feel free to ignore this comment if already works like that.\n\nI think that the default Ign-gui behavior when pausing/stepping/resuming is to publish a message with the new world state and change the GUI widget accordingly. This is fine when you only have one GUI client, but if you have multiple ones, the others might not receive any update. What I\u2019ve done in the past is to update the GUI based on a notification sent from the server. In this way, the server needs to process all the incoming requests \\(e.g.: pause\\), update its state, and then, notify state updates that will be received by the GUI clients. This is also useful when you change the state of the simulation from the CLI.", "markup": "markdown", "html": "<p>Disclaimer: I'm not familiar with <code>ign-gazebo</code> yet but wanted to mention this because was relevant during Delphyne development. Feel free to ignore this comment if already works like that.</p>\n<p>I think that the default Ign-gui behavior when pausing/stepping/resuming is to publish a message with the new world state and change the GUI widget accordingly. This is fine when you only have one GUI client, but if you have multiple ones, the others might not receive any update. What I\u2019ve done in the past is to update the GUI based on a notification sent from the server. In this way, the server needs to process all the incoming requests (e.g.: pause), update its state, and then, notify state updates that will be received by the GUI clients. This is also useful when you change the state of the simulation from the CLI.</p>", "type": "rendered"}, "created_on": "2018-08-31T16:29:04.733596+00:00", "user": {"display_name": "Carlos Ag\u00fcero", "uuid": "{da8a8e89-4bb0-421b-bd0e-dbbed3d4ed6a}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Bda8a8e89-4bb0-421b-bd0e-dbbed3d4ed6a%7D"}, "html": {"href": "https://bitbucket.org/%7Bda8a8e89-4bb0-421b-bd0e-dbbed3d4ed6a%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/692bf15758111acaddae4da15a47f9e5d=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsCA-0.png"}}, "nickname": "caguero", "type": "user", "account_id": "557058:4ded1ddf-947e-4154-bbd1-3dba24f1bdbd"}, "updated_on": "2018-08-31T16:29:04.741209+00:00", "type": "pullrequest_comment", "id": 74691909}, "pull_request": {"type": "pullrequest", "id": 33, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/33.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/33"}}, "title": "Refactor stats and support play / pause / step"}}, {"update": {"description": "Move time handling to `SimulationRunner`, which means:\r\n\r\n* Remove `WorldStatistics` component and system\r\n* `World` component now is just an identifier like `components::Model` or `components::Link`\r\n* Systems receive `UpdateInfo` at the update callback, which contains info about time and iterations.\r\n* World statistics are published by `SimulationRunner`\r\n* World controls service is provided by `SimulationRunner`\r\n\r\n---\r\n\r\n# Concepts\r\n\r\nSome important ideas, which are open to discussion, are:\r\n\r\n* ECS systems are updated even while paused. This is important for interacting with the GUI.\r\n* While paused, sim iterations and sim time don't increase.\r\n* While paused, the step size (`dt`) passed to each system is zero. Right now, it is up to the system to check that and behave accordingly.\r\n* The step size is 10ms by default (placeholder) and can be overridden from the SDF (`<max_step_size>`).\r\n* The ECS period is calculated based on the step size and the desired RTF, see calculation comments on `SimulationRunner.cc`; it can be overridden from the command line with `-z`\r\n\r\nThe image below summarizes some of these ideas:\r\n\r\n![ECSRTF.png](https://bitbucket.org/repo/8zodKzn/images/1055788081-ECSRTF.png)\r\n\r\n---\r\n\r\n# Demo\r\n\r\n`ign-gazebo -f test/worlds/shapes.sdf  -v 4 -z 3`\r\n\r\n![playpause_pot.gif](https://bitbucket.org/repo/8zodKzn/images/4020974896-playpause_pot.gif)\r\n\r\n---\r\n\r\n# TODO\r\n\r\n* Add tests\r\n* Fix GUI play / pause button - the button should always match the current state\r\n\r\n---\r\n\r\n# Future work\r\n\r\n* Even if I try to run faster than real time, with `-z 10000` for example, the maximum RTF I get is less than 160%. It would be good to port `gazebo_experimental`'s [DiagnosticsManager](https://bitbucket.org/osrf/gazebo_experimental/src/d828f7845f99ecb5da097f1c89b32da809bd9fd9/include/gazebo/util/DiagnosticsManager.hh?fileviewer=file-view-default) here to see what's going on\r\n* Add command line option to start paused", "title": "[WIP] Refactor stats and support play / pause / step", "destination": {"commit": {"hash": "03da0be720cd", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/commit/03da0be720cd.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/commits/03da0be720cd"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{f98d11fe-f287-4dfb-99c3-e2b76a13232e}ts=2082645"}}, "type": "repository", "name": "ign-gazebo", "full_name": "ignitionrobotics/ign-gazebo", "uuid": "{f98d11fe-f287-4dfb-99c3-e2b76a13232e}"}, "branch": {"name": "default"}}, "reason": "", "source": {"commit": {"hash": "b116dc158f14", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/commit/b116dc158f14.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/commits/b116dc158f14"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{f98d11fe-f287-4dfb-99c3-e2b76a13232e}ts=2082645"}}, "type": "repository", "name": "ign-gazebo", "full_name": "ignitionrobotics/ign-gazebo", "uuid": "{f98d11fe-f287-4dfb-99c3-e2b76a13232e}"}, "branch": {"name": "runner_stats"}}, "state": "OPEN", "author": {"display_name": "Louise Poubel", "uuid": "{5cfa2075-477b-4ded-bdb9-8d2479544ec4}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D"}, "html": {"href": "https://bitbucket.org/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8/7d903d90-c5ea-4182-b7ef-0d467e9e1c74/128"}}, "nickname": "chapulina", "type": "user", "account_id": "557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8"}, "date": "2018-08-31T01:49:31.564317+00:00"}, "pull_request": {"type": "pullrequest", "id": 33, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/33.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/33"}}, "title": "Refactor stats and support play / pause / step"}}, {"update": {"description": "Move time handling to `SimulationRunner`, which means:\r\n\r\n* Remove `WorldStatistics` component and system\r\n* `World` component now is just an identifier like `components::Model` or `components::Link`\r\n* Systems receive `UpdateInfo` at the update callback, which contains info about time and iterations.\r\n* World statistics are published by `SimulationRunner`\r\n* World controls service is provided by `SimulationRunner`\r\n\r\n---\r\n\r\n# Concepts\r\n\r\nSome important ideas, which are open to discussion, are:\r\n\r\n* ECS systems are updated even while paused. This is important for interacting with the GUI.\r\n* While paused, sim iterations and sim time don't increase.\r\n* While paused, the step size (`dt`) passed to each system is zero. Right now, it is up to the system to check that and behave accordingly.\r\n* The step size is 10ms by default (placeholder) and can be overridden from the SDF (`<max_step_size>`).\r\n* The ECS period is calculated based on the step size and the desired RTF, see calculation comments on `SimulationRunner.cc`; it can be overridden from the command line with `-z`\r\n\r\nThe image below summarizes some of these ideas:\r\n\r\n![ECSRTF.png](https://bitbucket.org/repo/8zodKzn/images/1055788081-ECSRTF.png)\r\n\r\n---\r\n\r\n# Demo\r\n\r\n`ign-gazebo -f test/worlds/shapes.sdf  -v 4 -z 3`\r\n\r\n![playpause_pot.gif](https://bitbucket.org/repo/8zodKzn/images/4020974896-playpause_pot.gif)\r\n\r\n---\r\n\r\n# TODO\r\n\r\n* Add tests\r\n* Fix GUI play / pause button - the button should always match the current state\r\n\r\n---\r\n\r\n# Future work\r\n\r\n* Even if I try to run faster than real time, with `-z 10000` for example, the maximum RTF I get is less than 160%. It would be good to port `gazebo_experimental`'s [DiagnosticsManager](https://bitbucket.org/osrf/gazebo_experimental/src/d828f7845f99ecb5da097f1c89b32da809bd9fd9/include/gazebo/util/DiagnosticsManager.hh?fileviewer=file-view-default) here to see what's going on\r\n* Add command line option to start paused", "title": "[WIP] Refactor stats and support play / pause / step", "destination": {"commit": {"hash": "03da0be720cd", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/commit/03da0be720cd.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/commits/03da0be720cd"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{f98d11fe-f287-4dfb-99c3-e2b76a13232e}ts=2082645"}}, "type": "repository", "name": "ign-gazebo", "full_name": "ignitionrobotics/ign-gazebo", "uuid": "{f98d11fe-f287-4dfb-99c3-e2b76a13232e}"}, "branch": {"name": "default"}}, "reason": "", "source": {"commit": {"hash": "fa23492433b3", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/commit/fa23492433b3.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/commits/fa23492433b3"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{f98d11fe-f287-4dfb-99c3-e2b76a13232e}ts=2082645"}}, "type": "repository", "name": "ign-gazebo", "full_name": "ignitionrobotics/ign-gazebo", "uuid": "{f98d11fe-f287-4dfb-99c3-e2b76a13232e}"}, "branch": {"name": "runner_stats"}}, "state": "OPEN", "author": {"display_name": "Louise Poubel", "uuid": "{5cfa2075-477b-4ded-bdb9-8d2479544ec4}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D"}, "html": {"href": "https://bitbucket.org/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8/7d903d90-c5ea-4182-b7ef-0d467e9e1c74/128"}}, "nickname": "chapulina", "type": "user", "account_id": "557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8"}, "date": "2018-08-31T00:20:52.276984+00:00"}, "pull_request": {"type": "pullrequest", "id": 33, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/33.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/33"}}, "title": "Refactor stats and support play / pause / step"}}, {"update": {"description": "Move time handling to `SimulationRunner`, which means:\r\n\r\n* Remove `WorldStatistics` component and system\r\n* `World` component now is just an identifier like `components::Model` or `components::Link`\r\n* Systems receive `UpdateInfo` at the update callback, which contains info about time and iterations.\r\n* World statistics are published by `SimulationRunner`\r\n* World controls service is provided by `SimulationRunner`\r\n\r\n---\r\n\r\n# Concepts\r\n\r\nSome important ideas, which are open to discussion, are:\r\n\r\n* ECS systems are updated even while paused. This is important for interacting with the GUI.\r\n* While paused, sim iterations and sim time don't increase.\r\n* While paused, the step size (`dt`) passed to each system is zero. Right now, it is up to the system to check that and behave accordingly.\r\n* The step size is 10ms by default (placeholder) and can be overridden from the SDF (`<max_step_size>`).\r\n* The ECS period is calculated based on the step size and the desired RTF, see calculation comments on `SimulationRunner.cc`; it can be overridden from the command line with `-z`\r\n\r\nThe image below summarizes some of these ideas:\r\n\r\n![ECSRTF.png](https://bitbucket.org/repo/8zodKzn/images/1055788081-ECSRTF.png)\r\n\r\n---\r\n\r\n# Demo\r\n\r\n`ign-gazebo -f test/worlds/shapes.sdf  -v 4 -z 3`\r\n\r\n![playpause_pot.gif](https://bitbucket.org/repo/8zodKzn/images/4020974896-playpause_pot.gif)\r\n\r\n---\r\n\r\n# TODO\r\n\r\n* Check why RTF is so low - right now I'm getting around 0.4 max. I  may have messed the sleep logic.\r\n* Add tests\r\n* Fix GUI play / pause button - the button should always match the current state\r\n* Add command line option to start paused", "title": "[WIP] Refactor stats and support play / pause / step", "destination": {"commit": {"hash": "03da0be720cd", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/commit/03da0be720cd.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/commits/03da0be720cd"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{f98d11fe-f287-4dfb-99c3-e2b76a13232e}ts=2082645"}}, "type": "repository", "name": "ign-gazebo", "full_name": "ignitionrobotics/ign-gazebo", "uuid": "{f98d11fe-f287-4dfb-99c3-e2b76a13232e}"}, "branch": {"name": "default"}}, "reason": "", "source": {"commit": {"hash": "fa23492433b3", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/commit/fa23492433b3.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/commits/fa23492433b3"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{f98d11fe-f287-4dfb-99c3-e2b76a13232e}ts=2082645"}}, "type": "repository", "name": "ign-gazebo", "full_name": "ignitionrobotics/ign-gazebo", "uuid": "{f98d11fe-f287-4dfb-99c3-e2b76a13232e}"}, "branch": {"name": "runner_stats"}}, "state": "OPEN", "author": {"display_name": "Louise Poubel", "uuid": "{5cfa2075-477b-4ded-bdb9-8d2479544ec4}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D"}, "html": {"href": "https://bitbucket.org/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8/7d903d90-c5ea-4182-b7ef-0d467e9e1c74/128"}}, "nickname": "chapulina", "type": "user", "account_id": "557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8"}, "date": "2018-08-31T00:17:06.824996+00:00"}, "pull_request": {"type": "pullrequest", "id": 33, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/33.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/33"}}, "title": "Refactor stats and support play / pause / step"}}, {"update": {"description": "Move time handling to `SimulationRunner`, which means:\r\n\r\n* Remove `WorldStatistics` component and system\r\n* `World` component now is just an identifier like `components::Model` or `components::Link`\r\n* Systems receive `UpdateInfo` at the update callback, which contains info about time and iterations.\r\n* World statistics are published by `SimulationRunner`\r\n* World controls service is provided by `SimulationRunner`\r\n\r\n---\r\n\r\n# Concepts\r\n\r\nSome important ideas, which are open to discussion, are:\r\n\r\n* ECS systems are updated even while paused. This is important for interacting with the GUI.\r\n* While paused, sim iterations and sim time don't increase.\r\n* While paused, the step size (`dt`) passed to each system is zero. Right now, it is up to the system to check that and behave accordingly.\r\n* The step size is 10ms by default (placeholder) and can be overridden from the SDF (`<max_step_size>`).\r\n* The ECS period is calculated based on the step size and the desired RTF, see calculation comments on `SimulationRunner.cc`; it can be overridden from the command line with `-z`\r\n\r\nThe image below summarizes some of these ideas:\r\n\r\n![ECSRTF.png](https://bitbucket.org/repo/8zodKzn/images/1055788081-ECSRTF.png)\r\n\r\n---\r\n\r\n# Demo\r\n\r\n`ign-gazebo -f test/worlds/shapes.sdf  -v 4 -z 3`\r\n\r\n![playpause_pot.gif](https://bitbucket.org/repo/8zodKzn/images/4020974896-playpause_pot.gif)\r\n\r\n---\r\n\r\n# TODO\r\n\r\n* Check why RTF is so low - right now I'm getting around 0.4 max. I  may have messed the sleep logic.\r\n* Add tests\r\n* Fix GUI play / pause button - the button should always match the current state\r\n* Add command line option to start paused", "title": "[WIP] Refactor stats and support play / pause / step", "destination": {"commit": {"hash": "03da0be720cd", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/commit/03da0be720cd.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/commits/03da0be720cd"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{f98d11fe-f287-4dfb-99c3-e2b76a13232e}ts=2082645"}}, "type": "repository", "name": "ign-gazebo", "full_name": "ignitionrobotics/ign-gazebo", "uuid": "{f98d11fe-f287-4dfb-99c3-e2b76a13232e}"}, "branch": {"name": "default"}}, "reason": "", "source": {"commit": {"hash": "841cf0161343", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/commit/841cf0161343.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/commits/841cf0161343"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{f98d11fe-f287-4dfb-99c3-e2b76a13232e}ts=2082645"}}, "type": "repository", "name": "ign-gazebo", "full_name": "ignitionrobotics/ign-gazebo", "uuid": "{f98d11fe-f287-4dfb-99c3-e2b76a13232e}"}, "branch": {"name": "runner_stats"}}, "state": "OPEN", "author": {"display_name": "Louise Poubel", "uuid": "{5cfa2075-477b-4ded-bdb9-8d2479544ec4}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D"}, "html": {"href": "https://bitbucket.org/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8/7d903d90-c5ea-4182-b7ef-0d467e9e1c74/128"}}, "nickname": "chapulina", "type": "user", "account_id": "557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8"}, "date": "2018-08-29T00:34:46.548613+00:00"}, "pull_request": {"type": "pullrequest", "id": 33, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/33.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/33"}}, "title": "Refactor stats and support play / pause / step"}}, {"update": {"description": "Move time handling to `SimulationRunner`, which means:\r\n\r\n* Remove `WorldStatistics` component and system\r\n* `World` component now is just an identifier like `components::Model` or `components::Link`\r\n* Systems receive `UpdateInfo` at the update callback, which contains info about time and iterations.\r\n* World statistics are published by `SimulationRunner`\r\n* World controls service is provided by `SimulationRunner`\r\n\r\n---\r\n\r\n# Concepts\r\n\r\nSome important ideas, which are open to discussion, are:\r\n\r\n* ECS systems are updated even while paused. This is important for interacting with the GUI.\r\n* While paused, sim iterations and sim time don't increase.\r\n* While paused, the step size (`dt`) passed to each system is zero. Right now, it is up to the system to check that and behave accordingly.\r\n* The step size is 10ms by default (placeholder) and can be overridden from the SDF (`<max_step_size>`).\r\n* The ECS period is calculated based on the step size and the desired RTF, see calculation comments on `SimulationRunner.cc`; it can be overridden from the command line with `-z`\r\n\r\nThe image below summarizes some of these ideas:\r\n\r\n![ECSRTF.png](https://bitbucket.org/repo/8zodKzn/images/1055788081-ECSRTF.png)\r\n\r\n---\r\n\r\n# Demo\r\n\r\n![playpause_pot.gif](https://bitbucket.org/repo/8zodKzn/images/4020974896-playpause_pot.gif)\r\n\r\n---\r\n\r\n# TODO\r\n\r\n* Check why RTF is so low - right now I'm getting around 0.4 max. I  may have messed the sleep logic.\r\n* Add tests\r\n* Fix GUI play / pause button - the button should always match the current state\r\n* Add command line option to start paused", "title": "[WIP] Refactor stats and support play / pause / step", "destination": {"commit": {"hash": "03da0be720cd", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/commit/03da0be720cd.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/commits/03da0be720cd"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{f98d11fe-f287-4dfb-99c3-e2b76a13232e}ts=2082645"}}, "type": "repository", "name": "ign-gazebo", "full_name": "ignitionrobotics/ign-gazebo", "uuid": "{f98d11fe-f287-4dfb-99c3-e2b76a13232e}"}, "branch": {"name": "default"}}, "reason": "", "source": {"commit": {"hash": "841cf0161343", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/commit/841cf0161343.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/commits/841cf0161343"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{f98d11fe-f287-4dfb-99c3-e2b76a13232e}ts=2082645"}}, "type": "repository", "name": "ign-gazebo", "full_name": "ignitionrobotics/ign-gazebo", "uuid": "{f98d11fe-f287-4dfb-99c3-e2b76a13232e}"}, "branch": {"name": "runner_stats"}}, "state": "OPEN", "author": {"display_name": "Louise Poubel", "uuid": "{5cfa2075-477b-4ded-bdb9-8d2479544ec4}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D"}, "html": {"href": "https://bitbucket.org/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8/7d903d90-c5ea-4182-b7ef-0d467e9e1c74/128"}}, "nickname": "chapulina", "type": "user", "account_id": "557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8"}, "date": "2018-08-29T00:33:40.019274+00:00"}, "pull_request": {"type": "pullrequest", "id": 33, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/33.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/33"}}, "title": "Refactor stats and support play / pause / step"}}, {"update": {"description": "Move time handling to `SimulationRunner`, which means:\r\n\r\n* Remove `WorldStatistics` component and system\r\n* `World` component now is just an identifier like `components::Model` or `components::Link`\r\n* Systems receive `UpdateInfo` at the update callback, which contains info about time and iterations.\r\n* World statistics are published by `SimulationRunner`\r\n* World controls service is provided by `SimulationRunner`\r\n\r\n---\r\n\r\n# Concepts\r\n\r\nSome important ideas, which are open to discussion, are:\r\n\r\n* ECS systems are updated even while paused. This is important for interacting with the GUI.\r\n* While paused, sim iterations and sim time don't increase.\r\n* While paused, the step size (`dt`) passed to each system is zero. Right now, it is up to the system to check that and behave accordingly.\r\n* The step size is 10ms by default (placeholder) and can be overridden from the SDF (`<max_step_size>`).\r\n* The ECS period is calculated based on the step size and the desired RTF, see calculation comments on `SimulationRunner.cc`; it can be overridden from the command line with `-z`\r\n\r\nThe image below summarizes some of these ideas:\r\n\r\n![ECSRTF.png](https://bitbucket.org/repo/8zodKzn/images/1055788081-ECSRTF.png)\r\n\r\n---\r\n\r\n# Demo\r\n\r\n![playpause_pot.gif](https://bitbucket.org/repo/8zodKzn/images/4020974896-playpause_pot.gif)\r\n\r\n---\r\n\r\n# TODO\r\n\r\n* Check why RTF is so low - right now I'm getting around 0.4 max. I  may have messed the sleep logic.\r\n* Add tests\r\n* Fix GUI play / pause button - the button should always match the current state\r\n* Add command line option to start paused", "title": "[WIP] Refactor stats and support play / pause / step", "destination": {"commit": {"hash": "03da0be720cd", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/commit/03da0be720cd.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/commits/03da0be720cd"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{f98d11fe-f287-4dfb-99c3-e2b76a13232e}ts=2082645"}}, "type": "repository", "name": "ign-gazebo", "full_name": "ignitionrobotics/ign-gazebo", "uuid": "{f98d11fe-f287-4dfb-99c3-e2b76a13232e}"}, "branch": {"name": "default"}}, "reason": "", "source": {"commit": {"hash": "841cf0161343", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/commit/841cf0161343.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/commits/841cf0161343"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{f98d11fe-f287-4dfb-99c3-e2b76a13232e}ts=2082645"}}, "type": "repository", "name": "ign-gazebo", "full_name": "ignitionrobotics/ign-gazebo", "uuid": "{f98d11fe-f287-4dfb-99c3-e2b76a13232e}"}, "branch": {"name": "runner_stats"}}, "state": "OPEN", "author": {"display_name": "Louise Poubel", "uuid": "{5cfa2075-477b-4ded-bdb9-8d2479544ec4}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D"}, "html": {"href": "https://bitbucket.org/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8/7d903d90-c5ea-4182-b7ef-0d467e9e1c74/128"}}, "nickname": "chapulina", "type": "user", "account_id": "557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8"}, "date": "2018-08-29T00:33:39.988792+00:00"}, "pull_request": {"type": "pullrequest", "id": 33, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/33.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/33"}}, "title": "Refactor stats and support play / pause / step"}}]}