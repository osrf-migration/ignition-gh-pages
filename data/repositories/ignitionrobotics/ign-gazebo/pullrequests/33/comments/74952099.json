{"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/33/comments/74952099.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/33/_/diff#comment-74952099"}}, "parent": {"id": 74947678, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/33/comments/74947678.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/33/_/diff#comment-74947678"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 33, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/33.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/33"}}, "title": "Refactor stats and support play / pause / step"}, "content": {"raw": "The evolution of time is deeply linked to updates and iterations, which are handled by `Server` and `SimulationRunner`, so it seemed like time should be handled on a higher level too.\n\nOther benefits:\n\n* Single authority on time - no system can change time and cause iterations and time to mismatch, nor can two systems try to change time at the same time (pun intended :smile: )\n\n* The real time update rate needs to be handled on the server so it can sleep appropriately between updates, and for that it needs the world step size, which could be variable. Keeping all this in the same place seemed cleaner. See your note [here](#!/ignitionrobotics/ign-gazebo/pull-requests/33/refactor-stats-and-support-play-pause-step/diff#Lsrc/SimulationRunner.ccF179).\n\n* This removes the logic which was taking the \"first\" World and WorldStatistics components, which assumed the order in which components are created is important, and that components have a meaning outside their entities.\n\nThat said, I can see the advantage of keeping the statistics publishing into a system. This way, users could turn off the publishing by removing the system and RTF computation can be moved to a separate thread. Handling world controls from a system would not be possible though, since systems curently can't affect time.", "markup": "markdown", "html": "<p>The evolution of time is deeply linked to updates and iterations, which are handled by <code>Server</code> and <code>SimulationRunner</code>, so it seemed like time should be handled on a higher level too.</p>\n<p>Other benefits:</p>\n<ul>\n<li>\n<p>Single authority on time - no system can change time and cause iterations and time to mismatch, nor can two systems try to change time at the same time (pun intended <img class=\"emoji\" src=\"data/pf-emoji-service--cdn.us-east-1.prod.public.atl-paas.net/standard/551c9814-1d37-4573-819d-afab3afeaf32/48x48/1f604.png\" alt=\"\ud83d\ude04\" title=\":smile:\" data-emoji-short-name=\":smile:\" /> )</p>\n</li>\n<li>\n<p>The real time update rate needs to be handled on the server so it can sleep appropriately between updates, and for that it needs the world step size, which could be variable. Keeping all this in the same place seemed cleaner. See your note <a data-is-external-link=\"true\" href=\"#!/ignitionrobotics/ign-gazebo/pull-requests/33/refactor-stats-and-support-play-pause-step/diff#Lsrc/SimulationRunner.ccF179\" rel=\"nofollow\">here</a>.</p>\n</li>\n<li>\n<p>This removes the logic which was taking the \"first\" World and WorldStatistics components, which assumed the order in which components are created is important, and that components have a meaning outside their entities.</p>\n</li>\n</ul>\n<p>That said, I can see the advantage of keeping the statistics publishing into a system. This way, users could turn off the publishing by removing the system and RTF computation can be moved to a separate thread. Handling world controls from a system would not be possible though, since systems curently can't affect time.</p>", "type": "rendered"}, "created_on": "2018-09-04T18:49:39.422812+00:00", "user": {"display_name": "Louise Poubel", "uuid": "{5cfa2075-477b-4ded-bdb9-8d2479544ec4}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D"}, "html": {"href": "https://bitbucket.org/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8/7d903d90-c5ea-4182-b7ef-0d467e9e1c74/128"}}, "nickname": "chapulina", "type": "user", "account_id": "557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8"}, "updated_on": "2018-09-04T18:49:59.613267+00:00", "type": "pullrequest_comment", "id": 74952099}