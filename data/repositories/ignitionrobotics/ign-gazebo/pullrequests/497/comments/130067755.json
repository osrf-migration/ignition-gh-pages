{"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/497/comments/130067755.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/497/_/diff#comment-130067755"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 497, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/497.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/497"}}, "title": "Log record overwrite"}, "content": {"raw": "There is an ambiguity exposed in tests 1 and 2 that I think a user would be very confused about.\n\nThe behavior of whether to overwrite is very ambiguous right now. We made the default behavior of the `LogRecord` plugin to overwrite, because it assumes that `ign.cc` takes care of whether to overwrite. However, when `ign.cc` does not take care of that, which happens in the case when no `--record` is specified on the command line, the plugin is specified only in the SDF, then the behavior is to overwrite.\n\nIt means this command \\(the SDF specifies path `/tmp/log`\\)\n\n```\n$ ign gazebo -v 4 -r examples/worlds/log_record_dbl_pendulum.sdf\n```\n\nwill overwrite if `/tmp/log` already exists, because the record plugin is only specified in SDF, so the log path is initialized in `LogRecord.cc` without going through the recording if-statement in `ign.cc`.\n\nBut this command\n\n```\n$ ign gazebo -v 4 -r examples/worlds/log_record_dbl_pendulum.sdf --record-path '/tmp/log'\n```\n\nwill not overwrite; it will create a unique path of `/tmp/log(1)` if `/tmp/log` already exists, because `--record-path` will activate the if-statement in `ign.cc` to initialize a `ignLogDirectory()`.\n\nWhile this command\n\n```\n$ ign gazebo -v 4 -r examples/worlds/log_record_dbl_pendulum.sdf --log-overwrite --record-path '/tmp/log'\n```\n\nwill overwrite.\n\nTo the user, the first and second commands should behave the same way. I think what should happen is that the first command should not overwrite. That can be implemented if we do not assume in `LogRecord.cc` that the path is taken care of in `ign.cc`, and revert to the original recorder\u2019s behavior that a unique path be created in `LogRecord.cc`. Now that we have the `--log-overwrite` flag, this makes sense to do. Otherwise in command 1 above, there is no option to not overwrite \\(we do not handle an <overwrite> tag in SDF, because we want `ign.cc` to handle all the overwriting, and there is nothing like `--log-dont-overwrite`\\).", "markup": "markdown", "html": "<p>There is an ambiguity exposed in tests 1 and 2 that I think a user would be very confused about.</p>\n<p>The behavior of whether to overwrite is very ambiguous right now. We made the default behavior of the <code>LogRecord</code> plugin to overwrite, because it assumes that <code>ign.cc</code> takes care of whether to overwrite. However, when <code>ign.cc</code> does not take care of that, which happens in the case when no <code>--record</code> is specified on the command line, the plugin is specified only in the SDF, then the behavior is to overwrite.</p>\n<p>It means this command (the SDF specifies path <code>/tmp/log</code>)</p>\n<div class=\"codehilite\"><pre><span></span>$ ign gazebo -v <span class=\"m\">4</span> -r examples/worlds/log_record_dbl_pendulum.sdf\n</pre></div>\n\n\n<p>will overwrite if <code>/tmp/log</code> already exists, because the record plugin is only specified in SDF, so the log path is initialized in <code>LogRecord.cc</code> without going through the recording if-statement in <code>ign.cc</code>.</p>\n<p>But this command</p>\n<div class=\"codehilite\"><pre><span></span>$ ign gazebo -v <span class=\"m\">4</span> -r examples/worlds/log_record_dbl_pendulum.sdf --record-path <span class=\"s1\">&#39;/tmp/log&#39;</span>\n</pre></div>\n\n\n<p>will not overwrite; it will create a unique path of <code>/tmp/log(1)</code> if <code>/tmp/log</code> already exists, because <code>--record-path</code> will activate the if-statement in <code>ign.cc</code> to initialize a <code>ignLogDirectory()</code>.</p>\n<p>While this command</p>\n<div class=\"codehilite\"><pre><span></span>$ ign gazebo -v <span class=\"m\">4</span> -r examples/worlds/log_record_dbl_pendulum.sdf --log-overwrite --record-path <span class=\"s1\">&#39;/tmp/log&#39;</span>\n</pre></div>\n\n\n<p>will overwrite.</p>\n<p>To the user, the first and second commands should behave the same way. I think what should happen is that the first command should not overwrite. That can be implemented if we do not assume in <code>LogRecord.cc</code> that the path is taken care of in <code>ign.cc</code>, and revert to the original recorder\u2019s behavior that a unique path be created in <code>LogRecord.cc</code>. Now that we have the <code>--log-overwrite</code> flag, this makes sense to do. Otherwise in command 1 above, there is no option to not overwrite (we do not handle an &lt;overwrite&gt; tag in SDF, because we want <code>ign.cc</code> to handle all the overwriting, and there is nothing like <code>--log-dont-overwrite</code>).</p>", "type": "rendered"}, "created_on": "2019-12-28T09:56:21.255907+00:00", "user": {"display_name": "Mabel Zhang", "uuid": "{4b0e38fb-bf50-45c0-a496-61147518b2bf}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B4b0e38fb-bf50-45c0-a496-61147518b2bf%7D"}, "html": {"href": "https://bitbucket.org/%7B4b0e38fb-bf50-45c0-a496-61147518b2bf%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:ceb5942c-6843-408c-8550-3ce4899d299b/4d48e5ea-cf28-4fa7-9715-8fc9e315d831/128"}}, "nickname": "mabelmzhang", "type": "user", "account_id": "557058:ceb5942c-6843-408c-8550-3ce4899d299b"}, "updated_on": "2019-12-28T09:58:08.198569+00:00", "type": "pullrequest_comment", "id": 130067755}