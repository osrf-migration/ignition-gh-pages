{"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/579/comments/144727394.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/579/_/diff#comment-144727394"}}, "parent": {"id": 144608502, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/579/comments/144608502.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/579/_/diff#comment-144608502"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 579, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/579.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/579"}}, "title": "Actor skeleton animation (auto update mode)"}, "content": {"raw": "the longer load time is mainly from loading the animations into the render engine. One of the actors have 8 animations so the load time is more noticeable.\n\nI\u2019ll keep the trajectory stuff in there for now. We can update it later.\n\nI added `actor_crowd.sdf` for performance testing and fixed an issue with loading duplicate animations in [6d375c7](#!/ignitionrobotics/ign-gazebo/commits/6d375c7929585fa023ea643db16cbd5320c43dce) . The RTF is still 100% for me in both modes as that comes from the server.  The screenshot below shows profiling using remotery:  manual update \\(top\\) and auto update \\(bottom\\). There is slight performance improvement in `RenderUtil::Update Poses` when making the ign-rendering calls to animate actors. But the real saving is implicitly captured by `RenderUtil::Update` that went down from ~32.635 ms to 2.366 ms. In manual mode, it was constantly blocked on a mutex waiting for the skeleton local transforms to be computed, confirmed by manually profiling the [Each](#!/ignitionrobotics/ign-gazebo/src/b23ca11d8c419d4e9f63736b4b09f76dcfba5bfb/src/rendering/RenderUtil.cc#lines-1009) function that computes these transforms which shows that it takes 2x ms.\n\n![](data/bitbucket.org/repo/8zodKzn/images/1391461063-actor_manual_auto.png)\n\u200c", "markup": "markdown", "html": "<p>the longer load time is mainly from loading the animations into the render engine. One of the actors have 8 animations so the load time is more noticeable.</p>\n<p>I\u2019ll keep the trajectory stuff in there for now. We can update it later.</p>\n<p>I added <code>actor_crowd.sdf</code> for performance testing and fixed an issue with loading duplicate animations in <a data-is-external-link=\"true\" href=\"#!/ignitionrobotics/ign-gazebo/commits/6d375c7929585fa023ea643db16cbd5320c43dce\" rel=\"nofollow\">6d375c7</a> . The RTF is still 100% for me in both modes as that comes from the server.  The screenshot below shows profiling using remotery:  manual update (top) and auto update (bottom). There is slight performance improvement in <code>RenderUtil::Update Poses</code> when making the ign-rendering calls to animate actors. But the real saving is implicitly captured by <code>RenderUtil::Update</code> that went down from ~32.635 ms to 2.366 ms. In manual mode, it was constantly blocked on a mutex waiting for the skeleton local transforms to be computed, confirmed by manually profiling the <a data-is-external-link=\"true\" href=\"#!/ignitionrobotics/ign-gazebo/src/b23ca11d8c419d4e9f63736b4b09f76dcfba5bfb/src/rendering/RenderUtil.cc#lines-1009\" rel=\"nofollow\">Each</a> function that computes these transforms which shows that it takes 2x ms.</p>\n<p><img alt=\"\" src=\"data/bitbucket.org/repo/8zodKzn/images/1391461063-actor_manual_auto.png\" />\n\u200c</p>", "type": "rendered"}, "created_on": "2020-04-10T23:43:54.310700+00:00", "user": {"display_name": "Ian Chen", "uuid": "{eaa6fca5-6deb-43f6-907f-971c144735dd}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Beaa6fca5-6deb-43f6-907f-971c144735dd%7D"}, "html": {"href": "https://bitbucket.org/%7Beaa6fca5-6deb-43f6-907f-971c144735dd%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:10b01d41-a2e9-4a41-a907-e6e2f03b6cd5/1e4adcdf-1946-4280-9aea-eb5f15a7f912/128"}}, "nickname": "Ian Chen", "type": "user", "account_id": "557058:10b01d41-a2e9-4a41-a907-e6e2f03b6cd5"}, "updated_on": "2020-04-10T23:43:54.315051+00:00", "type": "pullrequest_comment", "id": 144727394}