{"pagelen": 50, "values": [{"update": {"description": "The general idea here is put each of the `PostUpdate` calls \\(for systems that implement them\\) in their own worker thread. They are syncronized via two barriers \\(which isn\u2019t in the C\\+\\+ standard yet\\).\r\n\r\nCreating a thread and using a barrier ends up being slightly more efficient than the ign::common::WorkerPool, because we aren\u2019t creating and destroying WorkOrders in each loop. This is only really possible because we\u2019re making the same function calls repeatedly.\r\n\r\nThe barriers will block until all threads have reached the `barrier.wait()` call. This is why the barriers are constructed with a count of `number of postupdates + 1 (for the main thread)`\r\n\r\nEdit:\r\n\r\nThis now includes a worker thread for rendering sensors, causing rendering updates to happen in parallel with the main thread.  In the case that a new rendering operation is required, the main thread will block until the previous one is complete.  \r\n\r\nThis generally eliminates frames that substantially overran their allotted time \\(a rendering update could take 30-60x the allotted time\\).", "title": "Add worker threads for System PostUpdate phase", "destination": {"commit": {"hash": "cc505203a1d8", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/commit/cc505203a1d8.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/commits/cc505203a1d8"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{f98d11fe-f287-4dfb-99c3-e2b76a13232e}ts=2082645"}}, "type": "repository", "name": "ign-gazebo", "full_name": "ignitionrobotics/ign-gazebo", "uuid": "{f98d11fe-f287-4dfb-99c3-e2b76a13232e}"}, "branch": {"name": "ign-gazebo2"}}, "reason": "", "source": {"commit": {"hash": "5fc2091317a6", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/commit/5fc2091317a6.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/commits/5fc2091317a6"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{f98d11fe-f287-4dfb-99c3-e2b76a13232e}ts=2082645"}}, "type": "repository", "name": "ign-gazebo", "full_name": "ignitionrobotics/ign-gazebo", "uuid": "{f98d11fe-f287-4dfb-99c3-e2b76a13232e}"}, "branch": {"name": "thread_postupdate"}}, "state": "MERGED", "author": {"display_name": "Nate Koenig", "uuid": "{c862cdd9-fcc8-4419-9fc7-e20db14b8fcb}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Bc862cdd9-fcc8-4419-9fc7-e20db14b8fcb%7D"}, "html": {"href": "https://bitbucket.org/%7Bc862cdd9-fcc8-4419-9fc7-e20db14b8fcb%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:095b1e12-74ed-4e20-b44f-2f0745b616e0/ca24bb11-4787-4b14-a20d-d91835e9bde2/128"}}, "nickname": "Nathan Koenig", "type": "user", "account_id": "557058:095b1e12-74ed-4e20-b44f-2f0745b616e0"}, "date": "2019-08-02T18:38:07.835996+00:00"}, "pull_request": {"type": "pullrequest", "id": 387, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/387.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/387"}}, "title": "Add worker threads for System PostUpdate phase"}}, {"update": {"description": "The general idea here is put each of the `PostUpdate` calls \\(for systems that implement them\\) in their own worker thread. They are syncronized via two barriers \\(which isn\u2019t in the C\\+\\+ standard yet\\).\r\n\r\nCreating a thread and using a barrier ends up being slightly more efficient than the ign::common::WorkerPool, because we aren\u2019t creating and destroying WorkOrders in each loop. This is only really possible because we\u2019re making the same function calls repeatedly.\r\n\r\nThe barriers will block until all threads have reached the `barrier.wait()` call. This is why the barriers are constructed with a count of `number of postupdates + 1 (for the main thread)`\r\n\r\nEdit:\r\n\r\nThis now includes a worker thread for rendering sensors, causing rendering updates to happen in parallel with the main thread.  In the case that a new rendering operation is required, the main thread will block until the previous one is complete.  \r\n\r\nThis generally eliminates frames that substantially overran their allotted time \\(a rendering update could take 30-60x the allotted time\\).", "title": "Add worker threads for System PostUpdate phase", "destination": {"commit": {"hash": "cc505203a1d8", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/commit/cc505203a1d8.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/commits/cc505203a1d8"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{f98d11fe-f287-4dfb-99c3-e2b76a13232e}ts=2082645"}}, "type": "repository", "name": "ign-gazebo", "full_name": "ignitionrobotics/ign-gazebo", "uuid": "{f98d11fe-f287-4dfb-99c3-e2b76a13232e}"}, "branch": {"name": "ign-gazebo2"}}, "reason": "", "source": {"commit": {"hash": "5fc2091317a6", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/commit/5fc2091317a6.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/commits/5fc2091317a6"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{f98d11fe-f287-4dfb-99c3-e2b76a13232e}ts=2082645"}}, "type": "repository", "name": "ign-gazebo", "full_name": "ignitionrobotics/ign-gazebo", "uuid": "{f98d11fe-f287-4dfb-99c3-e2b76a13232e}"}, "branch": {"name": "thread_postupdate"}}, "state": "OPEN", "author": {"display_name": "Nate Koenig", "uuid": "{c862cdd9-fcc8-4419-9fc7-e20db14b8fcb}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Bc862cdd9-fcc8-4419-9fc7-e20db14b8fcb%7D"}, "html": {"href": "https://bitbucket.org/%7Bc862cdd9-fcc8-4419-9fc7-e20db14b8fcb%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:095b1e12-74ed-4e20-b44f-2f0745b616e0/ca24bb11-4787-4b14-a20d-d91835e9bde2/128"}}, "nickname": "Nathan Koenig", "type": "user", "account_id": "557058:095b1e12-74ed-4e20-b44f-2f0745b616e0"}, "date": "2019-08-02T18:37:48.699194+00:00"}, "pull_request": {"type": "pullrequest", "id": 387, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/387.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/387"}}, "title": "Add worker threads for System PostUpdate phase"}}, {"approval": {"date": "2019-08-02T17:02:50.232851+00:00", "pullrequest": {"type": "pullrequest", "id": 387, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/387.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/387"}}, "title": "Add worker threads for System PostUpdate phase"}, "user": {"display_name": "Addisu Z. Taddese", "uuid": "{9d7fdc68-d270-4080-bf03-4df0d0dbf635}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B9d7fdc68-d270-4080-bf03-4df0d0dbf635%7D"}, "html": {"href": "https://bitbucket.org/%7B9d7fdc68-d270-4080-bf03-4df0d0dbf635%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:90bc87b0-2886-4377-a17c-3a6629a697ff/afbf9be5-1e4c-4810-89d4-e58831f34b11/128"}}, "nickname": "azeey", "type": "user", "account_id": "557058:90bc87b0-2886-4377-a17c-3a6629a697ff"}}, "pull_request": {"type": "pullrequest", "id": 387, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/387.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/387"}}, "title": "Add worker threads for System PostUpdate phase"}}, {"comment": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/387/comments/111762225.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/387/_/diff#comment-111762225"}}, "parent": {"id": 111761840, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/387/comments/111761840.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/387/_/diff#comment-111761840"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 387, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/387.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/387"}}, "title": "Add worker threads for System PostUpdate phase"}, "content": {"raw": "Okay. Just to be clear, my comment only applied only to the threading inside the Sensors system, not threading post updates in general. The flag could be passed in as an element of the `<plugin>` tag for the the sensor system.", "markup": "markdown", "html": "<p>Okay. Just to be clear, my comment only applied only to the threading inside the Sensors system, not threading post updates in general. The flag could be passed in as an element of the <code>&lt;plugin&gt;</code> tag for the the sensor system.</p>", "type": "rendered"}, "created_on": "2019-08-02T17:01:06.584899+00:00", "user": {"display_name": "Addisu Z. Taddese", "uuid": "{9d7fdc68-d270-4080-bf03-4df0d0dbf635}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B9d7fdc68-d270-4080-bf03-4df0d0dbf635%7D"}, "html": {"href": "https://bitbucket.org/%7B9d7fdc68-d270-4080-bf03-4df0d0dbf635%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:90bc87b0-2886-4377-a17c-3a6629a697ff/afbf9be5-1e4c-4810-89d4-e58831f34b11/128"}}, "nickname": "azeey", "type": "user", "account_id": "557058:90bc87b0-2886-4377-a17c-3a6629a697ff"}, "updated_on": "2019-08-02T17:01:06.594684+00:00", "type": "pullrequest_comment", "id": 111762225}, "pull_request": {"type": "pullrequest", "id": 387, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/387.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/387"}}, "title": "Add worker threads for System PostUpdate phase"}}, {"comment": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/387/comments/111761840.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/387/_/diff#comment-111761840"}}, "parent": {"id": 111757433, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/387/comments/111757433.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/387/_/diff#comment-111757433"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 387, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/387.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/387"}}, "title": "Add worker threads for System PostUpdate phase"}, "content": {"raw": "Good idea. I've created issue #34 to capture this. It will be important to add this in, but not directly needed by subt at the moment.", "markup": "markdown", "html": "<p>Good idea. I've created issue <a href=\"#!/ignitionrobotics/ign-gazebo/issues/34/support-disabling-threading\" rel=\"nofollow\" title=\"Support disabling threading\" class=\"ap-connect-link\">#34</a> to capture this. It will be important to add this in, but not directly needed by subt at the moment.</p>", "type": "rendered"}, "created_on": "2019-08-02T16:57:07.836810+00:00", "user": {"display_name": "Nate Koenig", "uuid": "{c862cdd9-fcc8-4419-9fc7-e20db14b8fcb}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Bc862cdd9-fcc8-4419-9fc7-e20db14b8fcb%7D"}, "html": {"href": "https://bitbucket.org/%7Bc862cdd9-fcc8-4419-9fc7-e20db14b8fcb%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:095b1e12-74ed-4e20-b44f-2f0745b616e0/ca24bb11-4787-4b14-a20d-d91835e9bde2/128"}}, "nickname": "Nathan Koenig", "type": "user", "account_id": "557058:095b1e12-74ed-4e20-b44f-2f0745b616e0"}, "updated_on": "2019-08-02T16:57:07.849811+00:00", "type": "pullrequest_comment", "id": 111761840}, "pull_request": {"type": "pullrequest", "id": 387, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/387.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/387"}}, "title": "Add worker threads for System PostUpdate phase"}}, {"comment": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/387/comments/111757433.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/387/_/diff#comment-111757433"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 387, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/387.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/387"}}, "title": "Add worker threads for System PostUpdate phase"}, "content": {"raw": "Should we make the threading inside the Sensors system optional? I say this because while the running the rendering task in the background increases performance, it introduces latency in the rendered image. i.e, the image rendered will be from `n` time steps ago and `n` is not a fixed number. I imagine some of users of ign-gazebo might be okay with taking performance hit in exchange for having no sensor latency.", "markup": "markdown", "html": "<p>Should we make the threading inside the Sensors system optional? I say this because while the running the rendering task in the background increases performance, it introduces latency in the rendered image. i.e, the image rendered will be from <code>n</code> time steps ago and <code>n</code> is not a fixed number. I imagine some of users of ign-gazebo might be okay with taking performance hit in exchange for having no sensor latency.</p>", "type": "rendered"}, "created_on": "2019-08-02T16:12:47.700932+00:00", "user": {"display_name": "Addisu Z. Taddese", "uuid": "{9d7fdc68-d270-4080-bf03-4df0d0dbf635}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B9d7fdc68-d270-4080-bf03-4df0d0dbf635%7D"}, "html": {"href": "https://bitbucket.org/%7B9d7fdc68-d270-4080-bf03-4df0d0dbf635%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:90bc87b0-2886-4377-a17c-3a6629a697ff/afbf9be5-1e4c-4810-89d4-e58831f34b11/128"}}, "nickname": "azeey", "type": "user", "account_id": "557058:90bc87b0-2886-4377-a17c-3a6629a697ff"}, "updated_on": "2019-08-02T16:12:47.708418+00:00", "type": "pullrequest_comment", "id": 111757433}, "pull_request": {"type": "pullrequest", "id": 387, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/387.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/387"}}, "title": "Add worker threads for System PostUpdate phase"}}, {"approval": {"date": "2019-07-31T22:59:59.714198+00:00", "pullrequest": {"type": "pullrequest", "id": 387, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/387.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/387"}}, "title": "Add worker threads for System PostUpdate phase"}, "user": {"display_name": "Nate Koenig", "uuid": "{c862cdd9-fcc8-4419-9fc7-e20db14b8fcb}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Bc862cdd9-fcc8-4419-9fc7-e20db14b8fcb%7D"}, "html": {"href": "https://bitbucket.org/%7Bc862cdd9-fcc8-4419-9fc7-e20db14b8fcb%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:095b1e12-74ed-4e20-b44f-2f0745b616e0/ca24bb11-4787-4b14-a20d-d91835e9bde2/128"}}, "nickname": "Nathan Koenig", "type": "user", "account_id": "557058:095b1e12-74ed-4e20-b44f-2f0745b616e0"}}, "pull_request": {"type": "pullrequest", "id": 387, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/387.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/387"}}, "title": "Add worker threads for System PostUpdate phase"}}, {"update": {"description": "The general idea here is put each of the `PostUpdate` calls \\(for systems that implement them\\) in their own worker thread. They are syncronized via two barriers \\(which isn\u2019t in the C\\+\\+ standard yet\\).\r\n\r\nCreating a thread and using a barrier ends up being slightly more efficient than the ign::common::WorkerPool, because we aren\u2019t creating and destroying WorkOrders in each loop. This is only really possible because we\u2019re making the same function calls repeatedly.\r\n\r\nThe barriers will block until all threads have reached the `barrier.wait()` call. This is why the barriers are constructed with a count of `number of postupdates + 1 (for the main thread)`\r\n\r\nEdit:\r\n\r\nThis now includes a worker thread for rendering sensors, causing rendering updates to happen in parallel with the main thread.  In the case that a new rendering operation is required, the main thread will block until the previous one is complete.  \r\n\r\nThis generally eliminates frames that substantially overran their allotted time \\(a rendering update could take 30-60x the allotted time\\).", "title": "Add worker threads for System PostUpdate phase", "destination": {"commit": {"hash": "cc505203a1d8", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/commit/cc505203a1d8.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/commits/cc505203a1d8"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{f98d11fe-f287-4dfb-99c3-e2b76a13232e}ts=2082645"}}, "type": "repository", "name": "ign-gazebo", "full_name": "ignitionrobotics/ign-gazebo", "uuid": "{f98d11fe-f287-4dfb-99c3-e2b76a13232e}"}, "branch": {"name": "ign-gazebo2"}}, "reason": "", "source": {"commit": {"hash": "ab4af815ee0f", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/commit/ab4af815ee0f.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/commits/ab4af815ee0f"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{f98d11fe-f287-4dfb-99c3-e2b76a13232e}ts=2082645"}}, "type": "repository", "name": "ign-gazebo", "full_name": "ignitionrobotics/ign-gazebo", "uuid": "{f98d11fe-f287-4dfb-99c3-e2b76a13232e}"}, "branch": {"name": "thread_postupdate"}}, "state": "OPEN", "author": {"display_name": "Michael Carroll", "uuid": "{17dbbc15-cbc0-42f0-a985-cde9061c78a0}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B17dbbc15-cbc0-42f0-a985-cde9061c78a0%7D"}, "html": {"href": "https://bitbucket.org/%7B17dbbc15-cbc0-42f0-a985-cde9061c78a0%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:65740f22-cc56-4418-9608-7e17d0ed47b7/2aa259f5-4de1-4f68-9156-eded72041d84/128"}}, "nickname": "Michael Carroll", "type": "user", "account_id": "557058:65740f22-cc56-4418-9608-7e17d0ed47b7"}, "date": "2019-07-31T21:00:04.388808+00:00"}, "pull_request": {"type": "pullrequest", "id": 387, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/387.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/387"}}, "title": "Add worker threads for System PostUpdate phase"}}, {"comment": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/387/comments/111462519.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/387/_/diff#comment-111462519"}}, "parent": {"id": 111457497, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/387/comments/111457497.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/387/_/diff#comment-111457497"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 387, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/387.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/387"}}, "title": "Add worker threads for System PostUpdate phase"}, "content": {"raw": "Done!", "markup": "markdown", "html": "<p>Done!</p>", "type": "rendered"}, "created_on": "2019-07-31T20:49:32.518409+00:00", "user": {"display_name": "Michael Carroll", "uuid": "{17dbbc15-cbc0-42f0-a985-cde9061c78a0}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B17dbbc15-cbc0-42f0-a985-cde9061c78a0%7D"}, "html": {"href": "https://bitbucket.org/%7B17dbbc15-cbc0-42f0-a985-cde9061c78a0%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:65740f22-cc56-4418-9608-7e17d0ed47b7/2aa259f5-4de1-4f68-9156-eded72041d84/128"}}, "nickname": "Michael Carroll", "type": "user", "account_id": "557058:65740f22-cc56-4418-9608-7e17d0ed47b7"}, "updated_on": "2019-07-31T20:49:32.528361+00:00", "type": "pullrequest_comment", "id": 111462519}, "pull_request": {"type": "pullrequest", "id": 387, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/387.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/387"}}, "title": "Add worker threads for System PostUpdate phase"}}, {"comment": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/387/comments/111457497.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/387/_/diff#comment-111457497"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 387, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/387.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/387"}}, "title": "Add worker threads for System PostUpdate phase"}, "content": {"raw": "Can you add to the Changelog please? After that, it looks good to me.", "markup": "markdown", "html": "<p>Can you add to the Changelog please? After that, it looks good to me.</p>", "type": "rendered"}, "created_on": "2019-07-31T20:01:36.637828+00:00", "user": {"display_name": "Nate Koenig", "uuid": "{c862cdd9-fcc8-4419-9fc7-e20db14b8fcb}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Bc862cdd9-fcc8-4419-9fc7-e20db14b8fcb%7D"}, "html": {"href": "https://bitbucket.org/%7Bc862cdd9-fcc8-4419-9fc7-e20db14b8fcb%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:095b1e12-74ed-4e20-b44f-2f0745b616e0/ca24bb11-4787-4b14-a20d-d91835e9bde2/128"}}, "nickname": "Nathan Koenig", "type": "user", "account_id": "557058:095b1e12-74ed-4e20-b44f-2f0745b616e0"}, "updated_on": "2019-07-31T20:01:36.648868+00:00", "type": "pullrequest_comment", "id": 111457497}, "pull_request": {"type": "pullrequest", "id": 387, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/387.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/387"}}, "title": "Add worker threads for System PostUpdate phase"}}, {"comment": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/387/comments/111455949.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/387/_/diff#comment-111455949"}}, "parent": {"id": 111431705, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/387/comments/111431705.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/387/_/diff#comment-111431705"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 387, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/387.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/387"}}, "title": "Add worker threads for System PostUpdate phase"}, "content": {"raw": "Documentation updated in bbc292c", "markup": "markdown", "html": "<p>Documentation updated in <a href=\"#!/ignitionrobotics/ign-gazebo/commits/bbc292c\" rel=\"nofollow\" class=\"ap-connect-link\">bbc292c</a></p>", "type": "rendered"}, "created_on": "2019-07-31T19:47:24.351528+00:00", "user": {"display_name": "Michael Carroll", "uuid": "{17dbbc15-cbc0-42f0-a985-cde9061c78a0}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B17dbbc15-cbc0-42f0-a985-cde9061c78a0%7D"}, "html": {"href": "https://bitbucket.org/%7B17dbbc15-cbc0-42f0-a985-cde9061c78a0%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:65740f22-cc56-4418-9608-7e17d0ed47b7/2aa259f5-4de1-4f68-9156-eded72041d84/128"}}, "nickname": "Michael Carroll", "type": "user", "account_id": "557058:65740f22-cc56-4418-9608-7e17d0ed47b7"}, "inline": {}, "updated_on": "2019-07-31T19:47:24.370248+00:00", "type": "pullrequest_comment", "id": 111455949}, "pull_request": {"type": "pullrequest", "id": 387, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/387.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/387"}}, "title": "Add worker threads for System PostUpdate phase"}}, {"update": {"description": "The general idea here is put each of the `PostUpdate` calls \\(for systems that implement them\\) in their own worker thread. They are syncronized via two barriers \\(which isn\u2019t in the C\\+\\+ standard yet\\).\r\n\r\nCreating a thread and using a barrier ends up being slightly more efficient than the ign::common::WorkerPool, because we aren\u2019t creating and destroying WorkOrders in each loop. This is only really possible because we\u2019re making the same function calls repeatedly.\r\n\r\nThe barriers will block until all threads have reached the `barrier.wait()` call. This is why the barriers are constructed with a count of `number of postupdates + 1 (for the main thread)`\r\n\r\nEdit:\r\n\r\nThis now includes a worker thread for rendering sensors, causing rendering updates to happen in parallel with the main thread.  In the case that a new rendering operation is required, the main thread will block until the previous one is complete.  \r\n\r\nThis generally eliminates frames that substantially overran their allotted time \\(a rendering update could take 30-60x the allotted time\\).", "title": "Add worker threads for System PostUpdate phase", "destination": {"commit": {"hash": "cc505203a1d8", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/commit/cc505203a1d8.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/commits/cc505203a1d8"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{f98d11fe-f287-4dfb-99c3-e2b76a13232e}ts=2082645"}}, "type": "repository", "name": "ign-gazebo", "full_name": "ignitionrobotics/ign-gazebo", "uuid": "{f98d11fe-f287-4dfb-99c3-e2b76a13232e}"}, "branch": {"name": "ign-gazebo2"}}, "reason": "", "source": {"commit": {"hash": "bbc292c0ced5", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/commit/bbc292c0ced5.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/commits/bbc292c0ced5"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{f98d11fe-f287-4dfb-99c3-e2b76a13232e}ts=2082645"}}, "type": "repository", "name": "ign-gazebo", "full_name": "ignitionrobotics/ign-gazebo", "uuid": "{f98d11fe-f287-4dfb-99c3-e2b76a13232e}"}, "branch": {"name": "thread_postupdate"}}, "state": "OPEN", "author": {"display_name": "Michael Carroll", "uuid": "{17dbbc15-cbc0-42f0-a985-cde9061c78a0}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B17dbbc15-cbc0-42f0-a985-cde9061c78a0%7D"}, "html": {"href": "https://bitbucket.org/%7B17dbbc15-cbc0-42f0-a985-cde9061c78a0%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:65740f22-cc56-4418-9608-7e17d0ed47b7/2aa259f5-4de1-4f68-9156-eded72041d84/128"}}, "nickname": "Michael Carroll", "type": "user", "account_id": "557058:65740f22-cc56-4418-9608-7e17d0ed47b7"}, "date": "2019-07-31T19:46:58.002167+00:00"}, "pull_request": {"type": "pullrequest", "id": 387, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/387.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/387"}}, "title": "Add worker threads for System PostUpdate phase"}}, {"update": {"description": "The general idea here is put each of the `PostUpdate` calls \\(for systems that implement them\\) in their own worker thread. They are syncronized via two barriers \\(which isn\u2019t in the C\\+\\+ standard yet\\).\r\n\r\nCreating a thread and using a barrier ends up being slightly more efficient than the ign::common::WorkerPool, because we aren\u2019t creating and destroying WorkOrders in each loop. This is only really possible because we\u2019re making the same function calls repeatedly.\r\n\r\nThe barriers will block until all threads have reached the `barrier.wait()` call. This is why the barriers are constructed with a count of `number of postupdates + 1 (for the main thread)`\r\n\r\nEdit:\r\n\r\nThis now includes a worker thread for rendering sensors, causing rendering updates to happen in parallel with the main thread.  In the case that a new rendering operation is required, the main thread will block until the previous one is complete.  \r\n\r\nThis generally eliminates frames that substantially overran their allotted time \\(a rendering update could take 30-60x the allotted time\\).", "title": "Add worker threads for System PostUpdate phase", "destination": {"commit": {"hash": "cc505203a1d8", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/commit/cc505203a1d8.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/commits/cc505203a1d8"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{f98d11fe-f287-4dfb-99c3-e2b76a13232e}ts=2082645"}}, "type": "repository", "name": "ign-gazebo", "full_name": "ignitionrobotics/ign-gazebo", "uuid": "{f98d11fe-f287-4dfb-99c3-e2b76a13232e}"}, "branch": {"name": "ign-gazebo2"}}, "reason": "", "source": {"commit": {"hash": "d39a7d7a31d1", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/commit/d39a7d7a31d1.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/commits/d39a7d7a31d1"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{f98d11fe-f287-4dfb-99c3-e2b76a13232e}ts=2082645"}}, "type": "repository", "name": "ign-gazebo", "full_name": "ignitionrobotics/ign-gazebo", "uuid": "{f98d11fe-f287-4dfb-99c3-e2b76a13232e}"}, "branch": {"name": "thread_postupdate"}}, "state": "OPEN", "author": {"display_name": "Michael Carroll", "uuid": "{17dbbc15-cbc0-42f0-a985-cde9061c78a0}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B17dbbc15-cbc0-42f0-a985-cde9061c78a0%7D"}, "html": {"href": "https://bitbucket.org/%7B17dbbc15-cbc0-42f0-a985-cde9061c78a0%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:65740f22-cc56-4418-9608-7e17d0ed47b7/2aa259f5-4de1-4f68-9156-eded72041d84/128"}}, "nickname": "Michael Carroll", "type": "user", "account_id": "557058:65740f22-cc56-4418-9608-7e17d0ed47b7"}, "date": "2019-07-31T19:19:30.686017+00:00"}, "pull_request": {"type": "pullrequest", "id": 387, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/387.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/387"}}, "title": "Add worker threads for System PostUpdate phase"}}, {"comment": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/387/comments/111439409.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/387/_/diff#comment-111439409"}}, "parent": {"id": 111435768, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/387/comments/111435768.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/387/_/diff#comment-111435768"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 387, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/387.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/387"}}, "title": "Add worker threads for System PostUpdate phase"}, "content": {"raw": "Got it thanks. I forgot about the OGRE requirement.", "markup": "markdown", "html": "<p>Got it thanks. I forgot about the OGRE requirement.</p>", "type": "rendered"}, "created_on": "2019-07-31T17:29:08.538904+00:00", "user": {"display_name": "Nate Koenig", "uuid": "{c862cdd9-fcc8-4419-9fc7-e20db14b8fcb}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Bc862cdd9-fcc8-4419-9fc7-e20db14b8fcb%7D"}, "html": {"href": "https://bitbucket.org/%7Bc862cdd9-fcc8-4419-9fc7-e20db14b8fcb%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:095b1e12-74ed-4e20-b44f-2f0745b616e0/ca24bb11-4787-4b14-a20d-d91835e9bde2/128"}}, "nickname": "Nathan Koenig", "type": "user", "account_id": "557058:095b1e12-74ed-4e20-b44f-2f0745b616e0"}, "inline": {}, "updated_on": "2019-07-31T17:29:08.555212+00:00", "type": "pullrequest_comment", "id": 111439409}, "pull_request": {"type": "pullrequest", "id": 387, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/387.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/387"}}, "title": "Add worker threads for System PostUpdate phase"}}, {"comment": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/387/comments/111436458.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/387/_/diff#comment-111436458"}}, "parent": {"id": 111436089, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/387/comments/111436089.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/387/_/diff#comment-111436089"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 387, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/387.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/387"}}, "title": "Add worker threads for System PostUpdate phase"}, "content": {"raw": "That\u2019s not to say that the sensors are incorrect.  They are correct for the single-threaded paradigm where update needed -> rendering happens \u2192 rendering finishes \u2192 sensors clears the update status.\n\nIn the multithreaded paradigm, we can end up in a situation where we schedule the same sensor for updates in back-to-back frames if we are going off of the internal status.", "markup": "markdown", "html": "<p>That\u2019s not to say that the sensors are incorrect.  They are correct for the single-threaded paradigm where update needed -&gt; rendering happens \u2192 rendering finishes \u2192 sensors clears the update status.</p>\n<p>In the multithreaded paradigm, we can end up in a situation where we schedule the same sensor for updates in back-to-back frames if we are going off of the internal status.</p>", "type": "rendered"}, "created_on": "2019-07-31T17:06:29.490076+00:00", "user": {"display_name": "Michael Carroll", "uuid": "{17dbbc15-cbc0-42f0-a985-cde9061c78a0}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B17dbbc15-cbc0-42f0-a985-cde9061c78a0%7D"}, "html": {"href": "https://bitbucket.org/%7B17dbbc15-cbc0-42f0-a985-cde9061c78a0%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:65740f22-cc56-4418-9608-7e17d0ed47b7/2aa259f5-4de1-4f68-9156-eded72041d84/128"}}, "nickname": "Michael Carroll", "type": "user", "account_id": "557058:65740f22-cc56-4418-9608-7e17d0ed47b7"}, "inline": {}, "updated_on": "2019-07-31T17:06:29.504544+00:00", "type": "pullrequest_comment", "id": 111436458}, "pull_request": {"type": "pullrequest", "id": 387, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/387.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/387"}}, "title": "Add worker threads for System PostUpdate phase"}}, {"comment": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/387/comments/111436089.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/387/_/diff#comment-111436089"}}, "parent": {"id": 111431705, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/387/comments/111431705.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/387/_/diff#comment-111431705"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 387, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/387.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/387"}}, "title": "Add worker threads for System PostUpdate phase"}, "content": {"raw": "I\u2019ll add a comment. This is a workaround for the fact that the sensors don\u2019t update their delta/nextFrame status until the rendering is complete.\n\nThis mirrors the sensors internal logic, and masks out sensors that are currently being rendered, but have not completed rendering, so won\u2019t correctly report their status. The delta was chosen to be slightly smaller than the sensors actual internal computation \\(which is 1.0/UpdateRate\\(\\)\\)", "markup": "markdown", "html": "<p>I\u2019ll add a comment. This is a workaround for the fact that the sensors don\u2019t update their delta/nextFrame status until the rendering is complete.</p>\n<p>This mirrors the sensors internal logic, and masks out sensors that are currently being rendered, but have not completed rendering, so won\u2019t correctly report their status. The delta was chosen to be slightly smaller than the sensors actual internal computation (which is 1.0/UpdateRate())</p>", "type": "rendered"}, "created_on": "2019-07-31T17:03:45.120430+00:00", "user": {"display_name": "Michael Carroll", "uuid": "{17dbbc15-cbc0-42f0-a985-cde9061c78a0}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B17dbbc15-cbc0-42f0-a985-cde9061c78a0%7D"}, "html": {"href": "https://bitbucket.org/%7B17dbbc15-cbc0-42f0-a985-cde9061c78a0%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:65740f22-cc56-4418-9608-7e17d0ed47b7/2aa259f5-4de1-4f68-9156-eded72041d84/128"}}, "nickname": "Michael Carroll", "type": "user", "account_id": "557058:65740f22-cc56-4418-9608-7e17d0ed47b7"}, "inline": {}, "updated_on": "2019-07-31T17:04:05.603058+00:00", "type": "pullrequest_comment", "id": 111436089}, "pull_request": {"type": "pullrequest", "id": 387, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/387.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/387"}}, "title": "Add worker threads for System PostUpdate phase"}}, {"comment": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/387/comments/111435768.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/387/_/diff#comment-111435768"}}, "parent": {"id": 111435115, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/387/comments/111435115.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/387/_/diff#comment-111435115"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 387, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/387.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/387"}}, "title": "Add worker threads for System PostUpdate phase"}, "content": {"raw": "The reason that I ended up doing it this was is because the initialization and interaction with OGRE has to all come from the same thread.  Initializing from one thread and using from another caused segfaults, in my experience.\n\nThe other alternative I considered was to have the ability to have the systems provide some sort of PostUpdateThread, rather than have the SimulationRunner create them, but I think that would change the System API, and would probably be better for citadel.", "markup": "markdown", "html": "<p>The reason that I ended up doing it this was is because the initialization and interaction with OGRE has to all come from the same thread.  Initializing from one thread and using from another caused segfaults, in my experience.</p>\n<p>The other alternative I considered was to have the ability to have the systems provide some sort of PostUpdateThread, rather than have the SimulationRunner create them, but I think that would change the System API, and would probably be better for citadel.</p>", "type": "rendered"}, "created_on": "2019-07-31T17:01:18.645217+00:00", "user": {"display_name": "Michael Carroll", "uuid": "{17dbbc15-cbc0-42f0-a985-cde9061c78a0}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B17dbbc15-cbc0-42f0-a985-cde9061c78a0%7D"}, "html": {"href": "https://bitbucket.org/%7B17dbbc15-cbc0-42f0-a985-cde9061c78a0%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:65740f22-cc56-4418-9608-7e17d0ed47b7/2aa259f5-4de1-4f68-9156-eded72041d84/128"}}, "nickname": "Michael Carroll", "type": "user", "account_id": "557058:65740f22-cc56-4418-9608-7e17d0ed47b7"}, "inline": {}, "updated_on": "2019-07-31T17:01:18.663412+00:00", "type": "pullrequest_comment", "id": 111435768}, "pull_request": {"type": "pullrequest", "id": 387, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/387.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/387"}}, "title": "Add worker threads for System PostUpdate phase"}}, {"comment": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/387/comments/111435115.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/387/_/diff#comment-111435115"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 387, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/387.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/387"}}, "title": "Add worker threads for System PostUpdate phase"}, "content": {"raw": "I think the following proposal may make things less complex. \n\n\nCan the current render thread be reduced to just the `WaitForInit` call? Then the `Sensors::PostUpdate` function could directly call `SensorsPrivate::RunOnce`, instead of using a mutex + condition variable. ", "markup": "markdown", "html": "<p>I think the following proposal may make things less complex. </p>\n<p>Can the current render thread be reduced to just the <code>WaitForInit</code> call? Then the <code>Sensors::PostUpdate</code> function could directly call <code>SensorsPrivate::RunOnce</code>, instead of using a mutex + condition variable. </p>", "type": "rendered"}, "created_on": "2019-07-31T16:56:33.556917+00:00", "user": {"display_name": "Nate Koenig", "uuid": "{c862cdd9-fcc8-4419-9fc7-e20db14b8fcb}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Bc862cdd9-fcc8-4419-9fc7-e20db14b8fcb%7D"}, "html": {"href": "https://bitbucket.org/%7Bc862cdd9-fcc8-4419-9fc7-e20db14b8fcb%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:095b1e12-74ed-4e20-b44f-2f0745b616e0/ca24bb11-4787-4b14-a20d-d91835e9bde2/128"}}, "nickname": "Nathan Koenig", "type": "user", "account_id": "557058:095b1e12-74ed-4e20-b44f-2f0745b616e0"}, "inline": {}, "updated_on": "2019-07-31T16:56:33.567345+00:00", "type": "pullrequest_comment", "id": 111435115}, "pull_request": {"type": "pullrequest", "id": 387, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/387.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/387"}}, "title": "Add worker threads for System PostUpdate phase"}}, {"comment": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/387/comments/111431705.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/387/_/diff#comment-111431705"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 387, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/387.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/387"}}, "title": "Add worker threads for System PostUpdate phase"}, "content": {"raw": "Can you add a comment that describes what is going on here, in particular where the delta value comes from?", "markup": "markdown", "html": "<p>Can you add a comment that describes what is going on here, in particular where the delta value comes from?</p>", "type": "rendered"}, "created_on": "2019-07-31T16:32:02.319945+00:00", "user": {"display_name": "Nate Koenig", "uuid": "{c862cdd9-fcc8-4419-9fc7-e20db14b8fcb}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Bc862cdd9-fcc8-4419-9fc7-e20db14b8fcb%7D"}, "html": {"href": "https://bitbucket.org/%7Bc862cdd9-fcc8-4419-9fc7-e20db14b8fcb%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:095b1e12-74ed-4e20-b44f-2f0745b616e0/ca24bb11-4787-4b14-a20d-d91835e9bde2/128"}}, "nickname": "Nathan Koenig", "type": "user", "account_id": "557058:095b1e12-74ed-4e20-b44f-2f0745b616e0"}, "inline": {}, "updated_on": "2019-07-31T16:32:02.328675+00:00", "type": "pullrequest_comment", "id": 111431705}, "pull_request": {"type": "pullrequest", "id": 387, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/387.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/387"}}, "title": "Add worker threads for System PostUpdate phase"}}, {"update": {"description": "The general idea here is put each of the `PostUpdate` calls \\(for systems that implement them\\) in their own worker thread. They are syncronized via two barriers \\(which isn\u2019t in the C\\+\\+ standard yet\\).\r\n\r\nCreating a thread and using a barrier ends up being slightly more efficient than the ign::common::WorkerPool, because we aren\u2019t creating and destroying WorkOrders in each loop. This is only really possible because we\u2019re making the same function calls repeatedly.\r\n\r\nThe barriers will block until all threads have reached the `barrier.wait()` call. This is why the barriers are constructed with a count of `number of postupdates + 1 (for the main thread)`\r\n\r\nEdit:\r\n\r\nThis now includes a worker thread for rendering sensors, causing rendering updates to happen in parallel with the main thread.  In the case that a new rendering operation is required, the main thread will block until the previous one is complete.  \r\n\r\nThis generally eliminates frames that substantially overran their allotted time \\(a rendering update could take 30-60x the allotted time\\).", "title": "Add worker threads for System PostUpdate phase", "destination": {"commit": {"hash": "5964c66d2ef3", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/commit/5964c66d2ef3.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/commits/5964c66d2ef3"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{f98d11fe-f287-4dfb-99c3-e2b76a13232e}ts=2082645"}}, "type": "repository", "name": "ign-gazebo", "full_name": "ignitionrobotics/ign-gazebo", "uuid": "{f98d11fe-f287-4dfb-99c3-e2b76a13232e}"}, "branch": {"name": "ign-gazebo2"}}, "reason": "", "source": {"commit": {"hash": "e363f3353237", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/commit/e363f3353237.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/commits/e363f3353237"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{f98d11fe-f287-4dfb-99c3-e2b76a13232e}ts=2082645"}}, "type": "repository", "name": "ign-gazebo", "full_name": "ignitionrobotics/ign-gazebo", "uuid": "{f98d11fe-f287-4dfb-99c3-e2b76a13232e}"}, "branch": {"name": "thread_postupdate"}}, "state": "OPEN", "author": {"display_name": "Louise Poubel", "uuid": "{5cfa2075-477b-4ded-bdb9-8d2479544ec4}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D"}, "html": {"href": "https://bitbucket.org/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8/7d903d90-c5ea-4182-b7ef-0d467e9e1c74/128"}}, "nickname": "chapulina", "type": "user", "account_id": "557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8"}, "date": "2019-07-27T20:36:09.423442+00:00"}, "pull_request": {"type": "pullrequest", "id": 387, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/387.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/387"}}, "title": "Add worker threads for System PostUpdate phase"}}, {"comment": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/387/comments/110911481.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/387/_/diff#comment-110911481"}}, "parent": {"id": 110599327, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/387/comments/110599327.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/387/_/diff#comment-110599327"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 387, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/387.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/387"}}, "title": "Add worker threads for System PostUpdate phase"}, "content": {"raw": "Thanks for the documentation. It sounds like the same variable is serving 3 different purposes. Is there a chance these get mixed up? (i.e. it's released by at the wrong time?) Not sure if this is a good idea, but it sounds to me like this could be split into 3 independent variables", "markup": "markdown", "html": "<p>Thanks for the documentation. It sounds like the same variable is serving 3 different purposes. Is there a chance these get mixed up? (i.e. it's released by at the wrong time?) Not sure if this is a good idea, but it sounds to me like this could be split into 3 independent variables</p>", "type": "rendered"}, "created_on": "2019-07-26T21:22:01.254844+00:00", "user": {"display_name": "Louise Poubel", "uuid": "{5cfa2075-477b-4ded-bdb9-8d2479544ec4}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D"}, "html": {"href": "https://bitbucket.org/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8/7d903d90-c5ea-4182-b7ef-0d467e9e1c74/128"}}, "nickname": "chapulina", "type": "user", "account_id": "557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8"}, "inline": {}, "updated_on": "2019-07-26T21:22:01.265752+00:00", "type": "pullrequest_comment", "id": 110911481}, "pull_request": {"type": "pullrequest", "id": 387, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/387.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/387"}}, "title": "Add worker threads for System PostUpdate phase"}}, {"update": {"description": "The general idea here is put each of the `PostUpdate` calls \\(for systems that implement them\\) in their own worker thread. They are syncronized via two barriers \\(which isn\u2019t in the C\\+\\+ standard yet\\).\r\n\r\nCreating a thread and using a barrier ends up being slightly more efficient than the ign::common::WorkerPool, because we aren\u2019t creating and destroying WorkOrders in each loop. This is only really possible because we\u2019re making the same function calls repeatedly.\r\n\r\nThe barriers will block until all threads have reached the `barrier.wait()` call. This is why the barriers are constructed with a count of `number of postupdates + 1 (for the main thread)`\r\n\r\nEdit:\r\n\r\nThis now includes a worker thread for rendering sensors, causing rendering updates to happen in parallel with the main thread.  In the case that a new rendering operation is required, the main thread will block until the previous one is complete.  \r\n\r\nThis generally eliminates frames that substantially overran their allotted time \\(a rendering update could take 30-60x the allotted time\\).", "title": "Add worker threads for System PostUpdate phase", "destination": {"commit": {"hash": "23a55b416ea4", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/commit/23a55b416ea4.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/commits/23a55b416ea4"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{f98d11fe-f287-4dfb-99c3-e2b76a13232e}ts=2082645"}}, "type": "repository", "name": "ign-gazebo", "full_name": "ignitionrobotics/ign-gazebo", "uuid": "{f98d11fe-f287-4dfb-99c3-e2b76a13232e}"}, "branch": {"name": "ign-gazebo2"}}, "reason": "", "source": {"commit": {"hash": "b6ef58fac772", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/commit/b6ef58fac772.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/commits/b6ef58fac772"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{f98d11fe-f287-4dfb-99c3-e2b76a13232e}ts=2082645"}}, "type": "repository", "name": "ign-gazebo", "full_name": "ignitionrobotics/ign-gazebo", "uuid": "{f98d11fe-f287-4dfb-99c3-e2b76a13232e}"}, "branch": {"name": "thread_postupdate"}}, "state": "OPEN", "author": {"display_name": "Louise Poubel", "uuid": "{5cfa2075-477b-4ded-bdb9-8d2479544ec4}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D"}, "html": {"href": "https://bitbucket.org/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8/7d903d90-c5ea-4182-b7ef-0d467e9e1c74/128"}}, "nickname": "chapulina", "type": "user", "account_id": "557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8"}, "date": "2019-07-26T21:17:16.038763+00:00"}, "pull_request": {"type": "pullrequest", "id": 387, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/387.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/387"}}, "title": "Add worker threads for System PostUpdate phase"}}, {"comment": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/387/comments/110771832.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/387/_/diff#comment-110771832"}}, "parent": {"id": 110367049, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/387/comments/110367049.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/387/_/diff#comment-110367049"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 387, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/387.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/387"}}, "title": "Add worker threads for System PostUpdate phase"}, "content": {"raw": "I pulled the profiler changes from this PR into pull request #400 so we can run all this nice stuff against `ign-gazebo2` before and after this PR", "markup": "markdown", "html": "<p>I pulled the profiler changes from this PR into <a href=\"#!/ignitionrobotics/ign-gazebo/pull-requests/400/profile-points-broken-off-from-pull\" rel=\"nofollow\" class=\"ap-connect-link\">pull request #400</a> so we can run all this nice stuff against <code>ign-gazebo2</code> before and after this PR</p>", "type": "rendered"}, "created_on": "2019-07-26T00:48:24.390826+00:00", "user": {"display_name": "Louise Poubel", "uuid": "{5cfa2075-477b-4ded-bdb9-8d2479544ec4}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D"}, "html": {"href": "https://bitbucket.org/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8/7d903d90-c5ea-4182-b7ef-0d467e9e1c74/128"}}, "nickname": "chapulina", "type": "user", "account_id": "557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8"}, "updated_on": "2019-07-26T00:48:24.399928+00:00", "type": "pullrequest_comment", "id": 110771832}, "pull_request": {"type": "pullrequest", "id": 387, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/387.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/387"}}, "title": "Add worker threads for System PostUpdate phase"}}, {"comment": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/387/comments/110766833.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/387/_/diff#comment-110766833"}}, "parent": {"id": 110597735, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/387/comments/110597735.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/387/_/diff#comment-110597735"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 387, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/387.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/387"}}, "title": "Add worker threads for System PostUpdate phase"}, "content": {"raw": "I can't reproduce this anymore :tada: ", "markup": "markdown", "html": "<p>I can't reproduce this anymore <img class=\"emoji\" src=\"data/pf-emoji-service--cdn.us-east-1.prod.public.atl-paas.net/standard/551c9814-1d37-4573-819d-afab3afeaf32/48x48/1f389.png\" alt=\"\ud83c\udf89\" title=\":tada:\" data-emoji-short-name=\":tada:\" /> </p>", "type": "rendered"}, "created_on": "2019-07-25T23:09:47.651361+00:00", "user": {"display_name": "Louise Poubel", "uuid": "{5cfa2075-477b-4ded-bdb9-8d2479544ec4}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D"}, "html": {"href": "https://bitbucket.org/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8/7d903d90-c5ea-4182-b7ef-0d467e9e1c74/128"}}, "nickname": "chapulina", "type": "user", "account_id": "557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8"}, "updated_on": "2019-07-25T23:09:47.662147+00:00", "type": "pullrequest_comment", "id": 110766833}, "pull_request": {"type": "pullrequest", "id": 387, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/387.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/387"}}, "title": "Add worker threads for System PostUpdate phase"}}, {"update": {"description": "The general idea here is put each of the `PostUpdate` calls \\(for systems that implement them\\) in their own worker thread. They are syncronized via two barriers \\(which isn\u2019t in the C\\+\\+ standard yet\\).\r\n\r\nCreating a thread and using a barrier ends up being slightly more efficient than the ign::common::WorkerPool, because we aren\u2019t creating and destroying WorkOrders in each loop. This is only really possible because we\u2019re making the same function calls repeatedly.\r\n\r\nThe barriers will block until all threads have reached the `barrier.wait()` call. This is why the barriers are constructed with a count of `number of postupdates + 1 (for the main thread)`\r\n\r\nEdit:\r\n\r\nThis now includes a worker thread for rendering sensors, causing rendering updates to happen in parallel with the main thread.  In the case that a new rendering operation is required, the main thread will block until the previous one is complete.  \r\n\r\nThis generally eliminates frames that substantially overran their allotted time \\(a rendering update could take 30-60x the allotted time\\).", "title": "Add worker threads for System PostUpdate phase", "destination": {"commit": {"hash": "7c58d6b84583", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/commit/7c58d6b84583.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/commits/7c58d6b84583"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{f98d11fe-f287-4dfb-99c3-e2b76a13232e}ts=2082645"}}, "type": "repository", "name": "ign-gazebo", "full_name": "ignitionrobotics/ign-gazebo", "uuid": "{f98d11fe-f287-4dfb-99c3-e2b76a13232e}"}, "branch": {"name": "ign-gazebo2"}}, "reason": "", "source": {"commit": {"hash": "fa90bc814065", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/commit/fa90bc814065.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/commits/fa90bc814065"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{f98d11fe-f287-4dfb-99c3-e2b76a13232e}ts=2082645"}}, "type": "repository", "name": "ign-gazebo", "full_name": "ignitionrobotics/ign-gazebo", "uuid": "{f98d11fe-f287-4dfb-99c3-e2b76a13232e}"}, "branch": {"name": "thread_postupdate"}}, "state": "OPEN", "author": {"display_name": "Louise Poubel", "uuid": "{5cfa2075-477b-4ded-bdb9-8d2479544ec4}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D"}, "html": {"href": "https://bitbucket.org/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8/7d903d90-c5ea-4182-b7ef-0d467e9e1c74/128"}}, "nickname": "chapulina", "type": "user", "account_id": "557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8"}, "date": "2019-07-25T22:35:41.414420+00:00"}, "pull_request": {"type": "pullrequest", "id": 387, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/387.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/387"}}, "title": "Add worker threads for System PostUpdate phase"}}, {"comment": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/387/comments/110599937.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/387/_/diff#comment-110599937"}}, "parent": {"id": 110583123, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/387/comments/110583123.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/387/_/diff#comment-110583123"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 387, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/387.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/387"}}, "title": "Add worker threads for System PostUpdate phase"}, "content": {"raw": "@{557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8} I believe that I clarified it a bit by changing the names of the ExitStatus variables, let me know what you think: 239de64", "markup": "markdown", "html": "<p><span class=\"ap-mention\" data-atlassian-id=\"557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8\">@Louise Poubel</span> I believe that I clarified it a bit by changing the names of the ExitStatus variables, let me know what you think: <a href=\"#!/ignitionrobotics/ign-gazebo/commits/239de64\" rel=\"nofollow\" class=\"ap-connect-link\">239de64</a></p>", "type": "rendered"}, "created_on": "2019-07-25T02:14:47.896987+00:00", "user": {"display_name": "Michael Carroll", "uuid": "{17dbbc15-cbc0-42f0-a985-cde9061c78a0}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B17dbbc15-cbc0-42f0-a985-cde9061c78a0%7D"}, "html": {"href": "https://bitbucket.org/%7B17dbbc15-cbc0-42f0-a985-cde9061c78a0%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:65740f22-cc56-4418-9608-7e17d0ed47b7/2aa259f5-4de1-4f68-9156-eded72041d84/128"}}, "nickname": "Michael Carroll", "type": "user", "account_id": "557058:65740f22-cc56-4418-9608-7e17d0ed47b7"}, "inline": {}, "updated_on": "2019-07-25T02:14:47.912872+00:00", "type": "pullrequest_comment", "id": 110599937}, "pull_request": {"type": "pullrequest", "id": 387, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/387.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/387"}}, "title": "Add worker threads for System PostUpdate phase"}}, {"update": {"description": "The general idea here is put each of the `PostUpdate` calls \\(for systems that implement them\\) in their own worker thread. They are syncronized via two barriers \\(which isn\u2019t in the C\\+\\+ standard yet\\).\r\n\r\nCreating a thread and using a barrier ends up being slightly more efficient than the ign::common::WorkerPool, because we aren\u2019t creating and destroying WorkOrders in each loop. This is only really possible because we\u2019re making the same function calls repeatedly.\r\n\r\nThe barriers will block until all threads have reached the `barrier.wait()` call. This is why the barriers are constructed with a count of `number of postupdates + 1 (for the main thread)`\r\n\r\nEdit:\r\n\r\nThis now includes a worker thread for rendering sensors, causing rendering updates to happen in parallel with the main thread.  In the case that a new rendering operation is required, the main thread will block until the previous one is complete.  \r\n\r\nThis generally eliminates frames that substantially overran their allotted time \\(a rendering update could take 30-60x the allotted time\\).", "title": "Add worker threads for System PostUpdate phase", "destination": {"commit": {"hash": "67a0e72ce175", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/commit/67a0e72ce175.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/commits/67a0e72ce175"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{f98d11fe-f287-4dfb-99c3-e2b76a13232e}ts=2082645"}}, "type": "repository", "name": "ign-gazebo", "full_name": "ignitionrobotics/ign-gazebo", "uuid": "{f98d11fe-f287-4dfb-99c3-e2b76a13232e}"}, "branch": {"name": "ign-gazebo2"}}, "reason": "", "source": {"commit": {"hash": "239de647d40f", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/commit/239de647d40f.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/commits/239de647d40f"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{f98d11fe-f287-4dfb-99c3-e2b76a13232e}ts=2082645"}}, "type": "repository", "name": "ign-gazebo", "full_name": "ignitionrobotics/ign-gazebo", "uuid": "{f98d11fe-f287-4dfb-99c3-e2b76a13232e}"}, "branch": {"name": "thread_postupdate"}}, "state": "OPEN", "author": {"display_name": "Michael Carroll", "uuid": "{17dbbc15-cbc0-42f0-a985-cde9061c78a0}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B17dbbc15-cbc0-42f0-a985-cde9061c78a0%7D"}, "html": {"href": "https://bitbucket.org/%7B17dbbc15-cbc0-42f0-a985-cde9061c78a0%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:65740f22-cc56-4418-9608-7e17d0ed47b7/2aa259f5-4de1-4f68-9156-eded72041d84/128"}}, "nickname": "Michael Carroll", "type": "user", "account_id": "557058:65740f22-cc56-4418-9608-7e17d0ed47b7"}, "date": "2019-07-25T02:13:35.031504+00:00"}, "pull_request": {"type": "pullrequest", "id": 387, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/387.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/387"}}, "title": "Add worker threads for System PostUpdate phase"}}, {"comment": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/387/comments/110599340.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/387/_/diff#comment-110599340"}}, "parent": {"id": 110580726, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/387/comments/110580726.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/387/_/diff#comment-110580726"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 387, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/387.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/387"}}, "title": "Add worker threads for System PostUpdate phase"}, "content": {"raw": "Added here: 241414f", "markup": "markdown", "html": "<p>Added here: <a href=\"#!/ignitionrobotics/ign-gazebo/commits/241414f\" rel=\"nofollow\" class=\"ap-connect-link\">241414f</a></p>", "type": "rendered"}, "created_on": "2019-07-25T02:01:50.368215+00:00", "user": {"display_name": "Michael Carroll", "uuid": "{17dbbc15-cbc0-42f0-a985-cde9061c78a0}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B17dbbc15-cbc0-42f0-a985-cde9061c78a0%7D"}, "html": {"href": "https://bitbucket.org/%7B17dbbc15-cbc0-42f0-a985-cde9061c78a0%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:65740f22-cc56-4418-9608-7e17d0ed47b7/2aa259f5-4de1-4f68-9156-eded72041d84/128"}}, "nickname": "Michael Carroll", "type": "user", "account_id": "557058:65740f22-cc56-4418-9608-7e17d0ed47b7"}, "inline": {}, "updated_on": "2019-07-25T02:01:50.379070+00:00", "type": "pullrequest_comment", "id": 110599340}, "pull_request": {"type": "pullrequest", "id": 387, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/387.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/387"}}, "title": "Add worker threads for System PostUpdate phase"}}, {"comment": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/387/comments/110599327.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/387/_/diff#comment-110599327"}}, "parent": {"id": 110591032, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/387/comments/110591032.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/387/_/diff#comment-110591032"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 387, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/387.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/387"}}, "title": "Add worker threads for System PostUpdate phase"}, "content": {"raw": "More documentation on the control flow here: 241414f", "markup": "markdown", "html": "<p>More documentation on the control flow here: <a href=\"#!/ignitionrobotics/ign-gazebo/commits/241414f\" rel=\"nofollow\" class=\"ap-connect-link\">241414f</a></p>", "type": "rendered"}, "created_on": "2019-07-25T02:01:41.540703+00:00", "user": {"display_name": "Michael Carroll", "uuid": "{17dbbc15-cbc0-42f0-a985-cde9061c78a0}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B17dbbc15-cbc0-42f0-a985-cde9061c78a0%7D"}, "html": {"href": "https://bitbucket.org/%7B17dbbc15-cbc0-42f0-a985-cde9061c78a0%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:65740f22-cc56-4418-9608-7e17d0ed47b7/2aa259f5-4de1-4f68-9156-eded72041d84/128"}}, "nickname": "Michael Carroll", "type": "user", "account_id": "557058:65740f22-cc56-4418-9608-7e17d0ed47b7"}, "inline": {}, "updated_on": "2019-07-25T02:01:41.549547+00:00", "type": "pullrequest_comment", "id": 110599327}, "pull_request": {"type": "pullrequest", "id": 387, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/387.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/387"}}, "title": "Add worker threads for System PostUpdate phase"}}, {"update": {"description": "The general idea here is put each of the `PostUpdate` calls \\(for systems that implement them\\) in their own worker thread. They are syncronized via two barriers \\(which isn\u2019t in the C\\+\\+ standard yet\\).\r\n\r\nCreating a thread and using a barrier ends up being slightly more efficient than the ign::common::WorkerPool, because we aren\u2019t creating and destroying WorkOrders in each loop. This is only really possible because we\u2019re making the same function calls repeatedly.\r\n\r\nThe barriers will block until all threads have reached the `barrier.wait()` call. This is why the barriers are constructed with a count of `number of postupdates + 1 (for the main thread)`\r\n\r\nEdit:\r\n\r\nThis now includes a worker thread for rendering sensors, causing rendering updates to happen in parallel with the main thread.  In the case that a new rendering operation is required, the main thread will block until the previous one is complete.  \r\n\r\nThis generally eliminates frames that substantially overran their allotted time \\(a rendering update could take 30-60x the allotted time\\).", "title": "Add worker threads for System PostUpdate phase", "destination": {"commit": {"hash": "67a0e72ce175", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/commit/67a0e72ce175.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/commits/67a0e72ce175"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{f98d11fe-f287-4dfb-99c3-e2b76a13232e}ts=2082645"}}, "type": "repository", "name": "ign-gazebo", "full_name": "ignitionrobotics/ign-gazebo", "uuid": "{f98d11fe-f287-4dfb-99c3-e2b76a13232e}"}, "branch": {"name": "ign-gazebo2"}}, "reason": "", "source": {"commit": {"hash": "241414f657e2", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/commit/241414f657e2.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/commits/241414f657e2"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{f98d11fe-f287-4dfb-99c3-e2b76a13232e}ts=2082645"}}, "type": "repository", "name": "ign-gazebo", "full_name": "ignitionrobotics/ign-gazebo", "uuid": "{f98d11fe-f287-4dfb-99c3-e2b76a13232e}"}, "branch": {"name": "thread_postupdate"}}, "state": "OPEN", "author": {"display_name": "Michael Carroll", "uuid": "{17dbbc15-cbc0-42f0-a985-cde9061c78a0}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B17dbbc15-cbc0-42f0-a985-cde9061c78a0%7D"}, "html": {"href": "https://bitbucket.org/%7B17dbbc15-cbc0-42f0-a985-cde9061c78a0%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:65740f22-cc56-4418-9608-7e17d0ed47b7/2aa259f5-4de1-4f68-9156-eded72041d84/128"}}, "nickname": "Michael Carroll", "type": "user", "account_id": "557058:65740f22-cc56-4418-9608-7e17d0ed47b7"}, "date": "2019-07-25T01:59:21.769626+00:00"}, "pull_request": {"type": "pullrequest", "id": 387, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/387.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/387"}}, "title": "Add worker threads for System PostUpdate phase"}}, {"update": {"description": "The general idea here is put each of the `PostUpdate` calls \\(for systems that implement them\\) in their own worker thread. They are syncronized via two barriers \\(which isn\u2019t in the C\\+\\+ standard yet\\).\r\n\r\nCreating a thread and using a barrier ends up being slightly more efficient than the ign::common::WorkerPool, because we aren\u2019t creating and destroying WorkOrders in each loop. This is only really possible because we\u2019re making the same function calls repeatedly.\r\n\r\nThe barriers will block until all threads have reached the `barrier.wait()` call. This is why the barriers are constructed with a count of `number of postupdates + 1 (for the main thread)`\r\n\r\nEdit:\r\n\r\nThis now includes a worker thread for rendering sensors, causing rendering updates to happen in parallel with the main thread.  In the case that a new rendering operation is required, the main thread will block until the previous one is complete.  \r\n\r\nThis generally eliminates frames that substantially overran their allotted time \\(a rendering update could take 30-60x the allotted time\\).", "title": "Add worker threads for System PostUpdate phase", "destination": {"commit": {"hash": "aadcbeadf179", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/commit/aadcbeadf179.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/commits/aadcbeadf179"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{f98d11fe-f287-4dfb-99c3-e2b76a13232e}ts=2082645"}}, "type": "repository", "name": "ign-gazebo", "full_name": "ignitionrobotics/ign-gazebo", "uuid": "{f98d11fe-f287-4dfb-99c3-e2b76a13232e}"}, "branch": {"name": "ign-gazebo2"}}, "reason": "", "source": {"commit": {"hash": "d43e63713580", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/commit/d43e63713580.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/commits/d43e63713580"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{f98d11fe-f287-4dfb-99c3-e2b76a13232e}ts=2082645"}}, "type": "repository", "name": "ign-gazebo", "full_name": "ignitionrobotics/ign-gazebo", "uuid": "{f98d11fe-f287-4dfb-99c3-e2b76a13232e}"}, "branch": {"name": "thread_postupdate"}}, "state": "OPEN", "author": {"display_name": "Michael Carroll", "uuid": "{17dbbc15-cbc0-42f0-a985-cde9061c78a0}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B17dbbc15-cbc0-42f0-a985-cde9061c78a0%7D"}, "html": {"href": "https://bitbucket.org/%7B17dbbc15-cbc0-42f0-a985-cde9061c78a0%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:65740f22-cc56-4418-9608-7e17d0ed47b7/2aa259f5-4de1-4f68-9156-eded72041d84/128"}}, "nickname": "Michael Carroll", "type": "user", "account_id": "557058:65740f22-cc56-4418-9608-7e17d0ed47b7"}, "date": "2019-07-25T01:48:09.965005+00:00"}, "pull_request": {"type": "pullrequest", "id": 387, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/387.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/387"}}, "title": "Add worker threads for System PostUpdate phase"}}, {"comment": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/387/comments/110597784.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/387/_/diff#comment-110597784"}}, "parent": {"id": 110589666, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/387/comments/110589666.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/387/_/diff#comment-110589666"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 387, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/387.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/387"}}, "title": "Add worker threads for System PostUpdate phase"}, "content": {"raw": "Yes, I like this, much tidier.", "markup": "markdown", "html": "<p>Yes, I like this, much tidier.</p>", "type": "rendered"}, "created_on": "2019-07-25T01:28:36.984427+00:00", "user": {"display_name": "Michael Carroll", "uuid": "{17dbbc15-cbc0-42f0-a985-cde9061c78a0}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B17dbbc15-cbc0-42f0-a985-cde9061c78a0%7D"}, "html": {"href": "https://bitbucket.org/%7B17dbbc15-cbc0-42f0-a985-cde9061c78a0%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:65740f22-cc56-4418-9608-7e17d0ed47b7/2aa259f5-4de1-4f68-9156-eded72041d84/128"}}, "nickname": "Michael Carroll", "type": "user", "account_id": "557058:65740f22-cc56-4418-9608-7e17d0ed47b7"}, "inline": {}, "updated_on": "2019-07-25T01:28:36.997821+00:00", "type": "pullrequest_comment", "id": 110597784}, "pull_request": {"type": "pullrequest", "id": 387, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/387.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/387"}}, "title": "Add worker threads for System PostUpdate phase"}}, {"comment": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/387/comments/110597735.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/387/_/diff#comment-110597735"}}, "parent": {"id": 110590630, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/387/comments/110590630.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/387/_/diff#comment-110590630"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 387, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/387.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/387"}}, "title": "Add worker threads for System PostUpdate phase"}, "content": {"raw": "Can you get me a stacktrace?    \n  \nBased on the location, I\u2019m guessing it may be related to [#!/ignitionrobotics/ign-rendering/pull-requests/174](#!/ignitionrobotics/ign-rendering/pull-requests/174) and [#!/ignitionrobotics/ign-rendering/pull-requests/175](#!/ignitionrobotics/ign-rendering/pull-requests/175) \\(which breaks ABI\\)", "markup": "markdown", "html": "<p>Can you get me a stacktrace?    </p>\n<p>Based on the location, I\u2019m guessing it may be related to <a data-is-external-link=\"true\" href=\"#!/ignitionrobotics/ign-rendering/pull-requests/174\" rel=\"nofollow\">#!/ignitionrobotics/ign-rendering/pull-requests/174</a> and <a data-is-external-link=\"true\" href=\"#!/ignitionrobotics/ign-rendering/pull-requests/175\" rel=\"nofollow\">#!/ignitionrobotics/ign-rendering/pull-requests/175</a> (which breaks ABI)</p>", "type": "rendered"}, "created_on": "2019-07-25T01:27:38.539398+00:00", "user": {"display_name": "Michael Carroll", "uuid": "{17dbbc15-cbc0-42f0-a985-cde9061c78a0}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B17dbbc15-cbc0-42f0-a985-cde9061c78a0%7D"}, "html": {"href": "https://bitbucket.org/%7B17dbbc15-cbc0-42f0-a985-cde9061c78a0%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:65740f22-cc56-4418-9608-7e17d0ed47b7/2aa259f5-4de1-4f68-9156-eded72041d84/128"}}, "nickname": "Michael Carroll", "type": "user", "account_id": "557058:65740f22-cc56-4418-9608-7e17d0ed47b7"}, "updated_on": "2019-07-25T01:27:38.551303+00:00", "type": "pullrequest_comment", "id": 110597735}, "pull_request": {"type": "pullrequest", "id": 387, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/387.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/387"}}, "title": "Add worker threads for System PostUpdate phase"}}, {"comment": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/387/comments/110591261.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/387/_/diff#comment-110591261"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 387, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/387.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/387"}}, "title": "Add worker threads for System PostUpdate phase"}, "content": {"raw": "I haven't gone through the rendering code yet, but the rest is looking good so far. I have some small suggestions on pull request #395.", "markup": "markdown", "html": "<p>I haven't gone through the rendering code yet, but the rest is looking good so far. I have some small suggestions on <a href=\"#!/ignitionrobotics/ign-gazebo/pull-requests/395/suggestions-to-pull-request-387\" rel=\"nofollow\" class=\"ap-connect-link\">pull request #395</a>.</p>", "type": "rendered"}, "created_on": "2019-07-24T23:18:48.181718+00:00", "user": {"display_name": "Louise Poubel", "uuid": "{5cfa2075-477b-4ded-bdb9-8d2479544ec4}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D"}, "html": {"href": "https://bitbucket.org/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8/7d903d90-c5ea-4182-b7ef-0d467e9e1c74/128"}}, "nickname": "chapulina", "type": "user", "account_id": "557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8"}, "updated_on": "2019-07-24T23:18:48.187508+00:00", "type": "pullrequest_comment", "id": 110591261}, "pull_request": {"type": "pullrequest", "id": 387, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/387.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/387"}}, "title": "Add worker threads for System PostUpdate phase"}}, {"comment": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/387/comments/110591032.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/387/_/diff#comment-110591032"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 387, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/387.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/387"}}, "title": "Add worker threads for System PostUpdate phase"}, "content": {"raw": "This variable is blocked and released in several different places. Maybe the documentation could explain a bit more about how it should be used?", "markup": "markdown", "html": "<p>This variable is blocked and released in several different places. Maybe the documentation could explain a bit more about how it should be used?</p>", "type": "rendered"}, "created_on": "2019-07-24T23:15:27.769819+00:00", "user": {"display_name": "Louise Poubel", "uuid": "{5cfa2075-477b-4ded-bdb9-8d2479544ec4}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D"}, "html": {"href": "https://bitbucket.org/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8/7d903d90-c5ea-4182-b7ef-0d467e9e1c74/128"}}, "nickname": "chapulina", "type": "user", "account_id": "557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8"}, "inline": {}, "updated_on": "2019-07-24T23:15:27.777393+00:00", "type": "pullrequest_comment", "id": 110591032}, "pull_request": {"type": "pullrequest", "id": 387, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/387.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/387"}}, "title": "Add worker threads for System PostUpdate phase"}}, {"comment": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/387/comments/110590630.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/387/_/diff#comment-110590630"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 387, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/387.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/387"}}, "title": "Add worker threads for System PostUpdate phase"}, "content": {"raw": "I'm always getting a crash on shutdown like this:\n\n~~~\nign gazebo -v 4 sensors_demo.sdf\n# Ctrl + C\n~~~\n\nOutput:\n\n~~~\n^C[GUI] [Dbg] [SignalHandler.cc:141] Received signal[2].\n[GUI] [Dbg] [SignalHandler.cc:141] Received signal[2].\n[GUI] [Dbg] [ign.cc:284] Shutting down ign-gazebo-gui\n[GUI] [Dbg] [Application.cc:130] Terminating application.\n[GUI] [Dbg] [Scene3D.cc:469] Destroy scene [scene]\n[Dbg] [SignalHandler.cc:141] Received signal[2].\n[Dbg] [ServerPrivate.cc:106] Server received signal[2]\n[Dbg] [Sensors.cc:224] SensorsPrivate::Stop\n[Dbg] [Sensors.cc:210] SensorsPrivate::RenderThread stopped\n[Dbg] [ign.cc:138] Shutting down ign-gazebo-server\n[Dbg] [SimulationRunner.cc:369] [Dbg] [SimulationRunner.cc:369] [Dbg] [SimulationRunner.cc:369] Exiting postupdate worker thread ()Exiting postupdate worker thread (\n0)\n[Dbg] [Sensors.cc:224] SensorsPrivate::Stop\ndouble free or corruption (fasttop)\n~~~", "markup": "markdown", "html": "<p>I'm always getting a crash on shutdown like this:</p>\n<div class=\"codehilite\"><pre><span></span>ign gazebo -v 4 sensors_demo.sdf\n# Ctrl + C\n</pre></div>\n\n\n<p>Output:</p>\n<div class=\"codehilite\"><pre><span></span>^C[GUI] [Dbg] [SignalHandler.cc:141] Received signal[2].\n[GUI] [Dbg] [SignalHandler.cc:141] Received signal[2].\n[GUI] [Dbg] [ign.cc:284] Shutting down ign-gazebo-gui\n[GUI] [Dbg] [Application.cc:130] Terminating application.\n[GUI] [Dbg] [Scene3D.cc:469] Destroy scene [scene]\n[Dbg] [SignalHandler.cc:141] Received signal[2].\n[Dbg] [ServerPrivate.cc:106] Server received signal[2]\n[Dbg] [Sensors.cc:224] SensorsPrivate::Stop\n[Dbg] [Sensors.cc:210] SensorsPrivate::RenderThread stopped\n[Dbg] [ign.cc:138] Shutting down ign-gazebo-server\n[Dbg] [SimulationRunner.cc:369] [Dbg] [SimulationRunner.cc:369] [Dbg] [SimulationRunner.cc:369] Exiting postupdate worker thread ()Exiting postupdate worker thread (\n0)\n[Dbg] [Sensors.cc:224] SensorsPrivate::Stop\ndouble free or corruption (fasttop)\n</pre></div>", "type": "rendered"}, "created_on": "2019-07-24T23:08:20.191536+00:00", "user": {"display_name": "Louise Poubel", "uuid": "{5cfa2075-477b-4ded-bdb9-8d2479544ec4}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D"}, "html": {"href": "https://bitbucket.org/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8/7d903d90-c5ea-4182-b7ef-0d467e9e1c74/128"}}, "nickname": "chapulina", "type": "user", "account_id": "557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8"}, "updated_on": "2019-07-24T23:08:20.197768+00:00", "type": "pullrequest_comment", "id": 110590630}, "pull_request": {"type": "pullrequest", "id": 387, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/387.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/387"}}, "title": "Add worker threads for System PostUpdate phase"}}, {"comment": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/387/comments/110589666.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/387/_/diff#comment-110589666"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 387, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/387.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/387"}}, "title": "Add worker threads for System PostUpdate phase"}, "content": {"raw": "How about moving some of the instructions out of this if, just in case things get out of sync? Something like\n\n```\nvoid SimulationRunner::StopWorkerThreads()\n{\n  this->postUpdateThreadsRunning = false;\n  if (this->postUpdateStartBarrier)\n  { \n    this->postUpdateStartBarrier->Cancel();\n  } \n  if (this->postUpdateStopBarrier)\n  { \n    this->postUpdateStopBarrier->Cancel();\n  } \n  for (auto &thread : this->postUpdateThreads)\n  { \n    thread.join();\n  } \n  this->postUpdateThreads.clear();\n}\n```", "markup": "markdown", "html": "<p>How about moving some of the instructions out of this if, just in case things get out of sync? Something like</p>\n<div class=\"codehilite\"><pre><span></span>void SimulationRunner::StopWorkerThreads()\n{\n  this-&gt;postUpdateThreadsRunning = false;\n  if (this-&gt;postUpdateStartBarrier)\n  { \n    this-&gt;postUpdateStartBarrier-&gt;Cancel();\n  } \n  if (this-&gt;postUpdateStopBarrier)\n  { \n    this-&gt;postUpdateStopBarrier-&gt;Cancel();\n  } \n  for (auto &amp;thread : this-&gt;postUpdateThreads)\n  { \n    thread.join();\n  } \n  this-&gt;postUpdateThreads.clear();\n}\n</pre></div>", "type": "rendered"}, "created_on": "2019-07-24T22:52:04.204820+00:00", "user": {"display_name": "Louise Poubel", "uuid": "{5cfa2075-477b-4ded-bdb9-8d2479544ec4}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D"}, "html": {"href": "https://bitbucket.org/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8/7d903d90-c5ea-4182-b7ef-0d467e9e1c74/128"}}, "nickname": "chapulina", "type": "user", "account_id": "557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8"}, "inline": {}, "updated_on": "2019-07-24T22:54:25.839424+00:00", "type": "pullrequest_comment", "id": 110589666}, "pull_request": {"type": "pullrequest", "id": 387, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/387.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/387"}}, "title": "Add worker threads for System PostUpdate phase"}}, {"comment": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/387/comments/110583123.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/387/_/diff#comment-110583123"}}, "parent": {"id": 110582856, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/387/comments/110582856.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/387/_/diff#comment-110582856"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 387, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/387.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/387"}}, "title": "Add worker threads for System PostUpdate phase"}, "content": {"raw": "Addisu and I were talking about this earlier and the naming is kind of confusing.\n\nThe last thread to hit the `wait()` will return GENERATION\\_DONE, while every other thread will get a GENERATION\\_PENDING.  I don\u2019t think that this information is particularly useful in general, but it\u2019s nice to know it wasn\u2019t cancelled.", "markup": "markdown", "html": "<p>Addisu and I were talking about this earlier and the naming is kind of confusing.</p>\n<p>The last thread to hit the <code>wait()</code> will return GENERATION_DONE, while every other thread will get a GENERATION_PENDING.  I don\u2019t think that this information is particularly useful in general, but it\u2019s nice to know it wasn\u2019t cancelled.</p>", "type": "rendered"}, "created_on": "2019-07-24T21:23:04.943475+00:00", "user": {"display_name": "Michael Carroll", "uuid": "{17dbbc15-cbc0-42f0-a985-cde9061c78a0}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B17dbbc15-cbc0-42f0-a985-cde9061c78a0%7D"}, "html": {"href": "https://bitbucket.org/%7B17dbbc15-cbc0-42f0-a985-cde9061c78a0%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:65740f22-cc56-4418-9608-7e17d0ed47b7/2aa259f5-4de1-4f68-9156-eded72041d84/128"}}, "nickname": "Michael Carroll", "type": "user", "account_id": "557058:65740f22-cc56-4418-9608-7e17d0ed47b7"}, "inline": {}, "updated_on": "2019-07-24T21:23:04.954003+00:00", "type": "pullrequest_comment", "id": 110583123}, "pull_request": {"type": "pullrequest", "id": 387, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/387.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/387"}}, "title": "Add worker threads for System PostUpdate phase"}}, {"comment": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/387/comments/110582856.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/387/_/diff#comment-110582856"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 387, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/387.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/387"}}, "title": "Add worker threads for System PostUpdate phase"}, "content": {"raw": "How can we end up here?", "markup": "markdown", "html": "<p>How can we end up here?</p>", "type": "rendered"}, "created_on": "2019-07-24T21:20:20.579356+00:00", "user": {"display_name": "Louise Poubel", "uuid": "{5cfa2075-477b-4ded-bdb9-8d2479544ec4}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D"}, "html": {"href": "https://bitbucket.org/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8/7d903d90-c5ea-4182-b7ef-0d467e9e1c74/128"}}, "nickname": "chapulina", "type": "user", "account_id": "557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8"}, "inline": {}, "updated_on": "2019-07-24T21:20:20.587077+00:00", "type": "pullrequest_comment", "id": 110582856}, "pull_request": {"type": "pullrequest", "id": 387, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/387.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/387"}}, "title": "Add worker threads for System PostUpdate phase"}}, {"comment": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/387/comments/110580726.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/387/_/diff#comment-110580726"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 387, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/387.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/387"}}, "title": "Add worker threads for System PostUpdate phase"}, "content": {"raw": "Could document the cases when `-1` is returned. Also, this function could be const if `updateMutex` were mutable.", "markup": "markdown", "html": "<p>Could document the cases when <code>-1</code> is returned. Also, this function could be const if <code>updateMutex</code> were mutable.</p>", "type": "rendered"}, "created_on": "2019-07-24T20:58:33.249872+00:00", "user": {"display_name": "Louise Poubel", "uuid": "{5cfa2075-477b-4ded-bdb9-8d2479544ec4}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D"}, "html": {"href": "https://bitbucket.org/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8/7d903d90-c5ea-4182-b7ef-0d467e9e1c74/128"}}, "nickname": "chapulina", "type": "user", "account_id": "557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8"}, "inline": {}, "updated_on": "2019-07-24T20:58:33.258582+00:00", "type": "pullrequest_comment", "id": 110580726}, "pull_request": {"type": "pullrequest", "id": 387, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/387.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/387"}}, "title": "Add worker threads for System PostUpdate phase"}}, {"update": {"description": "The general idea here is put each of the `PostUpdate` calls \\(for systems that implement them\\) in their own worker thread. They are syncronized via two barriers \\(which isn\u2019t in the C\\+\\+ standard yet\\).\r\n\r\nCreating a thread and using a barrier ends up being slightly more efficient than the ign::common::WorkerPool, because we aren\u2019t creating and destroying WorkOrders in each loop. This is only really possible because we\u2019re making the same function calls repeatedly.\r\n\r\nThe barriers will block until all threads have reached the `barrier.wait()` call. This is why the barriers are constructed with a count of `number of postupdates + 1 (for the main thread)`\r\n\r\nEdit:\r\n\r\nThis now includes a worker thread for rendering sensors, causing rendering updates to happen in parallel with the main thread.  In the case that a new rendering operation is required, the main thread will block until the previous one is complete.  \r\n\r\nThis generally eliminates frames that substantially overran their allotted time \\(a rendering update could take 30-60x the allotted time\\).", "title": "Add worker threads for System PostUpdate phase", "destination": {"commit": {"hash": "a4486f0e1149", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/commit/a4486f0e1149.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/commits/a4486f0e1149"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{f98d11fe-f287-4dfb-99c3-e2b76a13232e}ts=2082645"}}, "type": "repository", "name": "ign-gazebo", "full_name": "ignitionrobotics/ign-gazebo", "uuid": "{f98d11fe-f287-4dfb-99c3-e2b76a13232e}"}, "branch": {"name": "ign-gazebo2"}}, "reason": "", "source": {"commit": {"hash": "a0443a8faf21", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/commit/a0443a8faf21.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/commits/a0443a8faf21"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{f98d11fe-f287-4dfb-99c3-e2b76a13232e}ts=2082645"}}, "type": "repository", "name": "ign-gazebo", "full_name": "ignitionrobotics/ign-gazebo", "uuid": "{f98d11fe-f287-4dfb-99c3-e2b76a13232e}"}, "branch": {"name": "thread_postupdate"}}, "state": "OPEN", "author": {"display_name": "Michael Carroll", "uuid": "{17dbbc15-cbc0-42f0-a985-cde9061c78a0}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B17dbbc15-cbc0-42f0-a985-cde9061c78a0%7D"}, "html": {"href": "https://bitbucket.org/%7B17dbbc15-cbc0-42f0-a985-cde9061c78a0%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:65740f22-cc56-4418-9608-7e17d0ed47b7/2aa259f5-4de1-4f68-9156-eded72041d84/128"}}, "nickname": "Michael Carroll", "type": "user", "account_id": "557058:65740f22-cc56-4418-9608-7e17d0ed47b7"}, "date": "2019-07-24T16:59:49.032044+00:00"}, "pull_request": {"type": "pullrequest", "id": 387, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/387.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/387"}}, "title": "Add worker threads for System PostUpdate phase"}}, {"update": {"description": "The general idea here is put each of the `PostUpdate` calls \\(for systems that implement them\\) in their own worker thread. They are syncronized via two barriers \\(which isn\u2019t in the C\\+\\+ standard yet\\).\r\n\r\nCreating a thread and using a barrier ends up being slightly more efficient than the ign::common::WorkerPool, because we aren\u2019t creating and destroying WorkOrders in each loop. This is only really possible because we\u2019re making the same function calls repeatedly.\r\n\r\nThe barriers will block until all threads have reached the `barrier.wait()` call. This is why the barriers are constructed with a count of `number of postupdates + 1 (for the main thread)`\r\n\r\nEdit:\r\n\r\nThis now includes a worker thread for rendering sensors, causing rendering updates to happen in parallel with the main thread.  In the case that a new rendering operation is required, the main thread will block until the previous one is complete.  \r\n\r\nThis generally eliminates frames that substantially overran their allotted time \\(a rendering update could take 30-60x the allotted time\\).", "title": "Add worker threads for System PostUpdate phase", "destination": {"commit": {"hash": "a4486f0e1149", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/commit/a4486f0e1149.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/commits/a4486f0e1149"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{f98d11fe-f287-4dfb-99c3-e2b76a13232e}ts=2082645"}}, "type": "repository", "name": "ign-gazebo", "full_name": "ignitionrobotics/ign-gazebo", "uuid": "{f98d11fe-f287-4dfb-99c3-e2b76a13232e}"}, "branch": {"name": "ign-gazebo2"}}, "reason": "", "source": {"commit": {"hash": "a0443a8faf21", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/commit/a0443a8faf21.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/commits/a0443a8faf21"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{f98d11fe-f287-4dfb-99c3-e2b76a13232e}ts=2082645"}}, "type": "repository", "name": "ign-gazebo", "full_name": "ignitionrobotics/ign-gazebo", "uuid": "{f98d11fe-f287-4dfb-99c3-e2b76a13232e}"}, "branch": {"name": "thread_postupdate"}}, "state": "OPEN", "author": {"display_name": "Michael Carroll", "uuid": "{17dbbc15-cbc0-42f0-a985-cde9061c78a0}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B17dbbc15-cbc0-42f0-a985-cde9061c78a0%7D"}, "html": {"href": "https://bitbucket.org/%7B17dbbc15-cbc0-42f0-a985-cde9061c78a0%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:65740f22-cc56-4418-9608-7e17d0ed47b7/2aa259f5-4de1-4f68-9156-eded72041d84/128"}}, "nickname": "Michael Carroll", "type": "user", "account_id": "557058:65740f22-cc56-4418-9608-7e17d0ed47b7"}, "date": "2019-07-24T16:59:47.662630+00:00"}, "pull_request": {"type": "pullrequest", "id": 387, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/387.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/387"}}, "title": "Add worker threads for System PostUpdate phase"}}, {"update": {"description": "The general idea here is put each of the `PostUpdate` calls \\(for systems that implement them\\) in their own worker thread. They are syncronized via two barriers \\(which isn\u2019t in the C\\+\\+ standard yet\\).\r\n\r\nCreating a thread and using a barrier ends up being slightly more efficient than the ign::common::WorkerPool, because we aren\u2019t creating and destroying WorkOrders in each loop. This is only really possible because we\u2019re making the same function calls repeatedly.\r\n\r\nThe barriers will block until all threads have reached the `barrier.wait()` call. This is why the barriers are constructed with a count of `number of postupdates + 1 (for the main thread)`\r\n\r\nEdit:\r\n\r\nThis now includes a worker thread for rendering sensors, causing rendering updates to happen in parallel with the main thread.  In the case that a new rendering operation is required, the main thread will block until the previous one is complete.  \r\n\r\nThis generally eliminates frames that substantially overran their allotted time \\(a rendering update could take 30-60x the allotted time\\).", "title": "Add worker threads for System PostUpdate phase", "destination": {"commit": {"hash": "a4486f0e1149", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/commit/a4486f0e1149.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/commits/a4486f0e1149"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{f98d11fe-f287-4dfb-99c3-e2b76a13232e}ts=2082645"}}, "type": "repository", "name": "ign-gazebo", "full_name": "ignitionrobotics/ign-gazebo", "uuid": "{f98d11fe-f287-4dfb-99c3-e2b76a13232e}"}, "branch": {"name": "ign-gazebo2"}}, "reason": "", "source": {"commit": {"hash": "58968a253ed0", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/commit/58968a253ed0.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/commits/58968a253ed0"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{f98d11fe-f287-4dfb-99c3-e2b76a13232e}ts=2082645"}}, "type": "repository", "name": "ign-gazebo", "full_name": "ignitionrobotics/ign-gazebo", "uuid": "{f98d11fe-f287-4dfb-99c3-e2b76a13232e}"}, "branch": {"name": "thread_postupdate"}}, "state": "OPEN", "author": {"display_name": "Michael Carroll", "uuid": "{17dbbc15-cbc0-42f0-a985-cde9061c78a0}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B17dbbc15-cbc0-42f0-a985-cde9061c78a0%7D"}, "html": {"href": "https://bitbucket.org/%7B17dbbc15-cbc0-42f0-a985-cde9061c78a0%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:65740f22-cc56-4418-9608-7e17d0ed47b7/2aa259f5-4de1-4f68-9156-eded72041d84/128"}}, "nickname": "Michael Carroll", "type": "user", "account_id": "557058:65740f22-cc56-4418-9608-7e17d0ed47b7"}, "date": "2019-07-24T16:53:31.673676+00:00"}, "pull_request": {"type": "pullrequest", "id": 387, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/387.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/387"}}, "title": "Add worker threads for System PostUpdate phase"}}, {"update": {"description": "The general idea here is put each of the `PostUpdate` calls \\(for systems that implement them\\) in their own worker thread. They are syncronized via two barriers \\(which isn\u2019t in the C\\+\\+ standard yet\\).\r\n\r\nCreating a thread and using a barrier ends up being slightly more efficient than the ign::common::WorkerPool, because we aren\u2019t creating and destroying WorkOrders in each loop. This is only really possible because we\u2019re making the same function calls repeatedly.\r\n\r\nThe barriers will block until all threads have reached the `barrier.wait()` call. This is why the barriers are constructed with a count of `number of postupdates + 1 (for the main thread)`\r\n\r\nEdit:\r\n\r\nThis now includes a worker thread for rendering sensors, causing rendering updates to happen in parallel with the main thread.  In the case that a new rendering operation is required, the main thread will block until the previous one is complete.  \r\n\r\nThis generally eliminates frames that substantially overran their allotted time \\(a rendering update could take 30-60x the allotted time\\).", "title": "Add worker threads for System PostUpdate phase", "destination": {"commit": {"hash": "14b90ce8453c", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/commit/14b90ce8453c.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/commits/14b90ce8453c"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{f98d11fe-f287-4dfb-99c3-e2b76a13232e}ts=2082645"}}, "type": "repository", "name": "ign-gazebo", "full_name": "ignitionrobotics/ign-gazebo", "uuid": "{f98d11fe-f287-4dfb-99c3-e2b76a13232e}"}, "branch": {"name": "ign-gazebo2"}}, "reason": "", "source": {"commit": {"hash": "b9010251d7e6", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/commit/b9010251d7e6.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/commits/b9010251d7e6"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{f98d11fe-f287-4dfb-99c3-e2b76a13232e}ts=2082645"}}, "type": "repository", "name": "ign-gazebo", "full_name": "ignitionrobotics/ign-gazebo", "uuid": "{f98d11fe-f287-4dfb-99c3-e2b76a13232e}"}, "branch": {"name": "thread_postupdate"}}, "state": "OPEN", "author": {"display_name": "Michael Carroll", "uuid": "{17dbbc15-cbc0-42f0-a985-cde9061c78a0}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B17dbbc15-cbc0-42f0-a985-cde9061c78a0%7D"}, "html": {"href": "https://bitbucket.org/%7B17dbbc15-cbc0-42f0-a985-cde9061c78a0%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:65740f22-cc56-4418-9608-7e17d0ed47b7/2aa259f5-4de1-4f68-9156-eded72041d84/128"}}, "nickname": "Michael Carroll", "type": "user", "account_id": "557058:65740f22-cc56-4418-9608-7e17d0ed47b7"}, "date": "2019-07-24T00:18:58.339317+00:00"}, "pull_request": {"type": "pullrequest", "id": 387, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/387.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/387"}}, "title": "Add worker threads for System PostUpdate phase"}}, {"update": {"description": "The general idea here is put each of the `PostUpdate` calls \\(for systems that implement them\\) in their own worker thread. They are syncronized via two barriers \\(which isn\u2019t in the C\\+\\+ standard yet\\).\r\n\r\nCreating a thread and using a barrier ends up being slightly more efficient than the ign::common::WorkerPool, because we aren\u2019t creating and destroying WorkOrders in each loop. This is only really possible because we\u2019re making the same function calls repeatedly.\r\n\r\nThe barriers will block until all threads have reached the `barrier.wait()` call. This is why the barriers are constructed with a count of `number of postupdates + 1 (for the main thread)`\r\n\r\nEdit:\r\n\r\nThis now includes a worker thread for rendering sensors, causing rendering updates to happen in parallel with the main thread.  In the case that a new rendering operation is required, the main thread will block until the previous one is complete.  \r\n\r\nThis generally eliminates frames that substantially overran their allotted time \\(a rendering update could take 30-60x the allotted time\\).", "title": "Add worker threads for System PostUpdate phase", "destination": {"commit": {"hash": "14b90ce8453c", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/commit/14b90ce8453c.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/commits/14b90ce8453c"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{f98d11fe-f287-4dfb-99c3-e2b76a13232e}ts=2082645"}}, "type": "repository", "name": "ign-gazebo", "full_name": "ignitionrobotics/ign-gazebo", "uuid": "{f98d11fe-f287-4dfb-99c3-e2b76a13232e}"}, "branch": {"name": "ign-gazebo2"}}, "reason": "", "source": {"commit": {"hash": "95bc14b8516a", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/commit/95bc14b8516a.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/commits/95bc14b8516a"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{f98d11fe-f287-4dfb-99c3-e2b76a13232e}ts=2082645"}}, "type": "repository", "name": "ign-gazebo", "full_name": "ignitionrobotics/ign-gazebo", "uuid": "{f98d11fe-f287-4dfb-99c3-e2b76a13232e}"}, "branch": {"name": "thread_postupdate"}}, "state": "OPEN", "author": {"display_name": "Michael Carroll", "uuid": "{17dbbc15-cbc0-42f0-a985-cde9061c78a0}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B17dbbc15-cbc0-42f0-a985-cde9061c78a0%7D"}, "html": {"href": "https://bitbucket.org/%7B17dbbc15-cbc0-42f0-a985-cde9061c78a0%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:65740f22-cc56-4418-9608-7e17d0ed47b7/2aa259f5-4de1-4f68-9156-eded72041d84/128"}}, "nickname": "Michael Carroll", "type": "user", "account_id": "557058:65740f22-cc56-4418-9608-7e17d0ed47b7"}, "date": "2019-07-23T23:47:34.647250+00:00"}, "pull_request": {"type": "pullrequest", "id": 387, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/387.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/387"}}, "title": "Add worker threads for System PostUpdate phase"}}, {"update": {"description": "The general idea here is put each of the `PostUpdate` calls \\(for systems that implement them\\) in their own worker thread. They are syncronized via two barriers \\(which isn\u2019t in the C\\+\\+ standard yet\\).\r\n\r\nCreating a thread and using a barrier ends up being slightly more efficient than the ign::common::WorkerPool, because we aren\u2019t creating and destroying WorkOrders in each loop. This is only really possible because we\u2019re making the same function calls repeatedly.\r\n\r\nThe barriers will block until all threads have reached the `barrier.wait()` call. This is why the barriers are constructed with a count of `number of postupdates + 1 (for the main thread)`\r\n\r\nEdit:\r\n\r\nThis now includes a worker thread for rendering sensors, causing rendering updates to happen in parallel with the main thread.  In the case that a new rendering operation is required, the main thread will block until the previous one is complete.  \r\n\r\nThis generally eliminates frames that substantially overran their allotted time \\(a rendering update could take 30-60x the allotted time\\).", "title": "Add worker threads for System PostUpdate phase", "destination": {"commit": {"hash": "14b90ce8453c", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/commit/14b90ce8453c.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/commits/14b90ce8453c"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{f98d11fe-f287-4dfb-99c3-e2b76a13232e}ts=2082645"}}, "type": "repository", "name": "ign-gazebo", "full_name": "ignitionrobotics/ign-gazebo", "uuid": "{f98d11fe-f287-4dfb-99c3-e2b76a13232e}"}, "branch": {"name": "ign-gazebo2"}}, "reason": "", "source": {"commit": {"hash": "41c4a4d77a1c", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/commit/41c4a4d77a1c.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/commits/41c4a4d77a1c"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{f98d11fe-f287-4dfb-99c3-e2b76a13232e}ts=2082645"}}, "type": "repository", "name": "ign-gazebo", "full_name": "ignitionrobotics/ign-gazebo", "uuid": "{f98d11fe-f287-4dfb-99c3-e2b76a13232e}"}, "branch": {"name": "thread_postupdate"}}, "state": "OPEN", "author": {"display_name": "Michael Carroll", "uuid": "{17dbbc15-cbc0-42f0-a985-cde9061c78a0}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B17dbbc15-cbc0-42f0-a985-cde9061c78a0%7D"}, "html": {"href": "https://bitbucket.org/%7B17dbbc15-cbc0-42f0-a985-cde9061c78a0%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:65740f22-cc56-4418-9608-7e17d0ed47b7/2aa259f5-4de1-4f68-9156-eded72041d84/128"}}, "nickname": "Michael Carroll", "type": "user", "account_id": "557058:65740f22-cc56-4418-9608-7e17d0ed47b7"}, "date": "2019-07-23T23:41:04.829677+00:00"}, "pull_request": {"type": "pullrequest", "id": 387, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/387.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/387"}}, "title": "Add worker threads for System PostUpdate phase"}}, {"update": {"description": "The general idea here is put each of the `PostUpdate` calls \\(for systems that implement them\\) in their own worker thread. They are syncronized via two barriers \\(which isn\u2019t in the C\\+\\+ standard yet\\).\r\n\r\nCreating a thread and using a barrier ends up being slightly more efficient than the ign::common::WorkerPool, because we aren\u2019t creating and destroying WorkOrders in each loop. This is only really possible because we\u2019re making the same function calls repeatedly.\r\n\r\nThe barriers will block until all threads have reached the `barrier.wait()` call. This is why the barriers are constructed with a count of `number of postupdates + 1 (for the main thread)`\r\n\r\nEdit:\r\n\r\nThis now includes a worker thread for rendering sensors, causing rendering updates to happen in parallel with the main thread.  In the case that a new rendering operation is required, the main thread will block until the previous one is complete.  \r\n\r\nThis generally eliminates frames that substantially overran their allotted time \\(a rendering update could take 30-60x the allotted time\\).", "title": "Add worker threads for System PostUpdate phase", "destination": {"commit": {"hash": "5d3971aaccd5", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/commit/5d3971aaccd5.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/commits/5d3971aaccd5"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{f98d11fe-f287-4dfb-99c3-e2b76a13232e}ts=2082645"}}, "type": "repository", "name": "ign-gazebo", "full_name": "ignitionrobotics/ign-gazebo", "uuid": "{f98d11fe-f287-4dfb-99c3-e2b76a13232e}"}, "branch": {"name": "ign-gazebo2"}}, "reason": "", "source": {"commit": {"hash": "a6a969cd79c6", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/commit/a6a969cd79c6.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/commits/a6a969cd79c6"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{f98d11fe-f287-4dfb-99c3-e2b76a13232e}ts=2082645"}}, "type": "repository", "name": "ign-gazebo", "full_name": "ignitionrobotics/ign-gazebo", "uuid": "{f98d11fe-f287-4dfb-99c3-e2b76a13232e}"}, "branch": {"name": "thread_postupdate"}}, "state": "OPEN", "author": {"display_name": "Michael Carroll", "uuid": "{17dbbc15-cbc0-42f0-a985-cde9061c78a0}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B17dbbc15-cbc0-42f0-a985-cde9061c78a0%7D"}, "html": {"href": "https://bitbucket.org/%7B17dbbc15-cbc0-42f0-a985-cde9061c78a0%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:65740f22-cc56-4418-9608-7e17d0ed47b7/2aa259f5-4de1-4f68-9156-eded72041d84/128"}}, "nickname": "Michael Carroll", "type": "user", "account_id": "557058:65740f22-cc56-4418-9608-7e17d0ed47b7"}, "date": "2019-07-23T23:22:04.266356+00:00"}, "pull_request": {"type": "pullrequest", "id": 387, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/387.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/387"}}, "title": "Add worker threads for System PostUpdate phase"}}, {"comment": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/387/comments/110412473.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/387/_/diff#comment-110412473"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 387, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/387.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/387"}}, "title": "Add worker threads for System PostUpdate phase"}, "content": {"raw": "I think this comment goes with `PreRender` a few lines below.", "markup": "markdown", "html": "<p>I think this comment goes with <code>PreRender</code> a few lines below.</p>", "type": "rendered"}, "created_on": "2019-07-23T22:50:17.530406+00:00", "user": {"display_name": "Addisu Z. Taddese", "uuid": "{9d7fdc68-d270-4080-bf03-4df0d0dbf635}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B9d7fdc68-d270-4080-bf03-4df0d0dbf635%7D"}, "html": {"href": "https://bitbucket.org/%7B9d7fdc68-d270-4080-bf03-4df0d0dbf635%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:90bc87b0-2886-4377-a17c-3a6629a697ff/afbf9be5-1e4c-4810-89d4-e58831f34b11/128"}}, "nickname": "azeey", "type": "user", "account_id": "557058:90bc87b0-2886-4377-a17c-3a6629a697ff"}, "inline": {}, "updated_on": "2019-07-23T22:50:17.538088+00:00", "type": "pullrequest_comment", "id": 110412473}, "pull_request": {"type": "pullrequest", "id": 387, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/387.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/387"}}, "title": "Add worker threads for System PostUpdate phase"}}, {"comment": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/387/comments/110409022.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/387/_/diff#comment-110409022"}}, "parent": {"id": 110400558, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/387/comments/110400558.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/387/_/diff#comment-110400558"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 387, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/387.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/387"}}, "title": "Add worker threads for System PostUpdate phase"}, "content": {"raw": "I went ahead and removed it in [75fb874](#!/ignitionrobotics/ign-gazebo/commits/75fb874250646c61a3fcc63c991cb52a075f6cc7?at=ign-gazebo2)", "markup": "markdown", "html": "<p>I went ahead and removed it in <a data-is-external-link=\"true\" href=\"#!/ignitionrobotics/ign-gazebo/commits/75fb874250646c61a3fcc63c991cb52a075f6cc7?at=ign-gazebo2\" rel=\"nofollow\">75fb874</a></p>", "type": "rendered"}, "created_on": "2019-07-23T22:05:01.528529+00:00", "user": {"display_name": "Michael Carroll", "uuid": "{17dbbc15-cbc0-42f0-a985-cde9061c78a0}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B17dbbc15-cbc0-42f0-a985-cde9061c78a0%7D"}, "html": {"href": "https://bitbucket.org/%7B17dbbc15-cbc0-42f0-a985-cde9061c78a0%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:65740f22-cc56-4418-9608-7e17d0ed47b7/2aa259f5-4de1-4f68-9156-eded72041d84/128"}}, "nickname": "Michael Carroll", "type": "user", "account_id": "557058:65740f22-cc56-4418-9608-7e17d0ed47b7"}, "inline": {}, "updated_on": "2019-07-23T22:05:01.538842+00:00", "type": "pullrequest_comment", "id": 110409022}, "pull_request": {"type": "pullrequest", "id": 387, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/387.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/387"}}, "title": "Add worker threads for System PostUpdate phase"}}, {"comment": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/387/comments/110409005.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/387/_/diff#comment-110409005"}}, "parent": {"id": 110400439, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/387/comments/110400439.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/387/_/diff#comment-110400439"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 387, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/387.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/387"}}, "title": "Add worker threads for System PostUpdate phase"}, "content": {"raw": "In [75fb874](#!/ignitionrobotics/ign-gazebo/commits/75fb874250646c61a3fcc63c991cb52a075f6cc7?at=ign-gazebo2), I made it so that worker threads are stopped before the `AddSystemToRunner` call, which is the only place that appends systems to `systemsPostUpdate`.  This should be safer now.", "markup": "markdown", "html": "<p>In <a data-is-external-link=\"true\" href=\"#!/ignitionrobotics/ign-gazebo/commits/75fb874250646c61a3fcc63c991cb52a075f6cc7?at=ign-gazebo2\" rel=\"nofollow\">75fb874</a>, I made it so that worker threads are stopped before the <code>AddSystemToRunner</code> call, which is the only place that appends systems to <code>systemsPostUpdate</code>.  This should be safer now.</p>", "type": "rendered"}, "created_on": "2019-07-23T22:04:52.670168+00:00", "user": {"display_name": "Michael Carroll", "uuid": "{17dbbc15-cbc0-42f0-a985-cde9061c78a0}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B17dbbc15-cbc0-42f0-a985-cde9061c78a0%7D"}, "html": {"href": "https://bitbucket.org/%7B17dbbc15-cbc0-42f0-a985-cde9061c78a0%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:65740f22-cc56-4418-9608-7e17d0ed47b7/2aa259f5-4de1-4f68-9156-eded72041d84/128"}}, "nickname": "Michael Carroll", "type": "user", "account_id": "557058:65740f22-cc56-4418-9608-7e17d0ed47b7"}, "inline": {}, "updated_on": "2019-07-23T22:04:52.681632+00:00", "type": "pullrequest_comment", "id": 110409005}, "pull_request": {"type": "pullrequest", "id": 387, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/387.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/387"}}, "title": "Add worker threads for System PostUpdate phase"}}], "next": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/387/activity_ctx=KpC9Xtdsb.json"}