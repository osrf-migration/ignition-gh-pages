{"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/34/comments/75234712.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/34/_/diff#comment-75234712"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 34, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/34.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/34"}}, "title": "Fix performance by disabling worker pool"}, "content": {"raw": "This is definitely an improvement, if I comment out the sleep inside the physics system callback:\n\n~~~\ndiff -r 3b20252af890 src/systems/Physics.cc\n--- a/src/systems/Physics.cc    Thu Sep 06 10:12:19 2018 -0700\n+++ b/src/systems/Physics.cc    Thu Sep 06 10:52:36 2018 -0700\n@@ -81,7 +81,7 @@\n \n   // Sleep for some amount of time to simulate the computation needed to\n   // update physics.\n-  std::this_thread::sleep_for(50us);\n+//  std::this_thread::sleep_for(50us);\n \n   _manager.Each<components::Name, components::Pose>(\n~~~\n\nThe following results in an RTF bouncing around 700% ~ 900%\n\n`ign-gazebo -v 0 -f test/worlds/shapes.sdf -z 10000`\n\nAnd with the following I get at most 1600%:\n\n`ign-gazebo -v 0 -f ../test/worlds/shapes.sdf -z 100000`\n\nThat seems to be the new upper-bound, so this PR increases, at least on my machine, one order of magnitude from ~160% to ~1600%.", "markup": "markdown", "html": "<p>This is definitely an improvement, if I comment out the sleep inside the physics system callback:</p>\n<div class=\"codehilite\"><pre><span></span><span class=\"gh\">diff -r 3b20252af890 src/systems/Physics.cc</span>\n<span class=\"gd\">--- a/src/systems/Physics.cc    Thu Sep 06 10:12:19 2018 -0700</span>\n<span class=\"gi\">+++ b/src/systems/Physics.cc    Thu Sep 06 10:52:36 2018 -0700</span>\n<span class=\"gu\">@@ -81,7 +81,7 @@</span>\n\n   // Sleep for some amount of time to simulate the computation needed to\n   // update physics.\n<span class=\"gd\">-  std::this_thread::sleep_for(50us);</span>\n<span class=\"gi\">+//  std::this_thread::sleep_for(50us);</span>\n\n   _manager.Each&lt;components::Name, components::Pose&gt;(\n</pre></div>\n\n\n<p>The following results in an RTF bouncing around 700% ~ 900%</p>\n<p><code>ign-gazebo -v 0 -f test/worlds/shapes.sdf -z 10000</code></p>\n<p>And with the following I get at most 1600%:</p>\n<p><code>ign-gazebo -v 0 -f ../test/worlds/shapes.sdf -z 100000</code></p>\n<p>That seems to be the new upper-bound, so this PR increases, at least on my machine, one order of magnitude from ~160% to ~1600%.</p>", "type": "rendered"}, "created_on": "2018-09-06T17:57:26.352187+00:00", "user": {"display_name": "Louise Poubel", "uuid": "{5cfa2075-477b-4ded-bdb9-8d2479544ec4}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D"}, "html": {"href": "https://bitbucket.org/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8/7d903d90-c5ea-4182-b7ef-0d467e9e1c74/128"}}, "nickname": "chapulina", "type": "user", "account_id": "557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8"}, "updated_on": "2018-09-06T17:57:26.361240+00:00", "type": "pullrequest_comment", "id": 75234712}