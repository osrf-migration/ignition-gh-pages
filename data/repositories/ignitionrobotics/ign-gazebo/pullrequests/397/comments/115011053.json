{"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397/comments/115011053.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397/_/diff#comment-115011053"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 397, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397"}}, "title": "[Blueprint] Logging meshes and materials"}, "content": {"raw": "Various observations:\n\n---\n\nI'm seeing the `log.zip` file being created even if I'm not recording resources. Is this expected?\n\n---\n\nI also noticed that if I run the `log_record_resources` world twice in a row I get these messages:\n\n```\n[Err] [Zip.cc:42] Error adding directory to zip: /tmp/log\n[Err] [Zip.cc:103] Error compressing file: /tmp/log\n[Err] [LogRecord.cc:534] Failed to compressed log file and resources to [/tmp/log.zip]\n```\n\nIf I remember correctly, we were creating new numbered directories if the directory already existed?\n\n---\n\nThe `zip` file is created as a sibling to the record path, i.e.:\n\n```\n/tmp/log\n|-- home\n|   `-- chapulina\n|-- server_console.log\n`-- state.tlog\n/tmp/log.zip\n```\n\nThis was a bit counter-intuitive to me, because I was expecting Gazebo not to create any files outside that directory. But maybe it's just me.\n\nAlso, keeping both the zip file and the original folders means every log takes even more space, with redundant information. Some things I'm wondering about:\n\n* Should we delete the directory after zipping it?\n\n* Should we make zipping optional?\n\n* Should we support playing back directly from the zip file?\n\n---\n\nI think we more fixes to the paths are needed. Try this:\n\n1. `ign gazebo -v 4 -r log_record_resources.sdf --record-resources --record-path '/tmp/log'`\n1. `rm -rf ~/.ignition/fuel/fuel.ignitionrobotics.org/openrobotics/models/subt_tunnel_staging_area`\n1. `ign gazebo --force-version 2.9.0 -v 4 -r log_playback.sdf`\n\nInstead of loading the logged mesh, the simulation prints these errors:\n\n```\n[GUI] [Err] [SystemPaths.cc:434] File [file:///home/chapulina/.ignition/fuel/fuel.ignitionrobotics.org/openrobotics/models/subt_tunnel_staging_area/2//meshes/Asphalt_Plane.DAE] resolved to path [/home/chapulina/.ignition/fuel/fuel.ignitionrobotics.org/openrobotics/models/subt_tunnel_staging_area/2//meshes/Asphalt_Plane.DAE] but the path does not exist\n[GUI] [Err] [MeshManager.cc:172] Unable to find file[file:///home/chapulina/.ignition/fuel/fuel.ignitionrobotics.org/openrobotics/models/subt_tunnel_staging_area/2//meshes/Asphalt_Plane.DAE]\n[GUI] [Err] [MeshDescriptor.cc:56] Mesh manager can't find mesh named [file:///home/chapulina/.ignition/fuel/fuel.ignitionrobotics.org/openrobotics/models/subt_tunnel_staging_area/2//meshes/Asphalt_Plane.DAE]\n[GUI] [Err] [Ogre2MeshFactory.cc:430] Cannot load null mesh [file:///home/chapulina/.ignition/fuel/fuel.ignitionrobotics.org/openrobotics/models/subt_tunnel_staging_area/2//meshes/Asphalt_Plane.DAE]\n[GUI] [Err] [Ogre2MeshFactory.cc:72] Failed to get Ogre item for [file:///home/chapulina/.ignition/fuel/fuel.ignitionrobotics.org/openrobotics/models/subt_tunnel_staging_area/2//meshes/Asphalt_Plane.DAE]\n[GUI] [Err] [SceneManager.cc:271] Failed to load geometry for visual: plane_visual\n[GUI] [Err] [SystemPaths.cc:434] File [file:///home/chapulina/.ignition/fuel/fuel.ignitionrobotics.org/openrobotics/models/subt_tunnel_staging_area/2//meshes/Entrance.obj] resolved to path [/home/chapulina/.ignition/fuel/fuel.ignitionrobotics.org/openrobotics/models/subt_tunnel_staging_area/2//meshes/Entrance.obj] but the path does not exist\n[GUI] [Err] [MeshManager.cc:172] Unable to find file[file:///home/chapulina/.ignition/fuel/fuel.ignitionrobotics.org/openrobotics/models/subt_tunnel_staging_area/2//meshes/Entrance.obj]\n[GUI] [Err] [MeshDescriptor.cc:56] Mesh manager can't find mesh named [file:///home/chapulina/.ignition/fuel/fuel.ignitionrobotics.org/openrobotics/models/subt_tunnel_staging_area/2//meshes/Entrance.obj]\n[GUI] [Err] [Ogre2MeshFactory.cc:430] Cannot load null mesh [file:///home/chapulina/.ignition/fuel/fuel.ignitionrobotics.org/openrobotics/models/subt_tunnel_staging_area/2//meshes/Entrance.obj]\n[GUI] [Err] [Ogre2MeshFactory.cc:72] Failed to get Ogre item for [file:///home/chapulina/.ignition/fuel/fuel.ignitionrobotics.org/openrobotics/models/subt_tunnel_staging_area/2//meshes/Entrance.obj]\n[GUI] [Err] [SceneManager.cc:271] Failed to load geometry for visual: visual\n```", "markup": "markdown", "html": "<p>Various observations:</p>\n<hr />\n<p>I'm seeing the <code>log.zip</code> file being created even if I'm not recording resources. Is this expected?</p>\n<hr />\n<p>I also noticed that if I run the <code>log_record_resources</code> world twice in a row I get these messages:</p>\n<div class=\"codehilite\"><pre><span></span>[Err] [Zip.cc:42] Error adding directory to zip: /tmp/log\n[Err] [Zip.cc:103] Error compressing file: /tmp/log\n[Err] [LogRecord.cc:534] Failed to compressed log file and resources to [/tmp/log.zip]\n</pre></div>\n\n\n<p>If I remember correctly, we were creating new numbered directories if the directory already existed?</p>\n<hr />\n<p>The <code>zip</code> file is created as a sibling to the record path, i.e.:</p>\n<div class=\"codehilite\"><pre><span></span>/tmp/log\n|-- home\n|   `-- chapulina\n|-- server_console.log\n`-- state.tlog\n/tmp/log.zip\n</pre></div>\n\n\n<p>This was a bit counter-intuitive to me, because I was expecting Gazebo not to create any files outside that directory. But maybe it's just me.</p>\n<p>Also, keeping both the zip file and the original folders means every log takes even more space, with redundant information. Some things I'm wondering about:</p>\n<ul>\n<li>\n<p>Should we delete the directory after zipping it?</p>\n</li>\n<li>\n<p>Should we make zipping optional?</p>\n</li>\n<li>\n<p>Should we support playing back directly from the zip file?</p>\n</li>\n</ul>\n<hr />\n<p>I think we more fixes to the paths are needed. Try this:</p>\n<ol>\n<li><code>ign gazebo -v 4 -r log_record_resources.sdf --record-resources --record-path '/tmp/log'</code></li>\n<li><code>rm -rf ~/.ignition/fuel/fuel.ignitionrobotics.org/openrobotics/models/subt_tunnel_staging_area</code></li>\n<li><code>ign gazebo --force-version 2.9.0 -v 4 -r log_playback.sdf</code></li>\n</ol>\n<p>Instead of loading the logged mesh, the simulation prints these errors:</p>\n<div class=\"codehilite\"><pre><span></span>[GUI] [Err] [SystemPaths.cc:434] File [file:///home/chapulina/.ignition/fuel/fuel.ignitionrobotics.org/openrobotics/models/subt_tunnel_staging_area/2//meshes/Asphalt_Plane.DAE] resolved to path [/home/chapulina/.ignition/fuel/fuel.ignitionrobotics.org/openrobotics/models/subt_tunnel_staging_area/2//meshes/Asphalt_Plane.DAE] but the path does not exist\n[GUI] [Err] [MeshManager.cc:172] Unable to find file[file:///home/chapulina/.ignition/fuel/fuel.ignitionrobotics.org/openrobotics/models/subt_tunnel_staging_area/2//meshes/Asphalt_Plane.DAE]\n[GUI] [Err] [MeshDescriptor.cc:56] Mesh manager can&#39;t find mesh named [file:///home/chapulina/.ignition/fuel/fuel.ignitionrobotics.org/openrobotics/models/subt_tunnel_staging_area/2//meshes/Asphalt_Plane.DAE]\n[GUI] [Err] [Ogre2MeshFactory.cc:430] Cannot load null mesh [file:///home/chapulina/.ignition/fuel/fuel.ignitionrobotics.org/openrobotics/models/subt_tunnel_staging_area/2//meshes/Asphalt_Plane.DAE]\n[GUI] [Err] [Ogre2MeshFactory.cc:72] Failed to get Ogre item for [file:///home/chapulina/.ignition/fuel/fuel.ignitionrobotics.org/openrobotics/models/subt_tunnel_staging_area/2//meshes/Asphalt_Plane.DAE]\n[GUI] [Err] [SceneManager.cc:271] Failed to load geometry for visual: plane_visual\n[GUI] [Err] [SystemPaths.cc:434] File [file:///home/chapulina/.ignition/fuel/fuel.ignitionrobotics.org/openrobotics/models/subt_tunnel_staging_area/2//meshes/Entrance.obj] resolved to path [/home/chapulina/.ignition/fuel/fuel.ignitionrobotics.org/openrobotics/models/subt_tunnel_staging_area/2//meshes/Entrance.obj] but the path does not exist\n[GUI] [Err] [MeshManager.cc:172] Unable to find file[file:///home/chapulina/.ignition/fuel/fuel.ignitionrobotics.org/openrobotics/models/subt_tunnel_staging_area/2//meshes/Entrance.obj]\n[GUI] [Err] [MeshDescriptor.cc:56] Mesh manager can&#39;t find mesh named [file:///home/chapulina/.ignition/fuel/fuel.ignitionrobotics.org/openrobotics/models/subt_tunnel_staging_area/2//meshes/Entrance.obj]\n[GUI] [Err] [Ogre2MeshFactory.cc:430] Cannot load null mesh [file:///home/chapulina/.ignition/fuel/fuel.ignitionrobotics.org/openrobotics/models/subt_tunnel_staging_area/2//meshes/Entrance.obj]\n[GUI] [Err] [Ogre2MeshFactory.cc:72] Failed to get Ogre item for [file:///home/chapulina/.ignition/fuel/fuel.ignitionrobotics.org/openrobotics/models/subt_tunnel_staging_area/2//meshes/Entrance.obj]\n[GUI] [Err] [SceneManager.cc:271] Failed to load geometry for visual: visual\n</pre></div>", "type": "rendered"}, "created_on": "2019-08-29T18:31:50.210692+00:00", "user": {"display_name": "Louise Poubel", "uuid": "{5cfa2075-477b-4ded-bdb9-8d2479544ec4}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D"}, "html": {"href": "https://bitbucket.org/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8/7d903d90-c5ea-4182-b7ef-0d467e9e1c74/128"}}, "nickname": "chapulina", "type": "user", "account_id": "557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8"}, "updated_on": "2019-08-29T18:32:42.365723+00:00", "type": "pullrequest_comment", "id": 115011053}