{"pagelen": 50, "values": [{"update": {"description": "Depends on [ign-common PR 200](#!/ignitionrobotics/ign-common/pull-requests/200/log-resources/diff).\r\n\r\nPorts [this Gazebo PR](https://bitbucket.org/osrf/gazebo/pull-requests/2811/save-models-material-and-meshes-when/diff) to Ignition.\r\n\r\nImplements `--record-resources`, and `--compress` and `--record-overwrite` to support it.\r\n\r\nRecords resources \\(`--record-resources`\\), i.e. meshes and materials, to a directory under the specified log record directory. Optionally compresses \\(`--compress`\\) the whole directory, which contains the existing `.tlog` sqlite3 file and any resources, to a zip file. If directory or compressed file already exist, optionally overwrites \\(`--record-overwrite`\\).\r\n\r\nCorresponding SDF plugin parameters: `<record_resources>1</record_resources>`, `<compress>1</compress>`, `<record_overwrite>1</record_overwrite>.`If both command line and SDF parameters are specified, command line option overwrites SDF parameter.\r\n\r\n## Usage:\r\n\r\n```\r\nign gazebo [...] --record-resources --record-overwrite --compress\r\n```\r\n\r\n## Test --record-resources:\r\n\r\n```\r\n# This SDF specifies the equivalent of --record-resources --record-path '/tmp/log'\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf\r\n$ ign gazebo -v 4 -r examples/worlds/log_playback.sdf\r\n```\r\n\r\nTested with `<include><uri>https://fuel...</uri></include>` and `<mesh><uri>file://...</uri></mesh>`. Paths specified by `model://` are not supported in Ignition yet, so this case in the code is not tested.\r\n\r\n## Test --log-overwrite and --compress:\r\n\r\nWhen recording to `path`, the compression file is implied to be `path.zip`. Both are checked for existence.\r\n\r\nNo `--log-overwrite` \\(default\\):\r\n\r\n```\r\n# This SDF specifies the equivalent of --record-resources --record-path '/tmp/log'\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf\r\n\r\n# Run it again, and it should write to new directory\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf\r\n[Wrn] [LogRecord.cc:260] Log path already exists on disk! Recording instead to [/tmp/log(1)]\r\n[Msg] Recording to log file [/tmp/log(1)/state.tlog]\r\n```\r\n\r\n`--log-overwrite`, `/tmp/log` already exists:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-overwrite --record-path '/tmp/log'\r\n[Wrn] [LogRecord.cc:292] Log path already exists on disk! Existing files will be overwritten.\r\n[Msg] Overwriting existing path [/tmp/log]\r\n...\r\n[Msg] Stopping recording\r\n```\r\n\r\n`--log-overwrite --compress`, `/tmp/log.zip` already exists:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --compress --log-overwrite --record-path '/tmp/log'\r\n[Wrn] [LogRecord.cc:291] Log path already exists on disk! Existing files will be overwritten.\r\n...\r\n[Msg] Overwriting existing file [/tmp/log.zip]\r\n[Msg] Compressed log file and resources to [/tmp/log.zip]. Removing recorded directory [/tmp/log].\r\n[Msg] Stopping recording\r\n```\r\n\r\n`--log-overwrite` only, `/tmp/log.zip` exists, `/tmp/log` does not exist:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-overwrite --record-path '/tmp/log'\r\n[Wrn] [LogRecord.cc:291] Log path already exists on disk! Existing files will be overwritten.\r\n[Msg] Overwriting existing path [/tmp/log]\r\n...\r\n[Msg] Stopping recording\r\n```\r\n\r\n`--compress` only, both `/tmp/log` and `/tmp/log.zip` already exist:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --compress --record-path '/tmp/log'\r\n[Wrn] [LogRecord.cc:299] Log path already exists on disk! Recording instead to [/tmp/log(1)]\r\n...\r\n[Msg] Compressed log file and resources to [/tmp/log(1).zip]. Removing recorded directory [/tmp/log(1)].\r\n[Msg] Stopping recording\r\n$ ls /tmp\r\nlog\r\n'log(1).zip'\r\nlog.zip\r\n```\r\n\r\n`--compress` only, `/tmp/log` does not exist, `/tmp/log.zip` already exists:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --compress --record-path '/tmp/log'\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n...\r\n[Err] [Zip.cc:42] Error adding directory to zip: /tmp/log\r\n[Err] [Zip.cc:103] Error compressing file: /tmp/log\r\n[Err] [LogRecord.cc:639] Failed to compressed log file and resources to [/tmp/log.zip]. Keeping recorded directory [/tmp/log].\r\n[Msg] Stopping recording\r\n```\r\n\r\n## Record Path vs. Console Log Path\r\n\r\nIn Blueprint and Citadel, if `--record` is specified without `--record-path`, and `<path>` exists in SDF, a warning is printed, and recording will go to `<path>`, while console log will go to the default timestamp path.\r\n\r\nAs in this example:\r\n\r\n```\r\n# SDF specifies <path>/tmp/log</path>\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --record\r\n[Wrn] [ServerPrivate.cc:229] --record-path is not specified on command line. <path> is specified in SDF. Will record to <path>. Console will be logged to [/home/master/.ignition/gazebo/log/2019-09-20T19:51:33.996055619]. Note: In Ignition-D, <path> will be ignored, and all recordings will be written to default console log path if no path is specified on command line.\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n```\r\n\r\nIn Ignition-D, `<path>` will be permanently ignored. Recordings and console log will go to same default path.\r\n\r\nIf `--record-path` is specified, then recording and console log will go to this path in Blueprint, Citadel, and Ignition-D.\r\n\r\n## Future Work\r\n\r\nFiles are outputted in `/tmp/log` and `/tmp/log.zip` in this example. During record, the original path in `file://` is prepended with the specified path, e.g. `/tmp/log`. During playback, the specified path is prepended to the URIs in the SDF.", "title": "[Blueprint] Logging meshes and materials", "destination": {"commit": {"hash": "890e28ea75d0", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/commit/890e28ea75d0.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/commits/890e28ea75d0"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{f98d11fe-f287-4dfb-99c3-e2b76a13232e}ts=2082645"}}, "type": "repository", "name": "ign-gazebo", "full_name": "ignitionrobotics/ign-gazebo", "uuid": "{f98d11fe-f287-4dfb-99c3-e2b76a13232e}"}, "branch": {"name": "ign-gazebo2"}}, "reason": "", "source": {"commit": {"hash": "b6d588b9b661", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/commit/b6d588b9b661.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/commits/b6d588b9b661"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{f98d11fe-f287-4dfb-99c3-e2b76a13232e}ts=2082645"}}, "type": "repository", "name": "ign-gazebo", "full_name": "ignitionrobotics/ign-gazebo", "uuid": "{f98d11fe-f287-4dfb-99c3-e2b76a13232e}"}, "branch": {"name": "log_resources"}}, "state": "OPEN", "author": {"display_name": "Mabel Zhang", "uuid": "{4b0e38fb-bf50-45c0-a496-61147518b2bf}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B4b0e38fb-bf50-45c0-a496-61147518b2bf%7D"}, "html": {"href": "https://bitbucket.org/%7B4b0e38fb-bf50-45c0-a496-61147518b2bf%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:ceb5942c-6843-408c-8550-3ce4899d299b/4d48e5ea-cf28-4fa7-9715-8fc9e315d831/128"}}, "nickname": "mabelmzhang", "type": "user", "account_id": "557058:ceb5942c-6843-408c-8550-3ce4899d299b"}, "date": "2019-09-20T23:51:59.444908+00:00"}, "pull_request": {"type": "pullrequest", "id": 397, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397"}}, "title": "[Blueprint] Logging meshes and materials"}}, {"update": {"description": "Depends on [ign-common PR 200](#!/ignitionrobotics/ign-common/pull-requests/200/log-resources/diff).\r\n\r\nPorts [this Gazebo PR](https://bitbucket.org/osrf/gazebo/pull-requests/2811/save-models-material-and-meshes-when/diff) to Ignition.\r\n\r\nImplements `--record-resources`, and `--compress` and `--record-overwrite` to support it.\r\n\r\nRecords resources \\(`--record-resources`\\), i.e. meshes and materials, to a directory under the specified log record directory. Optionally compresses \\(`--compress`\\) the whole directory, which contains the existing `.tlog` sqlite3 file and any resources, to a zip file. If directory or compressed file already exist, optionally overwrites \\(`--record-overwrite`\\).\r\n\r\nCorresponding SDF plugin parameters: `<record_resources>1</record_resources>`, `<compress>1</compress>`, `<record_overwrite>1</record_overwrite>.`If both command line and SDF parameters are specified, command line option overwrites SDF parameter.\r\n\r\n## Usage:\r\n\r\n```\r\nign gazebo [...] --record-resources --record-overwrite --compress\r\n```\r\n\r\n## Test --record-resources:\r\n\r\n```\r\n# This SDF specifies the equivalent of --record-resources --record-path '/tmp/log'\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf\r\n$ ign gazebo -v 4 -r examples/worlds/log_playback.sdf\r\n```\r\n\r\nTested with `<include><uri>https://fuel...</uri></include>` and `<mesh><uri>file://...</uri></mesh>`. Paths specified by `model://` are not supported in Ignition yet, so this case in the code is not tested.\r\n\r\n## Test --log-overwrite and --compress:\r\n\r\nWhen recording to `path`, the compression file is implied to be `path.zip`. Both are checked for existence.\r\n\r\nNo `--log-overwrite` \\(default\\):\r\n\r\n```\r\n# This SDF specifies the equivalent of --record-resources --record-path '/tmp/log'\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf\r\n\r\n# Run it again, and it should write to new directory\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf\r\n[Wrn] [LogRecord.cc:260] Log path already exists on disk! Recording instead to [/tmp/log(1)]\r\n[Msg] Recording to log file [/tmp/log(1)/state.tlog]\r\n```\r\n\r\n`--log-overwrite`, `/tmp/log` already exists:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-overwrite --record-path '/tmp/log'\r\n[Wrn] [LogRecord.cc:292] Log path already exists on disk! Existing files will be overwritten.\r\n[Msg] Overwriting existing path [/tmp/log]\r\n...\r\n[Msg] Stopping recording\r\n```\r\n\r\n`--log-overwrite --compress`, `/tmp/log.zip` already exists:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --compress --log-overwrite --record-path '/tmp/log'\r\n[Wrn] [LogRecord.cc:291] Log path already exists on disk! Existing files will be overwritten.\r\n...\r\n[Msg] Overwriting existing file [/tmp/log.zip]\r\n[Msg] Compressed log file and resources to [/tmp/log.zip]. Removing recorded directory [/tmp/log].\r\n[Msg] Stopping recording\r\n```\r\n\r\n`--log-overwrite` only, `/tmp/log.zip` exists, `/tmp/log` does not exist:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-overwrite --record-path '/tmp/log'\r\n[Wrn] [LogRecord.cc:291] Log path already exists on disk! Existing files will be overwritten.\r\n[Msg] Overwriting existing path [/tmp/log]\r\n...\r\n[Msg] Stopping recording\r\n```\r\n\r\n`--compress` only, both `/tmp/log` and `/tmp/log.zip` already exist:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --compress --record-path '/tmp/log'\r\n[Wrn] [LogRecord.cc:299] Log path already exists on disk! Recording instead to [/tmp/log(1)]\r\n...\r\n[Msg] Compressed log file and resources to [/tmp/log(1).zip]. Removing recorded directory [/tmp/log(1)].\r\n[Msg] Stopping recording\r\n$ ls /tmp\r\nlog\r\n'log(1).zip'\r\nlog.zip\r\n```\r\n\r\n`--compress` only, `/tmp/log` does not exist, `/tmp/log.zip` already exists:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --compress --record-path '/tmp/log'\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n...\r\n[Err] [Zip.cc:42] Error adding directory to zip: /tmp/log\r\n[Err] [Zip.cc:103] Error compressing file: /tmp/log\r\n[Err] [LogRecord.cc:639] Failed to compressed log file and resources to [/tmp/log.zip]. Keeping recorded directory [/tmp/log].\r\n[Msg] Stopping recording\r\n```\r\n\r\n## Record Path vs. Console Log Path\r\n\r\nIn Blueprint and Citadel, if `--record` is specified without `--record-path`, and `<path>` exists in SDF, a warning is printed, and recording will go to `<path>`, while console log will go to the default timestamp path.\r\n\r\nIn Ignition-D, `<path>` will be permanently ignored. Recordings and console log will go to same default path.\r\n\r\nIf `--record-path` is specified, then recording and console log will go to this path in Blueprint, Citadel, and Ignition-D.\r\n\r\n## Future Work\r\n\r\nFiles are outputted in `/tmp/log` and `/tmp/log.zip` in this example. During record, the original path in `file://` is prepended with the specified path, e.g. `/tmp/log`. During playback, the specified path is prepended to the URIs in the SDF.", "title": "[Blueprint] Logging meshes and materials", "destination": {"commit": {"hash": "890e28ea75d0", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/commit/890e28ea75d0.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/commits/890e28ea75d0"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{f98d11fe-f287-4dfb-99c3-e2b76a13232e}ts=2082645"}}, "type": "repository", "name": "ign-gazebo", "full_name": "ignitionrobotics/ign-gazebo", "uuid": "{f98d11fe-f287-4dfb-99c3-e2b76a13232e}"}, "branch": {"name": "ign-gazebo2"}}, "reason": "", "source": {"commit": {"hash": "b6d588b9b661", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/commit/b6d588b9b661.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/commits/b6d588b9b661"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{f98d11fe-f287-4dfb-99c3-e2b76a13232e}ts=2082645"}}, "type": "repository", "name": "ign-gazebo", "full_name": "ignitionrobotics/ign-gazebo", "uuid": "{f98d11fe-f287-4dfb-99c3-e2b76a13232e}"}, "branch": {"name": "log_resources"}}, "state": "OPEN", "author": {"display_name": "Mabel Zhang", "uuid": "{4b0e38fb-bf50-45c0-a496-61147518b2bf}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B4b0e38fb-bf50-45c0-a496-61147518b2bf%7D"}, "html": {"href": "https://bitbucket.org/%7B4b0e38fb-bf50-45c0-a496-61147518b2bf%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:ceb5942c-6843-408c-8550-3ce4899d299b/4d48e5ea-cf28-4fa7-9715-8fc9e315d831/128"}}, "nickname": "mabelmzhang", "type": "user", "account_id": "557058:ceb5942c-6843-408c-8550-3ce4899d299b"}, "date": "2019-09-20T23:45:56.363196+00:00"}, "pull_request": {"type": "pullrequest", "id": 397, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397"}}, "title": "[Blueprint] Logging meshes and materials"}}, {"comment": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397/comments/117807845.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397/_/diff#comment-117807845"}}, "parent": {"id": 117807726, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397/comments/117807726.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397/_/diff#comment-117807726"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 397, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397"}}, "title": "[Blueprint] Logging meshes and materials"}, "content": {"raw": "Ah I see, makes sense. I'm leaning towards losing a couple of log messages in favor of keeping the file names consistent. Names like `/tmp/log(1).zip(1)` are no good, we shouldn't mess with the extension :confused: ", "markup": "markdown", "html": "<p>Ah I see, makes sense. I'm leaning towards losing a couple of log messages in favor of keeping the file names consistent. Names like <code>/tmp/log(1).zip(1)</code> are no good, we shouldn't mess with the extension <img class=\"emoji\" src=\"data/pf-emoji-service--cdn.us-east-1.prod.public.atl-paas.net/standard/551c9814-1d37-4573-819d-afab3afeaf32/48x48/1f615.png\" alt=\"\ud83d\ude15\" title=\":confused:\" data-emoji-short-name=\":confused:\" /> </p>", "type": "rendered"}, "created_on": "2019-09-20T22:39:16.645994+00:00", "user": {"display_name": "Louise Poubel", "uuid": "{5cfa2075-477b-4ded-bdb9-8d2479544ec4}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D"}, "html": {"href": "https://bitbucket.org/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8/7d903d90-c5ea-4182-b7ef-0d467e9e1c74/128"}}, "nickname": "chapulina", "type": "user", "account_id": "557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8"}, "inline": {}, "updated_on": "2019-09-20T22:39:16.656016+00:00", "type": "pullrequest_comment", "id": 117807845}, "pull_request": {"type": "pullrequest", "id": 397, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397"}}, "title": "[Blueprint] Logging meshes and materials"}}, {"comment": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397/comments/117807726.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397/_/diff#comment-117807726"}}, "parent": {"id": 117806589, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397/comments/117806589.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397/_/diff#comment-117806589"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 397, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397"}}, "title": "[Blueprint] Logging meshes and materials"}, "content": {"raw": "So\u2026 I had the logic together first, in the first block where the console log was initiated. Then I ran into this scenario:`/tmp/log` exists, because it was generated in a run without `--compress`; `/tmp/log(1).zip` exists, because it was generated in a run with `--compress`, so`/tmp/log(1)` doesn\u2019t exist; then, `common::uniqueDirectoryPath` gives `/tmp/log(1)` as the path, which works for the path, but does not work for the zip file. So it needs to then check the zip `cmpPath` after generating the `recordPathMod`, generate a `common::uniqueFilePath`, and go back to generate a new `recordPathMod`. But as it does the first and second renaming, all the messages about this renaming will not be logged. So\u2026 I moved the `cmpDest` to after the `recordPathMod` has been finalized.  \nThat said, I do like that way better, which combines the check of `/tmp/log(1)` and `/tmp/log(1).zip` in the same if-statement, because that gives paths like `/tmp/log(2)` and `/tmp/log(2).zip`. Downside is some messages are not logged. The current way logs all messages, but gives names like `/tmp/log(1).zip(1)`.", "markup": "markdown", "html": "<p>So\u2026 I had the logic together first, in the first block where the console log was initiated. Then I ran into this scenario:<code>/tmp/log</code> exists, because it was generated in a run without <code>--compress</code>; <code>/tmp/log(1).zip</code> exists, because it was generated in a run with <code>--compress</code>, so<code>/tmp/log(1)</code> doesn\u2019t exist; then, <code>common::uniqueDirectoryPath</code> gives <code>/tmp/log(1)</code> as the path, which works for the path, but does not work for the zip file. So it needs to then check the zip <code>cmpPath</code> after generating the <code>recordPathMod</code>, generate a <code>common::uniqueFilePath</code>, and go back to generate a new <code>recordPathMod</code>. But as it does the first and second renaming, all the messages about this renaming will not be logged. So\u2026 I moved the <code>cmpDest</code> to after the <code>recordPathMod</code> has been finalized.<br />\nThat said, I do like that way better, which combines the check of <code>/tmp/log(1)</code> and <code>/tmp/log(1).zip</code> in the same if-statement, because that gives paths like <code>/tmp/log(2)</code> and <code>/tmp/log(2).zip</code>. Downside is some messages are not logged. The current way logs all messages, but gives names like <code>/tmp/log(1).zip(1)</code>.</p>", "type": "rendered"}, "created_on": "2019-09-20T22:35:58.753292+00:00", "user": {"display_name": "Mabel Zhang", "uuid": "{4b0e38fb-bf50-45c0-a496-61147518b2bf}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B4b0e38fb-bf50-45c0-a496-61147518b2bf%7D"}, "html": {"href": "https://bitbucket.org/%7B4b0e38fb-bf50-45c0-a496-61147518b2bf%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:ceb5942c-6843-408c-8550-3ce4899d299b/4d48e5ea-cf28-4fa7-9715-8fc9e315d831/128"}}, "nickname": "mabelmzhang", "type": "user", "account_id": "557058:ceb5942c-6843-408c-8550-3ce4899d299b"}, "inline": {}, "updated_on": "2019-09-20T22:36:51.336801+00:00", "type": "pullrequest_comment", "id": 117807726}, "pull_request": {"type": "pullrequest", "id": 397, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397"}}, "title": "[Blueprint] Logging meshes and materials"}}, {"comment": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397/comments/117806589.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397/_/diff#comment-117806589"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 397, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397"}}, "title": "[Blueprint] Logging meshes and materials"}, "content": {"raw": "I'm not sure about separating the logic for the compressed file and the rest of the log, because this means they could end up with different names depending on the combination of flags and whether one exists but not the other.", "markup": "markdown", "html": "<p>I'm not sure about separating the logic for the compressed file and the rest of the log, because this means they could end up with different names depending on the combination of flags and whether one exists but not the other.</p>", "type": "rendered"}, "created_on": "2019-09-20T22:06:54.592959+00:00", "user": {"display_name": "Louise Poubel", "uuid": "{5cfa2075-477b-4ded-bdb9-8d2479544ec4}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D"}, "html": {"href": "https://bitbucket.org/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8/7d903d90-c5ea-4182-b7ef-0d467e9e1c74/128"}}, "nickname": "chapulina", "type": "user", "account_id": "557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8"}, "inline": {}, "updated_on": "2019-09-20T22:06:54.599742+00:00", "type": "pullrequest_comment", "id": 117806589}, "pull_request": {"type": "pullrequest", "id": 397, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397"}}, "title": "[Blueprint] Logging meshes and materials"}}, {"comment": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397/comments/117806059.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397/_/diff#comment-117806059"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 397, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397"}}, "title": "[Blueprint] Logging meshes and materials"}, "content": {"raw": "Maybe we should remove before calling `init`? Just to be sure we don't erase the log file by mistake.\n\nAlso, I think it doesn't need to be a warning in this case, because the user asked for it. It could be a single `ignmsg` with the info about overwriting existing files.", "markup": "markdown", "html": "<p>Maybe we should remove before calling <code>init</code>? Just to be sure we don't erase the log file by mistake.</p>\n<p>Also, I think it doesn't need to be a warning in this case, because the user asked for it. It could be a single <code>ignmsg</code> with the info about overwriting existing files.</p>", "type": "rendered"}, "created_on": "2019-09-20T21:54:28.653343+00:00", "user": {"display_name": "Louise Poubel", "uuid": "{5cfa2075-477b-4ded-bdb9-8d2479544ec4}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D"}, "html": {"href": "https://bitbucket.org/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8/7d903d90-c5ea-4182-b7ef-0d467e9e1c74/128"}}, "nickname": "chapulina", "type": "user", "account_id": "557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8"}, "inline": {}, "updated_on": "2019-09-20T21:54:28.660505+00:00", "type": "pullrequest_comment", "id": 117806059}, "pull_request": {"type": "pullrequest", "id": 397, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397"}}, "title": "[Blueprint] Logging meshes and materials"}}, {"update": {"description": "Depends on [ign-common PR 200](#!/ignitionrobotics/ign-common/pull-requests/200/log-resources/diff).\r\n\r\nPorts [this Gazebo PR](https://bitbucket.org/osrf/gazebo/pull-requests/2811/save-models-material-and-meshes-when/diff) to Ignition.\r\n\r\nImplements `--record-resources`, and `--compress` and `--record-overwrite` to support it.\r\n\r\nRecords resources \\(`--record-resources`\\), i.e. meshes and materials, to a directory under the specified log record directory. Optionally compresses \\(`--compress`\\) the whole directory, which contains the existing `.tlog` sqlite3 file and any resources, to a zip file. If directory or compressed file already exist, optionally overwrites \\(`--record-overwrite`\\).\r\n\r\nCorresponding SDF plugin parameters: `<record_resources>1</record_resources>`, `<compress>1</compress>`, `<record_overwrite>1</record_overwrite>.`If both command line and SDF parameters are specified, command line option overwrites SDF parameter.\r\n\r\n## Usage:\r\n\r\n```\r\nign gazebo [...] --record-resources --record-overwrite --compress\r\n```\r\n\r\n## Test --record-resources:\r\n\r\n```\r\n# This SDF specifies the equivalent of --record-resources --record-path '/tmp/log'\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf\r\n$ ign gazebo -v 4 -r examples/worlds/log_playback.sdf\r\n```\r\n\r\nTested with `<include><uri>https://fuel...</uri></include>` and `<mesh><uri>file://...</uri></mesh>`. Paths specified by `model://` are not supported in Ignition yet, so this case in the code is not tested.\r\n\r\n## Test --record-overwrite and --compress:\r\n\r\nWhen recording to `path`, the compression file is implied to be `path.zip`. Both are checked for existence.\r\n\r\nNo `--record-overwrite` \\(default\\):\r\n\r\n```\r\n# This SDF specifies the equivalent of --record-resources --record-path '/tmp/log'\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf\r\n\r\n# Run it again, and it should write to new directory\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf\r\n[Wrn] [LogRecord.cc:260] Log path already exists on disk! Recording instead to [/tmp/log(1)]\r\n[Msg] Recording to log file [/tmp/log(1)/state.tlog]\r\n```\r\n\r\n`--record-overwrite`, `/tmp/log` already exists:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --record-overwrite --record-path '/tmp/log'\r\n[Wrn] [LogRecord.cc:292] Log path already exists on disk! Existing files will be overwritten.\r\n[Msg] Overwriting existing path [/tmp/log]\r\n...\r\n[Msg] Stopping recording\r\n```\r\n\r\n`--record-overwrite --compress`, `/tmp/log.zip` already exists:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --compress --record-overwrite --record-path '/tmp/log'\r\n[Wrn] [LogRecord.cc:291] Log path already exists on disk! Existing files will be overwritten.\r\n...\r\n[Msg] Overwriting existing file [/tmp/log.zip]\r\n[Msg] Compressed log file and resources to [/tmp/log.zip]. Removing recorded directory [/tmp/log].\r\n[Msg] Stopping recording\r\n```\r\n\r\n`--record-overwrite` only, `/tmp/log.zip` exists, `/tmp/log` does not exist:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --record-overwrite --record-path '/tmp/log'\r\n[Wrn] [LogRecord.cc:291] Log path already exists on disk! Existing files will be overwritten.\r\n[Msg] Overwriting existing path [/tmp/log]\r\n...\r\n[Msg] Stopping recording\r\n```\r\n\r\n`--compress` only, both `/tmp/log` and `/tmp/log.zip` already exist:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --compress --record-path '/tmp/log'\r\n[Wrn] [LogRecord.cc:299] Log path already exists on disk! Recording instead to [/tmp/log(1)]\r\n...\r\n[Msg] Compressed log file and resources to [/tmp/log(1).zip]. Removing recorded directory [/tmp/log(1)].\r\n[Msg] Stopping recording\r\n$ ls /tmp\r\nlog\r\n'log(1).zip'\r\nlog.zip\r\n```\r\n\r\n`--compress` only, `/tmp/log` does not exist, `/tmp/log.zip` already exists:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --compress --record-path '/tmp/log'\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n...\r\n[Err] [Zip.cc:42] Error adding directory to zip: /tmp/log\r\n[Err] [Zip.cc:103] Error compressing file: /tmp/log\r\n[Err] [LogRecord.cc:639] Failed to compressed log file and resources to [/tmp/log.zip]. Keeping recorded directory [/tmp/log].\r\n[Msg] Stopping recording\r\n```\r\n\r\n\\(Pending changes:\\)\r\n\r\nFiles are outputted in `/tmp/log` and `/tmp/log.zip` in this example. During record, the original path in `file://` is prepended with the specified path, e.g. `/tmp/log`. During playback, the specified path is prepended to the URIs in the SDF.", "title": "[Blueprint] Logging meshes and materials", "destination": {"commit": {"hash": "a5d9d4b4a0cf", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/commit/a5d9d4b4a0cf.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/commits/a5d9d4b4a0cf"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{f98d11fe-f287-4dfb-99c3-e2b76a13232e}ts=2082645"}}, "type": "repository", "name": "ign-gazebo", "full_name": "ignitionrobotics/ign-gazebo", "uuid": "{f98d11fe-f287-4dfb-99c3-e2b76a13232e}"}, "branch": {"name": "ign-gazebo2"}}, "reason": "", "source": {"commit": {"hash": "b6d588b9b661", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/commit/b6d588b9b661.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/commits/b6d588b9b661"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{f98d11fe-f287-4dfb-99c3-e2b76a13232e}ts=2082645"}}, "type": "repository", "name": "ign-gazebo", "full_name": "ignitionrobotics/ign-gazebo", "uuid": "{f98d11fe-f287-4dfb-99c3-e2b76a13232e}"}, "branch": {"name": "log_resources"}}, "state": "OPEN", "author": {"display_name": "Mabel Zhang", "uuid": "{4b0e38fb-bf50-45c0-a496-61147518b2bf}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B4b0e38fb-bf50-45c0-a496-61147518b2bf%7D"}, "html": {"href": "https://bitbucket.org/%7B4b0e38fb-bf50-45c0-a496-61147518b2bf%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:ceb5942c-6843-408c-8550-3ce4899d299b/4d48e5ea-cf28-4fa7-9715-8fc9e315d831/128"}}, "nickname": "mabelmzhang", "type": "user", "account_id": "557058:ceb5942c-6843-408c-8550-3ce4899d299b"}, "date": "2019-09-20T15:16:01.440231+00:00"}, "pull_request": {"type": "pullrequest", "id": 397, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397"}}, "title": "[Blueprint] Logging meshes and materials"}}, {"update": {"description": "Depends on [ign-common PR 200](#!/ignitionrobotics/ign-common/pull-requests/200/log-resources/diff).\r\n\r\nPorts [this Gazebo PR](https://bitbucket.org/osrf/gazebo/pull-requests/2811/save-models-material-and-meshes-when/diff) to Ignition.\r\n\r\nImplements `--record-resources`, and `--compress` and `--record-overwrite` to support it.\r\n\r\nRecords resources \\(`--record-resources`\\), i.e. meshes and materials, to a directory under the specified log record directory. Optionally compresses \\(`--compress`\\) the whole directory, which contains the existing `.tlog` sqlite3 file and any resources, to a zip file. If directory or compressed file already exist, optionally overwrites \\(`--record-overwrite`\\).\r\n\r\nCorresponding SDF plugin parameters: `<record_resources>1</record_resources>`, `<compress>1</compress>`, `<record_overwrite>1</record_overwrite>.`If both command line and SDF parameters are specified, command line option overwrites SDF parameter.\r\n\r\n## Usage:\r\n\r\n```\r\nign gazebo [...] --record-resources --record-overwrite --compress\r\n```\r\n\r\n## Test --record-resources:\r\n\r\n```\r\n# This SDF specifies the equivalent of --record-resources --record-path '/tmp/log'\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf\r\n$ ign gazebo -v 4 -r examples/worlds/log_playback.sdf\r\n```\r\n\r\nTested with `<include><uri>https://fuel...</uri></include>` and `<mesh><uri>file://...</uri></mesh>`. Paths specified by `model://` are not supported in Ignition yet, so this case in the code is not tested.\r\n\r\n## Test --record-overwrite and --compress:\r\n\r\nWhen recording to `path`, the compression file is implied to be `path.zip`. Both are checked for existence.\r\n\r\nNo `--record-overwrite` \\(default\\):\r\n\r\n```\r\n# This SDF specifies the equivalent of --record-resources --record-path '/tmp/log'\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf\r\n\r\n# Run it again, and it should write to new directory\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf\r\n[Wrn] [LogRecord.cc:260] Log path already exists on disk! Recording instead to [/tmp/log(1)]\r\n[Msg] Recording to log file [/tmp/log(1)/state.tlog]\r\n```\r\n\r\n`--record-overwrite`, `/tmp/log` already exists:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --record-overwrite --record-path '/tmp/log'\r\n[Wrn] [LogRecord.cc:292] Log path already exists on disk! Existing files will be overwritten.\r\n[Msg] Overwriting existing path [/tmp/log]\r\n...\r\n[Msg] Stopping recording\r\n```\r\n\r\n`--record-overwrite --compress`, `/tmp/log.zip` already exists:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --compress --record-overwrite --record-path '/tmp/log'\r\n[Wrn] [LogRecord.cc:291] Log path already exists on disk! Existing files will be overwritten.\r\n...\r\n[Msg] Overwriting existing file [/tmp/log.zip]\r\n[Msg] Compressed log file and resources to [/tmp/log.zip]. Removing recorded directory [/tmp/log].\r\n[Msg] Stopping recording\r\n```\r\n\r\n`--record-overwrite` only, `/tmp/log.zip` exists, `/tmp/log` does not exist:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --record-overwrite --record-path '/tmp/log'\r\n[Wrn] [LogRecord.cc:291] Log path already exists on disk! Existing files will be overwritten.\r\n[Msg] Overwriting existing path [/tmp/log]\r\n...\r\n[Msg] Stopping recording\r\n```\r\n\r\n`--compress` only, both `/tmp/log` and `/tmp/log.zip` already exist:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --compress --record-path '/tmp/log'\r\n[Wrn] [LogRecord.cc:299] Log path already exists on disk! Recording instead to [/tmp/log(1)]\r\n...\r\n[Msg] Compressed log file and resources to [/tmp/log(1).zip]. Removing recorded directory [/tmp/log(1)].\r\n[Msg] Stopping recording\r\n$ ls /tmp\r\nlog\r\n'log(1).zip'\r\nlog.zip\r\n```\r\n\r\n`--compress` only, `/tmp/log` does not exist, `/tmp/log.zip` already exists:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --compress --record-path '/tmp/log'\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n...\r\n[Err] [Zip.cc:42] Error adding directory to zip: /tmp/log\r\n[Err] [Zip.cc:103] Error compressing file: /tmp/log\r\n[Err] [LogRecord.cc:639] Failed to compressed log file and resources to [/tmp/log.zip]. Keeping recorded directory [/tmp/log].\r\n[Msg] Stopping recording\r\n```\r\n\r\n\\(Pending changes:\\)\r\n\r\nFiles are outputted in `/tmp/log` and `/tmp/log.zip` in this example. During record, the original path in `file://` is prepended with the specified path, e.g. `/tmp/log`. During playback, the specified path is prepended to the URIs in the SDF.", "title": "[Blueprint] Logging meshes and materials", "destination": {"commit": {"hash": "a5d9d4b4a0cf", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/commit/a5d9d4b4a0cf.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/commits/a5d9d4b4a0cf"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{f98d11fe-f287-4dfb-99c3-e2b76a13232e}ts=2082645"}}, "type": "repository", "name": "ign-gazebo", "full_name": "ignitionrobotics/ign-gazebo", "uuid": "{f98d11fe-f287-4dfb-99c3-e2b76a13232e}"}, "branch": {"name": "ign-gazebo2"}}, "reason": "", "source": {"commit": {"hash": "327e7fb47cb2", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/commit/327e7fb47cb2.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/commits/327e7fb47cb2"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{f98d11fe-f287-4dfb-99c3-e2b76a13232e}ts=2082645"}}, "type": "repository", "name": "ign-gazebo", "full_name": "ignitionrobotics/ign-gazebo", "uuid": "{f98d11fe-f287-4dfb-99c3-e2b76a13232e}"}, "branch": {"name": "log_resources"}}, "state": "OPEN", "author": {"display_name": "Mabel Zhang", "uuid": "{4b0e38fb-bf50-45c0-a496-61147518b2bf}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B4b0e38fb-bf50-45c0-a496-61147518b2bf%7D"}, "html": {"href": "https://bitbucket.org/%7B4b0e38fb-bf50-45c0-a496-61147518b2bf%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:ceb5942c-6843-408c-8550-3ce4899d299b/4d48e5ea-cf28-4fa7-9715-8fc9e315d831/128"}}, "nickname": "mabelmzhang", "type": "user", "account_id": "557058:ceb5942c-6843-408c-8550-3ce4899d299b"}, "date": "2019-09-20T13:28:58.928097+00:00"}, "pull_request": {"type": "pullrequest", "id": 397, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397"}}, "title": "[Blueprint] Logging meshes and materials"}}, {"update": {"description": "Depends on [ign-common PR 200](#!/ignitionrobotics/ign-common/pull-requests/200/log-resources/diff).\r\n\r\nPorts [this Gazebo PR](https://bitbucket.org/osrf/gazebo/pull-requests/2811/save-models-material-and-meshes-when/diff) to Ignition.\r\n\r\nImplements `--record-resources`, and `--compress` and `--record-overwrite` to support it.\r\n\r\nRecords resources \\(`--record-resources`\\), i.e. meshes and materials, to a directory under the specified log record directory. Optionally compresses \\(`--compress`\\) the whole directory, which contains the existing `.tlog` sqlite3 file and any resources, to a zip file. If directory or compressed file already exist, optionally overwrites \\(`--record-overwrite`\\).\r\n\r\nCorresponding SDF plugin parameters: `<record_resources>1</record_resources>`, `<compress>1</compress>`, `<record_overwrite>1</record_overwrite>.`If both command line and SDF parameters are specified, command line option overwrites SDF parameter.\r\n\r\n## Usage:\r\n\r\n```\r\nign gazebo [...] --record-resources --record-overwrite --compress\r\n```\r\n\r\n## Test --record-resources:\r\n\r\n```\r\n# This SDF specifies the equivalent of --record-resources --record-path '/tmp/log'\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf\r\n$ ign gazebo -v 4 -r examples/worlds/log_playback.sdf\r\n```\r\n\r\nTested with `<include><uri>https://fuel...</uri></include>` and `<mesh><uri>file://...</uri></mesh>`. Paths specified by `model://` are not supported in Ignition yet, so this case in the code is not tested.\r\n\r\n## Test --record-overwrite and --compress:\r\n\r\nWhen recording to `path`, the compression file is implied to be `path.zip`. Both are checked for existence.\r\n\r\nNo `--record-overwrite` \\(default\\):\r\n\r\n```\r\n# This SDF specifies the equivalent of --record-resources --record-path '/tmp/log'\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf\r\n\r\n# Run it again, and it should write to new directory\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf\r\n[Wrn] [LogRecord.cc:260] Log path already exists on disk! Recording instead to [/tmp/log(1)]\r\n[Msg] Recording to log file [/tmp/log(1)/state.tlog]\r\n```\r\n\r\n`--record-overwrite`, `/tmp/log` already exists:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --record-overwrite --record-path '/tmp/log'\r\n[Wrn] [LogRecord.cc:292] Log path already exists on disk! Existing files will be overwritten.\r\n[Msg] Overwriting existing path [/tmp/log]\r\n...\r\n[Msg] Stopping recording\r\n```\r\n\r\n`--record-overwrite --compress`, `/tmp/log.zip` already exists:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --compress --record-overwrite --record-path '/tmp/log'\r\n[Wrn] [LogRecord.cc:291] Log path already exists on disk! Existing files will be overwritten.\r\n...\r\n[Msg] Overwriting existing file [/tmp/log.zip]\r\n[Msg] Compressed log file and resources to [/tmp/log.zip]. Removing recorded directory [/tmp/log].\r\n[Msg] Stopping recording\r\n```\r\n\r\n`--record-overwrite` only, `/tmp/log.zip` exists, `/tmp/log` does not exist:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --record-overwrite --record-path '/tmp/log'\r\n[Wrn] [LogRecord.cc:291] Log path already exists on disk! Existing files will be overwritten.\r\n[Msg] Overwriting existing path [/tmp/log]\r\n...\r\n[Msg] Stopping recording\r\n```\r\n\r\n`--compress` only, both `/tmp/log` and `/tmp/log.zip` already exist:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --compress --record-path '/tmp/log'\r\n[Wrn] [LogRecord.cc:299] Log path already exists on disk! Recording instead to [/tmp/log(1)]\r\n...\r\n[Msg] Compressed log file and resources to [/tmp/log(1).zip]. Removing recorded directory [/tmp/log(1)].\r\n[Msg] Stopping recording\r\n$ ls /tmp\r\nlog\r\n'log(1).zip'\r\nlog.zip\r\n```\r\n\r\n`--compress` only, `/tmp/log` does not exist, `/tmp/log.zip` already exists:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --compress --record-path '/tmp/log'\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n...\r\n[Err] [Zip.cc:42] Error adding directory to zip: /tmp/log\r\n[Err] [Zip.cc:103] Error compressing file: /tmp/log\r\n[Err] [LogRecord.cc:639] Failed to compressed log file and resources to [/tmp/log.zip]. Keeping recorded directory [/tmp/log].\r\n[Msg] Stopping recording\r\n```\r\n\r\n\\(Pending changes:\\)\r\n\r\nFiles are outputted in `/tmp/log` and `/tmp/log.zip` in this example. During record, the original path in `file://` is prepended with the specified path, e.g. `/tmp/log`. During playback, the specified path is prepended to the URIs in the SDF.", "title": "[Blueprint] Logging meshes and materials", "destination": {"commit": {"hash": "a5d9d4b4a0cf", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/commit/a5d9d4b4a0cf.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/commits/a5d9d4b4a0cf"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{f98d11fe-f287-4dfb-99c3-e2b76a13232e}ts=2082645"}}, "type": "repository", "name": "ign-gazebo", "full_name": "ignitionrobotics/ign-gazebo", "uuid": "{f98d11fe-f287-4dfb-99c3-e2b76a13232e}"}, "branch": {"name": "ign-gazebo2"}}, "reason": "", "source": {"commit": {"hash": "b32134eef356", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/commit/b32134eef356.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/commits/b32134eef356"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{f98d11fe-f287-4dfb-99c3-e2b76a13232e}ts=2082645"}}, "type": "repository", "name": "ign-gazebo", "full_name": "ignitionrobotics/ign-gazebo", "uuid": "{f98d11fe-f287-4dfb-99c3-e2b76a13232e}"}, "branch": {"name": "log_resources"}}, "state": "OPEN", "author": {"display_name": "Mabel Zhang", "uuid": "{4b0e38fb-bf50-45c0-a496-61147518b2bf}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B4b0e38fb-bf50-45c0-a496-61147518b2bf%7D"}, "html": {"href": "https://bitbucket.org/%7B4b0e38fb-bf50-45c0-a496-61147518b2bf%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:ceb5942c-6843-408c-8550-3ce4899d299b/4d48e5ea-cf28-4fa7-9715-8fc9e315d831/128"}}, "nickname": "mabelmzhang", "type": "user", "account_id": "557058:ceb5942c-6843-408c-8550-3ce4899d299b"}, "date": "2019-09-20T12:36:38.041409+00:00"}, "pull_request": {"type": "pullrequest", "id": 397, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397"}}, "title": "[Blueprint] Logging meshes and materials"}}, {"update": {"description": "Depends on [ign-common PR 200](#!/ignitionrobotics/ign-common/pull-requests/200/log-resources/diff).\r\n\r\nPorts [this Gazebo PR](https://bitbucket.org/osrf/gazebo/pull-requests/2811/save-models-material-and-meshes-when/diff) to Ignition.\r\n\r\nImplements `--record-resources`, and `--compress` and `--record-overwrite` to support it.\r\n\r\nRecords resources \\(`--record-resources`\\), i.e. meshes and materials, to a directory under the specified log record directory. Optionally compresses \\(`--compress`\\) the whole directory, which contains the existing `.tlog` sqlite3 file and any resources, to a zip file. If directory or compressed file already exist, optionally overwrites \\(`--record-overwrite`\\).\r\n\r\nCorresponding SDF plugin parameters: `<record_resources>1</record_resources>`, `<compress>1</compress>`, `<record_overwrite>1</record_overwrite>.`If both command line and SDF parameters are specified, command line option overwrites SDF parameter.\r\n\r\n## Usage:\r\n\r\n```\r\nign gazebo [...] --record-resources --record-overwrite --compress\r\n```\r\n\r\n## Test --record-resources:\r\n\r\n```\r\n# This SDF specifies the equivalent of --record-resources --record-path '/tmp/log'\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf\r\n$ ign gazebo -v 4 -r examples/worlds/log_playback.sdf\r\n```\r\n\r\nTested with `<include><uri>https://fuel...</uri></include>` and `<mesh><uri>file://...</uri></mesh>`. Paths specified by `model://` are not supported in Ignition yet, so this case in the code is not tested.\r\n\r\n## Test --record-overwrite and --compress:\r\n\r\nWhen recording to `path`, the compression file is implied to be `path.zip`. Both are checked for existence.\r\n\r\nNo `--record-overwrite` \\(default\\):\r\n\r\n```\r\n# This SDF specifies the equivalent of --record-resources --record-path '/tmp/log'\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf\r\n\r\n# Run it again, and it should write to new directory\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf\r\n[Wrn] [LogRecord.cc:260] Log path already exists on disk! Recording instead to [/tmp/log(1)]\r\n[Msg] Recording to log file [/tmp/log(1)/state.tlog]\r\n```\r\n\r\n`--record-overwrite`, `/tmp/log` already exists:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --record-overwrite --record-path '/tmp/log'\r\n[Wrn] [LogRecord.cc:292] Log path already exists on disk! Existing files will be overwritten.\r\n[Msg] Overwriting existing path [/tmp/log]\r\n...\r\n[Msg] Stopping recording\r\n```\r\n\r\n`--record-overwrite --compress`, `/tmp/log.zip` already exists:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --compress --record-overwrite --record-path '/tmp/log'\r\n[Wrn] [LogRecord.cc:291] Log path already exists on disk! Existing files will be overwritten.\r\n...\r\n[Msg] Overwriting existing file [/tmp/log.zip]\r\n[Msg] Compressed log file and resources to [/tmp/log.zip]. Removing recorded directory [/tmp/log].\r\n[Msg] Stopping recording\r\n```\r\n\r\n`--record-overwrite` only, `/tmp/log.zip` exists, `/tmp/log` does not exist:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --record-overwrite --record-path '/tmp/log'\r\n[Wrn] [LogRecord.cc:291] Log path already exists on disk! Existing files will be overwritten.\r\n[Msg] Overwriting existing path [/tmp/log]\r\n...\r\n[Msg] Stopping recording\r\n```\r\n\r\n`--compress` only, both `/tmp/log` and `/tmp/log.zip` already exist:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --compress --record-path '/tmp/log'\r\n[Wrn] [LogRecord.cc:299] Log path already exists on disk! Recording instead to [/tmp/log(1)]\r\n...\r\n[Msg] Compressed log file and resources to [/tmp/log(1).zip]. Removing recorded directory [/tmp/log(1)].\r\n[Msg] Stopping recording\r\n$ ls /tmp\r\nlog\r\n'log(1).zip'\r\nlog.zip\r\n```\r\n\r\n`--compress` only, `/tmp/log` does not exist, `/tmp/log.zip` already exists:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --compress --record-path '/tmp/log'\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n...\r\n[Err] [Zip.cc:42] Error adding directory to zip: /tmp/log\r\n[Err] [Zip.cc:103] Error compressing file: /tmp/log\r\n[Err] [LogRecord.cc:639] Failed to compressed log file and resources to [/tmp/log.zip]. Keeping recorded directory [/tmp/log].\r\n[Msg] Stopping recording\r\n```\r\n\r\n\\(Pending changes:\\)\r\n\r\nFiles are outputted in `/tmp/log` and `/tmp/log.zip` in this example. During record, the original path in `file://` is prepended with the specified path, e.g. `/tmp/log`. During playback, the specified path is prepended to the URIs in the SDF.", "title": "[Blueprint] Logging meshes and materials", "destination": {"commit": {"hash": "a5d9d4b4a0cf", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/commit/a5d9d4b4a0cf.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/commits/a5d9d4b4a0cf"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{f98d11fe-f287-4dfb-99c3-e2b76a13232e}ts=2082645"}}, "type": "repository", "name": "ign-gazebo", "full_name": "ignitionrobotics/ign-gazebo", "uuid": "{f98d11fe-f287-4dfb-99c3-e2b76a13232e}"}, "branch": {"name": "ign-gazebo2"}}, "reason": "", "source": {"commit": {"hash": "b3b9a6c7fac8", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/commit/b3b9a6c7fac8.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/commits/b3b9a6c7fac8"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{f98d11fe-f287-4dfb-99c3-e2b76a13232e}ts=2082645"}}, "type": "repository", "name": "ign-gazebo", "full_name": "ignitionrobotics/ign-gazebo", "uuid": "{f98d11fe-f287-4dfb-99c3-e2b76a13232e}"}, "branch": {"name": "log_resources"}}, "state": "OPEN", "author": {"display_name": "Mabel Zhang", "uuid": "{4b0e38fb-bf50-45c0-a496-61147518b2bf}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B4b0e38fb-bf50-45c0-a496-61147518b2bf%7D"}, "html": {"href": "https://bitbucket.org/%7B4b0e38fb-bf50-45c0-a496-61147518b2bf%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:ceb5942c-6843-408c-8550-3ce4899d299b/4d48e5ea-cf28-4fa7-9715-8fc9e315d831/128"}}, "nickname": "mabelmzhang", "type": "user", "account_id": "557058:ceb5942c-6843-408c-8550-3ce4899d299b"}, "date": "2019-09-20T12:31:27.673228+00:00"}, "pull_request": {"type": "pullrequest", "id": 397, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397"}}, "title": "[Blueprint] Logging meshes and materials"}}, {"comment": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397/comments/117502896.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397/_/diff#comment-117502896"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 397, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397"}}, "title": "[Blueprint] Logging meshes and materials"}, "content": {"raw": "Hmm I\u2019m not sure why `INTEGRATION_log_system` test isn't passing in Pipelines, which says some playback poses are off by more than expected. It passes locally for me\u2026", "markup": "markdown", "html": "<p>Hmm I\u2019m not sure why <code>INTEGRATION_log_system</code> test isn't passing in Pipelines, which says some playback poses are off by more than expected. It passes locally for me\u2026</p>", "type": "rendered"}, "created_on": "2019-09-19T07:03:13.829378+00:00", "user": {"display_name": "Mabel Zhang", "uuid": "{4b0e38fb-bf50-45c0-a496-61147518b2bf}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B4b0e38fb-bf50-45c0-a496-61147518b2bf%7D"}, "html": {"href": "https://bitbucket.org/%7B4b0e38fb-bf50-45c0-a496-61147518b2bf%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:ceb5942c-6843-408c-8550-3ce4899d299b/4d48e5ea-cf28-4fa7-9715-8fc9e315d831/128"}}, "nickname": "mabelmzhang", "type": "user", "account_id": "557058:ceb5942c-6843-408c-8550-3ce4899d299b"}, "updated_on": "2019-09-19T07:03:13.846207+00:00", "type": "pullrequest_comment", "id": 117502896}, "pull_request": {"type": "pullrequest", "id": 397, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397"}}, "title": "[Blueprint] Logging meshes and materials"}}, {"comment": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397/comments/117499005.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397/_/diff#comment-117499005"}}, "parent": {"id": 117472880, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397/comments/117472880.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397/_/diff#comment-117472880"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 397, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397"}}, "title": "[Blueprint] Logging meshes and materials"}, "content": {"raw": "Done in b3b9a6c", "markup": "markdown", "html": "<p>Done in <a href=\"#!/ignitionrobotics/ign-gazebo/commits/b3b9a6c\" rel=\"nofollow\" class=\"ap-connect-link\">b3b9a6c</a></p>", "type": "rendered"}, "created_on": "2019-09-19T06:36:10.721511+00:00", "user": {"display_name": "Mabel Zhang", "uuid": "{4b0e38fb-bf50-45c0-a496-61147518b2bf}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B4b0e38fb-bf50-45c0-a496-61147518b2bf%7D"}, "html": {"href": "https://bitbucket.org/%7B4b0e38fb-bf50-45c0-a496-61147518b2bf%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:ceb5942c-6843-408c-8550-3ce4899d299b/4d48e5ea-cf28-4fa7-9715-8fc9e315d831/128"}}, "nickname": "mabelmzhang", "type": "user", "account_id": "557058:ceb5942c-6843-408c-8550-3ce4899d299b"}, "inline": {}, "updated_on": "2019-09-19T06:36:10.735449+00:00", "type": "pullrequest_comment", "id": 117499005}, "pull_request": {"type": "pullrequest", "id": 397, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397"}}, "title": "[Blueprint] Logging meshes and materials"}}, {"update": {"description": "Depends on [ign-common PR 200](#!/ignitionrobotics/ign-common/pull-requests/200/log-resources/diff).\r\n\r\nPorts [this Gazebo PR](https://bitbucket.org/osrf/gazebo/pull-requests/2811/save-models-material-and-meshes-when/diff) to Ignition.\r\n\r\nImplements `--record-resources`, and `--compress` and `--overwrite` to support it.\r\n\r\nRecords resources \\(`--record-resources`\\), i.e. meshes and materials, to a directory under the specified log record directory. Optionally compresses \\(`--compress`\\) the whole directory, which contains the existing `.tlog` sqlite3 file and any resources, to a zip file. If directory or compressed file already exist, optionally overwrites \\(`--overwrite`\\).\r\n\r\nCorresponding SDF plugin parameters: `<record_resources>1</record_resources>`, `<compress>1</compress>`, `<overwrite>1</overwrite>.`If both command line and SDF parameters are specified, command line option overwrites SDF parameter.\r\n\r\n## Usage:\r\n\r\n```\r\nign gazebo [...] --record-resources --overwrite --compress\r\n```\r\n\r\n## Test --record-resources:\r\n\r\n```\r\n# This SDF specifies the equivalent of --record-resources --record-path '/tmp/log'\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf\r\n$ ign gazebo -v 4 -r examples/worlds/log_playback.sdf\r\n```\r\n\r\nTested with `<include><uri>https://fuel...</uri></include>` and `<mesh><uri>file://...</uri></mesh>`. Paths specified by `model://` are not supported in Ignition yet, so this case in the code is not tested.\r\n\r\n## Test --overwrite and --compress:\r\n\r\nWhen recording to `path`, the compression file is implied to be `path.zip`. Both are checked for existence.\r\n\r\nNo `--overwrite` \\(default\\):\r\n\r\n```\r\n# This SDF specifies the equivalent of --record-resources --record-path '/tmp/log'\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf\r\n\r\n# Run it again, and it should write to new directory\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf\r\n[Wrn] [LogRecord.cc:260] Log path already exists on disk! Recording instead to [/tmp/log(1)]\r\n[Msg] Recording to log file [/tmp/log(1)/state.tlog]\r\n```\r\n\r\n`--overwrite`, `/tmp/log` already exists:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --overwrite --record-path '/tmp/log'\r\n[Wrn] [LogRecord.cc:292] Log path already exists on disk! Existing files will be overwritten.\r\n[Msg] Overwriting existing path [/tmp/log]\r\n...\r\n[Msg] Stopping recording\r\n```\r\n\r\n`--overwrite --compress`, `/tmp/log.zip` already exists:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --compress --overwrite --record-path '/tmp/log'\r\n[Wrn] [LogRecord.cc:291] Log path already exists on disk! Existing files will be overwritten.\r\n...\r\n[Msg] Overwriting existing file [/tmp/log.zip]\r\n[Msg] Compressed log file and resources to [/tmp/log.zip]. Removing recorded directory [/tmp/log].\r\n[Msg] Stopping recording\r\n```\r\n\r\n`--overwrite` only, `/tmp/log.zip` exists, `/tmp/log` does not exist:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --overwrite --record-path '/tmp/log'\r\n[Wrn] [LogRecord.cc:291] Log path already exists on disk! Existing files will be overwritten.\r\n[Msg] Overwriting existing path [/tmp/log]\r\n...\r\n[Msg] Stopping recording\r\n```\r\n\r\n`--compress` only, both `/tmp/log` and `/tmp/log.zip` already exist:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --compress --record-path '/tmp/log'\r\n[Wrn] [LogRecord.cc:299] Log path already exists on disk! Recording instead to [/tmp/log(1)]\r\n...\r\n[Msg] Compressed log file and resources to [/tmp/log(1).zip]. Removing recorded directory [/tmp/log(1)].\r\n[Msg] Stopping recording\r\n$ ls /tmp\r\nlog\r\n'log(1).zip'\r\nlog.zip\r\n```\r\n\r\n\\(Pending changes:\\)\r\n\r\nFiles are outputted in `/tmp/log` and `/tmp/log.zip` in this example. During record, the original path in `file://` is prepended with the specified path, e.g. `/tmp/log`. During playback, the specified path is prepended to the URIs in the SDF.", "title": "[Blueprint] Logging meshes and materials", "destination": {"commit": {"hash": "a5d9d4b4a0cf", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/commit/a5d9d4b4a0cf.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/commits/a5d9d4b4a0cf"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{f98d11fe-f287-4dfb-99c3-e2b76a13232e}ts=2082645"}}, "type": "repository", "name": "ign-gazebo", "full_name": "ignitionrobotics/ign-gazebo", "uuid": "{f98d11fe-f287-4dfb-99c3-e2b76a13232e}"}, "branch": {"name": "ign-gazebo2"}}, "reason": "", "source": {"commit": {"hash": "b3b9a6c7fac8", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/commit/b3b9a6c7fac8.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/commits/b3b9a6c7fac8"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{f98d11fe-f287-4dfb-99c3-e2b76a13232e}ts=2082645"}}, "type": "repository", "name": "ign-gazebo", "full_name": "ignitionrobotics/ign-gazebo", "uuid": "{f98d11fe-f287-4dfb-99c3-e2b76a13232e}"}, "branch": {"name": "log_resources"}}, "state": "OPEN", "author": {"display_name": "Mabel Zhang", "uuid": "{4b0e38fb-bf50-45c0-a496-61147518b2bf}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B4b0e38fb-bf50-45c0-a496-61147518b2bf%7D"}, "html": {"href": "https://bitbucket.org/%7B4b0e38fb-bf50-45c0-a496-61147518b2bf%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:ceb5942c-6843-408c-8550-3ce4899d299b/4d48e5ea-cf28-4fa7-9715-8fc9e315d831/128"}}, "nickname": "mabelmzhang", "type": "user", "account_id": "557058:ceb5942c-6843-408c-8550-3ce4899d299b"}, "date": "2019-09-19T06:35:50.677285+00:00"}, "pull_request": {"type": "pullrequest", "id": 397, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397"}}, "title": "[Blueprint] Logging meshes and materials"}}, {"comment": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397/comments/117497570.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397/_/diff#comment-117497570"}}, "parent": {"id": 117476423, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397/comments/117476423.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397/_/diff#comment-117476423"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 397, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397"}}, "title": "[Blueprint] Logging meshes and materials"}, "content": {"raw": "Changed to `Element` in 1d240b8. Things still seem to work.", "markup": "markdown", "html": "<p>Changed to <code>Element</code> in <a href=\"#!/ignitionrobotics/ign-gazebo/commits/1d240b8\" rel=\"nofollow\" class=\"ap-connect-link\">1d240b8</a>. Things still seem to work.</p>", "type": "rendered"}, "created_on": "2019-09-19T06:25:10.878889+00:00", "user": {"display_name": "Mabel Zhang", "uuid": "{4b0e38fb-bf50-45c0-a496-61147518b2bf}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B4b0e38fb-bf50-45c0-a496-61147518b2bf%7D"}, "html": {"href": "https://bitbucket.org/%7B4b0e38fb-bf50-45c0-a496-61147518b2bf%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:ceb5942c-6843-408c-8550-3ce4899d299b/4d48e5ea-cf28-4fa7-9715-8fc9e315d831/128"}}, "nickname": "mabelmzhang", "type": "user", "account_id": "557058:ceb5942c-6843-408c-8550-3ce4899d299b"}, "inline": {}, "updated_on": "2019-09-19T06:25:10.892387+00:00", "type": "pullrequest_comment", "id": 117497570}, "pull_request": {"type": "pullrequest", "id": 397, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397"}}, "title": "[Blueprint] Logging meshes and materials"}}, {"update": {"description": "Depends on [ign-common PR 200](#!/ignitionrobotics/ign-common/pull-requests/200/log-resources/diff).\r\n\r\nPorts [this Gazebo PR](https://bitbucket.org/osrf/gazebo/pull-requests/2811/save-models-material-and-meshes-when/diff) to Ignition.\r\n\r\nImplements `--record-resources`, and `--compress` and `--overwrite` to support it.\r\n\r\nRecords resources \\(`--record-resources`\\), i.e. meshes and materials, to a directory under the specified log record directory. Optionally compresses \\(`--compress`\\) the whole directory, which contains the existing `.tlog` sqlite3 file and any resources, to a zip file. If directory or compressed file already exist, optionally overwrites \\(`--overwrite`\\).\r\n\r\nCorresponding SDF plugin parameters: `<record_resources>1</record_resources>`, `<compress>1</compress>`, `<overwrite>1</overwrite>.`If both command line and SDF parameters are specified, command line option overwrites SDF parameter.\r\n\r\n## Usage:\r\n\r\n```\r\nign gazebo [...] --record-resources --overwrite --compress\r\n```\r\n\r\n## Test --record-resources:\r\n\r\n```\r\n# This SDF specifies the equivalent of --record-resources --record-path '/tmp/log'\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf\r\n$ ign gazebo -v 4 -r examples/worlds/log_playback.sdf\r\n```\r\n\r\nTested with `<include><uri>https://fuel...</uri></include>` and `<mesh><uri>file://...</uri></mesh>`. Paths specified by `model://` are not supported in Ignition yet, so this case in the code is not tested.\r\n\r\n## Test --overwrite and --compress:\r\n\r\nWhen recording to `path`, the compression file is implied to be `path.zip`. Both are checked for existence.\r\n\r\nNo `--overwrite` \\(default\\):\r\n\r\n```\r\n# This SDF specifies the equivalent of --record-resources --record-path '/tmp/log'\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf\r\n\r\n# Run it again, and it should write to new directory\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf\r\n[Wrn] [LogRecord.cc:260] Log path already exists on disk! Recording instead to [/tmp/log(1)]\r\n[Msg] Recording to log file [/tmp/log(1)/state.tlog]\r\n```\r\n\r\n`--overwrite`, `/tmp/log` already exists:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --overwrite --record-path '/tmp/log'\r\n[Wrn] [LogRecord.cc:292] Log path already exists on disk! Existing files will be overwritten.\r\n[Msg] Overwriting existing path [/tmp/log]\r\n...\r\n[Msg] Stopping recording\r\n```\r\n\r\n`--overwrite --compress`, `/tmp/log.zip` already exists:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --compress --overwrite --record-path '/tmp/log'\r\n[Wrn] [LogRecord.cc:291] Log path already exists on disk! Existing files will be overwritten.\r\n...\r\n[Msg] Overwriting existing file [/tmp/log.zip]\r\n[Msg] Compressed log file and resources to [/tmp/log.zip]. Removing recorded directory [/tmp/log].\r\n[Msg] Stopping recording\r\n```\r\n\r\n`--overwrite` only, `/tmp/log.zip` exists, `/tmp/log` does not exist:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --overwrite --record-path '/tmp/log'\r\n[Wrn] [LogRecord.cc:291] Log path already exists on disk! Existing files will be overwritten.\r\n[Msg] Overwriting existing path [/tmp/log]\r\n...\r\n[Msg] Stopping recording\r\n```\r\n\r\n`--compress` only, both `/tmp/log` and `/tmp/log.zip` already exist:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --compress --record-path '/tmp/log'\r\n[Wrn] [LogRecord.cc:299] Log path already exists on disk! Recording instead to [/tmp/log(1)]\r\n...\r\n[Msg] Compressed log file and resources to [/tmp/log(1).zip]. Removing recorded directory [/tmp/log(1)].\r\n[Msg] Stopping recording\r\n$ ls /tmp\r\nlog\r\n'log(1).zip'\r\nlog.zip\r\n```\r\n\r\n\\(Pending changes:\\)\r\n\r\nFiles are outputted in `/tmp/log` and `/tmp/log.zip` in this example. During record, the original path in `file://` is prepended with the specified path, e.g. `/tmp/log`. During playback, the specified path is prepended to the URIs in the SDF.", "title": "[Blueprint] Logging meshes and materials", "destination": {"commit": {"hash": "a5d9d4b4a0cf", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/commit/a5d9d4b4a0cf.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/commits/a5d9d4b4a0cf"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{f98d11fe-f287-4dfb-99c3-e2b76a13232e}ts=2082645"}}, "type": "repository", "name": "ign-gazebo", "full_name": "ignitionrobotics/ign-gazebo", "uuid": "{f98d11fe-f287-4dfb-99c3-e2b76a13232e}"}, "branch": {"name": "ign-gazebo2"}}, "reason": "", "source": {"commit": {"hash": "1d240b825203", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/commit/1d240b825203.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/commits/1d240b825203"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{f98d11fe-f287-4dfb-99c3-e2b76a13232e}ts=2082645"}}, "type": "repository", "name": "ign-gazebo", "full_name": "ignitionrobotics/ign-gazebo", "uuid": "{f98d11fe-f287-4dfb-99c3-e2b76a13232e}"}, "branch": {"name": "log_resources"}}, "state": "OPEN", "author": {"display_name": "Mabel Zhang", "uuid": "{4b0e38fb-bf50-45c0-a496-61147518b2bf}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B4b0e38fb-bf50-45c0-a496-61147518b2bf%7D"}, "html": {"href": "https://bitbucket.org/%7B4b0e38fb-bf50-45c0-a496-61147518b2bf%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:ceb5942c-6843-408c-8550-3ce4899d299b/4d48e5ea-cf28-4fa7-9715-8fc9e315d831/128"}}, "nickname": "mabelmzhang", "type": "user", "account_id": "557058:ceb5942c-6843-408c-8550-3ce4899d299b"}, "date": "2019-09-19T06:24:26.017293+00:00"}, "pull_request": {"type": "pullrequest", "id": 397, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397"}}, "title": "[Blueprint] Logging meshes and materials"}}, {"comment": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397/comments/117494539.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397/_/diff#comment-117494539"}}, "parent": {"id": 117474642, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397/comments/117474642.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397/_/diff#comment-117474642"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 397, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397"}}, "title": "[Blueprint] Logging meshes and materials"}, "content": {"raw": "Done in a0892c9", "markup": "markdown", "html": "<p>Done in <a href=\"#!/ignitionrobotics/ign-gazebo/commits/a0892c9\" rel=\"nofollow\" class=\"ap-connect-link\">a0892c9</a></p>", "type": "rendered"}, "created_on": "2019-09-19T05:54:50.851761+00:00", "user": {"display_name": "Mabel Zhang", "uuid": "{4b0e38fb-bf50-45c0-a496-61147518b2bf}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B4b0e38fb-bf50-45c0-a496-61147518b2bf%7D"}, "html": {"href": "https://bitbucket.org/%7B4b0e38fb-bf50-45c0-a496-61147518b2bf%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:ceb5942c-6843-408c-8550-3ce4899d299b/4d48e5ea-cf28-4fa7-9715-8fc9e315d831/128"}}, "nickname": "mabelmzhang", "type": "user", "account_id": "557058:ceb5942c-6843-408c-8550-3ce4899d299b"}, "inline": {}, "updated_on": "2019-09-19T05:54:50.863248+00:00", "type": "pullrequest_comment", "id": 117494539}, "pull_request": {"type": "pullrequest", "id": 397, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397"}}, "title": "[Blueprint] Logging meshes and materials"}}, {"comment": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397/comments/117494532.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397/_/diff#comment-117494532"}}, "parent": {"id": 117474866, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397/comments/117474866.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397/_/diff#comment-117474866"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 397, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397"}}, "title": "[Blueprint] Logging meshes and materials"}, "content": {"raw": "Moved to PostUpdate in a0892c9", "markup": "markdown", "html": "<p>Moved to PostUpdate in <a href=\"#!/ignitionrobotics/ign-gazebo/commits/a0892c9\" rel=\"nofollow\" class=\"ap-connect-link\">a0892c9</a></p>", "type": "rendered"}, "created_on": "2019-09-19T05:54:44.267197+00:00", "user": {"display_name": "Mabel Zhang", "uuid": "{4b0e38fb-bf50-45c0-a496-61147518b2bf}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B4b0e38fb-bf50-45c0-a496-61147518b2bf%7D"}, "html": {"href": "https://bitbucket.org/%7B4b0e38fb-bf50-45c0-a496-61147518b2bf%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:ceb5942c-6843-408c-8550-3ce4899d299b/4d48e5ea-cf28-4fa7-9715-8fc9e315d831/128"}}, "nickname": "mabelmzhang", "type": "user", "account_id": "557058:ceb5942c-6843-408c-8550-3ce4899d299b"}, "inline": {}, "updated_on": "2019-09-19T05:54:44.277266+00:00", "type": "pullrequest_comment", "id": 117494532}, "pull_request": {"type": "pullrequest", "id": 397, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397"}}, "title": "[Blueprint] Logging meshes and materials"}}, {"comment": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397/comments/117494510.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397/_/diff#comment-117494510"}}, "parent": {"id": 117476512, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397/comments/117476512.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397/_/diff#comment-117476512"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 397, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397"}}, "title": "[Blueprint] Logging meshes and materials"}, "content": {"raw": "Thanks! Done in a0892c9", "markup": "markdown", "html": "<p>Thanks! Done in <a href=\"#!/ignitionrobotics/ign-gazebo/commits/a0892c9\" rel=\"nofollow\" class=\"ap-connect-link\">a0892c9</a></p>", "type": "rendered"}, "created_on": "2019-09-19T05:54:32.594065+00:00", "user": {"display_name": "Mabel Zhang", "uuid": "{4b0e38fb-bf50-45c0-a496-61147518b2bf}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B4b0e38fb-bf50-45c0-a496-61147518b2bf%7D"}, "html": {"href": "https://bitbucket.org/%7B4b0e38fb-bf50-45c0-a496-61147518b2bf%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:ceb5942c-6843-408c-8550-3ce4899d299b/4d48e5ea-cf28-4fa7-9715-8fc9e315d831/128"}}, "nickname": "mabelmzhang", "type": "user", "account_id": "557058:ceb5942c-6843-408c-8550-3ce4899d299b"}, "inline": {}, "updated_on": "2019-09-19T05:54:32.610172+00:00", "type": "pullrequest_comment", "id": 117494510}, "pull_request": {"type": "pullrequest", "id": 397, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397"}}, "title": "[Blueprint] Logging meshes and materials"}}, {"update": {"description": "Depends on [ign-common PR 200](#!/ignitionrobotics/ign-common/pull-requests/200/log-resources/diff).\r\n\r\nPorts [this Gazebo PR](https://bitbucket.org/osrf/gazebo/pull-requests/2811/save-models-material-and-meshes-when/diff) to Ignition.\r\n\r\nImplements `--record-resources`, and `--compress` and `--overwrite` to support it.\r\n\r\nRecords resources \\(`--record-resources`\\), i.e. meshes and materials, to a directory under the specified log record directory. Optionally compresses \\(`--compress`\\) the whole directory, which contains the existing `.tlog` sqlite3 file and any resources, to a zip file. If directory or compressed file already exist, optionally overwrites \\(`--overwrite`\\).\r\n\r\nCorresponding SDF plugin parameters: `<record_resources>1</record_resources>`, `<compress>1</compress>`, `<overwrite>1</overwrite>.`If both command line and SDF parameters are specified, command line option overwrites SDF parameter.\r\n\r\n## Usage:\r\n\r\n```\r\nign gazebo [...] --record-resources --overwrite --compress\r\n```\r\n\r\n## Test --record-resources:\r\n\r\n```\r\n# This SDF specifies the equivalent of --record-resources --record-path '/tmp/log'\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf\r\n$ ign gazebo -v 4 -r examples/worlds/log_playback.sdf\r\n```\r\n\r\nTested with `<include><uri>https://fuel...</uri></include>` and `<mesh><uri>file://...</uri></mesh>`. Paths specified by `model://` are not supported in Ignition yet, so this case in the code is not tested.\r\n\r\n## Test --overwrite and --compress:\r\n\r\nWhen recording to `path`, the compression file is implied to be `path.zip`. Both are checked for existence.\r\n\r\nNo `--overwrite` \\(default\\):\r\n\r\n```\r\n# This SDF specifies the equivalent of --record-resources --record-path '/tmp/log'\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf\r\n\r\n# Run it again, and it should write to new directory\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf\r\n[Wrn] [LogRecord.cc:260] Log path already exists on disk! Recording instead to [/tmp/log(1)]\r\n[Msg] Recording to log file [/tmp/log(1)/state.tlog]\r\n```\r\n\r\n`--overwrite`, `/tmp/log` already exists:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --overwrite --record-path '/tmp/log'\r\n[Wrn] [LogRecord.cc:292] Log path already exists on disk! Existing files will be overwritten.\r\n[Msg] Overwriting existing path [/tmp/log]\r\n...\r\n[Msg] Stopping recording\r\n```\r\n\r\n`--overwrite --compress`, `/tmp/log.zip` already exists:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --compress --overwrite --record-path '/tmp/log'\r\n[Wrn] [LogRecord.cc:291] Log path already exists on disk! Existing files will be overwritten.\r\n...\r\n[Msg] Overwriting existing file [/tmp/log.zip]\r\n[Msg] Compressed log file and resources to [/tmp/log.zip]. Removing recorded directory [/tmp/log].\r\n[Msg] Stopping recording\r\n```\r\n\r\n`--overwrite` only, `/tmp/log.zip` exists, `/tmp/log` does not exist:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --overwrite --record-path '/tmp/log'\r\n[Wrn] [LogRecord.cc:291] Log path already exists on disk! Existing files will be overwritten.\r\n[Msg] Overwriting existing path [/tmp/log]\r\n...\r\n[Msg] Stopping recording\r\n```\r\n\r\n`--compress` only, both `/tmp/log` and `/tmp/log.zip` already exist:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --compress --record-path '/tmp/log'\r\n[Wrn] [LogRecord.cc:299] Log path already exists on disk! Recording instead to [/tmp/log(1)]\r\n...\r\n[Msg] Compressed log file and resources to [/tmp/log(1).zip]. Removing recorded directory [/tmp/log(1)].\r\n[Msg] Stopping recording\r\n$ ls /tmp\r\nlog\r\n'log(1).zip'\r\nlog.zip\r\n```\r\n\r\n\\(Pending changes:\\)\r\n\r\nFiles are outputted in `/tmp/log` and `/tmp/log.zip` in this example. During record, the original path in `file://` is prepended with the specified path, e.g. `/tmp/log`. During playback, the specified path is prepended to the URIs in the SDF.", "title": "[Blueprint] Logging meshes and materials", "destination": {"commit": {"hash": "a5d9d4b4a0cf", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/commit/a5d9d4b4a0cf.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/commits/a5d9d4b4a0cf"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{f98d11fe-f287-4dfb-99c3-e2b76a13232e}ts=2082645"}}, "type": "repository", "name": "ign-gazebo", "full_name": "ignitionrobotics/ign-gazebo", "uuid": "{f98d11fe-f287-4dfb-99c3-e2b76a13232e}"}, "branch": {"name": "ign-gazebo2"}}, "reason": "", "source": {"commit": {"hash": "a0892c915da3", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/commit/a0892c915da3.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/commits/a0892c915da3"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{f98d11fe-f287-4dfb-99c3-e2b76a13232e}ts=2082645"}}, "type": "repository", "name": "ign-gazebo", "full_name": "ignitionrobotics/ign-gazebo", "uuid": "{f98d11fe-f287-4dfb-99c3-e2b76a13232e}"}, "branch": {"name": "log_resources"}}, "state": "OPEN", "author": {"display_name": "Mabel Zhang", "uuid": "{4b0e38fb-bf50-45c0-a496-61147518b2bf}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B4b0e38fb-bf50-45c0-a496-61147518b2bf%7D"}, "html": {"href": "https://bitbucket.org/%7B4b0e38fb-bf50-45c0-a496-61147518b2bf%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:ceb5942c-6843-408c-8550-3ce4899d299b/4d48e5ea-cf28-4fa7-9715-8fc9e315d831/128"}}, "nickname": "mabelmzhang", "type": "user", "account_id": "557058:ceb5942c-6843-408c-8550-3ce4899d299b"}, "date": "2019-09-19T05:54:04.846933+00:00"}, "pull_request": {"type": "pullrequest", "id": 397, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397"}}, "title": "[Blueprint] Logging meshes and materials"}}, {"update": {"description": "Depends on [ign-common PR 200](#!/ignitionrobotics/ign-common/pull-requests/200/log-resources/diff).\r\n\r\nPorts [this Gazebo PR](https://bitbucket.org/osrf/gazebo/pull-requests/2811/save-models-material-and-meshes-when/diff) to Ignition.\r\n\r\nImplements `--record-resources`, and `--compress` and `--overwrite` to support it.\r\n\r\nRecords resources \\(`--record-resources`\\), i.e. meshes and materials, to a directory under the specified log record directory. Optionally compresses \\(`--compress`\\) the whole directory, which contains the existing `.tlog` sqlite3 file and any resources, to a zip file. If directory or compressed file already exist, optionally overwrites \\(`--overwrite`\\).\r\n\r\nCorresponding SDF plugin parameters: `<record_resources>1</record_resources>`, `<compress>1</compress>`, `<overwrite>1</overwrite>.`If both command line and SDF parameters are specified, command line option overwrites SDF parameter.\r\n\r\n## Usage:\r\n\r\n```\r\nign gazebo [...] --record-resources --overwrite --compress\r\n```\r\n\r\n## Test --record-resources:\r\n\r\n```\r\n# This SDF specifies the equivalent of --record-resources --record-path '/tmp/log'\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf\r\n$ ign gazebo -v 4 -r examples/worlds/log_playback.sdf\r\n```\r\n\r\nTested with `<include><uri>https://fuel...</uri></include>` and `<mesh><uri>file://...</uri></mesh>`. Paths specified by `model://` are not supported in Ignition yet, so this case in the code is not tested.\r\n\r\n## Test --overwrite and --compress:\r\n\r\nWhen recording to `path`, the compression file is implied to be `path.zip`. Both are checked for existence.\r\n\r\nNo `--overwrite` \\(default\\):\r\n\r\n```\r\n# This SDF specifies the equivalent of --record-resources --record-path '/tmp/log'\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf\r\n\r\n# Run it again, and it should write to new directory\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf\r\n[Wrn] [LogRecord.cc:260] Log path already exists on disk! Recording instead to [/tmp/log(1)]\r\n[Msg] Recording to log file [/tmp/log(1)/state.tlog]\r\n```\r\n\r\n`--overwrite`, `/tmp/log` already exists:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --overwrite --record-path '/tmp/log'\r\n[Wrn] [LogRecord.cc:292] Log path already exists on disk! Existing files will be overwritten.\r\n[Msg] Overwriting existing path [/tmp/log]\r\n...\r\n[Msg] Stopping recording\r\n```\r\n\r\n`--overwrite --compress`, `/tmp/log.zip` already exists:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --compress --overwrite --record-path '/tmp/log'\r\n[Wrn] [LogRecord.cc:291] Log path already exists on disk! Existing files will be overwritten.\r\n...\r\n[Msg] Overwriting existing file [/tmp/log.zip]\r\n[Msg] Compressed log file and resources to [/tmp/log.zip]. Removing recorded directory [/tmp/log].\r\n[Msg] Stopping recording\r\n```\r\n\r\n`--overwrite` only, `/tmp/log.zip` exists, `/tmp/log` does not exist:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --overwrite --record-path '/tmp/log'\r\n[Wrn] [LogRecord.cc:291] Log path already exists on disk! Existing files will be overwritten.\r\n[Msg] Overwriting existing path [/tmp/log]\r\n...\r\n[Msg] Stopping recording\r\n```\r\n\r\n`--compress` only, both `/tmp/log` and `/tmp/log.zip` already exist:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --compress --record-path '/tmp/log'\r\n[Wrn] [LogRecord.cc:299] Log path already exists on disk! Recording instead to [/tmp/log(1)]\r\n...\r\n[Msg] Compressed log file and resources to [/tmp/log(1).zip]. Removing recorded directory [/tmp/log(1)].\r\n[Msg] Stopping recording\r\n$ ls /tmp\r\nlog\r\n'log(1).zip'\r\nlog.zip\r\n```\r\n\r\n\\(Pending changes:\\)\r\n\r\nFiles are outputted in `/tmp/log` and `/tmp/log.zip` in this example. During record, the original path in `file://` is prepended with the specified path, e.g. `/tmp/log`. During playback, the specified path is prepended to the URIs in the SDF.", "title": "[Blueprint] Logging meshes and materials", "destination": {"commit": {"hash": "a5d9d4b4a0cf", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/commit/a5d9d4b4a0cf.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/commits/a5d9d4b4a0cf"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{f98d11fe-f287-4dfb-99c3-e2b76a13232e}ts=2082645"}}, "type": "repository", "name": "ign-gazebo", "full_name": "ignitionrobotics/ign-gazebo", "uuid": "{f98d11fe-f287-4dfb-99c3-e2b76a13232e}"}, "branch": {"name": "ign-gazebo2"}}, "reason": "", "source": {"commit": {"hash": "98de4f963424", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/commit/98de4f963424.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/commits/98de4f963424"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{f98d11fe-f287-4dfb-99c3-e2b76a13232e}ts=2082645"}}, "type": "repository", "name": "ign-gazebo", "full_name": "ignitionrobotics/ign-gazebo", "uuid": "{f98d11fe-f287-4dfb-99c3-e2b76a13232e}"}, "branch": {"name": "log_resources"}}, "state": "OPEN", "author": {"display_name": "Mabel Zhang", "uuid": "{4b0e38fb-bf50-45c0-a496-61147518b2bf}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B4b0e38fb-bf50-45c0-a496-61147518b2bf%7D"}, "html": {"href": "https://bitbucket.org/%7B4b0e38fb-bf50-45c0-a496-61147518b2bf%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:ceb5942c-6843-408c-8550-3ce4899d299b/4d48e5ea-cf28-4fa7-9715-8fc9e315d831/128"}}, "nickname": "mabelmzhang", "type": "user", "account_id": "557058:ceb5942c-6843-408c-8550-3ce4899d299b"}, "date": "2019-09-19T05:48:05.078002+00:00"}, "pull_request": {"type": "pullrequest", "id": 397, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397"}}, "title": "[Blueprint] Logging meshes and materials"}}, {"update": {"description": "Depends on [ign-common PR 200](#!/ignitionrobotics/ign-common/pull-requests/200/log-resources/diff).\r\n\r\nPorts [this Gazebo PR](https://bitbucket.org/osrf/gazebo/pull-requests/2811/save-models-material-and-meshes-when/diff) to Ignition.\r\n\r\nImplements `--record-resources`, and `--compress` and `--overwrite` to support it.\r\n\r\nRecords resources \\(`--record-resources`\\), i.e. meshes and materials, to a directory under the specified log record directory. Optionally compresses \\(`--compress`\\) the whole directory, which contains the existing `.tlog` sqlite3 file and any resources, to a zip file. If directory or compressed file already exist, optionally overwrites \\(`--overwrite`\\).\r\n\r\nCorresponding SDF plugin parameters: `<record_resources>1</record_resources>`, `<compress>1</compress>`, `<overwrite>1</overwrite>.`If both command line and SDF parameters are specified, command line option overwrites SDF parameter.\r\n\r\n## Usage:\r\n\r\n```\r\nign gazebo [...] --record-resources --overwrite --compress\r\n```\r\n\r\n## Test --record-resources:\r\n\r\n```\r\n# This SDF specifies the equivalent of --record-resources --record-path '/tmp/log'\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf\r\n$ ign gazebo -v 4 -r examples/worlds/log_playback.sdf\r\n```\r\n\r\nTested with `<include><uri>https://fuel...</uri></include>` and `<mesh><uri>file://...</uri></mesh>`. Paths specified by `model://` are not supported in Ignition yet, so this case in the code is not tested.\r\n\r\n## Test --overwrite and --compress:\r\n\r\nWhen recording to `path`, the compression file is implied to be `path.zip`. Both are checked for existence.\r\n\r\nNo `--overwrite` \\(default\\):\r\n\r\n```\r\n# This SDF specifies the equivalent of --record-resources --record-path '/tmp/log'\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf\r\n\r\n# Run it again, and it should write to new directory\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf\r\n[Wrn] [LogRecord.cc:260] Log path already exists on disk! Recording instead to [/tmp/log(1)]\r\n[Msg] Recording to log file [/tmp/log(1)/state.tlog]\r\n```\r\n\r\n`--overwrite`, `/tmp/log` already exists:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --overwrite --record-path '/tmp/log'\r\n[Wrn] [LogRecord.cc:292] Log path already exists on disk! Existing files will be overwritten.\r\n[Msg] Overwriting existing path [/tmp/log]\r\n...\r\n[Msg] Stopping recording\r\n```\r\n\r\n`--overwrite --compress`, `/tmp/log.zip` already exists:\r\n\r\n```\r\n[Wrn] [LogRecord.cc:291] Log path already exists on disk! Existing files will be overwritten.\r\n...\r\n[Msg] Overwriting existing file [/tmp/log.zip]\r\n[Msg] Compressed log file and resources to [/tmp/log.zip]. Removing recorded directory [/tmp/log].\r\n[Msg] Stopping recording\r\n```\r\n\r\n`--overwrite` only, `/tmp/log.zip` exists, `/tmp/log` does not exist:\r\n\r\n```\r\n[Wrn] [LogRecord.cc:291] Log path already exists on disk! Existing files will be overwritten.\r\n[Msg] Overwriting existing path [/tmp/log]\r\n...\r\n[Msg] Stopping recording\r\n```\r\n\r\n`--compress` only, both `/tmp/log` and `/tmp/log.zip` already exist:\r\n\r\n```\r\n[Wrn] [LogRecord.cc:299] Log path already exists on disk! Recording instead to [/tmp/log(1)]\r\n...\r\n[Msg] Compressed log file and resources to [/tmp/log(1).zip]. Removing recorded directory [/tmp/log(1)].\r\n[Msg] Stopping recording\r\n$ ls /tmp\r\nlog\r\n'log(1).zip'\r\nlog.zip\r\n```\r\n\r\n\\(Pending changes:\\)\r\n\r\nFiles are outputted in `/tmp/log` and `/tmp/log.zip` in this example. During record, the original path in `file://` is prepended with the specified path, e.g. `/tmp/log`. During playback, the specified path is prepended to the URIs in the SDF.", "title": "[Blueprint] Logging meshes and materials", "destination": {"commit": {"hash": "a5d9d4b4a0cf", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/commit/a5d9d4b4a0cf.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/commits/a5d9d4b4a0cf"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{f98d11fe-f287-4dfb-99c3-e2b76a13232e}ts=2082645"}}, "type": "repository", "name": "ign-gazebo", "full_name": "ignitionrobotics/ign-gazebo", "uuid": "{f98d11fe-f287-4dfb-99c3-e2b76a13232e}"}, "branch": {"name": "ign-gazebo2"}}, "reason": "", "source": {"commit": {"hash": "98de4f963424", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/commit/98de4f963424.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/commits/98de4f963424"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{f98d11fe-f287-4dfb-99c3-e2b76a13232e}ts=2082645"}}, "type": "repository", "name": "ign-gazebo", "full_name": "ignitionrobotics/ign-gazebo", "uuid": "{f98d11fe-f287-4dfb-99c3-e2b76a13232e}"}, "branch": {"name": "log_resources"}}, "state": "OPEN", "author": {"display_name": "Mabel Zhang", "uuid": "{4b0e38fb-bf50-45c0-a496-61147518b2bf}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B4b0e38fb-bf50-45c0-a496-61147518b2bf%7D"}, "html": {"href": "https://bitbucket.org/%7B4b0e38fb-bf50-45c0-a496-61147518b2bf%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:ceb5942c-6843-408c-8550-3ce4899d299b/4d48e5ea-cf28-4fa7-9715-8fc9e315d831/128"}}, "nickname": "mabelmzhang", "type": "user", "account_id": "557058:ceb5942c-6843-408c-8550-3ce4899d299b"}, "date": "2019-09-19T04:52:56.786236+00:00"}, "pull_request": {"type": "pullrequest", "id": 397, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397"}}, "title": "[Blueprint] Logging meshes and materials"}}, {"comment": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397/comments/117476681.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397/_/diff#comment-117476681"}}, "parent": {"id": 117473462, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397/comments/117473462.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397/_/diff#comment-117473462"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 397, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397"}}, "title": "[Blueprint] Logging meshes and materials"}, "content": {"raw": "Removed in ba71c5d", "markup": "markdown", "html": "<p>Removed in <a href=\"#!/ignitionrobotics/ign-gazebo/commits/ba71c5d\" rel=\"nofollow\" class=\"ap-connect-link\">ba71c5d</a></p>", "type": "rendered"}, "created_on": "2019-09-19T00:38:47.755627+00:00", "user": {"display_name": "Louise Poubel", "uuid": "{5cfa2075-477b-4ded-bdb9-8d2479544ec4}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D"}, "html": {"href": "https://bitbucket.org/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8/7d903d90-c5ea-4182-b7ef-0d467e9e1c74/128"}}, "nickname": "chapulina", "type": "user", "account_id": "557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8"}, "inline": {}, "updated_on": "2019-09-19T00:38:47.764641+00:00", "type": "pullrequest_comment", "id": 117476681}, "pull_request": {"type": "pullrequest", "id": 397, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397"}}, "title": "[Blueprint] Logging meshes and materials"}}, {"update": {"description": "Depends on [ign-common PR 200](#!/ignitionrobotics/ign-common/pull-requests/200/log-resources/diff).\r\n\r\nPorts [this Gazebo PR](https://bitbucket.org/osrf/gazebo/pull-requests/2811/save-models-material-and-meshes-when/diff) to Ignition.\r\n\r\nImplements `--record-resources`, and `--compress` and `--overwrite` to support it.\r\n\r\nRecords resources \\(`--record-resources`\\), i.e. meshes and materials, to a directory under the specified log record directory. Optionally compresses \\(`--compress`\\) the whole directory, which contains the existing `.tlog` sqlite3 file and any resources, to a zip file. If directory or compressed file already exist, optionally overwrites \\(`--overwrite`\\).\r\n\r\nCorresponding SDF plugin parameters: `<record_resources>1</record_resources>`, `<compress>1</compress>`, `<overwrite>1</overwrite>.`If both command line and SDF parameters are specified, command line option overwrites SDF parameter.\r\n\r\n## Usage:\r\n\r\n```\r\nign gazebo [...] --record-resources --overwrite --compress\r\n```\r\n\r\n## Test --record-resources:\r\n\r\n```\r\n# This SDF specifies the equivalent of --record-resources --record-path '/tmp/log'\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf\r\n$ ign gazebo -v 4 -r examples/worlds/log_playback.sdf\r\n```\r\n\r\nTested with `<include><uri>https://fuel...</uri></include>` and `<mesh><uri>file://...</uri></mesh>`. Paths specified by `model://` are not supported in Ignition yet, so this case in the code is not tested.\r\n\r\n## Test --overwrite and --compress:\r\n\r\nWhen recording to `path`, the compression file is implied to be `path.zip`. Both are checked for existence.\r\n\r\nNo `--overwrite` \\(default\\):\r\n\r\n```\r\n# This SDF specifies the equivalent of --record-resources --record-path '/tmp/log'\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf\r\n\r\n# Run it again, and it should write to new directory\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf\r\n[Wrn] [LogRecord.cc:260] Log path already exists on disk! Recording instead to [/tmp/log(1)]\r\n[Msg] Recording to log file [/tmp/log(1)/state.tlog]\r\n```\r\n\r\n`--overwrite`, `/tmp/log` already exists:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --overwrite --record-path '/tmp/log'\r\n[Wrn] [LogRecord.cc:292] Log path already exists on disk! Existing files will be overwritten.\r\n[Msg] Overwriting existing path [/tmp/log]\r\n...\r\n[Msg] Stopping recording\r\n```\r\n\r\n`--overwrite --compress`, `/tmp/log.zip` already exists:\r\n\r\n```\r\n[Wrn] [LogRecord.cc:291] Log path already exists on disk! Existing files will be overwritten.\r\n...\r\n[Msg] Overwriting existing file [/tmp/log.zip]\r\n[Msg] Compressed log file and resources to [/tmp/log.zip]. Removing recorded directory [/tmp/log].\r\n[Msg] Stopping recording\r\n```\r\n\r\n`--overwrite` only, `/tmp/log.zip` exists, `/tmp/log` does not exist:\r\n\r\n```\r\n[Wrn] [LogRecord.cc:291] Log path already exists on disk! Existing files will be overwritten.\r\n[Msg] Overwriting existing path [/tmp/log]\r\n...\r\n[Msg] Stopping recording\r\n```\r\n\r\n`--compress` only, both `/tmp/log` and `/tmp/log.zip` already exist:\r\n\r\n```\r\n[Wrn] [LogRecord.cc:299] Log path already exists on disk! Recording instead to [/tmp/log(1)]\r\n...\r\n[Msg] Compressed log file and resources to [/tmp/log(1).zip]. Removing recorded directory [/tmp/log(1)].\r\n[Msg] Stopping recording\r\n$ ls /tmp\r\nlog\r\n'log(1).zip'\r\nlog.zip\r\n```\r\n\r\n\\(Pending changes:\\)\r\n\r\nFiles are outputted in `/tmp/log` and `/tmp/log.zip` in this example. During record, the original path in `file://` is prepended with the specified path, e.g. `/tmp/log`. During playback, the specified path is prepended to the URIs in the SDF.", "title": "[Blueprint] Logging meshes and materials", "destination": {"commit": {"hash": "a5d9d4b4a0cf", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/commit/a5d9d4b4a0cf.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/commits/a5d9d4b4a0cf"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{f98d11fe-f287-4dfb-99c3-e2b76a13232e}ts=2082645"}}, "type": "repository", "name": "ign-gazebo", "full_name": "ignitionrobotics/ign-gazebo", "uuid": "{f98d11fe-f287-4dfb-99c3-e2b76a13232e}"}, "branch": {"name": "ign-gazebo2"}}, "reason": "", "source": {"commit": {"hash": "ba71c5d1ea12", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/commit/ba71c5d1ea12.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/commits/ba71c5d1ea12"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{f98d11fe-f287-4dfb-99c3-e2b76a13232e}ts=2082645"}}, "type": "repository", "name": "ign-gazebo", "full_name": "ignitionrobotics/ign-gazebo", "uuid": "{f98d11fe-f287-4dfb-99c3-e2b76a13232e}"}, "branch": {"name": "log_resources"}}, "state": "OPEN", "author": {"display_name": "Louise Poubel", "uuid": "{5cfa2075-477b-4ded-bdb9-8d2479544ec4}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D"}, "html": {"href": "https://bitbucket.org/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8/7d903d90-c5ea-4182-b7ef-0d467e9e1c74/128"}}, "nickname": "chapulina", "type": "user", "account_id": "557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8"}, "date": "2019-09-19T00:36:59.963817+00:00"}, "pull_request": {"type": "pullrequest", "id": 397, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397"}}, "title": "[Blueprint] Logging meshes and materials"}}, {"comment": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397/comments/117476512.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397/_/diff#comment-117476512"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 397, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397"}}, "title": "[Blueprint] Logging meshes and materials"}, "content": {"raw": "These `if` / `else` s could be simplified to:\n\n```\nserverConfig.SetLogRecordResources(_recordResources);\n```", "markup": "markdown", "html": "<p>These <code>if</code> / <code>else</code> s could be simplified to:</p>\n<div class=\"codehilite\"><pre><span></span>serverConfig.SetLogRecordResources(_recordResources);\n</pre></div>", "type": "rendered"}, "created_on": "2019-09-19T00:35:13.427302+00:00", "user": {"display_name": "Louise Poubel", "uuid": "{5cfa2075-477b-4ded-bdb9-8d2479544ec4}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D"}, "html": {"href": "https://bitbucket.org/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8/7d903d90-c5ea-4182-b7ef-0d467e9e1c74/128"}}, "nickname": "chapulina", "type": "user", "account_id": "557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8"}, "inline": {}, "updated_on": "2019-09-19T00:35:13.435149+00:00", "type": "pullrequest_comment", "id": 117476512}, "pull_request": {"type": "pullrequest", "id": 397, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397"}}, "title": "[Blueprint] Logging meshes and materials"}}, {"comment": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397/comments/117476423.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397/_/diff#comment-117476423"}}, "parent": {"id": 117475583, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397/comments/117475583.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397/_/diff#comment-117475583"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 397, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397"}}, "title": "[Blueprint] Logging meshes and materials"}, "content": {"raw": "This may be causing issues on lines like this above: `sdf::ParamPtr pathParam = pluginElem->GetAttribute(\"path\");`\n\nSince the SDF files have been using elements, the server is probably always adding attributes. ", "markup": "markdown", "html": "<p>This may be causing issues on lines like this above: <code>sdf::ParamPtr pathParam = pluginElem-&gt;GetAttribute(\"path\");</code></p>\n<p>Since the SDF files have been using elements, the server is probably always adding attributes. </p>", "type": "rendered"}, "created_on": "2019-09-19T00:33:07.864528+00:00", "user": {"display_name": "Louise Poubel", "uuid": "{5cfa2075-477b-4ded-bdb9-8d2479544ec4}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D"}, "html": {"href": "https://bitbucket.org/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8/7d903d90-c5ea-4182-b7ef-0d467e9e1c74/128"}}, "nickname": "chapulina", "type": "user", "account_id": "557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8"}, "inline": {}, "updated_on": "2019-09-19T00:33:07.874529+00:00", "type": "pullrequest_comment", "id": 117476423}, "pull_request": {"type": "pullrequest", "id": 397, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397"}}, "title": "[Blueprint] Logging meshes and materials"}}, {"comment": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397/comments/117475583.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397/_/diff#comment-117475583"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 397, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397"}}, "title": "[Blueprint] Logging meshes and materials"}, "content": {"raw": "I just realized this has been adding an attribute all along, when it should actually be adding an element. It's working because `_sdf->Get<std::string>(\"path\")` checks both attributes and elements, but I think we should be consistent in case someone tries to access the elements in a different way.\n\nThe example world is using elements:\n\n```\n    <plugin\n      filename=\"libignition-gazebo-log-system.so\"\n      name=\"ignition::gazebo::systems::LogRecord\">\n      <path>/tmp/log</path>\n      <record_resources>0</record_resources>\n      <overwrite>0</overwrite>\n      <compress>0</compress>\n    </plugin>\n```\n\nAnd the server is using attributes:\n\n```\n    <plugin\n      filename=\"libignition-gazebo-log-system.so\"\n      name=\"ignition::gazebo::systems::LogRecord\"\n      path=\"/tmp/log\"\n      record_resources=false\n      overwrite=false\n      compress=false/>\n```", "markup": "markdown", "html": "<p>I just realized this has been adding an attribute all along, when it should actually be adding an element. It's working because <code>_sdf-&gt;Get&lt;std::string&gt;(\"path\")</code> checks both attributes and elements, but I think we should be consistent in case someone tries to access the elements in a different way.</p>\n<p>The example world is using elements:</p>\n<div class=\"codehilite\"><pre><span></span>    <span class=\"nt\">&lt;plugin</span>\n      <span class=\"na\">filename=</span><span class=\"s\">&quot;libignition-gazebo-log-system.so&quot;</span>\n      <span class=\"na\">name=</span><span class=\"s\">&quot;ignition::gazebo::systems::LogRecord&quot;</span><span class=\"nt\">&gt;</span>\n      <span class=\"nt\">&lt;path&gt;</span>/tmp/log<span class=\"nt\">&lt;/path&gt;</span>\n      <span class=\"nt\">&lt;record_resources&gt;</span>0<span class=\"nt\">&lt;/record_resources&gt;</span>\n      <span class=\"nt\">&lt;overwrite&gt;</span>0<span class=\"nt\">&lt;/overwrite&gt;</span>\n      <span class=\"nt\">&lt;compress&gt;</span>0<span class=\"nt\">&lt;/compress&gt;</span>\n    <span class=\"nt\">&lt;/plugin&gt;</span>\n</pre></div>\n\n\n<p>And the server is using attributes:</p>\n<div class=\"codehilite\"><pre><span></span>    &lt;plugin\n      filename=&quot;libignition-gazebo-log-system.so&quot;\n      name=&quot;ignition::gazebo::systems::LogRecord&quot;\n      path=&quot;/tmp/log&quot;\n      record_resources=false\n      overwrite=false\n      compress=false/&gt;\n</pre></div>", "type": "rendered"}, "created_on": "2019-09-19T00:16:18.367889+00:00", "user": {"display_name": "Louise Poubel", "uuid": "{5cfa2075-477b-4ded-bdb9-8d2479544ec4}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D"}, "html": {"href": "https://bitbucket.org/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8/7d903d90-c5ea-4182-b7ef-0d467e9e1c74/128"}}, "nickname": "chapulina", "type": "user", "account_id": "557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8"}, "inline": {}, "updated_on": "2019-09-19T00:16:34.557354+00:00", "type": "pullrequest_comment", "id": 117475583}, "pull_request": {"type": "pullrequest", "id": 397, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397"}}, "title": "[Blueprint] Logging meshes and materials"}}, {"comment": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397/comments/117474866.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397/_/diff#comment-117474866"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 397, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397"}}, "title": "[Blueprint] Logging meshes and materials"}, "content": {"raw": "Would it be possible to do this on `PreUpdate` or `PostUpdate`? This system usually runs alongside `Physics`, and physics should be the only system active during update.\n\nIf the `_ecm` can be `const`, I recommend you do this on `PostUpdate` so that it runs in parallel with other systems.", "markup": "markdown", "html": "<p>Would it be possible to do this on <code>PreUpdate</code> or <code>PostUpdate</code>? This system usually runs alongside <code>Physics</code>, and physics should be the only system active during update.</p>\n<p>If the <code>_ecm</code> can be <code>const</code>, I recommend you do this on <code>PostUpdate</code> so that it runs in parallel with other systems.</p>", "type": "rendered"}, "created_on": "2019-09-19T00:01:34.783278+00:00", "user": {"display_name": "Louise Poubel", "uuid": "{5cfa2075-477b-4ded-bdb9-8d2479544ec4}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D"}, "html": {"href": "https://bitbucket.org/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8/7d903d90-c5ea-4182-b7ef-0d467e9e1c74/128"}}, "nickname": "chapulina", "type": "user", "account_id": "557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8"}, "inline": {}, "updated_on": "2019-09-19T00:01:34.791143+00:00", "type": "pullrequest_comment", "id": 117474866}, "pull_request": {"type": "pullrequest", "id": 397, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397"}}, "title": "[Blueprint] Logging meshes and materials"}}, {"comment": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397/comments/117474642.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397/_/diff#comment-117474642"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 397, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397"}}, "title": "[Blueprint] Logging meshes and materials"}, "content": {"raw": "This should be `--overwrite`", "markup": "markdown", "html": "<p>This should be <code>--overwrite</code></p>", "type": "rendered"}, "created_on": "2019-09-18T23:57:40.073858+00:00", "user": {"display_name": "Louise Poubel", "uuid": "{5cfa2075-477b-4ded-bdb9-8d2479544ec4}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D"}, "html": {"href": "https://bitbucket.org/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8/7d903d90-c5ea-4182-b7ef-0d467e9e1c74/128"}}, "nickname": "chapulina", "type": "user", "account_id": "557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8"}, "inline": {}, "updated_on": "2019-09-18T23:57:40.080940+00:00", "type": "pullrequest_comment", "id": 117474642}, "pull_request": {"type": "pullrequest", "id": 397, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397"}}, "title": "[Blueprint] Logging meshes and materials"}}, {"comment": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397/comments/117474316.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397/_/diff#comment-117474316"}}, "parent": {"id": 117474128, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397/comments/117474128.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397/_/diff#comment-117474128"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 397, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397"}}, "title": "[Blueprint] Logging meshes and materials"}, "content": {"raw": "Ah wait, just saw this other point\n\n> If --record is specified, but no --record-path is specified, and a <path></path> is specified in the SDF LogRecord plugin, then ServerConfig creates a timestamped directory, instead of using the one in <path></path>. Is this desired?\n\nThat sounds like a problem, we shouldn't dump `<path>`. But we only have that after we parse the SDF.", "markup": "markdown", "html": "<p>Ah wait, just saw this other point</p>\n<blockquote>\n<p>If --record is specified, but no --record-path is specified, and a &lt;path&gt;&lt;/path&gt; is specified in the SDF LogRecord plugin, then ServerConfig creates a timestamped directory, instead of using the one in &lt;path&gt;&lt;/path&gt;. Is this desired?</p>\n</blockquote>\n<p>That sounds like a problem, we shouldn't dump <code>&lt;path&gt;</code>. But we only have that after we parse the SDF.</p>", "type": "rendered"}, "created_on": "2019-09-18T23:51:32.198011+00:00", "user": {"display_name": "Louise Poubel", "uuid": "{5cfa2075-477b-4ded-bdb9-8d2479544ec4}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D"}, "html": {"href": "https://bitbucket.org/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8/7d903d90-c5ea-4182-b7ef-0d467e9e1c74/128"}}, "nickname": "chapulina", "type": "user", "account_id": "557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8"}, "updated_on": "2019-09-18T23:51:32.207670+00:00", "type": "pullrequest_comment", "id": 117474316}, "pull_request": {"type": "pullrequest", "id": 397, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397"}}, "title": "[Blueprint] Logging meshes and materials"}}, {"comment": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397/comments/117474128.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397/_/diff#comment-117474128"}}, "parent": {"id": 117473905, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397/comments/117473905.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397/_/diff#comment-117473905"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 397, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397"}}, "title": "[Blueprint] Logging meshes and materials"}, "content": {"raw": "We could move the logic of `overwrite` to `ign.cc` and don't modify `recordPath` inside `LogRecord`. What do you think?", "markup": "markdown", "html": "<p>We could move the logic of <code>overwrite</code> to <code>ign.cc</code> and don't modify <code>recordPath</code> inside <code>LogRecord</code>. What do you think?</p>", "type": "rendered"}, "created_on": "2019-09-18T23:48:15.289508+00:00", "user": {"display_name": "Louise Poubel", "uuid": "{5cfa2075-477b-4ded-bdb9-8d2479544ec4}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D"}, "html": {"href": "https://bitbucket.org/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8/7d903d90-c5ea-4182-b7ef-0d467e9e1c74/128"}}, "nickname": "chapulina", "type": "user", "account_id": "557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8"}, "updated_on": "2019-09-18T23:48:15.301333+00:00", "type": "pullrequest_comment", "id": 117474128}, "pull_request": {"type": "pullrequest", "id": 397, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397"}}, "title": "[Blueprint] Logging meshes and materials"}}, {"comment": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397/comments/117474020.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397/_/diff#comment-117474020"}}, "parent": {"id": 117472522, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397/comments/117472522.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397/_/diff#comment-117472522"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 397, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397"}}, "title": "[Blueprint] Logging meshes and materials"}, "content": {"raw": "I think there might have been something specific in the Param API. The `Param::GetAsString` returns the value after passing it to a string stream. For a Boolean it might always output `true`.", "markup": "markdown", "html": "<p>I think there might have been something specific in the Param API. The <code>Param::GetAsString</code> returns the value after passing it to a string stream. For a Boolean it might always output <code>true</code>.</p>", "type": "rendered"}, "created_on": "2019-09-18T23:46:30.481441+00:00", "user": {"display_name": "Mabel Zhang", "uuid": "{4b0e38fb-bf50-45c0-a496-61147518b2bf}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B4b0e38fb-bf50-45c0-a496-61147518b2bf%7D"}, "html": {"href": "https://bitbucket.org/%7B4b0e38fb-bf50-45c0-a496-61147518b2bf%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:ceb5942c-6843-408c-8550-3ce4899d299b/4d48e5ea-cf28-4fa7-9715-8fc9e315d831/128"}}, "nickname": "mabelmzhang", "type": "user", "account_id": "557058:ceb5942c-6843-408c-8550-3ce4899d299b"}, "inline": {}, "updated_on": "2019-09-18T23:46:30.491367+00:00", "type": "pullrequest_comment", "id": 117474020}, "pull_request": {"type": "pullrequest", "id": 397, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397"}}, "title": "[Blueprint] Logging meshes and materials"}}, {"comment": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397/comments/117473905.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397/_/diff#comment-117473905"}}, "parent": {"id": 116915468, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397/comments/116915468.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397/_/diff#comment-116915468"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 397, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397"}}, "title": "[Blueprint] Logging meshes and materials"}, "content": {"raw": "> If --record-path '/tmp/log' is specified, even if I rm /tmp/log -r right before the run, for some reason, the directory is already created before it gets to the check of common::exists(this->logPath) inside the LogRecord plugin\n\nIt looks like it's always being created [here](#!/ignitionrobotics/ign-gazebo/src/a5d9d4b4a0cf5905239ba07a1891495c97c2ec05/src/cmd/ign.cc#lines-67)", "markup": "markdown", "html": "<blockquote>\n<p>If --record-path '/tmp/log' is specified, even if I rm /tmp/log -r right before the run, for some reason, the directory is already created before it gets to the check of common::exists(this-&gt;logPath) inside the LogRecord plugin</p>\n</blockquote>\n<p>It looks like it's always being created <a data-is-external-link=\"true\" href=\"#!/ignitionrobotics/ign-gazebo/src/a5d9d4b4a0cf5905239ba07a1891495c97c2ec05/src/cmd/ign.cc#lines-67\" rel=\"nofollow\">here</a></p>", "type": "rendered"}, "created_on": "2019-09-18T23:44:38.820947+00:00", "user": {"display_name": "Louise Poubel", "uuid": "{5cfa2075-477b-4ded-bdb9-8d2479544ec4}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D"}, "html": {"href": "https://bitbucket.org/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8/7d903d90-c5ea-4182-b7ef-0d467e9e1c74/128"}}, "nickname": "chapulina", "type": "user", "account_id": "557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8"}, "updated_on": "2019-09-18T23:44:38.830197+00:00", "type": "pullrequest_comment", "id": 117473905}, "pull_request": {"type": "pullrequest", "id": 397, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397"}}, "title": "[Blueprint] Logging meshes and materials"}}, {"comment": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397/comments/117473462.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397/_/diff#comment-117473462"}}, "parent": {"id": 117473292, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397/comments/117473292.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397/_/diff#comment-117473292"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 397, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397"}}, "title": "[Blueprint] Logging meshes and materials"}, "content": {"raw": "I just checked that this include is not being used and can be removed.", "markup": "markdown", "html": "<p>I just checked that this include is not being used and can be removed.</p>", "type": "rendered"}, "created_on": "2019-09-18T23:37:12.802999+00:00", "user": {"display_name": "Louise Poubel", "uuid": "{5cfa2075-477b-4ded-bdb9-8d2479544ec4}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D"}, "html": {"href": "https://bitbucket.org/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8/7d903d90-c5ea-4182-b7ef-0d467e9e1c74/128"}}, "nickname": "chapulina", "type": "user", "account_id": "557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8"}, "inline": {}, "updated_on": "2019-09-18T23:37:12.817026+00:00", "type": "pullrequest_comment", "id": 117473462}, "pull_request": {"type": "pullrequest", "id": 397, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397"}}, "title": "[Blueprint] Logging meshes and materials"}}, {"comment": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397/comments/117473292.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397/_/diff#comment-117473292"}}, "parent": {"id": 115173315, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397/comments/115173315.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397/_/diff#comment-115173315"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 397, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397"}}, "title": "[Blueprint] Logging meshes and materials"}, "content": {"raw": "but to reiterate, this does break the macOS mojave build", "markup": "markdown", "html": "<p>but to reiterate, this does break the macOS mojave build</p>", "type": "rendered"}, "created_on": "2019-09-18T23:33:59.410316+00:00", "user": {"display_name": "Steve Peters", "uuid": "{2ccfed09-18b8-4921-8d58-15ef01092802}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D"}, "html": {"href": "https://bitbucket.org/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/1fb4816dad9e68337d3096f750951f6cd=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsSP-1.png"}}, "nickname": "Steven Peters", "type": "user", "account_id": "557058:5de38267-b118-494c-aa76-4fab35448816"}, "inline": {}, "updated_on": "2019-09-18T23:33:59.417152+00:00", "type": "pullrequest_comment", "id": 117473292}, "pull_request": {"type": "pullrequest", "id": 397, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397"}}, "title": "[Blueprint] Logging meshes and materials"}}, {"comment": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397/comments/117472880.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397/_/diff#comment-117472880"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 397, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397"}}, "title": "[Blueprint] Logging meshes and materials"}, "content": {"raw": "Can we change this to a model that has some motion, so that we can quickly check that the log is playing back poses correctly? Maybe something like [this](https://app.ignitionrobotics.org/openrobotics/fuel/models/X2%20Config%201) rolling downhill?", "markup": "markdown", "html": "<p>Can we change this to a model that has some motion, so that we can quickly check that the log is playing back poses correctly? Maybe something like <a data-is-external-link=\"true\" href=\"https://app.ignitionrobotics.org/openrobotics/fuel/models/X2%20Config%201\" rel=\"nofollow\">this</a> rolling downhill?</p>", "type": "rendered"}, "created_on": "2019-09-18T23:26:28.554393+00:00", "user": {"display_name": "Louise Poubel", "uuid": "{5cfa2075-477b-4ded-bdb9-8d2479544ec4}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D"}, "html": {"href": "https://bitbucket.org/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8/7d903d90-c5ea-4182-b7ef-0d467e9e1c74/128"}}, "nickname": "chapulina", "type": "user", "account_id": "557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8"}, "inline": {}, "updated_on": "2019-09-18T23:26:28.562835+00:00", "type": "pullrequest_comment", "id": 117472880}, "pull_request": {"type": "pullrequest", "id": 397, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397"}}, "title": "[Blueprint] Logging meshes and materials"}}, {"update": {"description": "Depends on [ign-common PR 200](#!/ignitionrobotics/ign-common/pull-requests/200/log-resources/diff).\r\n\r\nPorts [this Gazebo PR](https://bitbucket.org/osrf/gazebo/pull-requests/2811/save-models-material-and-meshes-when/diff) to Ignition.\r\n\r\nImplements `--record-resources`, and `--compress` and `--overwrite` to support it.\r\n\r\nRecords resources \\(`--record-resources`\\), i.e. meshes and materials, to a directory under the specified log record directory. Optionally compresses \\(`--compress`\\) the whole directory, which contains the existing `.tlog` sqlite3 file and any resources, to a zip file. If directory or compressed file already exist, optionally overwrites \\(`--overwrite`\\).\r\n\r\nCorresponding SDF plugin parameters: `<record_resources>1</record_resources>`, `<compress>1</compress>`, `<overwrite>1</overwrite>.`If both command line and SDF parameters are specified, command line option overwrites SDF parameter.\r\n\r\n## Usage:\r\n\r\n```\r\nign gazebo [...] --record-resources --overwrite --compress\r\n```\r\n\r\n## Test --record-resources:\r\n\r\n```\r\n# This SDF specifies the equivalent of --record-resources --record-path '/tmp/log'\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf\r\n$ ign gazebo -v 4 -r examples/worlds/log_playback.sdf\r\n```\r\n\r\nTested with `<include><uri>https://fuel...</uri></include>` and `<mesh><uri>file://...</uri></mesh>`. Paths specified by `model://` are not supported in Ignition yet, so this case in the code is not tested.\r\n\r\n## Test --overwrite and --compress:\r\n\r\nWhen recording to `path`, the compression file is implied to be `path.zip`. Both are checked for existence.\r\n\r\nNo `--overwrite` \\(default\\):\r\n\r\n```\r\n# This SDF specifies the equivalent of --record-resources --record-path '/tmp/log'\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf\r\n\r\n# Run it again, and it should write to new directory\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf\r\n[Wrn] [LogRecord.cc:260] Log path already exists on disk! Recording instead to [/tmp/log(1)]\r\n[Msg] Recording to log file [/tmp/log(1)/state.tlog]\r\n```\r\n\r\n`--overwrite`, `/tmp/log` already exists:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --overwrite --record-path '/tmp/log'\r\n[Wrn] [LogRecord.cc:292] Log path already exists on disk! Existing files will be overwritten.\r\n[Msg] Overwriting existing path [/tmp/log]\r\n...\r\n[Msg] Stopping recording\r\n```\r\n\r\n`--overwrite --compress`, `/tmp/log.zip` already exists:\r\n\r\n```\r\n[Wrn] [LogRecord.cc:291] Log path already exists on disk! Existing files will be overwritten.\r\n...\r\n[Msg] Overwriting existing file [/tmp/log.zip]\r\n[Msg] Compressed log file and resources to [/tmp/log.zip]. Removing recorded directory [/tmp/log].\r\n[Msg] Stopping recording\r\n```\r\n\r\n`--overwrite` only, `/tmp/log.zip` exists, `/tmp/log` does not exist:\r\n\r\n```\r\n[Wrn] [LogRecord.cc:291] Log path already exists on disk! Existing files will be overwritten.\r\n[Msg] Overwriting existing path [/tmp/log]\r\n...\r\n[Msg] Stopping recording\r\n```\r\n\r\n`--compress` only, both `/tmp/log` and `/tmp/log.zip` already exist:\r\n\r\n```\r\n[Wrn] [LogRecord.cc:299] Log path already exists on disk! Recording instead to [/tmp/log(1)]\r\n...\r\n[Msg] Compressed log file and resources to [/tmp/log(1).zip]. Removing recorded directory [/tmp/log(1)].\r\n[Msg] Stopping recording\r\n$ ls /tmp\r\nlog\r\n'log(1).zip'\r\nlog.zip\r\n```\r\n\r\n\\(Pending changes:\\)\r\n\r\nFiles are outputted in `/tmp/log` and `/tmp/log.zip` in this example. During record, the original path in `file://` is prepended with the specified path, e.g. `/tmp/log`. During playback, the specified path is prepended to the URIs in the SDF.", "title": "[Blueprint] Logging meshes and materials", "destination": {"commit": {"hash": "a5d9d4b4a0cf", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/commit/a5d9d4b4a0cf.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/commits/a5d9d4b4a0cf"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{f98d11fe-f287-4dfb-99c3-e2b76a13232e}ts=2082645"}}, "type": "repository", "name": "ign-gazebo", "full_name": "ignitionrobotics/ign-gazebo", "uuid": "{f98d11fe-f287-4dfb-99c3-e2b76a13232e}"}, "branch": {"name": "ign-gazebo2"}}, "reason": "", "source": {"commit": {"hash": "c0389b9b167a", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/commit/c0389b9b167a.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/commits/c0389b9b167a"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{f98d11fe-f287-4dfb-99c3-e2b76a13232e}ts=2082645"}}, "type": "repository", "name": "ign-gazebo", "full_name": "ignitionrobotics/ign-gazebo", "uuid": "{f98d11fe-f287-4dfb-99c3-e2b76a13232e}"}, "branch": {"name": "log_resources"}}, "state": "OPEN", "author": {"display_name": "Louise Poubel", "uuid": "{5cfa2075-477b-4ded-bdb9-8d2479544ec4}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D"}, "html": {"href": "https://bitbucket.org/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8/7d903d90-c5ea-4182-b7ef-0d467e9e1c74/128"}}, "nickname": "chapulina", "type": "user", "account_id": "557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8"}, "date": "2019-09-18T23:22:08.350665+00:00"}, "pull_request": {"type": "pullrequest", "id": 397, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397"}}, "title": "[Blueprint] Logging meshes and materials"}}, {"comment": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397/comments/117472522.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397/_/diff#comment-117472522"}}, "parent": {"id": 116589408, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397/comments/116589408.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397/_/diff#comment-116589408"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 397, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397"}}, "title": "[Blueprint] Logging meshes and materials"}, "content": {"raw": ":open_mouth: ", "markup": "markdown", "html": "<p><img class=\"emoji\" src=\"data/pf-emoji-service--cdn.us-east-1.prod.public.atl-paas.net/standard/551c9814-1d37-4573-819d-afab3afeaf32/48x48/1f62e.png\" alt=\"\ud83d\ude2e\" title=\":open_mouth:\" data-emoji-short-name=\":open_mouth:\" /> </p>", "type": "rendered"}, "created_on": "2019-09-18T23:19:10.378102+00:00", "user": {"display_name": "Louise Poubel", "uuid": "{5cfa2075-477b-4ded-bdb9-8d2479544ec4}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D"}, "html": {"href": "https://bitbucket.org/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8/7d903d90-c5ea-4182-b7ef-0d467e9e1c74/128"}}, "nickname": "chapulina", "type": "user", "account_id": "557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8"}, "inline": {}, "updated_on": "2019-09-18T23:19:10.387652+00:00", "type": "pullrequest_comment", "id": 117472522}, "pull_request": {"type": "pullrequest", "id": 397, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397"}}, "title": "[Blueprint] Logging meshes and materials"}}, {"comment": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397/comments/116915468.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397/_/diff#comment-116915468"}}, "parent": {"id": 116734423, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397/comments/116734423.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397/_/diff#comment-116734423"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 397, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397"}}, "title": "[Blueprint] Logging meshes and materials"}, "content": {"raw": "The above items, other than the `model://` one, have been implemented as of 66f80e7.\n\nSince now there is a `--compress` flag, a zip file will be created even if we\u2019re not recording resources. This is to make the flag\u2019s behavior clean.\n\nTwo general behaviors I\u2019m unsure about:\n\n1. If `--record` is specified, but no `--record-path` is specified, and a `<path></path>` is specified in the SDF LogRecord plugin, then ServerConfig creates a timestamped directory, instead of using the one in `<path></path>`. Is this desired?  \n  This means if I run `$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --record`, and the SDF says `<path>/tmp/log</path>`, it will still record to a default timestamped directory `~/.ignition/gazebo/log/<timestamp>`.\n2. This one is really weird. If `--record-path '/tmp/log'` is specified, even if I `rm /tmp/log -r` right before the run, for some reason, the directory is already created before it gets to the check of `common::exists(this->logPath)` inside the LogRecord plugin.  \n  To reproduce:\n\n    `$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --overwrite --record-path '/tmp/log' ... [Wrn] [LogRecord.cc:292] Log path already exists on disk! Existing files will be overwritten. [Msg] Overwriting existing path [/tmp/log] [Msg] Recording to log file [/tmp/log/state.tlog] ...`\n\n\n\n    The \u201cOverwriting\u2026\u201d line shouldn\u2019t happen, because the directory shouldn\u2019t exist yet.  \n    But if I only specify the `<path>` in the SDF and don\u2019t specify `--record-path`, then it only prints:\n\n\n\n    `[Msg] Recording to log file [/tmp/log/state.tlog]`\n\n\n\n    which is correct.  \n    Could it be that if both `<path>` and `--record-path` are specified, there are two LogRecord plugins running? I can\u2019t find where that directory could have been created before the plugin does the check - [ServerConfig.cc](http://ServerConfig.cc) doesn\u2019t create any directories.\n\n\n\n\u200c", "markup": "markdown", "html": "<p>The above items, other than the <code>model://</code> one, have been implemented as of <a href=\"#!/ignitionrobotics/ign-gazebo/commits/66f80e7\" rel=\"nofollow\" class=\"ap-connect-link\">66f80e7</a>.</p>\n<p>Since now there is a <code>--compress</code> flag, a zip file will be created even if we\u2019re not recording resources. This is to make the flag\u2019s behavior clean.</p>\n<p>Two general behaviors I\u2019m unsure about:</p>\n<ol>\n<li>If <code>--record</code> is specified, but no <code>--record-path</code> is specified, and a <code>&lt;path&gt;&lt;/path&gt;</code> is specified in the SDF LogRecord plugin, then ServerConfig creates a timestamped directory, instead of using the one in <code>&lt;path&gt;&lt;/path&gt;</code>. Is this desired?<br />\n  This means if I run <code>$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --record</code>, and the SDF says <code>&lt;path&gt;/tmp/log&lt;/path&gt;</code>, it will still record to a default timestamped directory <code>~/.ignition/gazebo/log/&lt;timestamp&gt;</code>.</li>\n<li>\n<p>This one is really weird. If <code>--record-path '/tmp/log'</code> is specified, even if I <code>rm /tmp/log -r</code> right before the run, for some reason, the directory is already created before it gets to the check of <code>common::exists(this-&gt;logPath)</code> inside the LogRecord plugin.<br />\n  To reproduce:</p>\n<p><code>$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --overwrite --record-path '/tmp/log' ... [Wrn] [LogRecord.cc:292] Log path already exists on disk! Existing files will be overwritten. [Msg] Overwriting existing path [/tmp/log] [Msg] Recording to log file [/tmp/log/state.tlog] ...</code></p>\n<p>The \u201cOverwriting\u2026\u201d line shouldn\u2019t happen, because the directory shouldn\u2019t exist yet.<br />\nBut if I only specify the <code>&lt;path&gt;</code> in the SDF and don\u2019t specify <code>--record-path</code>, then it only prints:</p>\n<p><code>[Msg] Recording to log file [/tmp/log/state.tlog]</code></p>\n<p>which is correct.<br />\nCould it be that if both <code>&lt;path&gt;</code> and <code>--record-path</code> are specified, there are two LogRecord plugins running? I can\u2019t find where that directory could have been created before the plugin does the check - <a data-is-external-link=\"true\" href=\"http://ServerConfig.cc\" rel=\"nofollow\">ServerConfig.cc</a> doesn\u2019t create any directories.</p>\n</li>\n</ol>\n<p>\u200c</p>", "type": "rendered"}, "created_on": "2019-09-15T05:38:12.020908+00:00", "user": {"display_name": "Mabel Zhang", "uuid": "{4b0e38fb-bf50-45c0-a496-61147518b2bf}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B4b0e38fb-bf50-45c0-a496-61147518b2bf%7D"}, "html": {"href": "https://bitbucket.org/%7B4b0e38fb-bf50-45c0-a496-61147518b2bf%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:ceb5942c-6843-408c-8550-3ce4899d299b/4d48e5ea-cf28-4fa7-9715-8fc9e315d831/128"}}, "nickname": "mabelmzhang", "type": "user", "account_id": "557058:ceb5942c-6843-408c-8550-3ce4899d299b"}, "updated_on": "2019-09-15T05:40:31.110381+00:00", "type": "pullrequest_comment", "id": 116915468}, "pull_request": {"type": "pullrequest", "id": 397, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397"}}, "title": "[Blueprint] Logging meshes and materials"}}, {"update": {"description": "Depends on [ign-common PR 200](#!/ignitionrobotics/ign-common/pull-requests/200/log-resources/diff).\r\n\r\nPorts [this Gazebo PR](https://bitbucket.org/osrf/gazebo/pull-requests/2811/save-models-material-and-meshes-when/diff) to Ignition.\r\n\r\nImplements `--record-resources`, and `--compress` and `--overwrite` to support it.\r\n\r\nRecords resources \\(`--record-resources`\\), i.e. meshes and materials, to a directory under the specified log record directory. Optionally compresses \\(`--compress`\\) the whole directory, which contains the existing `.tlog` sqlite3 file and any resources, to a zip file. If directory or compressed file already exist, optionally overwrites \\(`--overwrite`\\).\r\n\r\nCorresponding SDF plugin parameters: `<record_resources>1</record_resources>`, `<compress>1</compress>`, `<overwrite>1</overwrite>.`If both command line and SDF parameters are specified, command line option overwrites SDF parameter.\r\n\r\n## Usage:\r\n\r\n```\r\nign gazebo [...] --record-resources --overwrite --compress\r\n```\r\n\r\n## Test --record-resources:\r\n\r\n```\r\n# This SDF specifies the equivalent of --record-resources --record-path '/tmp/log'\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf\r\n$ ign gazebo -v 4 -r examples/worlds/log_playback.sdf\r\n```\r\n\r\nTested with `<include><uri>https://fuel...</uri></include>` and `<mesh><uri>file://...</uri></mesh>`. Paths specified by `model://` are not supported in Ignition yet, so this case in the code is not tested.\r\n\r\n## Test --overwrite and --compress:\r\n\r\nWhen recording to `path`, the compression file is implied to be `path.zip`. Both are checked for existence.\r\n\r\nNo `--overwrite` \\(default\\):\r\n\r\n```\r\n# This SDF specifies the equivalent of --record-resources --record-path '/tmp/log'\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf\r\n\r\n# Run it again, and it should write to new directory\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf\r\n[Wrn] [LogRecord.cc:260] Log path already exists on disk! Recording instead to [/tmp/log(1)]\r\n[Msg] Recording to log file [/tmp/log(1)/state.tlog]\r\n```\r\n\r\n`--overwrite`, `/tmp/log` already exists:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --overwrite --record-path '/tmp/log'\r\n[Wrn] [LogRecord.cc:292] Log path already exists on disk! Existing files will be overwritten.\r\n[Msg] Overwriting existing path [/tmp/log]\r\n...\r\n[Msg] Stopping recording\r\n```\r\n\r\n`--overwrite --compress`, `/tmp/log.zip` already exists:\r\n\r\n```\r\n[Wrn] [LogRecord.cc:291] Log path already exists on disk! Existing files will be overwritten.\r\n...\r\n[Msg] Overwriting existing file [/tmp/log.zip]\r\n[Msg] Compressed log file and resources to [/tmp/log.zip]. Removing recorded directory [/tmp/log].\r\n[Msg] Stopping recording\r\n```\r\n\r\n`--overwrite` only, `/tmp/log.zip` exists, `/tmp/log` does not exist:\r\n\r\n```\r\n[Wrn] [LogRecord.cc:291] Log path already exists on disk! Existing files will be overwritten.\r\n[Msg] Overwriting existing path [/tmp/log]\r\n...\r\n[Msg] Stopping recording\r\n```\r\n\r\n`--compress` only, both `/tmp/log` and `/tmp/log.zip` already exist:\r\n\r\n```\r\n[Wrn] [LogRecord.cc:299] Log path already exists on disk! Recording instead to [/tmp/log(1)]\r\n...\r\n[Msg] Compressed log file and resources to [/tmp/log(1).zip]. Removing recorded directory [/tmp/log(1)].\r\n[Msg] Stopping recording\r\n$ ls /tmp\r\nlog\r\n'log(1).zip'\r\nlog.zip\r\n```\r\n\r\n\\(Pending changes:\\)\r\n\r\nFiles are outputted in `/tmp/log` and `/tmp/log.zip` in this example. During record, the original path in `file://` is prepended with the specified path, e.g. `/tmp/log`. During playback, the specified path is prepended to the URIs in the SDF.", "title": "[Blueprint] Logging meshes and materials", "destination": {"commit": {"hash": "02e1fde5e923", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/commit/02e1fde5e923.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/commits/02e1fde5e923"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{f98d11fe-f287-4dfb-99c3-e2b76a13232e}ts=2082645"}}, "type": "repository", "name": "ign-gazebo", "full_name": "ignitionrobotics/ign-gazebo", "uuid": "{f98d11fe-f287-4dfb-99c3-e2b76a13232e}"}, "branch": {"name": "ign-gazebo2"}}, "reason": "", "source": {"commit": {"hash": "66f80e78c2cb", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/commit/66f80e78c2cb.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/commits/66f80e78c2cb"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{f98d11fe-f287-4dfb-99c3-e2b76a13232e}ts=2082645"}}, "type": "repository", "name": "ign-gazebo", "full_name": "ignitionrobotics/ign-gazebo", "uuid": "{f98d11fe-f287-4dfb-99c3-e2b76a13232e}"}, "branch": {"name": "log_resources"}}, "state": "OPEN", "author": {"display_name": "Mabel Zhang", "uuid": "{4b0e38fb-bf50-45c0-a496-61147518b2bf}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B4b0e38fb-bf50-45c0-a496-61147518b2bf%7D"}, "html": {"href": "https://bitbucket.org/%7B4b0e38fb-bf50-45c0-a496-61147518b2bf%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:ceb5942c-6843-408c-8550-3ce4899d299b/4d48e5ea-cf28-4fa7-9715-8fc9e315d831/128"}}, "nickname": "mabelmzhang", "type": "user", "account_id": "557058:ceb5942c-6843-408c-8550-3ce4899d299b"}, "date": "2019-09-15T05:24:40.170576+00:00"}, "pull_request": {"type": "pullrequest", "id": 397, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397"}}, "title": "[Blueprint] Logging meshes and materials"}}, {"update": {"description": "Depends on [ign-common PR 200](#!/ignitionrobotics/ign-common/pull-requests/200/log-resources/diff).\r\n\r\nPorts [this Gazebo PR](https://bitbucket.org/osrf/gazebo/pull-requests/2811/save-models-material-and-meshes-when/diff) to Ignition.\r\n\r\nImplements `--record-resources`, and `--compress` and `--overwrite` to support it.\r\n\r\nRecords resources \\(`--record-resources`\\), i.e. meshes and materials, to a directory under the specified log record directory. Optionally compresses \\(`--compress`\\) the whole directory, which contains the existing `.tlog` sqlite3 file and any resources, to a zip file. If directory or compressed file already exist, optionally overwrites \\(`--overwrite`\\).\r\n\r\nCorresponding SDF plugin parameters: `<record_resources>1</record_resources>`, `<compress>1</compress>`, `<overwrite>1</overwrite>.`If both command line and SDF parameters are specified, command line option overwrites SDF parameter.\r\n\r\n## Usage:\r\n\r\n```\r\nign gazebo [...] --record-resources --overwrite --compress\r\n```\r\n\r\n## Test --record-resources:\r\n\r\n```\r\n# This SDF specifies the equivalent of --record-resources --record-path '/tmp/log'\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf\r\n$ ign gazebo -v 4 -r examples/worlds/log_playback.sdf\r\n```\r\n\r\nTested with `<include><uri>https://fuel...</uri></include>` and `<mesh><uri>file://...</uri></mesh>`. Paths specified by `model://` are not supported in Ignition yet, so this case in the code is not tested.\r\n\r\n## Test --overwrite and --compress:\r\n\r\nWhen recording to `path`, the compression file is implied to be `path.zip`. Both are checked for existence.\r\n\r\nNo `--overwrite` \\(default\\):\r\n\r\n```\r\n# This SDF specifies the equivalent of --record-resources --record-path '/tmp/log'\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf\r\n\r\n# Run it again, and it should write to new directory\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf\r\n[Wrn] [LogRecord.cc:260] Log path already exists on disk! Recording instead to [/tmp/log(1)]\r\n[Msg] Recording to log file [/tmp/log(1)/state.tlog]\r\n```\r\n\r\n`--overwrite`, `/tmp/log` already exists:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --overwrite --record-path '/tmp/log'\r\n[Wrn] [LogRecord.cc:292] Log path already exists on disk! Existing files will be overwritten.\r\n[Msg] Overwriting existing path [/tmp/log]\r\n...\r\n[Msg] Stopping recording\r\n```\r\n\r\n`--overwrite --compress`, `/tmp/log.zip` already exists:\r\n\r\n```\r\n[Wrn] [LogRecord.cc:291] Log path already exists on disk! Existing files will be overwritten.\r\n...\r\n[Msg] Overwriting existing file [/tmp/log.zip]\r\n[Msg] Compressed log file and resources to [/tmp/log.zip]. Removing recorded directory [/tmp/log].\r\n[Msg] Stopping recording\r\n```\r\n\r\n`--overwrite` only, `/tmp/log.zip` exists, `/tmp/log` does not exist:\r\n\r\n```\r\n[Wrn] [LogRecord.cc:291] Log path already exists on disk! Existing files will be overwritten.\r\n[Msg] Overwriting existing path [/tmp/log]\r\n...\r\n[Msg] Stopping recording\r\n```\r\n\r\n`--compress` only, both `/tmp/log` and `/tmp/log.zip` already exist:\r\n\r\n```\r\n[Wrn] [LogRecord.cc:299] Log path already exists on disk! Recording instead to [/tmp/log(1)]\r\n...\r\n[Msg] Compressed log file and resources to [/tmp/log(1).zip]. Removing recorded directory [/tmp/log(1)].\r\n[Msg] Stopping recording\r\n$ ls /tmp\r\nlog\r\n'log(1).zip'\r\nlog.zip\r\n```\r\n\r\n\\(Pending changes:\\)\r\n\r\nFiles are outputted in `/tmp/log` and `/tmp/log.zip` in this example. During record, the original path in `file://` is prepended with the specified path, e.g. `/tmp/log`. During playback, the specified path is prepended to the URIs in the SDF.", "title": "[Blueprint] Logging meshes and materials", "destination": {"commit": {"hash": "02e1fde5e923", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/commit/02e1fde5e923.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/commits/02e1fde5e923"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{f98d11fe-f287-4dfb-99c3-e2b76a13232e}ts=2082645"}}, "type": "repository", "name": "ign-gazebo", "full_name": "ignitionrobotics/ign-gazebo", "uuid": "{f98d11fe-f287-4dfb-99c3-e2b76a13232e}"}, "branch": {"name": "ign-gazebo2"}}, "reason": "", "source": {"commit": {"hash": "9b84b5fc20a1", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/commit/9b84b5fc20a1.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/commits/9b84b5fc20a1"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{f98d11fe-f287-4dfb-99c3-e2b76a13232e}ts=2082645"}}, "type": "repository", "name": "ign-gazebo", "full_name": "ignitionrobotics/ign-gazebo", "uuid": "{f98d11fe-f287-4dfb-99c3-e2b76a13232e}"}, "branch": {"name": "log_resources"}}, "state": "OPEN", "author": {"display_name": "Mabel Zhang", "uuid": "{4b0e38fb-bf50-45c0-a496-61147518b2bf}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B4b0e38fb-bf50-45c0-a496-61147518b2bf%7D"}, "html": {"href": "https://bitbucket.org/%7B4b0e38fb-bf50-45c0-a496-61147518b2bf%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:ceb5942c-6843-408c-8550-3ce4899d299b/4d48e5ea-cf28-4fa7-9715-8fc9e315d831/128"}}, "nickname": "mabelmzhang", "type": "user", "account_id": "557058:ceb5942c-6843-408c-8550-3ce4899d299b"}, "date": "2019-09-15T05:20:35.681840+00:00"}, "pull_request": {"type": "pullrequest", "id": 397, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397"}}, "title": "[Blueprint] Logging meshes and materials"}}, {"comment": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397/comments/116734423.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397/_/diff#comment-116734423"}}, "parent": {"id": 116728562, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397/comments/116728562.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397/_/diff#comment-116728562"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 397, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397"}}, "title": "[Blueprint] Logging meshes and materials"}, "content": {"raw": "Sounds good to me! :thumbsup: ", "markup": "markdown", "html": "<p>Sounds good to me! <img class=\"emoji\" src=\"data/pf-emoji-service--cdn.us-east-1.prod.public.atl-paas.net/standard/551c9814-1d37-4573-819d-afab3afeaf32/48x48/1f44d.png\" alt=\"\ud83d\udc4d\" title=\":thumbsup:\" data-emoji-short-name=\":thumbsup:\" /> </p>", "type": "rendered"}, "created_on": "2019-09-12T20:54:46.180261+00:00", "user": {"display_name": "Louise Poubel", "uuid": "{5cfa2075-477b-4ded-bdb9-8d2479544ec4}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D"}, "html": {"href": "https://bitbucket.org/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8/7d903d90-c5ea-4182-b7ef-0d467e9e1c74/128"}}, "nickname": "chapulina", "type": "user", "account_id": "557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8"}, "updated_on": "2019-09-12T20:54:46.191106+00:00", "type": "pullrequest_comment", "id": 116734423}, "pull_request": {"type": "pullrequest", "id": 397, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397"}}, "title": "[Blueprint] Logging meshes and materials"}}, {"comment": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397/comments/116728562.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397/_/diff#comment-116728562"}}, "parent": {"id": 116724488, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397/comments/116724488.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397/_/diff#comment-116724488"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 397, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397"}}, "title": "[Blueprint] Logging meshes and materials"}, "content": {"raw": "Okay, sounds like \n\n* We should create an `--overwrite-existing` flag to force overwrite. If not provided, then create a new numbered directory.\n* We should create a `--compress` flag to zip the file after recording is finished, then remove the original directory.\n\nIn the case of overwrite, everything is easy, the directory or the zip \\(whichever exists\\) will simply be removed at the beginning of the program, and written to.\n\nIn the case of creating a new numbered directory, we need to check both the directory and the zip file path, to see if either of them exists \\(depending on whether `--compress` had been specified when they were created\\). If either exists, the number for both the directory and the zip file \\(if `--compress` is specified\\) will use the new number.\n\nThat should be a more tidy solution to all the mess with directory and zips and overwrite errors\u2026", "markup": "markdown", "html": "<p>Okay, sounds like </p>\n<ul>\n<li>We should create an <code>--overwrite-existing</code> flag to force overwrite. If not provided, then create a new numbered directory.</li>\n<li>We should create a <code>--compress</code> flag to zip the file after recording is finished, then remove the original directory.</li>\n</ul>\n<p>In the case of overwrite, everything is easy, the directory or the zip (whichever exists) will simply be removed at the beginning of the program, and written to.</p>\n<p>In the case of creating a new numbered directory, we need to check both the directory and the zip file path, to see if either of them exists (depending on whether <code>--compress</code> had been specified when they were created). If either exists, the number for both the directory and the zip file (if <code>--compress</code> is specified) will use the new number.</p>\n<p>That should be a more tidy solution to all the mess with directory and zips and overwrite errors\u2026</p>", "type": "rendered"}, "created_on": "2019-09-12T20:02:34.231596+00:00", "user": {"display_name": "Mabel Zhang", "uuid": "{4b0e38fb-bf50-45c0-a496-61147518b2bf}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B4b0e38fb-bf50-45c0-a496-61147518b2bf%7D"}, "html": {"href": "https://bitbucket.org/%7B4b0e38fb-bf50-45c0-a496-61147518b2bf%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:ceb5942c-6843-408c-8550-3ce4899d299b/4d48e5ea-cf28-4fa7-9715-8fc9e315d831/128"}}, "nickname": "mabelmzhang", "type": "user", "account_id": "557058:ceb5942c-6843-408c-8550-3ce4899d299b"}, "updated_on": "2019-09-12T20:02:34.246864+00:00", "type": "pullrequest_comment", "id": 116728562}, "pull_request": {"type": "pullrequest", "id": 397, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397"}}, "title": "[Blueprint] Logging meshes and materials"}}, {"comment": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397/comments/116724488.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397/_/diff#comment-116724488"}}, "parent": {"id": 116596065, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397/comments/116596065.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397/_/diff#comment-116596065"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 397, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397"}}, "title": "[Blueprint] Logging meshes and materials"}, "content": {"raw": "> the behavior has been changed to overwrite existing directory\n\nYou're right, it was changed on pull request #413. I think the intended use case was when the user intentionally wants to overwrite, but I think it's also useful to support creating a new numbered directory.\n\n> If zipping takes forever, then maybe people don\u2019t want the program to run forever\n\nThat's a good point. How about adding a flag so the user can enable zipping. In case zipping is enabled, we delete the original directory in the end. So we never end up with both the zip and the dir. What do you think?\n\n> Does this have to do with the model:// and file:// differences?\n\nYeah I think so.", "markup": "markdown", "html": "<blockquote>\n<p>the behavior has been changed to overwrite existing directory</p>\n</blockquote>\n<p>You're right, it was changed on <a href=\"#!/ignitionrobotics/ign-gazebo/pull-requests/413/log-console-messages-and-support-co\" rel=\"nofollow\" class=\"ap-connect-link\">pull request #413</a>. I think the intended use case was when the user intentionally wants to overwrite, but I think it's also useful to support creating a new numbered directory.</p>\n<blockquote>\n<p>If zipping takes forever, then maybe people don\u2019t want the program to run forever</p>\n</blockquote>\n<p>That's a good point. How about adding a flag so the user can enable zipping. In case zipping is enabled, we delete the original directory in the end. So we never end up with both the zip and the dir. What do you think?</p>\n<blockquote>\n<p>Does this have to do with the model:// and file:// differences?</p>\n</blockquote>\n<p>Yeah I think so.</p>", "type": "rendered"}, "created_on": "2019-09-12T19:26:16.971208+00:00", "user": {"display_name": "Louise Poubel", "uuid": "{5cfa2075-477b-4ded-bdb9-8d2479544ec4}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D"}, "html": {"href": "https://bitbucket.org/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8/7d903d90-c5ea-4182-b7ef-0d467e9e1c74/128"}}, "nickname": "chapulina", "type": "user", "account_id": "557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8"}, "updated_on": "2019-09-12T19:26:16.980670+00:00", "type": "pullrequest_comment", "id": 116724488}, "pull_request": {"type": "pullrequest", "id": 397, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397"}}, "title": "[Blueprint] Logging meshes and materials"}}, {"comment": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397/comments/116596065.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397/_/diff#comment-116596065"}}, "parent": {"id": 115011053, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397/comments/115011053.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397/_/diff#comment-115011053"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 397, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397"}}, "title": "[Blueprint] Logging meshes and materials"}, "content": {"raw": "I created a few checklist items to try to capture these.\n\n> I'm seeing the log.zip file being created even if I'm not recording resources. Is this expected?\n\nNo, there should have been a flag check. Added in 9b84b5f.\n\n> If I remember correctly, we were creating new numbered directories if the directory already existed?\n\nI saw that this had been removed before this PR. In `default` branch, it still has this line:\n\n```\nlogPath = common::uniqueDirectoryPath(logPath);\n```\n\nBut it is no longer in `ign-gazebo2` branch. It existed in `ign-gazebo` [f9963d8](#!/ignitionrobotics/ign-gazebo/src/f9963d81807019ae75cadf7c8bcf7f2090f65691/src/systems/log/LogRecord.cc?at=ign-gazebo2#lines-184) but was removed in [22d7915](#!/ignitionrobotics/ign-gazebo/src/22d79157d28d5d2984f70f0128413998476d1565/src/systems/log/LogRecord.cc?at=ign-gazebo2#lines-165), where the behavior has been changed to overwrite existing directory, but that doesn\u2019t seem to be implemented correctly right now. I think it just needs a remove of the existing directory and compressed file.\n\n> The `zip` file is created as a sibling to the record path, i.e.:\n\nSo... yeah... the directory organization was an issue that got kind of tricky and I wasn't sure what's the best way. Right now it zips the whole directory purely becase `` `Zip()`` takes a directory only, so I could not give it multiple files \\(the sub-directory, the `state.tlog` and the console file\\). So it sits outside the directory it zips.\n\n> Should we delete the directory after zipping it?\n\nThat was the original and most intuitive way I tried. There were problems with it, which I tried to describe in the last paragraph of the PR description. I think it\u2019s cleaner to delete it, but we need to resolve the other directory problems, which comes down to whether we want to just overwrite things.\n\n> Should we make zipping optional?\n\nI don\u2019t know the right answer to this. Zipping keeps the file smaller, but I don\u2019t know how big the file will end up after 1 hour run. If zipping takes forever, then maybe people don\u2019t want the program to run forever - they might want it to just terminate, and they can compress it themselves later.\n\n> Should we support playing back directly from the zip file?\n\nThis is already implemented in `LogPlayback::ExtractStateAndResources()`. For context, the `log` directory is only kept because of the directory overwrite problem above. It is not needed; `log.zip` file alone should already be sufficient for playback.\n\n> Instead of loading the logged mesh, the simulation prints these errors:\n\nDoes this have to do with the `model://` and `file://` differences? I still need to replace all `file` with `model`. I haven\u2019t done that yet.", "markup": "markdown", "html": "<p>I created a few checklist items to try to capture these.</p>\n<blockquote>\n<p>I'm seeing the log.zip file being created even if I'm not recording resources. Is this expected?</p>\n</blockquote>\n<p>No, there should have been a flag check. Added in <a href=\"#!/ignitionrobotics/ign-gazebo/commits/9b84b5f\" rel=\"nofollow\" class=\"ap-connect-link\">9b84b5f</a>.</p>\n<blockquote>\n<p>If I remember correctly, we were creating new numbered directories if the directory already existed?</p>\n</blockquote>\n<p>I saw that this had been removed before this PR. In <code>default</code> branch, it still has this line:</p>\n<div class=\"codehilite\"><pre><span></span><span class=\"nt\">logPath</span> <span class=\"o\">=</span> <span class=\"nt\">common</span><span class=\"p\">::</span><span class=\"nd\">uniqueDirectoryPath</span><span class=\"o\">(</span><span class=\"nt\">logPath</span><span class=\"o\">);</span>\n</pre></div>\n\n\n<p>But it is no longer in <code>ign-gazebo2</code> branch. It existed in <code>ign-gazebo</code> <a data-is-external-link=\"true\" href=\"#!/ignitionrobotics/ign-gazebo/src/f9963d81807019ae75cadf7c8bcf7f2090f65691/src/systems/log/LogRecord.cc?at=ign-gazebo2#lines-184\" rel=\"nofollow\">f9963d8</a> but was removed in <a data-is-external-link=\"true\" href=\"#!/ignitionrobotics/ign-gazebo/src/22d79157d28d5d2984f70f0128413998476d1565/src/systems/log/LogRecord.cc?at=ign-gazebo2#lines-165\" rel=\"nofollow\">22d7915</a>, where the behavior has been changed to overwrite existing directory, but that doesn\u2019t seem to be implemented correctly right now. I think it just needs a remove of the existing directory and compressed file.</p>\n<blockquote>\n<p>The <code>zip</code> file is created as a sibling to the record path, i.e.:</p>\n</blockquote>\n<p>So... yeah... the directory organization was an issue that got kind of tricky and I wasn't sure what's the best way. Right now it zips the whole directory purely becase <code>`Zip()</code> takes a directory only, so I could not give it multiple files (the sub-directory, the <code>state.tlog</code> and the console file). So it sits outside the directory it zips.</p>\n<blockquote>\n<p>Should we delete the directory after zipping it?</p>\n</blockquote>\n<p>That was the original and most intuitive way I tried. There were problems with it, which I tried to describe in the last paragraph of the PR description. I think it\u2019s cleaner to delete it, but we need to resolve the other directory problems, which comes down to whether we want to just overwrite things.</p>\n<blockquote>\n<p>Should we make zipping optional?</p>\n</blockquote>\n<p>I don\u2019t know the right answer to this. Zipping keeps the file smaller, but I don\u2019t know how big the file will end up after 1 hour run. If zipping takes forever, then maybe people don\u2019t want the program to run forever - they might want it to just terminate, and they can compress it themselves later.</p>\n<blockquote>\n<p>Should we support playing back directly from the zip file?</p>\n</blockquote>\n<p>This is already implemented in <code>LogPlayback::ExtractStateAndResources()</code>. For context, the <code>log</code> directory is only kept because of the directory overwrite problem above. It is not needed; <code>log.zip</code> file alone should already be sufficient for playback.</p>\n<blockquote>\n<p>Instead of loading the logged mesh, the simulation prints these errors:</p>\n</blockquote>\n<p>Does this have to do with the <code>model://</code> and <code>file://</code> differences? I still need to replace all <code>file</code> with <code>model</code>. I haven\u2019t done that yet.</p>", "type": "rendered"}, "created_on": "2019-09-12T05:40:29.987625+00:00", "user": {"display_name": "Mabel Zhang", "uuid": "{4b0e38fb-bf50-45c0-a496-61147518b2bf}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B4b0e38fb-bf50-45c0-a496-61147518b2bf%7D"}, "html": {"href": "https://bitbucket.org/%7B4b0e38fb-bf50-45c0-a496-61147518b2bf%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:ceb5942c-6843-408c-8550-3ce4899d299b/4d48e5ea-cf28-4fa7-9715-8fc9e315d831/128"}}, "nickname": "mabelmzhang", "type": "user", "account_id": "557058:ceb5942c-6843-408c-8550-3ce4899d299b"}, "updated_on": "2019-09-12T05:50:45.398423+00:00", "type": "pullrequest_comment", "id": 116596065}, "pull_request": {"type": "pullrequest", "id": 397, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397"}}, "title": "[Blueprint] Logging meshes and materials"}}, {"update": {"description": "Depends on [ign-common PR 200](#!/ignitionrobotics/ign-common/pull-requests/200/log-resources/diff).\r\n\r\nPorts [this Gazebo PR](https://bitbucket.org/osrf/gazebo/pull-requests/2811/save-models-material-and-meshes-when/diff) to Ignition.\r\n\r\nRecords resources \\(meshes and materials\\) to a directory under the specified log record directory, then compresses the whole directory, which contains the existing `.tlog` sqlite3 file and any resources, to a zip file.\r\n\r\nCan be triggered with `--record-resources` on command line or plugin parameter `<record_resources>1</record_resources>`. If both are specified and are different, current behavior is to take logical OR, so resources are recorded if either command line flag or SDF flag is true.\r\n\r\nTo test:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf [--record-resources --record-path '/tmp/log']\r\n$ ign gazebo -v 4 -r examples/worlds/log_playback.sdf\r\n```\r\n\r\nTested with `<include><uri>https://fuel...</uri></include>` and `<mesh><uri>file://...</uri></mesh>`. Paths specified by `model://` are not supported in Ignition yet, so this case in the code is not tested.\r\n\r\nFiles are outputted in `/tmp/log` and `/tmp/log.zip` in this example. During record, the original path in `file://` is prepended with the specified path, e.g. `/tmp/log`. During playback, the specified path is prepended to the URIs in the SDF.\r\n\r\nRight now, the directory `/tmp/log` is not removed. Because we don't know what resources are recorded, and the code uses `fuel_tools::Zip::Compress()`, which does not support wildcards. So it zips the entire `/tmp/log` directory into `/tmp/log.zip`. If we remove the directory, the problem is that if you record a second time to `/tmp/log`, it will happily do so, but then when it tries to zip to `/tmp/log.zip`, file already exists, and it will fail. We can force overwrite it, but I feel like users would not like to do that by mistake. So, keeping the directory, the second record will automatically record to `/tmp/log(1)`, and there\u2019s no clash problem.", "title": "[Blueprint] Logging meshes and materials", "destination": {"commit": {"hash": "02e1fde5e923", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/commit/02e1fde5e923.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/commits/02e1fde5e923"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{f98d11fe-f287-4dfb-99c3-e2b76a13232e}ts=2082645"}}, "type": "repository", "name": "ign-gazebo", "full_name": "ignitionrobotics/ign-gazebo", "uuid": "{f98d11fe-f287-4dfb-99c3-e2b76a13232e}"}, "branch": {"name": "ign-gazebo2"}}, "reason": "", "source": {"commit": {"hash": "9b84b5fc20a1", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/commit/9b84b5fc20a1.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/commits/9b84b5fc20a1"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{f98d11fe-f287-4dfb-99c3-e2b76a13232e}ts=2082645"}}, "type": "repository", "name": "ign-gazebo", "full_name": "ignitionrobotics/ign-gazebo", "uuid": "{f98d11fe-f287-4dfb-99c3-e2b76a13232e}"}, "branch": {"name": "log_resources"}}, "state": "OPEN", "author": {"display_name": "Mabel Zhang", "uuid": "{4b0e38fb-bf50-45c0-a496-61147518b2bf}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B4b0e38fb-bf50-45c0-a496-61147518b2bf%7D"}, "html": {"href": "https://bitbucket.org/%7B4b0e38fb-bf50-45c0-a496-61147518b2bf%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:ceb5942c-6843-408c-8550-3ce4899d299b/4d48e5ea-cf28-4fa7-9715-8fc9e315d831/128"}}, "nickname": "mabelmzhang", "type": "user", "account_id": "557058:ceb5942c-6843-408c-8550-3ce4899d299b"}, "date": "2019-09-12T05:41:19.591405+00:00"}, "pull_request": {"type": "pullrequest", "id": 397, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397"}}, "title": "[Blueprint] Logging meshes and materials"}}, {"comment": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397/comments/116589408.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397/_/diff#comment-116589408"}}, "parent": {"id": 115009297, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397/comments/115009297.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397/_/diff#comment-115009297"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 397, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397"}}, "title": "[Blueprint] Logging meshes and materials"}, "content": {"raw": "Fixed in f09d0d5\n\nAs a side note, it worked before too with `1`, as was tested in the sample SDF. I don\u2019t remember/know why.", "markup": "markdown", "html": "<p>Fixed in <a href=\"#!/ignitionrobotics/ign-gazebo/commits/f09d0d5\" rel=\"nofollow\" class=\"ap-connect-link\">f09d0d5</a></p>\n<p>As a side note, it worked before too with <code>1</code>, as was tested in the sample SDF. I don\u2019t remember/know why.</p>", "type": "rendered"}, "created_on": "2019-09-12T03:49:05.858713+00:00", "user": {"display_name": "Mabel Zhang", "uuid": "{4b0e38fb-bf50-45c0-a496-61147518b2bf}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B4b0e38fb-bf50-45c0-a496-61147518b2bf%7D"}, "html": {"href": "https://bitbucket.org/%7B4b0e38fb-bf50-45c0-a496-61147518b2bf%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:ceb5942c-6843-408c-8550-3ce4899d299b/4d48e5ea-cf28-4fa7-9715-8fc9e315d831/128"}}, "nickname": "mabelmzhang", "type": "user", "account_id": "557058:ceb5942c-6843-408c-8550-3ce4899d299b"}, "inline": {}, "updated_on": "2019-09-12T03:49:58.677937+00:00", "type": "pullrequest_comment", "id": 116589408}, "pull_request": {"type": "pullrequest", "id": 397, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397"}}, "title": "[Blueprint] Logging meshes and materials"}}, {"update": {"description": "Depends on [ign-common PR 200](#!/ignitionrobotics/ign-common/pull-requests/200/log-resources/diff).\r\n\r\nPorts [this Gazebo PR](https://bitbucket.org/osrf/gazebo/pull-requests/2811/save-models-material-and-meshes-when/diff) to Ignition.\r\n\r\nRecords resources \\(meshes and materials\\) to a directory under the specified log record directory, then compresses the whole directory, which contains the existing `.tlog` sqlite3 file and any resources, to a zip file.\r\n\r\nCan be triggered with `--record-resources` on command line or plugin parameter `<record_resources>1</record_resources>`. If both are specified and are different, current behavior is to take logical OR, so resources are recorded if either command line flag or SDF flag is true.\r\n\r\nTo test:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf [--record-resources --record-path '/tmp/log']\r\n$ ign gazebo -v 4 -r examples/worlds/log_playback.sdf\r\n```\r\n\r\nTested with `<include><uri>https://fuel...</uri></include>` and `<mesh><uri>file://...</uri></mesh>`. Paths specified by `model://` are not supported in Ignition yet, so this case in the code is not tested.\r\n\r\nFiles are outputted in `/tmp/log` and `/tmp/log.zip` in this example. During record, the original path in `file://` is prepended with the specified path, e.g. `/tmp/log`. During playback, the specified path is prepended to the URIs in the SDF.\r\n\r\nRight now, the directory `/tmp/log` is not removed. Because we don't know what resources are recorded, and the code uses `fuel_tools::Zip::Compress()`, which does not support wildcards. So it zips the entire `/tmp/log` directory into `/tmp/log.zip`. If we remove the directory, the problem is that if you record a second time to `/tmp/log`, it will happily do so, but then when it tries to zip to `/tmp/log.zip`, file already exists, and it will fail. We can force overwrite it, but I feel like users would not like to do that by mistake. So, keeping the directory, the second record will automatically record to `/tmp/log(1)`, and there\u2019s no clash problem.", "title": "[Blueprint] Logging meshes and materials", "destination": {"commit": {"hash": "02e1fde5e923", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/commit/02e1fde5e923.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/commits/02e1fde5e923"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{f98d11fe-f287-4dfb-99c3-e2b76a13232e}ts=2082645"}}, "type": "repository", "name": "ign-gazebo", "full_name": "ignitionrobotics/ign-gazebo", "uuid": "{f98d11fe-f287-4dfb-99c3-e2b76a13232e}"}, "branch": {"name": "ign-gazebo2"}}, "reason": "", "source": {"commit": {"hash": "4c605f678bbd", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/commit/4c605f678bbd.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/commits/4c605f678bbd"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{f98d11fe-f287-4dfb-99c3-e2b76a13232e}ts=2082645"}}, "type": "repository", "name": "ign-gazebo", "full_name": "ignitionrobotics/ign-gazebo", "uuid": "{f98d11fe-f287-4dfb-99c3-e2b76a13232e}"}, "branch": {"name": "log_resources"}}, "state": "OPEN", "author": {"display_name": "Mabel Zhang", "uuid": "{4b0e38fb-bf50-45c0-a496-61147518b2bf}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B4b0e38fb-bf50-45c0-a496-61147518b2bf%7D"}, "html": {"href": "https://bitbucket.org/%7B4b0e38fb-bf50-45c0-a496-61147518b2bf%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:ceb5942c-6843-408c-8550-3ce4899d299b/4d48e5ea-cf28-4fa7-9715-8fc9e315d831/128"}}, "nickname": "mabelmzhang", "type": "user", "account_id": "557058:ceb5942c-6843-408c-8550-3ce4899d299b"}, "date": "2019-09-12T03:48:06.003745+00:00"}, "pull_request": {"type": "pullrequest", "id": 397, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397"}}, "title": "[Blueprint] Logging meshes and materials"}}, {"comment": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397/comments/116589313.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397/_/diff#comment-116589313"}}, "parent": {"id": 115008751, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397/comments/115008751.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397/_/diff#comment-115008751"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 397, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397"}}, "title": "[Blueprint] Logging meshes and materials"}, "content": {"raw": "Fixed in f09d0d5", "markup": "markdown", "html": "<p>Fixed in <a href=\"#!/ignitionrobotics/ign-gazebo/commits/f09d0d5\" rel=\"nofollow\" class=\"ap-connect-link\">f09d0d5</a></p>", "type": "rendered"}, "created_on": "2019-09-12T03:47:13.749791+00:00", "user": {"display_name": "Mabel Zhang", "uuid": "{4b0e38fb-bf50-45c0-a496-61147518b2bf}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B4b0e38fb-bf50-45c0-a496-61147518b2bf%7D"}, "html": {"href": "https://bitbucket.org/%7B4b0e38fb-bf50-45c0-a496-61147518b2bf%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:ceb5942c-6843-408c-8550-3ce4899d299b/4d48e5ea-cf28-4fa7-9715-8fc9e315d831/128"}}, "nickname": "mabelmzhang", "type": "user", "account_id": "557058:ceb5942c-6843-408c-8550-3ce4899d299b"}, "inline": {}, "updated_on": "2019-09-12T03:47:13.763889+00:00", "type": "pullrequest_comment", "id": 116589313}, "pull_request": {"type": "pullrequest", "id": 397, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397"}}, "title": "[Blueprint] Logging meshes and materials"}}, {"comment": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397/comments/116589310.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397/_/diff#comment-116589310"}}, "parent": {"id": 115007199, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397/comments/115007199.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397/_/diff#comment-115007199"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 397, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397"}}, "title": "[Blueprint] Logging meshes and materials"}, "content": {"raw": "Yes, that is the intended behavior. Added documentation to the `--help` menu in f09d0d5.", "markup": "markdown", "html": "<p>Yes, that is the intended behavior. Added documentation to the <code>--help</code> menu in <a href=\"#!/ignitionrobotics/ign-gazebo/commits/f09d0d5\" rel=\"nofollow\" class=\"ap-connect-link\">f09d0d5</a>.</p>", "type": "rendered"}, "created_on": "2019-09-12T03:47:06.429070+00:00", "user": {"display_name": "Mabel Zhang", "uuid": "{4b0e38fb-bf50-45c0-a496-61147518b2bf}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B4b0e38fb-bf50-45c0-a496-61147518b2bf%7D"}, "html": {"href": "https://bitbucket.org/%7B4b0e38fb-bf50-45c0-a496-61147518b2bf%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:ceb5942c-6843-408c-8550-3ce4899d299b/4d48e5ea-cf28-4fa7-9715-8fc9e315d831/128"}}, "nickname": "mabelmzhang", "type": "user", "account_id": "557058:ceb5942c-6843-408c-8550-3ce4899d299b"}, "inline": {}, "updated_on": "2019-09-12T03:47:06.438246+00:00", "type": "pullrequest_comment", "id": 116589310}, "pull_request": {"type": "pullrequest", "id": 397, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397"}}, "title": "[Blueprint] Logging meshes and materials"}}, {"update": {"description": "Depends on [ign-common PR 200](#!/ignitionrobotics/ign-common/pull-requests/200/log-resources/diff).\r\n\r\nPorts [this Gazebo PR](https://bitbucket.org/osrf/gazebo/pull-requests/2811/save-models-material-and-meshes-when/diff) to Ignition.\r\n\r\nRecords resources \\(meshes and materials\\) to a directory under the specified log record directory, then compresses the whole directory, which contains the existing `.tlog` sqlite3 file and any resources, to a zip file.\r\n\r\nCan be triggered with `--record-resources` on command line or plugin parameter `<record_resources>1</record_resources>`. If both are specified and are different, current behavior is to take logical OR, so resources are recorded if either command line flag or SDF flag is true.\r\n\r\nTo test:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf [--record-resources --record-path '/tmp/log']\r\n$ ign gazebo -v 4 -r examples/worlds/log_playback.sdf\r\n```\r\n\r\nTested with `<include><uri>https://fuel...</uri></include>` and `<mesh><uri>file://...</uri></mesh>`. Paths specified by `model://` are not supported in Ignition yet, so this case in the code is not tested.\r\n\r\nFiles are outputted in `/tmp/log` and `/tmp/log.zip` in this example. During record, the original path in `file://` is prepended with the specified path, e.g. `/tmp/log`. During playback, the specified path is prepended to the URIs in the SDF.\r\n\r\nRight now, the directory `/tmp/log` is not removed. Because we don't know what resources are recorded, and the code uses `fuel_tools::Zip::Compress()`, which does not support wildcards. So it zips the entire `/tmp/log` directory into `/tmp/log.zip`. If we remove the directory, the problem is that if you record a second time to `/tmp/log`, it will happily do so, but then when it tries to zip to `/tmp/log.zip`, file already exists, and it will fail. We can force overwrite it, but I feel like users would not like to do that by mistake. So, keeping the directory, the second record will automatically record to `/tmp/log(1)`, and there\u2019s no clash problem.", "title": "[Blueprint] Logging meshes and materials", "destination": {"commit": {"hash": "02e1fde5e923", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/commit/02e1fde5e923.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/commits/02e1fde5e923"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{f98d11fe-f287-4dfb-99c3-e2b76a13232e}ts=2082645"}}, "type": "repository", "name": "ign-gazebo", "full_name": "ignitionrobotics/ign-gazebo", "uuid": "{f98d11fe-f287-4dfb-99c3-e2b76a13232e}"}, "branch": {"name": "ign-gazebo2"}}, "reason": "", "source": {"commit": {"hash": "f09d0d50f43d", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/commit/f09d0d50f43d.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/commits/f09d0d50f43d"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{f98d11fe-f287-4dfb-99c3-e2b76a13232e}ts=2082645"}}, "type": "repository", "name": "ign-gazebo", "full_name": "ignitionrobotics/ign-gazebo", "uuid": "{f98d11fe-f287-4dfb-99c3-e2b76a13232e}"}, "branch": {"name": "log_resources"}}, "state": "OPEN", "author": {"display_name": "Mabel Zhang", "uuid": "{4b0e38fb-bf50-45c0-a496-61147518b2bf}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B4b0e38fb-bf50-45c0-a496-61147518b2bf%7D"}, "html": {"href": "https://bitbucket.org/%7B4b0e38fb-bf50-45c0-a496-61147518b2bf%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:ceb5942c-6843-408c-8550-3ce4899d299b/4d48e5ea-cf28-4fa7-9715-8fc9e315d831/128"}}, "nickname": "mabelmzhang", "type": "user", "account_id": "557058:ceb5942c-6843-408c-8550-3ce4899d299b"}, "date": "2019-09-12T03:46:22.678053+00:00"}, "pull_request": {"type": "pullrequest", "id": 397, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397"}}, "title": "[Blueprint] Logging meshes and materials"}}], "next": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397/activity_ctx=yobFBjSatn.json"}