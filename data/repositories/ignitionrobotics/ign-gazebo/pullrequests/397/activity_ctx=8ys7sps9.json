{"pagelen": 50, "values": [{"comment": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397/comments/129026709.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397/_/diff#comment-129026709"}}, "parent": {"id": 129025404, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397/comments/129025404.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397/_/diff#comment-129025404"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 397, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397"}}, "title": "[Blueprint] Logging meshes and materials"}, "content": {"raw": "Updated in c7c133a", "markup": "markdown", "html": "<p>Updated in <a href=\"#!/ignitionrobotics/ign-gazebo/commits/c7c133a\" rel=\"nofollow\" class=\"ap-connect-link\">c7c133a</a></p>", "type": "rendered"}, "created_on": "2019-12-17T00:50:25.238728+00:00", "user": {"display_name": "Mabel Zhang", "uuid": "{4b0e38fb-bf50-45c0-a496-61147518b2bf}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B4b0e38fb-bf50-45c0-a496-61147518b2bf%7D"}, "html": {"href": "https://bitbucket.org/%7B4b0e38fb-bf50-45c0-a496-61147518b2bf%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:ceb5942c-6843-408c-8550-3ce4899d299b/4d48e5ea-cf28-4fa7-9715-8fc9e315d831/128"}}, "nickname": "mabelmzhang", "type": "user", "account_id": "557058:ceb5942c-6843-408c-8550-3ce4899d299b"}, "inline": {}, "updated_on": "2019-12-17T00:50:25.246054+00:00", "type": "pullrequest_comment", "id": 129026709}, "pull_request": {"type": "pullrequest", "id": 397, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397"}}, "title": "[Blueprint] Logging meshes and materials"}}, {"comment": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397/comments/129026701.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397/_/diff#comment-129026701"}}, "parent": {"id": 129025601, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397/comments/129025601.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397/_/diff#comment-129025601"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 397, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397"}}, "title": "[Blueprint] Logging meshes and materials"}, "content": {"raw": "c7c133a", "markup": "markdown", "html": "<p><a href=\"#!/ignitionrobotics/ign-gazebo/commits/c7c133a\" rel=\"nofollow\" class=\"ap-connect-link\">c7c133a</a></p>", "type": "rendered"}, "created_on": "2019-12-17T00:50:19.668383+00:00", "user": {"display_name": "Mabel Zhang", "uuid": "{4b0e38fb-bf50-45c0-a496-61147518b2bf}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B4b0e38fb-bf50-45c0-a496-61147518b2bf%7D"}, "html": {"href": "https://bitbucket.org/%7B4b0e38fb-bf50-45c0-a496-61147518b2bf%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:ceb5942c-6843-408c-8550-3ce4899d299b/4d48e5ea-cf28-4fa7-9715-8fc9e315d831/128"}}, "nickname": "mabelmzhang", "type": "user", "account_id": "557058:ceb5942c-6843-408c-8550-3ce4899d299b"}, "inline": {}, "updated_on": "2019-12-17T00:50:19.675306+00:00", "type": "pullrequest_comment", "id": 129026701}, "pull_request": {"type": "pullrequest", "id": 397, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397"}}, "title": "[Blueprint] Logging meshes and materials"}}, {"comment": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397/comments/129026686.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397/_/diff#comment-129026686"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 397, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397"}}, "title": "[Blueprint] Logging meshes and materials"}, "content": {"raw": "We're printing this even if `!_logCompress`, which I think could make users confused", "markup": "markdown", "html": "<p>We're printing this even if <code>!_logCompress</code>, which I think could make users confused</p>", "type": "rendered"}, "created_on": "2019-12-17T00:50:03.882461+00:00", "user": {"display_name": "Louise Poubel", "uuid": "{5cfa2075-477b-4ded-bdb9-8d2479544ec4}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D"}, "html": {"href": "https://bitbucket.org/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8/7d903d90-c5ea-4182-b7ef-0d467e9e1c74/128"}}, "nickname": "chapulina", "type": "user", "account_id": "557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8"}, "inline": {}, "updated_on": "2019-12-17T00:50:03.888223+00:00", "type": "pullrequest_comment", "id": 129026686}, "pull_request": {"type": "pullrequest", "id": 397, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397"}}, "title": "[Blueprint] Logging meshes and materials"}}, {"update": {"description": "Depends on [ign-common PR 200](#!/ignitionrobotics/ign-common/pull-requests/200/log-resources/diff).\r\n\r\nPorts [this Gazebo PR](https://bitbucket.org/osrf/gazebo/pull-requests/2811/save-models-material-and-meshes-when/diff) to Ignition.\r\n\r\nImplements `--record-resources`, and `--log-compress` and `--log-overwrite` to support it.\r\n\r\nRecords resources \\(`--record-resources`\\), i.e. meshes and materials, to a directory under the specified log record directory. Optionally compresses \\(`--log-compress`\\) the whole directory, which contains the existing `.tlog` sqlite3 file and any resources, to a zip file. If directory or compressed file already exist, optionally overwrites \\(`--log-overwrite`\\).\r\n\r\nCorresponding SDF plugin parameters: `<record_resources>1</record_resources>`, `<compress>1</compress>.`If both command line and SDF parameters are specified, command line option overwrites SDF parameter. `--log-overwrite` is handled on command line only, outside of the plugin. If recording is only enabled from SDF and not from command line, then behavior is to always overwrite.\r\n\r\n## Usage:\r\n\r\n```\r\nign gazebo [...] --record-resources --log-overwrite --log-compress\r\n```\r\n\r\n## Test --record-resources:\r\n\r\n```\r\n# This SDF specifies the equivalent of --record-resources --record-path '/tmp/log'\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf\r\n$ ign gazebo -v 4 -r examples/worlds/log_playback.sdf\r\n```\r\n\r\nTested with `<include><uri>https://fuel...</uri></include>` and `<mesh><uri>file://...</uri></mesh>`. Paths specified by `model://` are not supported in Ignition yet, so this case in the code is not tested.\r\n\r\n## Test --log-overwrite and --log-compress:\r\n\r\nWhen recording to `path`, the compression file is implied to be `path.zip`. Both are checked for existence.\r\n\r\nNo `--log-overwrite` \\(default\\):\r\n\r\n```\r\n# This SDF specifies the equivalent of --record-path '/tmp/log'\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf\r\n\r\n# Run it again. By default it will always overwrite, because overwrite is now taken care of in ign.cc\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf\r\n[Msg] Overwriting existing file [/tmp/log/state.tlog]\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n```\r\n\r\n`--log-overwrite`, `/tmp/log` already exists:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-overwrite --record-path '/tmp/log'\r\n[Msg] Log path already exists on disk! Existing files will be overwritten.\r\n[Msg] Removing existing path [/tmp/log]\r\n...\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n...\r\n[Msg] Stopping recording\r\n```\r\n\r\n`--log-overwrite --log-compress`, `/tmp/log` exists, `/tmp/log.zip` does not exist:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-compress --log-overwrite --record-path '/tmp/log'\r\n[Msg] Log path already exists on disk! Existing files will be overwritten.\r\n[Msg] Removing existing path [/tmp/log]\r\n...\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n...\r\n[Msg] Compressed log file and resources to [/tmp/log.zip].\r\nRemoving recorded directory [/tmp/log].\r\n[Msg] Stopping recording\r\n```\r\n\r\n`--log-overwrite --log-compress`, `/tmp/log` does not exist, `/tmp/log.zip` exists:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-compress --log-overwrite --record-path '/tmp/log'\r\n[Wrn] [ign.cc:121] Compressed log path already exists on disk! Existing files will be overwritten.\r\n[Msg] Removing existing compressed file [/tmp/log.zip]\r\n...\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n...\r\n[Msg] Compressed log file and resources to [/tmp/log.zip].\r\nRemoving recorded directory [/tmp/log].\r\n[Msg] Stopping recording\r\n```\r\n\r\n`--log-overwrite` only, `/tmp/log.zip` exists, `/tmp/log` does not exist:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-overwrite --record-path '/tmp/log'\r\n[Wrn] [ign.cc:121] Compressed log path already exists on disk! Existing files will be overwritten.\r\n[Msg] Removing existing compressed file [/tmp/log.zip]\r\n...\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n...\r\n[Msg] Stopping recording\r\n```\r\n\r\n`--log-compress` only, both `/tmp/log` and `/tmp/log.zip` already exist:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-compress --record-path '/tmp/log'\r\n[Wrn] [ign.cc:152] Log path already exists on disk! Recording instead to [/tmp/log(1)]\r\n[Wrn] [ign.cc:154] Compressed log path already exists on disk! Recording instead to [/tmp/log(1).zip]\r\n...\r\n[Msg] Recording to log file [/tmp/log(1)/state.tlog]\r\n...\r\n[Msg] Compressed log file and resources to [/tmp/log(1).zip].\r\nRemoving recorded directory [/tmp/log(1)].\r\n[Msg] Stopping recording\r\n$ ls /tmp\r\nlog\r\n'log(1).zip'\r\nlog.zip\r\n```\r\n\r\n`--log-compress` only, `/tmp/log` does not exist, `/tmp/log.zip` exists, `/tmp/log(1).zip` exists:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-compress --record-path '/tmp/log'\r\n[Wrn] [ign.cc:152] Log path already exists on disk! Recording instead to [/tmp/log(2)]\r\n[Wrn] [ign.cc:154] Compressed log path already exists on disk! Recording instead to [/tmp/log(2).zip]\r\n...\r\n[Msg] Recording to log file [/tmp/log(2)/state.tlog]\r\n...\r\n[Msg] Compressed log file and resources to [/tmp/log(2).zip].\r\nRemoving recorded directory [/tmp/log(2)].\r\n[Msg] Stopping recording\r\n```\r\n\r\n## Record Path vs. Console Log Path\r\n\r\nIn Blueprint and Citadel, if `--record` is specified without `--record-path`, and `<path>` exists in SDF, a warning is printed, and recording will go to `<path>`, while console log will go to the default timestamp path.\r\n\r\nAs in this example:\r\n\r\n```\r\n# SDF specifies <path>/tmp/log</path>\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --record --log-compress -log-overwrite\r\n[Wrn] [ServerPrivate.cc:229] --record-path is not specified on command line. <path> is specified in SDF. Will record to <path>. Console will be logged to [/home/master/.ignition/gazebo/log/2019-09-20T19:51:33.996055619]. Note: In Ignition-D, <path> will be ignored, and all recordings will be written to default console log path if no path is specified on command line.\r\n[Msg] Overwriting existing file [/tmp/log/state.tlog]\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n...\r\n[Msg] Removing existing file [/tmp/log.zip].\r\n[Msg] Compressed log file and resources to [/tmp/log.zip].\r\nRemoving recorded directory [/tmp/log].\r\n```\r\n\r\nIn Ignition-D, `<path>` will be permanently ignored. Recordings and console log will go to same default path.\r\n\r\nIf `--record-path` is specified, then recording and console log will go to this path in Blueprint, Citadel, and Ignition-D.\r\n\r\n## Future Work\r\n\r\nFiles are outputted in `/tmp/log` and `/tmp/log.zip` in this example. During record, the original path in `file://` is prepended with the specified path, e.g. `/tmp/log`. During playback, the specified path is prepended to the URIs in the SDF.", "title": "[Blueprint] Logging meshes and materials", "destination": {"commit": {"hash": "d21db16d0d03", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/commit/d21db16d0d03.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/commits/d21db16d0d03"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{f98d11fe-f287-4dfb-99c3-e2b76a13232e}ts=2082645"}}, "type": "repository", "name": "ign-gazebo", "full_name": "ignitionrobotics/ign-gazebo", "uuid": "{f98d11fe-f287-4dfb-99c3-e2b76a13232e}"}, "branch": {"name": "ign-gazebo2"}}, "reason": "", "source": {"commit": {"hash": "5e65a699e032", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/commit/5e65a699e032.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/commits/5e65a699e032"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{f98d11fe-f287-4dfb-99c3-e2b76a13232e}ts=2082645"}}, "type": "repository", "name": "ign-gazebo", "full_name": "ignitionrobotics/ign-gazebo", "uuid": "{f98d11fe-f287-4dfb-99c3-e2b76a13232e}"}, "branch": {"name": "log_resources"}}, "state": "OPEN", "author": {"display_name": "Mabel Zhang", "uuid": "{4b0e38fb-bf50-45c0-a496-61147518b2bf}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B4b0e38fb-bf50-45c0-a496-61147518b2bf%7D"}, "html": {"href": "https://bitbucket.org/%7B4b0e38fb-bf50-45c0-a496-61147518b2bf%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:ceb5942c-6843-408c-8550-3ce4899d299b/4d48e5ea-cf28-4fa7-9715-8fc9e315d831/128"}}, "nickname": "mabelmzhang", "type": "user", "account_id": "557058:ceb5942c-6843-408c-8550-3ce4899d299b"}, "date": "2019-12-17T00:49:51.998891+00:00"}, "pull_request": {"type": "pullrequest", "id": 397, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397"}}, "title": "[Blueprint] Logging meshes and materials"}}, {"comment": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397/comments/129025601.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397/_/diff#comment-129025601"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 397, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397"}}, "title": "[Blueprint] Logging meshes and materials"}, "content": {"raw": "We could document that this is not recommended and will be deprecated in later versions.", "markup": "markdown", "html": "<p>We could document that this is not recommended and will be deprecated in later versions.</p>", "type": "rendered"}, "created_on": "2019-12-17T00:30:36.560770+00:00", "user": {"display_name": "Louise Poubel", "uuid": "{5cfa2075-477b-4ded-bdb9-8d2479544ec4}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D"}, "html": {"href": "https://bitbucket.org/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8/7d903d90-c5ea-4182-b7ef-0d467e9e1c74/128"}}, "nickname": "chapulina", "type": "user", "account_id": "557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8"}, "inline": {}, "updated_on": "2019-12-17T00:30:36.566676+00:00", "type": "pullrequest_comment", "id": 129025601}, "pull_request": {"type": "pullrequest", "id": 397, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397"}}, "title": "[Blueprint] Logging meshes and materials"}}, {"comment": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397/comments/129025404.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397/_/diff#comment-129025404"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 397, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397"}}, "title": "[Blueprint] Logging meshes and materials"}, "content": {"raw": "Since C is out, we should deprecate the public APIs in D and remove them in E\n", "markup": "markdown", "html": "<p>Since C is out, we should deprecate the public APIs in D and remove them in E</p>", "type": "rendered"}, "created_on": "2019-12-17T00:27:41.778472+00:00", "user": {"display_name": "Louise Poubel", "uuid": "{5cfa2075-477b-4ded-bdb9-8d2479544ec4}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D"}, "html": {"href": "https://bitbucket.org/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8/7d903d90-c5ea-4182-b7ef-0d467e9e1c74/128"}}, "nickname": "chapulina", "type": "user", "account_id": "557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8"}, "inline": {}, "updated_on": "2019-12-17T00:27:41.784207+00:00", "type": "pullrequest_comment", "id": 129025404}, "pull_request": {"type": "pullrequest", "id": 397, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397"}}, "title": "[Blueprint] Logging meshes and materials"}}, {"comment": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397/comments/129025142.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397/_/diff#comment-129025142"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 397, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397"}}, "title": "[Blueprint] Logging meshes and materials"}, "content": {"raw": "If this block will be empty, could we just have the inverse logic, which prints the message?", "markup": "markdown", "html": "<p>If this block will be empty, could we just have the inverse logic, which prints the message?</p>", "type": "rendered"}, "created_on": "2019-12-17T00:23:55.256717+00:00", "user": {"display_name": "Louise Poubel", "uuid": "{5cfa2075-477b-4ded-bdb9-8d2479544ec4}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D"}, "html": {"href": "https://bitbucket.org/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8/7d903d90-c5ea-4182-b7ef-0d467e9e1c74/128"}}, "nickname": "chapulina", "type": "user", "account_id": "557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8"}, "inline": {}, "updated_on": "2019-12-17T00:23:55.262745+00:00", "type": "pullrequest_comment", "id": 129025142}, "pull_request": {"type": "pullrequest", "id": 397, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397"}}, "title": "[Blueprint] Logging meshes and materials"}}, {"update": {"description": "Depends on [ign-common PR 200](#!/ignitionrobotics/ign-common/pull-requests/200/log-resources/diff).\r\n\r\nPorts [this Gazebo PR](https://bitbucket.org/osrf/gazebo/pull-requests/2811/save-models-material-and-meshes-when/diff) to Ignition.\r\n\r\nImplements `--record-resources`, and `--log-compress` and `--log-overwrite` to support it.\r\n\r\nRecords resources \\(`--record-resources`\\), i.e. meshes and materials, to a directory under the specified log record directory. Optionally compresses \\(`--log-compress`\\) the whole directory, which contains the existing `.tlog` sqlite3 file and any resources, to a zip file. If directory or compressed file already exist, optionally overwrites \\(`--log-overwrite`\\).\r\n\r\nCorresponding SDF plugin parameters: `<record_resources>1</record_resources>`, `<compress>1</compress>.`If both command line and SDF parameters are specified, command line option overwrites SDF parameter. `--log-overwrite` is handled on command line only, outside of the plugin. If recording is only enabled from SDF and not from command line, then behavior is to always overwrite.\r\n\r\n## Usage:\r\n\r\n```\r\nign gazebo [...] --record-resources --log-overwrite --log-compress\r\n```\r\n\r\n## Test --record-resources:\r\n\r\n```\r\n# This SDF specifies the equivalent of --record-resources --record-path '/tmp/log'\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf\r\n$ ign gazebo -v 4 -r examples/worlds/log_playback.sdf\r\n```\r\n\r\nTested with `<include><uri>https://fuel...</uri></include>` and `<mesh><uri>file://...</uri></mesh>`. Paths specified by `model://` are not supported in Ignition yet, so this case in the code is not tested.\r\n\r\n## Test --log-overwrite and --log-compress:\r\n\r\nWhen recording to `path`, the compression file is implied to be `path.zip`. Both are checked for existence.\r\n\r\nNo `--log-overwrite` \\(default\\):\r\n\r\n```\r\n# This SDF specifies the equivalent of --record-path '/tmp/log'\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf\r\n\r\n# Run it again. By default it will always overwrite, because overwrite is now taken care of in ign.cc\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf\r\n[Msg] Overwriting existing file [/tmp/log/state.tlog]\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n```\r\n\r\n`--log-overwrite`, `/tmp/log` already exists:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-overwrite --record-path '/tmp/log'\r\n[Msg] Log path already exists on disk! Existing files will be overwritten.\r\n[Msg] Removing existing path [/tmp/log]\r\n...\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n...\r\n[Msg] Stopping recording\r\n```\r\n\r\n`--log-overwrite --log-compress`, `/tmp/log` exists, `/tmp/log.zip` does not exist:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-compress --log-overwrite --record-path '/tmp/log'\r\n[Msg] Log path already exists on disk! Existing files will be overwritten.\r\n[Msg] Removing existing path [/tmp/log]\r\n...\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n...\r\n[Msg] Compressed log file and resources to [/tmp/log.zip].\r\nRemoving recorded directory [/tmp/log].\r\n[Msg] Stopping recording\r\n```\r\n\r\n`--log-overwrite --log-compress`, `/tmp/log` does not exist, `/tmp/log.zip` exists:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-compress --log-overwrite --record-path '/tmp/log'\r\n[Wrn] [ign.cc:121] Compressed log path already exists on disk! Existing files will be overwritten.\r\n[Msg] Removing existing compressed file [/tmp/log.zip]\r\n...\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n...\r\n[Msg] Compressed log file and resources to [/tmp/log.zip].\r\nRemoving recorded directory [/tmp/log].\r\n[Msg] Stopping recording\r\n```\r\n\r\n`--log-overwrite` only, `/tmp/log.zip` exists, `/tmp/log` does not exist:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-overwrite --record-path '/tmp/log'\r\n[Wrn] [ign.cc:121] Compressed log path already exists on disk! Existing files will be overwritten.\r\n[Msg] Removing existing compressed file [/tmp/log.zip]\r\n...\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n...\r\n[Msg] Stopping recording\r\n```\r\n\r\n`--log-compress` only, both `/tmp/log` and `/tmp/log.zip` already exist:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-compress --record-path '/tmp/log'\r\n[Wrn] [ign.cc:152] Log path already exists on disk! Recording instead to [/tmp/log(1)]\r\n[Wrn] [ign.cc:154] Compressed log path already exists on disk! Recording instead to [/tmp/log(1).zip]\r\n...\r\n[Msg] Recording to log file [/tmp/log(1)/state.tlog]\r\n...\r\n[Msg] Compressed log file and resources to [/tmp/log(1).zip].\r\nRemoving recorded directory [/tmp/log(1)].\r\n[Msg] Stopping recording\r\n$ ls /tmp\r\nlog\r\n'log(1).zip'\r\nlog.zip\r\n```\r\n\r\n`--log-compress` only, `/tmp/log` does not exist, `/tmp/log.zip` exists, `/tmp/log(1).zip` exists:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-compress --record-path '/tmp/log'\r\n[Wrn] [ign.cc:152] Log path already exists on disk! Recording instead to [/tmp/log(2)]\r\n[Wrn] [ign.cc:154] Compressed log path already exists on disk! Recording instead to [/tmp/log(2).zip]\r\n...\r\n[Msg] Recording to log file [/tmp/log(2)/state.tlog]\r\n...\r\n[Msg] Compressed log file and resources to [/tmp/log(2).zip].\r\nRemoving recorded directory [/tmp/log(2)].\r\n[Msg] Stopping recording\r\n```\r\n\r\n## Record Path vs. Console Log Path\r\n\r\nIn Blueprint and Citadel, if `--record` is specified without `--record-path`, and `<path>` exists in SDF, a warning is printed, and recording will go to `<path>`, while console log will go to the default timestamp path.\r\n\r\nAs in this example:\r\n\r\n```\r\n# SDF specifies <path>/tmp/log</path>\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --record --log-compress -log-overwrite\r\n[Wrn] [ServerPrivate.cc:229] --record-path is not specified on command line. <path> is specified in SDF. Will record to <path>. Console will be logged to [/home/master/.ignition/gazebo/log/2019-09-20T19:51:33.996055619]. Note: In Ignition-D, <path> will be ignored, and all recordings will be written to default console log path if no path is specified on command line.\r\n[Msg] Overwriting existing file [/tmp/log/state.tlog]\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n...\r\n[Msg] Removing existing file [/tmp/log.zip].\r\n[Msg] Compressed log file and resources to [/tmp/log.zip].\r\nRemoving recorded directory [/tmp/log].\r\n```\r\n\r\nIn Ignition-D, `<path>` will be permanently ignored. Recordings and console log will go to same default path.\r\n\r\nIf `--record-path` is specified, then recording and console log will go to this path in Blueprint, Citadel, and Ignition-D.\r\n\r\n## Future Work\r\n\r\nFiles are outputted in `/tmp/log` and `/tmp/log.zip` in this example. During record, the original path in `file://` is prepended with the specified path, e.g. `/tmp/log`. During playback, the specified path is prepended to the URIs in the SDF.", "title": "[Blueprint] Logging meshes and materials", "destination": {"commit": {"hash": "d21db16d0d03", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/commit/d21db16d0d03.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/commits/d21db16d0d03"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{f98d11fe-f287-4dfb-99c3-e2b76a13232e}ts=2082645"}}, "type": "repository", "name": "ign-gazebo", "full_name": "ignitionrobotics/ign-gazebo", "uuid": "{f98d11fe-f287-4dfb-99c3-e2b76a13232e}"}, "branch": {"name": "ign-gazebo2"}}, "reason": "", "source": {"commit": {"hash": "7abae529de67", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/commit/7abae529de67.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/commits/7abae529de67"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{f98d11fe-f287-4dfb-99c3-e2b76a13232e}ts=2082645"}}, "type": "repository", "name": "ign-gazebo", "full_name": "ignitionrobotics/ign-gazebo", "uuid": "{f98d11fe-f287-4dfb-99c3-e2b76a13232e}"}, "branch": {"name": "log_resources"}}, "state": "OPEN", "author": {"display_name": "Mabel Zhang", "uuid": "{4b0e38fb-bf50-45c0-a496-61147518b2bf}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B4b0e38fb-bf50-45c0-a496-61147518b2bf%7D"}, "html": {"href": "https://bitbucket.org/%7B4b0e38fb-bf50-45c0-a496-61147518b2bf%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:ceb5942c-6843-408c-8550-3ce4899d299b/4d48e5ea-cf28-4fa7-9715-8fc9e315d831/128"}}, "nickname": "mabelmzhang", "type": "user", "account_id": "557058:ceb5942c-6843-408c-8550-3ce4899d299b"}, "date": "2019-12-16T23:49:19.474239+00:00"}, "pull_request": {"type": "pullrequest", "id": 397, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397"}}, "title": "[Blueprint] Logging meshes and materials"}}, {"comment": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397/comments/127141328.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397/_/diff#comment-127141328"}}, "parent": {"id": 126267527, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397/comments/126267527.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397/_/diff#comment-126267527"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 397, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397"}}, "title": "[Blueprint] Logging meshes and materials"}, "content": {"raw": "Thank you for finding this fix! I guess I wasn\u2019t tracking down the right place. This fix worked for me. Changed in 3b6c67a.", "markup": "markdown", "html": "<p>Thank you for finding this fix! I guess I wasn\u2019t tracking down the right place. This fix worked for me. Changed in <a href=\"#!/ignitionrobotics/ign-gazebo/commits/3b6c67a\" rel=\"nofollow\" class=\"ap-connect-link\">3b6c67a</a>.</p>", "type": "rendered"}, "created_on": "2019-12-03T02:38:21.220764+00:00", "user": {"display_name": "Mabel Zhang", "uuid": "{4b0e38fb-bf50-45c0-a496-61147518b2bf}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B4b0e38fb-bf50-45c0-a496-61147518b2bf%7D"}, "html": {"href": "https://bitbucket.org/%7B4b0e38fb-bf50-45c0-a496-61147518b2bf%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:ceb5942c-6843-408c-8550-3ce4899d299b/4d48e5ea-cf28-4fa7-9715-8fc9e315d831/128"}}, "nickname": "mabelmzhang", "type": "user", "account_id": "557058:ceb5942c-6843-408c-8550-3ce4899d299b"}, "updated_on": "2019-12-03T02:38:21.230135+00:00", "type": "pullrequest_comment", "id": 127141328}, "pull_request": {"type": "pullrequest", "id": 397, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397"}}, "title": "[Blueprint] Logging meshes and materials"}}, {"comment": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397/comments/127141309.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397/_/diff#comment-127141309"}}, "parent": {"id": 126266347, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397/comments/126266347.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397/_/diff#comment-126266347"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 397, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397"}}, "title": "[Blueprint] Logging meshes and materials"}, "content": {"raw": "Changed in 3b6c67a\n\nI tested the cases with relative paths on the command line brought up in Nate\u2019s comment. They still work. So seems like it\u2019s okay?", "markup": "markdown", "html": "<p>Changed in <a href=\"#!/ignitionrobotics/ign-gazebo/commits/3b6c67a\" rel=\"nofollow\" class=\"ap-connect-link\">3b6c67a</a></p>\n<p>I tested the cases with relative paths on the command line brought up in Nate\u2019s comment. They still work. So seems like it\u2019s okay?</p>", "type": "rendered"}, "created_on": "2019-12-03T02:37:52.713530+00:00", "user": {"display_name": "Mabel Zhang", "uuid": "{4b0e38fb-bf50-45c0-a496-61147518b2bf}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B4b0e38fb-bf50-45c0-a496-61147518b2bf%7D"}, "html": {"href": "https://bitbucket.org/%7B4b0e38fb-bf50-45c0-a496-61147518b2bf%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:ceb5942c-6843-408c-8550-3ce4899d299b/4d48e5ea-cf28-4fa7-9715-8fc9e315d831/128"}}, "nickname": "mabelmzhang", "type": "user", "account_id": "557058:ceb5942c-6843-408c-8550-3ce4899d299b"}, "inline": {}, "updated_on": "2019-12-03T02:37:52.720829+00:00", "type": "pullrequest_comment", "id": 127141309}, "pull_request": {"type": "pullrequest", "id": 397, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397"}}, "title": "[Blueprint] Logging meshes and materials"}}, {"update": {"description": "Depends on [ign-common PR 200](#!/ignitionrobotics/ign-common/pull-requests/200/log-resources/diff).\r\n\r\nPorts [this Gazebo PR](https://bitbucket.org/osrf/gazebo/pull-requests/2811/save-models-material-and-meshes-when/diff) to Ignition.\r\n\r\nImplements `--record-resources`, and `--log-compress` and `--log-overwrite` to support it.\r\n\r\nRecords resources \\(`--record-resources`\\), i.e. meshes and materials, to a directory under the specified log record directory. Optionally compresses \\(`--log-compress`\\) the whole directory, which contains the existing `.tlog` sqlite3 file and any resources, to a zip file. If directory or compressed file already exist, optionally overwrites \\(`--log-overwrite`\\).\r\n\r\nCorresponding SDF plugin parameters: `<record_resources>1</record_resources>`, `<compress>1</compress>.`If both command line and SDF parameters are specified, command line option overwrites SDF parameter. `--log-overwrite` is handled on command line only, outside of the plugin. If recording is only enabled from SDF and not from command line, then behavior is to always overwrite.\r\n\r\n## Usage:\r\n\r\n```\r\nign gazebo [...] --record-resources --log-overwrite --log-compress\r\n```\r\n\r\n## Test --record-resources:\r\n\r\n```\r\n# This SDF specifies the equivalent of --record-resources --record-path '/tmp/log'\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf\r\n$ ign gazebo -v 4 -r examples/worlds/log_playback.sdf\r\n```\r\n\r\nTested with `<include><uri>https://fuel...</uri></include>` and `<mesh><uri>file://...</uri></mesh>`. Paths specified by `model://` are not supported in Ignition yet, so this case in the code is not tested.\r\n\r\n## Test --log-overwrite and --log-compress:\r\n\r\nWhen recording to `path`, the compression file is implied to be `path.zip`. Both are checked for existence.\r\n\r\nNo `--log-overwrite` \\(default\\):\r\n\r\n```\r\n# This SDF specifies the equivalent of --record-path '/tmp/log'\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf\r\n\r\n# Run it again. By default it will always overwrite, because overwrite is now taken care of in ign.cc\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf\r\n[Msg] Overwriting existing file [/tmp/log/state.tlog]\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n```\r\n\r\n`--log-overwrite`, `/tmp/log` already exists:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-overwrite --record-path '/tmp/log'\r\n[Msg] Log path already exists on disk! Existing files will be overwritten.\r\n[Msg] Removing existing path [/tmp/log]\r\n...\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n...\r\n[Msg] Stopping recording\r\n```\r\n\r\n`--log-overwrite --log-compress`, `/tmp/log` exists, `/tmp/log.zip` does not exist:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-compress --log-overwrite --record-path '/tmp/log'\r\n[Msg] Log path already exists on disk! Existing files will be overwritten.\r\n[Msg] Removing existing path [/tmp/log]\r\n...\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n...\r\n[Msg] Compressed log file and resources to [/tmp/log.zip].\r\nRemoving recorded directory [/tmp/log].\r\n[Msg] Stopping recording\r\n```\r\n\r\n`--log-overwrite --log-compress`, `/tmp/log` does not exist, `/tmp/log.zip` exists:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-compress --log-overwrite --record-path '/tmp/log'\r\n[Wrn] [ign.cc:121] Compressed log path already exists on disk! Existing files will be overwritten.\r\n[Msg] Removing existing compressed file [/tmp/log.zip]\r\n...\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n...\r\n[Msg] Compressed log file and resources to [/tmp/log.zip].\r\nRemoving recorded directory [/tmp/log].\r\n[Msg] Stopping recording\r\n```\r\n\r\n`--log-overwrite` only, `/tmp/log.zip` exists, `/tmp/log` does not exist:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-overwrite --record-path '/tmp/log'\r\n[Wrn] [ign.cc:121] Compressed log path already exists on disk! Existing files will be overwritten.\r\n[Msg] Removing existing compressed file [/tmp/log.zip]\r\n...\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n...\r\n[Msg] Stopping recording\r\n```\r\n\r\n`--log-compress` only, both `/tmp/log` and `/tmp/log.zip` already exist:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-compress --record-path '/tmp/log'\r\n[Wrn] [ign.cc:152] Log path already exists on disk! Recording instead to [/tmp/log(1)]\r\n[Wrn] [ign.cc:154] Compressed log path already exists on disk! Recording instead to [/tmp/log(1).zip]\r\n...\r\n[Msg] Recording to log file [/tmp/log(1)/state.tlog]\r\n...\r\n[Msg] Compressed log file and resources to [/tmp/log(1).zip].\r\nRemoving recorded directory [/tmp/log(1)].\r\n[Msg] Stopping recording\r\n$ ls /tmp\r\nlog\r\n'log(1).zip'\r\nlog.zip\r\n```\r\n\r\n`--log-compress` only, `/tmp/log` does not exist, `/tmp/log.zip` exists, `/tmp/log(1).zip` exists:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-compress --record-path '/tmp/log'\r\n[Wrn] [ign.cc:152] Log path already exists on disk! Recording instead to [/tmp/log(2)]\r\n[Wrn] [ign.cc:154] Compressed log path already exists on disk! Recording instead to [/tmp/log(2).zip]\r\n...\r\n[Msg] Recording to log file [/tmp/log(2)/state.tlog]\r\n...\r\n[Msg] Compressed log file and resources to [/tmp/log(2).zip].\r\nRemoving recorded directory [/tmp/log(2)].\r\n[Msg] Stopping recording\r\n```\r\n\r\n## Record Path vs. Console Log Path\r\n\r\nIn Blueprint and Citadel, if `--record` is specified without `--record-path`, and `<path>` exists in SDF, a warning is printed, and recording will go to `<path>`, while console log will go to the default timestamp path.\r\n\r\nAs in this example:\r\n\r\n```\r\n# SDF specifies <path>/tmp/log</path>\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --record --log-compress -log-overwrite\r\n[Wrn] [ServerPrivate.cc:229] --record-path is not specified on command line. <path> is specified in SDF. Will record to <path>. Console will be logged to [/home/master/.ignition/gazebo/log/2019-09-20T19:51:33.996055619]. Note: In Ignition-D, <path> will be ignored, and all recordings will be written to default console log path if no path is specified on command line.\r\n[Msg] Overwriting existing file [/tmp/log/state.tlog]\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n...\r\n[Msg] Removing existing file [/tmp/log.zip].\r\n[Msg] Compressed log file and resources to [/tmp/log.zip].\r\nRemoving recorded directory [/tmp/log].\r\n```\r\n\r\nIn Ignition-D, `<path>` will be permanently ignored. Recordings and console log will go to same default path.\r\n\r\nIf `--record-path` is specified, then recording and console log will go to this path in Blueprint, Citadel, and Ignition-D.\r\n\r\n## Future Work\r\n\r\nFiles are outputted in `/tmp/log` and `/tmp/log.zip` in this example. During record, the original path in `file://` is prepended with the specified path, e.g. `/tmp/log`. During playback, the specified path is prepended to the URIs in the SDF.", "title": "[Blueprint] Logging meshes and materials", "destination": {"commit": {"hash": "c6260ecbefc2", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/commit/c6260ecbefc2.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/commits/c6260ecbefc2"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{f98d11fe-f287-4dfb-99c3-e2b76a13232e}ts=2082645"}}, "type": "repository", "name": "ign-gazebo", "full_name": "ignitionrobotics/ign-gazebo", "uuid": "{f98d11fe-f287-4dfb-99c3-e2b76a13232e}"}, "branch": {"name": "ign-gazebo2"}}, "reason": "", "source": {"commit": {"hash": "3b6c67ab1c7a", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/commit/3b6c67ab1c7a.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/commits/3b6c67ab1c7a"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{f98d11fe-f287-4dfb-99c3-e2b76a13232e}ts=2082645"}}, "type": "repository", "name": "ign-gazebo", "full_name": "ignitionrobotics/ign-gazebo", "uuid": "{f98d11fe-f287-4dfb-99c3-e2b76a13232e}"}, "branch": {"name": "log_resources"}}, "state": "OPEN", "author": {"display_name": "Mabel Zhang", "uuid": "{4b0e38fb-bf50-45c0-a496-61147518b2bf}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B4b0e38fb-bf50-45c0-a496-61147518b2bf%7D"}, "html": {"href": "https://bitbucket.org/%7B4b0e38fb-bf50-45c0-a496-61147518b2bf%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:ceb5942c-6843-408c-8550-3ce4899d299b/4d48e5ea-cf28-4fa7-9715-8fc9e315d831/128"}}, "nickname": "mabelmzhang", "type": "user", "account_id": "557058:ceb5942c-6843-408c-8550-3ce4899d299b"}, "date": "2019-12-03T02:36:35.927204+00:00"}, "pull_request": {"type": "pullrequest", "id": 397, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397"}}, "title": "[Blueprint] Logging meshes and materials"}}, {"comment": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397/comments/126267527.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397/_/diff#comment-126267527"}}, "parent": {"id": 123600832, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397/comments/123600832.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397/_/diff#comment-123600832"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 397, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397"}}, "title": "[Blueprint] Logging meshes and materials"}, "content": {"raw": "This fixes the first issue for me:\n\n~~~\ndiff -r 14b400a699f9 src/systems/log/LogPlayback.cc\n--- a/src/systems/log/LogPlayback.cc    Tue Oct 22 13:49:56 2019 -0400\n+++ b/src/systems/log/LogPlayback.cc    Mon Nov 25 17:10:53 2019 -0800\n@@ -393,7 +393,7 @@\n     }\n \n     // Prepend log path to file path\n-    std::string pathPrepended = filePrefix + common::joinPaths(this->logPath,\n+    std::string pathPrepended = common::joinPaths(this->logPath,\n       pathNoPrefix);\n \n     // For backward compatibility. If prepended record path does not exist,\n~~~\n\nIt looks like `common::exists` doesn't support paths starting with `file://`, so it thinks that the prepended path doesn't exist and tries to look at the original location.\n\nIt looks like `file://` was added on purpose though - do you think it's ok to remove it, @{mabelmzhang} ?", "markup": "markdown", "html": "<p>This fixes the first issue for me:</p>\n<div class=\"codehilite\"><pre><span></span><span class=\"gh\">diff -r 14b400a699f9 src/systems/log/LogPlayback.cc</span>\n<span class=\"gd\">--- a/src/systems/log/LogPlayback.cc    Tue Oct 22 13:49:56 2019 -0400</span>\n<span class=\"gi\">+++ b/src/systems/log/LogPlayback.cc    Mon Nov 25 17:10:53 2019 -0800</span>\n<span class=\"gu\">@@ -393,7 +393,7 @@</span>\n     }\n\n     // Prepend log path to file path\n<span class=\"gd\">-    std::string pathPrepended = filePrefix + common::joinPaths(this-&gt;logPath,</span>\n<span class=\"gi\">+    std::string pathPrepended = common::joinPaths(this-&gt;logPath,</span>\n       pathNoPrefix);\n\n     // For backward compatibility. If prepended record path does not exist,\n</pre></div>\n\n\n<p>It looks like <code>common::exists</code> doesn't support paths starting with <code>file://</code>, so it thinks that the prepended path doesn't exist and tries to look at the original location.</p>\n<p>It looks like <code>file://</code> was added on purpose though - do you think it's ok to remove it, <span class=\"ap-mention\" data-atlassian-id=\"557058:ceb5942c-6843-408c-8550-3ce4899d299b\">@Mabel Zhang</span> ?</p>", "type": "rendered"}, "created_on": "2019-11-26T01:13:07.273838+00:00", "user": {"display_name": "Louise Poubel", "uuid": "{5cfa2075-477b-4ded-bdb9-8d2479544ec4}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D"}, "html": {"href": "https://bitbucket.org/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8/7d903d90-c5ea-4182-b7ef-0d467e9e1c74/128"}}, "nickname": "chapulina", "type": "user", "account_id": "557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8"}, "updated_on": "2019-11-26T01:13:07.288143+00:00", "type": "pullrequest_comment", "id": 126267527}, "pull_request": {"type": "pullrequest", "id": 397, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397"}}, "title": "[Blueprint] Logging meshes and materials"}}, {"comment": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397/comments/126266347.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397/_/diff#comment-126266347"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 397, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397"}}, "title": "[Blueprint] Logging meshes and materials"}, "content": {"raw": "This needs to be different for Windows. Maybe you could use `ignition::common::absPath` and check if the result is equal to the passed string :thinking: ", "markup": "markdown", "html": "<p>This needs to be different for Windows. Maybe you could use <code>ignition::common::absPath</code> and check if the result is equal to the passed string <img class=\"emoji\" src=\"data/pf-emoji-service--cdn.us-east-1.prod.public.atl-paas.net/standard/551c9814-1d37-4573-819d-afab3afeaf32/48x48/1f914.png\" alt=\"\ud83e\udd14\" title=\":thinking:\" data-emoji-short-name=\":thinking:\" /> </p>", "type": "rendered"}, "created_on": "2019-11-26T00:54:26.871249+00:00", "user": {"display_name": "Louise Poubel", "uuid": "{5cfa2075-477b-4ded-bdb9-8d2479544ec4}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D"}, "html": {"href": "https://bitbucket.org/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8/7d903d90-c5ea-4182-b7ef-0d467e9e1c74/128"}}, "nickname": "chapulina", "type": "user", "account_id": "557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8"}, "inline": {}, "updated_on": "2019-11-26T00:54:26.876841+00:00", "type": "pullrequest_comment", "id": 126266347}, "pull_request": {"type": "pullrequest", "id": 397, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397"}}, "title": "[Blueprint] Logging meshes and materials"}}, {"comment": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397/comments/126208188.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397/_/diff#comment-126208188"}}, "parent": {"id": 125861823, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397/comments/125861823.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397/_/diff#comment-125861823"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 397, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397"}}, "title": "[Blueprint] Logging meshes and materials"}, "content": {"raw": "There were some recent changes to sdformat and ign-gazebo that added support for relative URIs. [sdformat PR #558](https://bitbucket.org/osrf/sdformat/pull-requests/558/) added `sdf::Mesh::FilePath`, which returns the absolute path of the sdf file containing `<mesh>` entry. This can be used with `ignition::gazebo::asFullPath` (added in ign-gazebo PR #433) to get the path of the mesh from the geometry component in the ECM. [Here's](#!/ignitionrobotics/ign-gazebo/src/default/src/rendering/SceneManager.cc#lines-338) an example usage.", "markup": "markdown", "html": "<p>There were some recent changes to sdformat and ign-gazebo that added support for relative URIs. <a data-is-external-link=\"true\" href=\"https://bitbucket.org/osrf/sdformat/pull-requests/558/\" rel=\"nofollow\">sdformat PR #558</a> added <code>sdf::Mesh::FilePath</code>, which returns the absolute path of the sdf file containing <code>&lt;mesh&gt;</code> entry. This can be used with <code>ignition::gazebo::asFullPath</code> (added in ign-gazebo <a href=\"#!/ignitionrobotics/ign-gazebo/pull-requests/433/handle-relative-uris\" rel=\"nofollow\" class=\"ap-connect-link\">PR #433</a>) to get the path of the mesh from the geometry component in the ECM. <a data-is-external-link=\"true\" href=\"#!/ignitionrobotics/ign-gazebo/src/default/src/rendering/SceneManager.cc#lines-338\" rel=\"nofollow\">Here's</a> an example usage.</p>", "type": "rendered"}, "created_on": "2019-11-25T16:28:44.103067+00:00", "user": {"display_name": "Addisu Z. Taddese", "uuid": "{9d7fdc68-d270-4080-bf03-4df0d0dbf635}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B9d7fdc68-d270-4080-bf03-4df0d0dbf635%7D"}, "html": {"href": "https://bitbucket.org/%7B9d7fdc68-d270-4080-bf03-4df0d0dbf635%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:90bc87b0-2886-4377-a17c-3a6629a697ff/afbf9be5-1e4c-4810-89d4-e58831f34b11/128"}}, "nickname": "azeey", "type": "user", "account_id": "557058:90bc87b0-2886-4377-a17c-3a6629a697ff"}, "updated_on": "2019-11-25T16:28:44.116044+00:00", "type": "pullrequest_comment", "id": 126208188}, "pull_request": {"type": "pullrequest", "id": 397, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397"}}, "title": "[Blueprint] Logging meshes and materials"}}, {"comment": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397/comments/125861823.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397/_/diff#comment-125861823"}}, "parent": {"id": 125859401, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397/comments/125859401.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397/_/diff#comment-125859401"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 397, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397"}}, "title": "[Blueprint] Logging meshes and materials"}, "content": {"raw": "So, the plugin cannot know which path an SDF comes from, by the time the SDF element becomes a component in the ECM, right? That is when the recorder sees a relative path like `<uri>meshes/gazebo.dae</uri>`. By this point, the information of where the parent path of `meshes` is already lost. So the recorder doesn\u2019t have the information to resolve that path.", "markup": "markdown", "html": "<p>So, the plugin cannot know which path an SDF comes from, by the time the SDF element becomes a component in the ECM, right? That is when the recorder sees a relative path like <code>&lt;uri&gt;meshes/gazebo.dae&lt;/uri&gt;</code>. By this point, the information of where the parent path of <code>meshes</code> is already lost. So the recorder doesn\u2019t have the information to resolve that path.</p>", "type": "rendered"}, "created_on": "2019-11-21T20:33:17.602875+00:00", "user": {"display_name": "Mabel Zhang", "uuid": "{4b0e38fb-bf50-45c0-a496-61147518b2bf}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B4b0e38fb-bf50-45c0-a496-61147518b2bf%7D"}, "html": {"href": "https://bitbucket.org/%7B4b0e38fb-bf50-45c0-a496-61147518b2bf%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:ceb5942c-6843-408c-8550-3ce4899d299b/4d48e5ea-cf28-4fa7-9715-8fc9e315d831/128"}}, "nickname": "mabelmzhang", "type": "user", "account_id": "557058:ceb5942c-6843-408c-8550-3ce4899d299b"}, "updated_on": "2019-11-21T20:33:17.611478+00:00", "type": "pullrequest_comment", "id": 125861823}, "pull_request": {"type": "pullrequest", "id": 397, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397"}}, "title": "[Blueprint] Logging meshes and materials"}}, {"comment": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397/comments/125859401.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397/_/diff#comment-125859401"}}, "parent": {"id": 125333880, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397/comments/125333880.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397/_/diff#comment-125333880"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 397, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397"}}, "title": "[Blueprint] Logging meshes and materials"}, "content": {"raw": "Thanks for looking into it. Maybe I tried fixing conflicts by myself and caused the problem? Do you think you can fix them?", "markup": "markdown", "html": "<p>Thanks for looking into it. Maybe I tried fixing conflicts by myself and caused the problem? Do you think you can fix them?</p>", "type": "rendered"}, "created_on": "2019-11-21T20:13:18.690403+00:00", "user": {"display_name": "Louise Poubel", "uuid": "{5cfa2075-477b-4ded-bdb9-8d2479544ec4}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D"}, "html": {"href": "https://bitbucket.org/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8/7d903d90-c5ea-4182-b7ef-0d467e9e1c74/128"}}, "nickname": "chapulina", "type": "user", "account_id": "557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8"}, "updated_on": "2019-11-21T20:13:18.700761+00:00", "type": "pullrequest_comment", "id": 125859401}, "pull_request": {"type": "pullrequest", "id": 397, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397"}}, "title": "[Blueprint] Logging meshes and materials"}}, {"comment": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397/comments/125333880.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397/_/diff#comment-125333880"}}, "parent": {"id": 123600832, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397/comments/123600832.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397/_/diff#comment-123600832"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 397, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397"}}, "title": "[Blueprint] Logging meshes and materials"}, "content": {"raw": "Hmm, I think I see why Addisu mentioned something about relative paths in the meeting. When I comment out the `Gazebo - relative paths` line, then the `fuel.sdf` works.\n\nInspecting the debug messages, I see that a mesh URI is printed simply as `meshes/gazebo.dae`, while the other is printed as `file:///home/master/.ignition/fuel/fuel.ignitionrobotics.org/nate/models/my_Backpack/2//meshes/Backpack.dae`. The `meshes/gazebo.dae` is the URI specified in the `model.sdf` in `Gazebo - relative paths`, while the absolute path is specified in `Backpack.dae`.\n\nThat mesh URI is obtained from `_ecm.EachNew()` and then passed to `addModelResource(meshUri)` to be stored. Currently, that function handles paths beginning with `model://`, `file://`, and `/`. With the relative path `meshes/gazebo.dae`, it doesn\u2019t know what to prepend as the parent path in order to find the file, because that information isn\u2019t available from the ECM\u2026 or is it? Can it be obtained somewhere?", "markup": "markdown", "html": "<p>Hmm, I think I see why Addisu mentioned something about relative paths in the meeting. When I comment out the <code>Gazebo - relative paths</code> line, then the <code>fuel.sdf</code> works.</p>\n<p>Inspecting the debug messages, I see that a mesh URI is printed simply as <code>meshes/gazebo.dae</code>, while the other is printed as <code>file:///home/master/.ignition/fuel/fuel.ignitionrobotics.org/nate/models/my_Backpack/2//meshes/Backpack.dae</code>. The <code>meshes/gazebo.dae</code> is the URI specified in the <code>model.sdf</code> in <code>Gazebo - relative paths</code>, while the absolute path is specified in <code>Backpack.dae</code>.</p>\n<p>That mesh URI is obtained from <code>_ecm.EachNew()</code> and then passed to <code>addModelResource(meshUri)</code> to be stored. Currently, that function handles paths beginning with <code>model://</code>, <code>file://</code>, and <code>/</code>. With the relative path <code>meshes/gazebo.dae</code>, it doesn\u2019t know what to prepend as the parent path in order to find the file, because that information isn\u2019t available from the ECM\u2026 or is it? Can it be obtained somewhere?</p>", "type": "rendered"}, "created_on": "2019-11-19T08:56:58.249747+00:00", "user": {"display_name": "Mabel Zhang", "uuid": "{4b0e38fb-bf50-45c0-a496-61147518b2bf}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B4b0e38fb-bf50-45c0-a496-61147518b2bf%7D"}, "html": {"href": "https://bitbucket.org/%7B4b0e38fb-bf50-45c0-a496-61147518b2bf%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:ceb5942c-6843-408c-8550-3ce4899d299b/4d48e5ea-cf28-4fa7-9715-8fc9e315d831/128"}}, "nickname": "mabelmzhang", "type": "user", "account_id": "557058:ceb5942c-6843-408c-8550-3ce4899d299b"}, "updated_on": "2019-11-19T08:57:34.387838+00:00", "type": "pullrequest_comment", "id": 125333880}, "pull_request": {"type": "pullrequest", "id": 397, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397"}}, "title": "[Blueprint] Logging meshes and materials"}}, {"comment": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397/comments/123600832.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397/_/diff#comment-123600832"}}, "parent": {"id": 121763221, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397/comments/121763221.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397/_/diff#comment-121763221"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 397, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397"}}, "title": "[Blueprint] Logging meshes and materials"}, "content": {"raw": "This is still not working for me :confused: \n\n1. `ign gazebo -r -v 4 fuel.sdf --record-resources --record-path /tmp/log_test`\n1. `rm -rf ~/.ignition/fuel/fuel.ignitionrobotics.org/nate`\n1. `ign gazebo -v 4 --playback /tmp/log_test`\n\nAnd I get:\n\n`[GUI] [Err] [SystemPaths.cc:438] File [file:///home/chapulina/.ignition/fuel/fuel.ignitionrobotics.org/nate/models/my_Backpack/2//meshes/Backpack.dae] resolved to path [/home/c\nhapulina/.ignition/fuel/fuel.ignitionrobotics.org/nate/models/my_Backpack/2//meshes/Backpack.dae] but the path does not exist`\n\nI also noticed that under `/tmp/log_test/home/chapulina/.ignition/fuel/fuel.ignitionrobotics.org/` I have `nate`'s `my_backPack`, but not `chapulina`'s `Gazebo - relative paths`.", "markup": "markdown", "html": "<p>This is still not working for me <img class=\"emoji\" src=\"data/pf-emoji-service--cdn.us-east-1.prod.public.atl-paas.net/standard/551c9814-1d37-4573-819d-afab3afeaf32/48x48/1f615.png\" alt=\"\ud83d\ude15\" title=\":confused:\" data-emoji-short-name=\":confused:\" /> </p>\n<ol>\n<li><code>ign gazebo -r -v 4 fuel.sdf --record-resources --record-path /tmp/log_test</code></li>\n<li><code>rm -rf ~/.ignition/fuel/fuel.ignitionrobotics.org/nate</code></li>\n<li><code>ign gazebo -v 4 --playback /tmp/log_test</code></li>\n</ol>\n<p>And I get:</p>\n<p><code>[GUI] [Err] [SystemPaths.cc:438] File [file:///home/chapulina/.ignition/fuel/fuel.ignitionrobotics.org/nate/models/my_Backpack/2//meshes/Backpack.dae] resolved to path [/home/c\nhapulina/.ignition/fuel/fuel.ignitionrobotics.org/nate/models/my_Backpack/2//meshes/Backpack.dae] but the path does not exist</code></p>\n<p>I also noticed that under <code>/tmp/log_test/home/chapulina/.ignition/fuel/fuel.ignitionrobotics.org/</code> I have <code>nate</code>'s <code>my_backPack</code>, but not <code>chapulina</code>'s <code>Gazebo - relative paths</code>.</p>", "type": "rendered"}, "created_on": "2019-11-06T01:03:42.591129+00:00", "user": {"display_name": "Louise Poubel", "uuid": "{5cfa2075-477b-4ded-bdb9-8d2479544ec4}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D"}, "html": {"href": "https://bitbucket.org/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8/7d903d90-c5ea-4182-b7ef-0d467e9e1c74/128"}}, "nickname": "chapulina", "type": "user", "account_id": "557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8"}, "updated_on": "2019-11-06T01:03:42.599882+00:00", "type": "pullrequest_comment", "id": 123600832}, "pull_request": {"type": "pullrequest", "id": 397, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397"}}, "title": "[Blueprint] Logging meshes and materials"}}, {"approval": {"date": "2019-10-22T18:55:01.224002+00:00", "pullrequest": {"type": "pullrequest", "id": 397, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397"}}, "title": "[Blueprint] Logging meshes and materials"}, "user": {"display_name": "Nate Koenig", "uuid": "{c862cdd9-fcc8-4419-9fc7-e20db14b8fcb}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Bc862cdd9-fcc8-4419-9fc7-e20db14b8fcb%7D"}, "html": {"href": "https://bitbucket.org/%7Bc862cdd9-fcc8-4419-9fc7-e20db14b8fcb%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:095b1e12-74ed-4e20-b44f-2f0745b616e0/ca24bb11-4787-4b14-a20d-d91835e9bde2/128"}}, "nickname": "Nathan Koenig", "type": "user", "account_id": "557058:095b1e12-74ed-4e20-b44f-2f0745b616e0"}}, "pull_request": {"type": "pullrequest", "id": 397, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397"}}, "title": "[Blueprint] Logging meshes and materials"}}, {"comment": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397/comments/121763221.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397/_/diff#comment-121763221"}}, "parent": {"id": 121756475, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397/comments/121756475.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397/_/diff#comment-121756475"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 397, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397"}}, "title": "[Blueprint] Logging meshes and materials"}, "content": {"raw": "Thanks. That seems to work.", "markup": "markdown", "html": "<p>Thanks. That seems to work.</p>", "type": "rendered"}, "created_on": "2019-10-22T18:44:24.627164+00:00", "user": {"display_name": "Nate Koenig", "uuid": "{c862cdd9-fcc8-4419-9fc7-e20db14b8fcb}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Bc862cdd9-fcc8-4419-9fc7-e20db14b8fcb%7D"}, "html": {"href": "https://bitbucket.org/%7Bc862cdd9-fcc8-4419-9fc7-e20db14b8fcb%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:095b1e12-74ed-4e20-b44f-2f0745b616e0/ca24bb11-4787-4b14-a20d-d91835e9bde2/128"}}, "nickname": "Nathan Koenig", "type": "user", "account_id": "557058:095b1e12-74ed-4e20-b44f-2f0745b616e0"}, "updated_on": "2019-10-22T18:44:24.636807+00:00", "type": "pullrequest_comment", "id": 121763221}, "pull_request": {"type": "pullrequest", "id": 397, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397"}}, "title": "[Blueprint] Logging meshes and materials"}}, {"comment": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397/comments/121756475.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397/_/diff#comment-121756475"}}, "parent": {"id": 121743491, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397/comments/121743491.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397/_/diff#comment-121743491"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 397, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397"}}, "title": "[Blueprint] Logging meshes and materials"}, "content": {"raw": "I tried to handle backward compatibility in 7d8f060. Could you give it another spin?\n\nSince we can\u2019t tell what version of the plugin was used to record the log files, I simply check if the URI prepended with the playback path exists. If it doesn\u2019t exist, then playback assumes that the file was recorded using an older version, and the playback log path is not prepended. In this case it just would leave the path alone as `~/.ignition/fuel/...`.", "markup": "markdown", "html": "<p>I tried to handle backward compatibility in <a href=\"#!/ignitionrobotics/ign-gazebo/commits/7d8f060\" rel=\"nofollow\" class=\"ap-connect-link\">7d8f060</a>. Could you give it another spin?</p>\n<p>Since we can\u2019t tell what version of the plugin was used to record the log files, I simply check if the URI prepended with the playback path exists. If it doesn\u2019t exist, then playback assumes that the file was recorded using an older version, and the playback log path is not prepended. In this case it just would leave the path alone as <code>~/.ignition/fuel/...</code>.</p>", "type": "rendered"}, "created_on": "2019-10-22T17:52:49.146603+00:00", "user": {"display_name": "Mabel Zhang", "uuid": "{4b0e38fb-bf50-45c0-a496-61147518b2bf}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B4b0e38fb-bf50-45c0-a496-61147518b2bf%7D"}, "html": {"href": "https://bitbucket.org/%7B4b0e38fb-bf50-45c0-a496-61147518b2bf%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:ceb5942c-6843-408c-8550-3ce4899d299b/4d48e5ea-cf28-4fa7-9715-8fc9e315d831/128"}}, "nickname": "mabelmzhang", "type": "user", "account_id": "557058:ceb5942c-6843-408c-8550-3ce4899d299b"}, "updated_on": "2019-10-22T17:53:34.612442+00:00", "type": "pullrequest_comment", "id": 121756475}, "pull_request": {"type": "pullrequest", "id": 397, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397"}}, "title": "[Blueprint] Logging meshes and materials"}}, {"update": {"description": "Depends on [ign-common PR 200](#!/ignitionrobotics/ign-common/pull-requests/200/log-resources/diff).\r\n\r\nPorts [this Gazebo PR](https://bitbucket.org/osrf/gazebo/pull-requests/2811/save-models-material-and-meshes-when/diff) to Ignition.\r\n\r\nImplements `--record-resources`, and `--log-compress` and `--log-overwrite` to support it.\r\n\r\nRecords resources \\(`--record-resources`\\), i.e. meshes and materials, to a directory under the specified log record directory. Optionally compresses \\(`--log-compress`\\) the whole directory, which contains the existing `.tlog` sqlite3 file and any resources, to a zip file. If directory or compressed file already exist, optionally overwrites \\(`--log-overwrite`\\).\r\n\r\nCorresponding SDF plugin parameters: `<record_resources>1</record_resources>`, `<compress>1</compress>.`If both command line and SDF parameters are specified, command line option overwrites SDF parameter. `--log-overwrite` is handled on command line only, outside of the plugin. If recording is only enabled from SDF and not from command line, then behavior is to always overwrite.\r\n\r\n## Usage:\r\n\r\n```\r\nign gazebo [...] --record-resources --log-overwrite --log-compress\r\n```\r\n\r\n## Test --record-resources:\r\n\r\n```\r\n# This SDF specifies the equivalent of --record-resources --record-path '/tmp/log'\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf\r\n$ ign gazebo -v 4 -r examples/worlds/log_playback.sdf\r\n```\r\n\r\nTested with `<include><uri>https://fuel...</uri></include>` and `<mesh><uri>file://...</uri></mesh>`. Paths specified by `model://` are not supported in Ignition yet, so this case in the code is not tested.\r\n\r\n## Test --log-overwrite and --log-compress:\r\n\r\nWhen recording to `path`, the compression file is implied to be `path.zip`. Both are checked for existence.\r\n\r\nNo `--log-overwrite` \\(default\\):\r\n\r\n```\r\n# This SDF specifies the equivalent of --record-path '/tmp/log'\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf\r\n\r\n# Run it again. By default it will always overwrite, because overwrite is now taken care of in ign.cc\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf\r\n[Msg] Overwriting existing file [/tmp/log/state.tlog]\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n```\r\n\r\n`--log-overwrite`, `/tmp/log` already exists:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-overwrite --record-path '/tmp/log'\r\n[Msg] Log path already exists on disk! Existing files will be overwritten.\r\n[Msg] Removing existing path [/tmp/log]\r\n...\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n...\r\n[Msg] Stopping recording\r\n```\r\n\r\n`--log-overwrite --log-compress`, `/tmp/log` exists, `/tmp/log.zip` does not exist:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-compress --log-overwrite --record-path '/tmp/log'\r\n[Msg] Log path already exists on disk! Existing files will be overwritten.\r\n[Msg] Removing existing path [/tmp/log]\r\n...\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n...\r\n[Msg] Compressed log file and resources to [/tmp/log.zip].\r\nRemoving recorded directory [/tmp/log].\r\n[Msg] Stopping recording\r\n```\r\n\r\n`--log-overwrite --log-compress`, `/tmp/log` does not exist, `/tmp/log.zip` exists:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-compress --log-overwrite --record-path '/tmp/log'\r\n[Wrn] [ign.cc:121] Compressed log path already exists on disk! Existing files will be overwritten.\r\n[Msg] Removing existing compressed file [/tmp/log.zip]\r\n...\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n...\r\n[Msg] Compressed log file and resources to [/tmp/log.zip].\r\nRemoving recorded directory [/tmp/log].\r\n[Msg] Stopping recording\r\n```\r\n\r\n`--log-overwrite` only, `/tmp/log.zip` exists, `/tmp/log` does not exist:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-overwrite --record-path '/tmp/log'\r\n[Wrn] [ign.cc:121] Compressed log path already exists on disk! Existing files will be overwritten.\r\n[Msg] Removing existing compressed file [/tmp/log.zip]\r\n...\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n...\r\n[Msg] Stopping recording\r\n```\r\n\r\n`--log-compress` only, both `/tmp/log` and `/tmp/log.zip` already exist:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-compress --record-path '/tmp/log'\r\n[Wrn] [ign.cc:152] Log path already exists on disk! Recording instead to [/tmp/log(1)]\r\n[Wrn] [ign.cc:154] Compressed log path already exists on disk! Recording instead to [/tmp/log(1).zip]\r\n...\r\n[Msg] Recording to log file [/tmp/log(1)/state.tlog]\r\n...\r\n[Msg] Compressed log file and resources to [/tmp/log(1).zip].\r\nRemoving recorded directory [/tmp/log(1)].\r\n[Msg] Stopping recording\r\n$ ls /tmp\r\nlog\r\n'log(1).zip'\r\nlog.zip\r\n```\r\n\r\n`--log-compress` only, `/tmp/log` does not exist, `/tmp/log.zip` exists, `/tmp/log(1).zip` exists:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-compress --record-path '/tmp/log'\r\n[Wrn] [ign.cc:152] Log path already exists on disk! Recording instead to [/tmp/log(2)]\r\n[Wrn] [ign.cc:154] Compressed log path already exists on disk! Recording instead to [/tmp/log(2).zip]\r\n...\r\n[Msg] Recording to log file [/tmp/log(2)/state.tlog]\r\n...\r\n[Msg] Compressed log file and resources to [/tmp/log(2).zip].\r\nRemoving recorded directory [/tmp/log(2)].\r\n[Msg] Stopping recording\r\n```\r\n\r\n## Record Path vs. Console Log Path\r\n\r\nIn Blueprint and Citadel, if `--record` is specified without `--record-path`, and `<path>` exists in SDF, a warning is printed, and recording will go to `<path>`, while console log will go to the default timestamp path.\r\n\r\nAs in this example:\r\n\r\n```\r\n# SDF specifies <path>/tmp/log</path>\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --record --log-compress -log-overwrite\r\n[Wrn] [ServerPrivate.cc:229] --record-path is not specified on command line. <path> is specified in SDF. Will record to <path>. Console will be logged to [/home/master/.ignition/gazebo/log/2019-09-20T19:51:33.996055619]. Note: In Ignition-D, <path> will be ignored, and all recordings will be written to default console log path if no path is specified on command line.\r\n[Msg] Overwriting existing file [/tmp/log/state.tlog]\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n...\r\n[Msg] Removing existing file [/tmp/log.zip].\r\n[Msg] Compressed log file and resources to [/tmp/log.zip].\r\nRemoving recorded directory [/tmp/log].\r\n```\r\n\r\nIn Ignition-D, `<path>` will be permanently ignored. Recordings and console log will go to same default path.\r\n\r\nIf `--record-path` is specified, then recording and console log will go to this path in Blueprint, Citadel, and Ignition-D.\r\n\r\n## Future Work\r\n\r\nFiles are outputted in `/tmp/log` and `/tmp/log.zip` in this example. During record, the original path in `file://` is prepended with the specified path, e.g. `/tmp/log`. During playback, the specified path is prepended to the URIs in the SDF.", "title": "[Blueprint] Logging meshes and materials", "destination": {"commit": {"hash": "4b8ff8874ee1", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/commit/4b8ff8874ee1.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/commits/4b8ff8874ee1"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{f98d11fe-f287-4dfb-99c3-e2b76a13232e}ts=2082645"}}, "type": "repository", "name": "ign-gazebo", "full_name": "ignitionrobotics/ign-gazebo", "uuid": "{f98d11fe-f287-4dfb-99c3-e2b76a13232e}"}, "branch": {"name": "ign-gazebo2"}}, "reason": "", "source": {"commit": {"hash": "14b400a699f9", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/commit/14b400a699f9.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/commits/14b400a699f9"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{f98d11fe-f287-4dfb-99c3-e2b76a13232e}ts=2082645"}}, "type": "repository", "name": "ign-gazebo", "full_name": "ignitionrobotics/ign-gazebo", "uuid": "{f98d11fe-f287-4dfb-99c3-e2b76a13232e}"}, "branch": {"name": "log_resources"}}, "state": "OPEN", "author": {"display_name": "Mabel Zhang", "uuid": "{4b0e38fb-bf50-45c0-a496-61147518b2bf}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B4b0e38fb-bf50-45c0-a496-61147518b2bf%7D"}, "html": {"href": "https://bitbucket.org/%7B4b0e38fb-bf50-45c0-a496-61147518b2bf%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:ceb5942c-6843-408c-8550-3ce4899d299b/4d48e5ea-cf28-4fa7-9715-8fc9e315d831/128"}}, "nickname": "mabelmzhang", "type": "user", "account_id": "557058:ceb5942c-6843-408c-8550-3ce4899d299b"}, "date": "2019-10-22T17:50:14.201550+00:00"}, "pull_request": {"type": "pullrequest", "id": 397, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397"}}, "title": "[Blueprint] Logging meshes and materials"}}, {"comment": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397/comments/121743491.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397/_/diff#comment-121743491"}}, "parent": {"id": 121740729, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397/comments/121740729.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397/_/diff#comment-121740729"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 397, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397"}}, "title": "[Blueprint] Logging meshes and materials"}, "content": {"raw": "I think this breaks playback of existing log files, log files that were created without this PR. I see the following:\n\n```\n[GUI] [Err] [SystemPaths.cc:438] File [file:///media/nkoenig/data/subt/gz-logs/Kankanwadi/93f2b64b-a026-4c9c-80eb-cd7e741b6146-c-1-r-1/logs//home/developer/.ignition/fuel/fuel.ignitionrobotics.org/openrobotics/models/Rescue Randy Sitting/1//meshes/rescue_randy.dae] resolved to path [/media/nkoenig/data/subt/gz-logs/Kankanwadi/93f2b64b-a026-4c9c-80eb-cd7e741b6146-c-1-r-1/logs//home/developer/.ignition/fuel/fuel.ignitionrobotics.org/openrobotics/models/Rescue Randy Sitting/1//meshes/rescue_randy.dae] but the path does not exist\n```", "markup": "markdown", "html": "<p>I think this breaks playback of existing log files, log files that were created without this PR. I see the following:</p>\n<div class=\"codehilite\"><pre><span></span>[GUI] [Err] [SystemPaths.cc:438] File [file:///media/nkoenig/data/subt/gz-logs/Kankanwadi/93f2b64b-a026-4c9c-80eb-cd7e741b6146-c-1-r-1/logs//home/developer/.ignition/fuel/fuel.ignitionrobotics.org/openrobotics/models/Rescue Randy Sitting/1//meshes/rescue_randy.dae] resolved to path [/media/nkoenig/data/subt/gz-logs/Kankanwadi/93f2b64b-a026-4c9c-80eb-cd7e741b6146-c-1-r-1/logs//home/developer/.ignition/fuel/fuel.ignitionrobotics.org/openrobotics/models/Rescue Randy Sitting/1//meshes/rescue_randy.dae] but the path does not exist\n</pre></div>", "type": "rendered"}, "created_on": "2019-10-22T16:23:19.400099+00:00", "user": {"display_name": "Nate Koenig", "uuid": "{c862cdd9-fcc8-4419-9fc7-e20db14b8fcb}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Bc862cdd9-fcc8-4419-9fc7-e20db14b8fcb%7D"}, "html": {"href": "https://bitbucket.org/%7Bc862cdd9-fcc8-4419-9fc7-e20db14b8fcb%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:095b1e12-74ed-4e20-b44f-2f0745b616e0/ca24bb11-4787-4b14-a20d-d91835e9bde2/128"}}, "nickname": "Nathan Koenig", "type": "user", "account_id": "557058:095b1e12-74ed-4e20-b44f-2f0745b616e0"}, "updated_on": "2019-10-22T16:23:19.410575+00:00", "type": "pullrequest_comment", "id": 121743491}, "pull_request": {"type": "pullrequest", "id": 397, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397"}}, "title": "[Blueprint] Logging meshes and materials"}}, {"comment": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397/comments/121740729.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397/_/diff#comment-121740729"}}, "parent": {"id": 120662974, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397/comments/120662974.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397/_/diff#comment-120662974"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 397, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397"}}, "title": "[Blueprint] Logging meshes and materials"}, "content": {"raw": "It works!", "markup": "markdown", "html": "<p>It works!</p>", "type": "rendered"}, "created_on": "2019-10-22T16:06:15.367149+00:00", "user": {"display_name": "Nate Koenig", "uuid": "{c862cdd9-fcc8-4419-9fc7-e20db14b8fcb}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Bc862cdd9-fcc8-4419-9fc7-e20db14b8fcb%7D"}, "html": {"href": "https://bitbucket.org/%7Bc862cdd9-fcc8-4419-9fc7-e20db14b8fcb%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:095b1e12-74ed-4e20-b44f-2f0745b616e0/ca24bb11-4787-4b14-a20d-d91835e9bde2/128"}}, "nickname": "Nathan Koenig", "type": "user", "account_id": "557058:095b1e12-74ed-4e20-b44f-2f0745b616e0"}, "updated_on": "2019-10-22T16:06:15.375810+00:00", "type": "pullrequest_comment", "id": 121740729}, "pull_request": {"type": "pullrequest", "id": 397, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397"}}, "title": "[Blueprint] Logging meshes and materials"}}, {"update": {"description": "Depends on [ign-common PR 200](#!/ignitionrobotics/ign-common/pull-requests/200/log-resources/diff).\r\n\r\nPorts [this Gazebo PR](https://bitbucket.org/osrf/gazebo/pull-requests/2811/save-models-material-and-meshes-when/diff) to Ignition.\r\n\r\nImplements `--record-resources`, and `--log-compress` and `--log-overwrite` to support it.\r\n\r\nRecords resources \\(`--record-resources`\\), i.e. meshes and materials, to a directory under the specified log record directory. Optionally compresses \\(`--log-compress`\\) the whole directory, which contains the existing `.tlog` sqlite3 file and any resources, to a zip file. If directory or compressed file already exist, optionally overwrites \\(`--log-overwrite`\\).\r\n\r\nCorresponding SDF plugin parameters: `<record_resources>1</record_resources>`, `<compress>1</compress>.`If both command line and SDF parameters are specified, command line option overwrites SDF parameter. `--log-overwrite` is handled on command line only, outside of the plugin. If recording is only enabled from SDF and not from command line, then behavior is to always overwrite.\r\n\r\n## Usage:\r\n\r\n```\r\nign gazebo [...] --record-resources --log-overwrite --log-compress\r\n```\r\n\r\n## Test --record-resources:\r\n\r\n```\r\n# This SDF specifies the equivalent of --record-resources --record-path '/tmp/log'\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf\r\n$ ign gazebo -v 4 -r examples/worlds/log_playback.sdf\r\n```\r\n\r\nTested with `<include><uri>https://fuel...</uri></include>` and `<mesh><uri>file://...</uri></mesh>`. Paths specified by `model://` are not supported in Ignition yet, so this case in the code is not tested.\r\n\r\n## Test --log-overwrite and --log-compress:\r\n\r\nWhen recording to `path`, the compression file is implied to be `path.zip`. Both are checked for existence.\r\n\r\nNo `--log-overwrite` \\(default\\):\r\n\r\n```\r\n# This SDF specifies the equivalent of --record-path '/tmp/log'\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf\r\n\r\n# Run it again. By default it will always overwrite, because overwrite is now taken care of in ign.cc\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf\r\n[Msg] Overwriting existing file [/tmp/log/state.tlog]\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n```\r\n\r\n`--log-overwrite`, `/tmp/log` already exists:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-overwrite --record-path '/tmp/log'\r\n[Msg] Log path already exists on disk! Existing files will be overwritten.\r\n[Msg] Removing existing path [/tmp/log]\r\n...\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n...\r\n[Msg] Stopping recording\r\n```\r\n\r\n`--log-overwrite --log-compress`, `/tmp/log` exists, `/tmp/log.zip` does not exist:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-compress --log-overwrite --record-path '/tmp/log'\r\n[Msg] Log path already exists on disk! Existing files will be overwritten.\r\n[Msg] Removing existing path [/tmp/log]\r\n...\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n...\r\n[Msg] Compressed log file and resources to [/tmp/log.zip].\r\nRemoving recorded directory [/tmp/log].\r\n[Msg] Stopping recording\r\n```\r\n\r\n`--log-overwrite --log-compress`, `/tmp/log` does not exist, `/tmp/log.zip` exists:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-compress --log-overwrite --record-path '/tmp/log'\r\n[Wrn] [ign.cc:121] Compressed log path already exists on disk! Existing files will be overwritten.\r\n[Msg] Removing existing compressed file [/tmp/log.zip]\r\n...\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n...\r\n[Msg] Compressed log file and resources to [/tmp/log.zip].\r\nRemoving recorded directory [/tmp/log].\r\n[Msg] Stopping recording\r\n```\r\n\r\n`--log-overwrite` only, `/tmp/log.zip` exists, `/tmp/log` does not exist:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-overwrite --record-path '/tmp/log'\r\n[Wrn] [ign.cc:121] Compressed log path already exists on disk! Existing files will be overwritten.\r\n[Msg] Removing existing compressed file [/tmp/log.zip]\r\n...\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n...\r\n[Msg] Stopping recording\r\n```\r\n\r\n`--log-compress` only, both `/tmp/log` and `/tmp/log.zip` already exist:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-compress --record-path '/tmp/log'\r\n[Wrn] [ign.cc:152] Log path already exists on disk! Recording instead to [/tmp/log(1)]\r\n[Wrn] [ign.cc:154] Compressed log path already exists on disk! Recording instead to [/tmp/log(1).zip]\r\n...\r\n[Msg] Recording to log file [/tmp/log(1)/state.tlog]\r\n...\r\n[Msg] Compressed log file and resources to [/tmp/log(1).zip].\r\nRemoving recorded directory [/tmp/log(1)].\r\n[Msg] Stopping recording\r\n$ ls /tmp\r\nlog\r\n'log(1).zip'\r\nlog.zip\r\n```\r\n\r\n`--log-compress` only, `/tmp/log` does not exist, `/tmp/log.zip` exists, `/tmp/log(1).zip` exists:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-compress --record-path '/tmp/log'\r\n[Wrn] [ign.cc:152] Log path already exists on disk! Recording instead to [/tmp/log(2)]\r\n[Wrn] [ign.cc:154] Compressed log path already exists on disk! Recording instead to [/tmp/log(2).zip]\r\n...\r\n[Msg] Recording to log file [/tmp/log(2)/state.tlog]\r\n...\r\n[Msg] Compressed log file and resources to [/tmp/log(2).zip].\r\nRemoving recorded directory [/tmp/log(2)].\r\n[Msg] Stopping recording\r\n```\r\n\r\n## Record Path vs. Console Log Path\r\n\r\nIn Blueprint and Citadel, if `--record` is specified without `--record-path`, and `<path>` exists in SDF, a warning is printed, and recording will go to `<path>`, while console log will go to the default timestamp path.\r\n\r\nAs in this example:\r\n\r\n```\r\n# SDF specifies <path>/tmp/log</path>\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --record --log-compress -log-overwrite\r\n[Wrn] [ServerPrivate.cc:229] --record-path is not specified on command line. <path> is specified in SDF. Will record to <path>. Console will be logged to [/home/master/.ignition/gazebo/log/2019-09-20T19:51:33.996055619]. Note: In Ignition-D, <path> will be ignored, and all recordings will be written to default console log path if no path is specified on command line.\r\n[Msg] Overwriting existing file [/tmp/log/state.tlog]\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n...\r\n[Msg] Removing existing file [/tmp/log.zip].\r\n[Msg] Compressed log file and resources to [/tmp/log.zip].\r\nRemoving recorded directory [/tmp/log].\r\n```\r\n\r\nIn Ignition-D, `<path>` will be permanently ignored. Recordings and console log will go to same default path.\r\n\r\nIf `--record-path` is specified, then recording and console log will go to this path in Blueprint, Citadel, and Ignition-D.\r\n\r\n## Future Work\r\n\r\nFiles are outputted in `/tmp/log` and `/tmp/log.zip` in this example. During record, the original path in `file://` is prepended with the specified path, e.g. `/tmp/log`. During playback, the specified path is prepended to the URIs in the SDF.", "title": "[Blueprint] Logging meshes and materials", "destination": {"commit": {"hash": "b376ddd76f5b", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/commit/b376ddd76f5b.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/commits/b376ddd76f5b"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{f98d11fe-f287-4dfb-99c3-e2b76a13232e}ts=2082645"}}, "type": "repository", "name": "ign-gazebo", "full_name": "ignitionrobotics/ign-gazebo", "uuid": "{f98d11fe-f287-4dfb-99c3-e2b76a13232e}"}, "branch": {"name": "ign-gazebo2"}}, "reason": "", "source": {"commit": {"hash": "37521f8f4b8f", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/commit/37521f8f4b8f.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/commits/37521f8f4b8f"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{f98d11fe-f287-4dfb-99c3-e2b76a13232e}ts=2082645"}}, "type": "repository", "name": "ign-gazebo", "full_name": "ignitionrobotics/ign-gazebo", "uuid": "{f98d11fe-f287-4dfb-99c3-e2b76a13232e}"}, "branch": {"name": "log_resources"}}, "state": "OPEN", "author": {"display_name": "Mabel Zhang", "uuid": "{4b0e38fb-bf50-45c0-a496-61147518b2bf}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B4b0e38fb-bf50-45c0-a496-61147518b2bf%7D"}, "html": {"href": "https://bitbucket.org/%7B4b0e38fb-bf50-45c0-a496-61147518b2bf%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:ceb5942c-6843-408c-8550-3ce4899d299b/4d48e5ea-cf28-4fa7-9715-8fc9e315d831/128"}}, "nickname": "mabelmzhang", "type": "user", "account_id": "557058:ceb5942c-6843-408c-8550-3ce4899d299b"}, "date": "2019-10-15T00:02:32.402176+00:00"}, "pull_request": {"type": "pullrequest", "id": 397, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397"}}, "title": "[Blueprint] Logging meshes and materials"}}, {"comment": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397/comments/120662974.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397/_/diff#comment-120662974"}}, "parent": {"id": 119972108, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397/comments/119972108.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397/_/diff#comment-119972108"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 397, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397"}}, "title": "[Blueprint] Logging meshes and materials"}, "content": {"raw": "Let\u2019s try that again\u2026 relative paths should be handled now in af9ee60.\n\nIt should work for both command line and plugin SDF `<path></path>` record and playback. The two cases above should work now. To test the SDF part, relative path can be specified in the LogRecord \\(`log_record_resources.sdf`\\) and LogPlayback plugins \\(`log_playback.sdf`\\) like so:\n\n```\n<path>log</path>\n```\n\n`common::cwd()` is prepended when a relative path is specified.", "markup": "markdown", "html": "<p>Let\u2019s try that again\u2026 relative paths should be handled now in <a href=\"#!/ignitionrobotics/ign-gazebo/commits/af9ee60\" rel=\"nofollow\" class=\"ap-connect-link\">af9ee60</a>.</p>\n<p>It should work for both command line and plugin SDF <code>&lt;path&gt;&lt;/path&gt;</code> record and playback. The two cases above should work now. To test the SDF part, relative path can be specified in the LogRecord (<code>log_record_resources.sdf</code>) and LogPlayback plugins (<code>log_playback.sdf</code>) like so:</p>\n<div class=\"codehilite\"><pre><span></span><span class=\"nt\">&lt;path&gt;</span>log<span class=\"nt\">&lt;/path&gt;</span>\n</pre></div>\n\n\n<p><code>common::cwd()</code> is prepended when a relative path is specified.</p>", "type": "rendered"}, "created_on": "2019-10-14T23:14:26.920445+00:00", "user": {"display_name": "Mabel Zhang", "uuid": "{4b0e38fb-bf50-45c0-a496-61147518b2bf}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B4b0e38fb-bf50-45c0-a496-61147518b2bf%7D"}, "html": {"href": "https://bitbucket.org/%7B4b0e38fb-bf50-45c0-a496-61147518b2bf%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:ceb5942c-6843-408c-8550-3ce4899d299b/4d48e5ea-cf28-4fa7-9715-8fc9e315d831/128"}}, "nickname": "mabelmzhang", "type": "user", "account_id": "557058:ceb5942c-6843-408c-8550-3ce4899d299b"}, "updated_on": "2019-10-14T23:24:25.207440+00:00", "type": "pullrequest_comment", "id": 120662974}, "pull_request": {"type": "pullrequest", "id": 397, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397"}}, "title": "[Blueprint] Logging meshes and materials"}}, {"update": {"description": "Depends on [ign-common PR 200](#!/ignitionrobotics/ign-common/pull-requests/200/log-resources/diff).\r\n\r\nPorts [this Gazebo PR](https://bitbucket.org/osrf/gazebo/pull-requests/2811/save-models-material-and-meshes-when/diff) to Ignition.\r\n\r\nImplements `--record-resources`, and `--log-compress` and `--log-overwrite` to support it.\r\n\r\nRecords resources \\(`--record-resources`\\), i.e. meshes and materials, to a directory under the specified log record directory. Optionally compresses \\(`--log-compress`\\) the whole directory, which contains the existing `.tlog` sqlite3 file and any resources, to a zip file. If directory or compressed file already exist, optionally overwrites \\(`--log-overwrite`\\).\r\n\r\nCorresponding SDF plugin parameters: `<record_resources>1</record_resources>`, `<compress>1</compress>.`If both command line and SDF parameters are specified, command line option overwrites SDF parameter. `--log-overwrite` is handled on command line only, outside of the plugin. If recording is only enabled from SDF and not from command line, then behavior is to always overwrite.\r\n\r\n## Usage:\r\n\r\n```\r\nign gazebo [...] --record-resources --log-overwrite --log-compress\r\n```\r\n\r\n## Test --record-resources:\r\n\r\n```\r\n# This SDF specifies the equivalent of --record-resources --record-path '/tmp/log'\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf\r\n$ ign gazebo -v 4 -r examples/worlds/log_playback.sdf\r\n```\r\n\r\nTested with `<include><uri>https://fuel...</uri></include>` and `<mesh><uri>file://...</uri></mesh>`. Paths specified by `model://` are not supported in Ignition yet, so this case in the code is not tested.\r\n\r\n## Test --log-overwrite and --log-compress:\r\n\r\nWhen recording to `path`, the compression file is implied to be `path.zip`. Both are checked for existence.\r\n\r\nNo `--log-overwrite` \\(default\\):\r\n\r\n```\r\n# This SDF specifies the equivalent of --record-path '/tmp/log'\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf\r\n\r\n# Run it again. By default it will always overwrite, because overwrite is now taken care of in ign.cc\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf\r\n[Msg] Overwriting existing file [/tmp/log/state.tlog]\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n```\r\n\r\n`--log-overwrite`, `/tmp/log` already exists:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-overwrite --record-path '/tmp/log'\r\n[Msg] Log path already exists on disk! Existing files will be overwritten.\r\n[Msg] Removing existing path [/tmp/log]\r\n...\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n...\r\n[Msg] Stopping recording\r\n```\r\n\r\n`--log-overwrite --log-compress`, `/tmp/log` exists, `/tmp/log.zip` does not exist:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-compress --log-overwrite --record-path '/tmp/log'\r\n[Msg] Log path already exists on disk! Existing files will be overwritten.\r\n[Msg] Removing existing path [/tmp/log]\r\n...\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n...\r\n[Msg] Compressed log file and resources to [/tmp/log.zip].\r\nRemoving recorded directory [/tmp/log].\r\n[Msg] Stopping recording\r\n```\r\n\r\n`--log-overwrite --log-compress`, `/tmp/log` does not exist, `/tmp/log.zip` exists:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-compress --log-overwrite --record-path '/tmp/log'\r\n[Wrn] [ign.cc:121] Compressed log path already exists on disk! Existing files will be overwritten.\r\n[Msg] Removing existing compressed file [/tmp/log.zip]\r\n...\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n...\r\n[Msg] Compressed log file and resources to [/tmp/log.zip].\r\nRemoving recorded directory [/tmp/log].\r\n[Msg] Stopping recording\r\n```\r\n\r\n`--log-overwrite` only, `/tmp/log.zip` exists, `/tmp/log` does not exist:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-overwrite --record-path '/tmp/log'\r\n[Wrn] [ign.cc:121] Compressed log path already exists on disk! Existing files will be overwritten.\r\n[Msg] Removing existing compressed file [/tmp/log.zip]\r\n...\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n...\r\n[Msg] Stopping recording\r\n```\r\n\r\n`--log-compress` only, both `/tmp/log` and `/tmp/log.zip` already exist:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-compress --record-path '/tmp/log'\r\n[Wrn] [ign.cc:152] Log path already exists on disk! Recording instead to [/tmp/log(1)]\r\n[Wrn] [ign.cc:154] Compressed log path already exists on disk! Recording instead to [/tmp/log(1).zip]\r\n...\r\n[Msg] Recording to log file [/tmp/log(1)/state.tlog]\r\n...\r\n[Msg] Compressed log file and resources to [/tmp/log(1).zip].\r\nRemoving recorded directory [/tmp/log(1)].\r\n[Msg] Stopping recording\r\n$ ls /tmp\r\nlog\r\n'log(1).zip'\r\nlog.zip\r\n```\r\n\r\n`--log-compress` only, `/tmp/log` does not exist, `/tmp/log.zip` exists, `/tmp/log(1).zip` exists:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-compress --record-path '/tmp/log'\r\n[Wrn] [ign.cc:152] Log path already exists on disk! Recording instead to [/tmp/log(2)]\r\n[Wrn] [ign.cc:154] Compressed log path already exists on disk! Recording instead to [/tmp/log(2).zip]\r\n...\r\n[Msg] Recording to log file [/tmp/log(2)/state.tlog]\r\n...\r\n[Msg] Compressed log file and resources to [/tmp/log(2).zip].\r\nRemoving recorded directory [/tmp/log(2)].\r\n[Msg] Stopping recording\r\n```\r\n\r\n## Record Path vs. Console Log Path\r\n\r\nIn Blueprint and Citadel, if `--record` is specified without `--record-path`, and `<path>` exists in SDF, a warning is printed, and recording will go to `<path>`, while console log will go to the default timestamp path.\r\n\r\nAs in this example:\r\n\r\n```\r\n# SDF specifies <path>/tmp/log</path>\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --record --log-compress -log-overwrite\r\n[Wrn] [ServerPrivate.cc:229] --record-path is not specified on command line. <path> is specified in SDF. Will record to <path>. Console will be logged to [/home/master/.ignition/gazebo/log/2019-09-20T19:51:33.996055619]. Note: In Ignition-D, <path> will be ignored, and all recordings will be written to default console log path if no path is specified on command line.\r\n[Msg] Overwriting existing file [/tmp/log/state.tlog]\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n...\r\n[Msg] Removing existing file [/tmp/log.zip].\r\n[Msg] Compressed log file and resources to [/tmp/log.zip].\r\nRemoving recorded directory [/tmp/log].\r\n```\r\n\r\nIn Ignition-D, `<path>` will be permanently ignored. Recordings and console log will go to same default path.\r\n\r\nIf `--record-path` is specified, then recording and console log will go to this path in Blueprint, Citadel, and Ignition-D.\r\n\r\n## Future Work\r\n\r\nFiles are outputted in `/tmp/log` and `/tmp/log.zip` in this example. During record, the original path in `file://` is prepended with the specified path, e.g. `/tmp/log`. During playback, the specified path is prepended to the URIs in the SDF.", "title": "[Blueprint] Logging meshes and materials", "destination": {"commit": {"hash": "b376ddd76f5b", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/commit/b376ddd76f5b.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/commits/b376ddd76f5b"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{f98d11fe-f287-4dfb-99c3-e2b76a13232e}ts=2082645"}}, "type": "repository", "name": "ign-gazebo", "full_name": "ignitionrobotics/ign-gazebo", "uuid": "{f98d11fe-f287-4dfb-99c3-e2b76a13232e}"}, "branch": {"name": "ign-gazebo2"}}, "reason": "", "source": {"commit": {"hash": "af9ee6000544", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/commit/af9ee6000544.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/commits/af9ee6000544"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{f98d11fe-f287-4dfb-99c3-e2b76a13232e}ts=2082645"}}, "type": "repository", "name": "ign-gazebo", "full_name": "ignitionrobotics/ign-gazebo", "uuid": "{f98d11fe-f287-4dfb-99c3-e2b76a13232e}"}, "branch": {"name": "log_resources"}}, "state": "OPEN", "author": {"display_name": "Mabel Zhang", "uuid": "{4b0e38fb-bf50-45c0-a496-61147518b2bf}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B4b0e38fb-bf50-45c0-a496-61147518b2bf%7D"}, "html": {"href": "https://bitbucket.org/%7B4b0e38fb-bf50-45c0-a496-61147518b2bf%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:ceb5942c-6843-408c-8550-3ce4899d299b/4d48e5ea-cf28-4fa7-9715-8fc9e315d831/128"}}, "nickname": "mabelmzhang", "type": "user", "account_id": "557058:ceb5942c-6843-408c-8550-3ce4899d299b"}, "date": "2019-10-14T23:11:54.198085+00:00"}, "pull_request": {"type": "pullrequest", "id": 397, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397"}}, "title": "[Blueprint] Logging meshes and materials"}}, {"update": {"description": "Depends on [ign-common PR 200](#!/ignitionrobotics/ign-common/pull-requests/200/log-resources/diff).\r\n\r\nPorts [this Gazebo PR](https://bitbucket.org/osrf/gazebo/pull-requests/2811/save-models-material-and-meshes-when/diff) to Ignition.\r\n\r\nImplements `--record-resources`, and `--log-compress` and `--log-overwrite` to support it.\r\n\r\nRecords resources \\(`--record-resources`\\), i.e. meshes and materials, to a directory under the specified log record directory. Optionally compresses \\(`--log-compress`\\) the whole directory, which contains the existing `.tlog` sqlite3 file and any resources, to a zip file. If directory or compressed file already exist, optionally overwrites \\(`--log-overwrite`\\).\r\n\r\nCorresponding SDF plugin parameters: `<record_resources>1</record_resources>`, `<compress>1</compress>.`If both command line and SDF parameters are specified, command line option overwrites SDF parameter. `--log-overwrite` is handled on command line only, outside of the plugin. If recording is only enabled from SDF and not from command line, then behavior is to always overwrite.\r\n\r\n## Usage:\r\n\r\n```\r\nign gazebo [...] --record-resources --log-overwrite --log-compress\r\n```\r\n\r\n## Test --record-resources:\r\n\r\n```\r\n# This SDF specifies the equivalent of --record-resources --record-path '/tmp/log'\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf\r\n$ ign gazebo -v 4 -r examples/worlds/log_playback.sdf\r\n```\r\n\r\nTested with `<include><uri>https://fuel...</uri></include>` and `<mesh><uri>file://...</uri></mesh>`. Paths specified by `model://` are not supported in Ignition yet, so this case in the code is not tested.\r\n\r\n## Test --log-overwrite and --log-compress:\r\n\r\nWhen recording to `path`, the compression file is implied to be `path.zip`. Both are checked for existence.\r\n\r\nNo `--log-overwrite` \\(default\\):\r\n\r\n```\r\n# This SDF specifies the equivalent of --record-path '/tmp/log'\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf\r\n\r\n# Run it again. By default it will always overwrite, because overwrite is now taken care of in ign.cc\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf\r\n[Msg] Overwriting existing file [/tmp/log/state.tlog]\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n```\r\n\r\n`--log-overwrite`, `/tmp/log` already exists:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-overwrite --record-path '/tmp/log'\r\n[Msg] Log path already exists on disk! Existing files will be overwritten.\r\n[Msg] Removing existing path [/tmp/log]\r\n...\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n...\r\n[Msg] Stopping recording\r\n```\r\n\r\n`--log-overwrite --log-compress`, `/tmp/log` exists, `/tmp/log.zip` does not exist:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-compress --log-overwrite --record-path '/tmp/log'\r\n[Msg] Log path already exists on disk! Existing files will be overwritten.\r\n[Msg] Removing existing path [/tmp/log]\r\n...\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n...\r\n[Msg] Compressed log file and resources to [/tmp/log.zip].\r\nRemoving recorded directory [/tmp/log].\r\n[Msg] Stopping recording\r\n```\r\n\r\n`--log-overwrite --log-compress`, `/tmp/log` does not exist, `/tmp/log.zip` exists:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-compress --log-overwrite --record-path '/tmp/log'\r\n[Wrn] [ign.cc:121] Compressed log path already exists on disk! Existing files will be overwritten.\r\n[Msg] Removing existing compressed file [/tmp/log.zip]\r\n...\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n...\r\n[Msg] Compressed log file and resources to [/tmp/log.zip].\r\nRemoving recorded directory [/tmp/log].\r\n[Msg] Stopping recording\r\n```\r\n\r\n`--log-overwrite` only, `/tmp/log.zip` exists, `/tmp/log` does not exist:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-overwrite --record-path '/tmp/log'\r\n[Wrn] [ign.cc:121] Compressed log path already exists on disk! Existing files will be overwritten.\r\n[Msg] Removing existing compressed file [/tmp/log.zip]\r\n...\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n...\r\n[Msg] Stopping recording\r\n```\r\n\r\n`--log-compress` only, both `/tmp/log` and `/tmp/log.zip` already exist:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-compress --record-path '/tmp/log'\r\n[Wrn] [ign.cc:152] Log path already exists on disk! Recording instead to [/tmp/log(1)]\r\n[Wrn] [ign.cc:154] Compressed log path already exists on disk! Recording instead to [/tmp/log(1).zip]\r\n...\r\n[Msg] Recording to log file [/tmp/log(1)/state.tlog]\r\n...\r\n[Msg] Compressed log file and resources to [/tmp/log(1).zip].\r\nRemoving recorded directory [/tmp/log(1)].\r\n[Msg] Stopping recording\r\n$ ls /tmp\r\nlog\r\n'log(1).zip'\r\nlog.zip\r\n```\r\n\r\n`--log-compress` only, `/tmp/log` does not exist, `/tmp/log.zip` exists, `/tmp/log(1).zip` exists:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-compress --record-path '/tmp/log'\r\n[Wrn] [ign.cc:152] Log path already exists on disk! Recording instead to [/tmp/log(2)]\r\n[Wrn] [ign.cc:154] Compressed log path already exists on disk! Recording instead to [/tmp/log(2).zip]\r\n...\r\n[Msg] Recording to log file [/tmp/log(2)/state.tlog]\r\n...\r\n[Msg] Compressed log file and resources to [/tmp/log(2).zip].\r\nRemoving recorded directory [/tmp/log(2)].\r\n[Msg] Stopping recording\r\n```\r\n\r\n## Record Path vs. Console Log Path\r\n\r\nIn Blueprint and Citadel, if `--record` is specified without `--record-path`, and `<path>` exists in SDF, a warning is printed, and recording will go to `<path>`, while console log will go to the default timestamp path.\r\n\r\nAs in this example:\r\n\r\n```\r\n# SDF specifies <path>/tmp/log</path>\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --record --log-compress -log-overwrite\r\n[Wrn] [ServerPrivate.cc:229] --record-path is not specified on command line. <path> is specified in SDF. Will record to <path>. Console will be logged to [/home/master/.ignition/gazebo/log/2019-09-20T19:51:33.996055619]. Note: In Ignition-D, <path> will be ignored, and all recordings will be written to default console log path if no path is specified on command line.\r\n[Msg] Overwriting existing file [/tmp/log/state.tlog]\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n...\r\n[Msg] Removing existing file [/tmp/log.zip].\r\n[Msg] Compressed log file and resources to [/tmp/log.zip].\r\nRemoving recorded directory [/tmp/log].\r\n```\r\n\r\nIn Ignition-D, `<path>` will be permanently ignored. Recordings and console log will go to same default path.\r\n\r\nIf `--record-path` is specified, then recording and console log will go to this path in Blueprint, Citadel, and Ignition-D.\r\n\r\n## Future Work\r\n\r\nFiles are outputted in `/tmp/log` and `/tmp/log.zip` in this example. During record, the original path in `file://` is prepended with the specified path, e.g. `/tmp/log`. During playback, the specified path is prepended to the URIs in the SDF.", "title": "[Blueprint] Logging meshes and materials", "destination": {"commit": {"hash": "b376ddd76f5b", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/commit/b376ddd76f5b.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/commits/b376ddd76f5b"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{f98d11fe-f287-4dfb-99c3-e2b76a13232e}ts=2082645"}}, "type": "repository", "name": "ign-gazebo", "full_name": "ignitionrobotics/ign-gazebo", "uuid": "{f98d11fe-f287-4dfb-99c3-e2b76a13232e}"}, "branch": {"name": "ign-gazebo2"}}, "reason": "", "source": {"commit": {"hash": "39fabb44cfa8", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/commit/39fabb44cfa8.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/commits/39fabb44cfa8"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{f98d11fe-f287-4dfb-99c3-e2b76a13232e}ts=2082645"}}, "type": "repository", "name": "ign-gazebo", "full_name": "ignitionrobotics/ign-gazebo", "uuid": "{f98d11fe-f287-4dfb-99c3-e2b76a13232e}"}, "branch": {"name": "log_resources"}}, "state": "OPEN", "author": {"display_name": "Mabel Zhang", "uuid": "{4b0e38fb-bf50-45c0-a496-61147518b2bf}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B4b0e38fb-bf50-45c0-a496-61147518b2bf%7D"}, "html": {"href": "https://bitbucket.org/%7B4b0e38fb-bf50-45c0-a496-61147518b2bf%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:ceb5942c-6843-408c-8550-3ce4899d299b/4d48e5ea-cf28-4fa7-9715-8fc9e315d831/128"}}, "nickname": "mabelmzhang", "type": "user", "account_id": "557058:ceb5942c-6843-408c-8550-3ce4899d299b"}, "date": "2019-10-14T22:46:52.509113+00:00"}, "pull_request": {"type": "pullrequest", "id": 397, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397"}}, "title": "[Blueprint] Logging meshes and materials"}}, {"comment": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397/comments/119972108.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397/_/diff#comment-119972108"}}, "parent": {"id": 119792831, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397/comments/119792831.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397/_/diff#comment-119792831"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 397, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397"}}, "title": "[Blueprint] Logging meshes and materials"}, "content": {"raw": "I'm seeing the same problem. Error output looks like:\n\n```\nUnable to find file[file://log//home/nkoenig/.ignition/fuel/fuel.ignitionrobotics.org/openrobotics/models/X2 Config 1/11//meshes/x2_wheel_left.dae]\n```\n\nTo record:\n\n```\nign gazebo examples/worlds/log_record_resources.sdf\n```\n\nTo playback:\n\n```\ncd /tmp\nign gazebo --playback log\n```", "markup": "markdown", "html": "<p>I'm seeing the same problem. Error output looks like:</p>\n<div class=\"codehilite\"><pre><span></span>Unable to find file[file://log//home/nkoenig/.ignition/fuel/fuel.ignitionrobotics.org/openrobotics/models/X2 Config 1/11//meshes/x2_wheel_left.dae]\n</pre></div>\n\n\n<p>To record:</p>\n<div class=\"codehilite\"><pre><span></span>ign gazebo examples/worlds/log_record_resources.sdf\n</pre></div>\n\n\n<p>To playback:</p>\n<div class=\"codehilite\"><pre><span></span>cd /tmp\nign gazebo --playback log\n</pre></div>", "type": "rendered"}, "created_on": "2019-10-08T21:56:50.936670+00:00", "user": {"display_name": "Nate Koenig", "uuid": "{c862cdd9-fcc8-4419-9fc7-e20db14b8fcb}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Bc862cdd9-fcc8-4419-9fc7-e20db14b8fcb%7D"}, "html": {"href": "https://bitbucket.org/%7Bc862cdd9-fcc8-4419-9fc7-e20db14b8fcb%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:095b1e12-74ed-4e20-b44f-2f0745b616e0/ca24bb11-4787-4b14-a20d-d91835e9bde2/128"}}, "nickname": "Nathan Koenig", "type": "user", "account_id": "557058:095b1e12-74ed-4e20-b44f-2f0745b616e0"}, "updated_on": "2019-10-08T21:57:46.983165+00:00", "type": "pullrequest_comment", "id": 119972108}, "pull_request": {"type": "pullrequest", "id": 397, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397"}}, "title": "[Blueprint] Logging meshes and materials"}}, {"update": {"description": "Depends on [ign-common PR 200](#!/ignitionrobotics/ign-common/pull-requests/200/log-resources/diff).\r\n\r\nPorts [this Gazebo PR](https://bitbucket.org/osrf/gazebo/pull-requests/2811/save-models-material-and-meshes-when/diff) to Ignition.\r\n\r\nImplements `--record-resources`, and `--log-compress` and `--log-overwrite` to support it.\r\n\r\nRecords resources \\(`--record-resources`\\), i.e. meshes and materials, to a directory under the specified log record directory. Optionally compresses \\(`--log-compress`\\) the whole directory, which contains the existing `.tlog` sqlite3 file and any resources, to a zip file. If directory or compressed file already exist, optionally overwrites \\(`--log-overwrite`\\).\r\n\r\nCorresponding SDF plugin parameters: `<record_resources>1</record_resources>`, `<compress>1</compress>.`If both command line and SDF parameters are specified, command line option overwrites SDF parameter. `--log-overwrite` is handled on command line only, outside of the plugin. If recording is only enabled from SDF and not from command line, then behavior is to always overwrite.\r\n\r\n## Usage:\r\n\r\n```\r\nign gazebo [...] --record-resources --log-overwrite --log-compress\r\n```\r\n\r\n## Test --record-resources:\r\n\r\n```\r\n# This SDF specifies the equivalent of --record-resources --record-path '/tmp/log'\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf\r\n$ ign gazebo -v 4 -r examples/worlds/log_playback.sdf\r\n```\r\n\r\nTested with `<include><uri>https://fuel...</uri></include>` and `<mesh><uri>file://...</uri></mesh>`. Paths specified by `model://` are not supported in Ignition yet, so this case in the code is not tested.\r\n\r\n## Test --log-overwrite and --log-compress:\r\n\r\nWhen recording to `path`, the compression file is implied to be `path.zip`. Both are checked for existence.\r\n\r\nNo `--log-overwrite` \\(default\\):\r\n\r\n```\r\n# This SDF specifies the equivalent of --record-path '/tmp/log'\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf\r\n\r\n# Run it again. By default it will always overwrite, because overwrite is now taken care of in ign.cc\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf\r\n[Msg] Overwriting existing file [/tmp/log/state.tlog]\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n```\r\n\r\n`--log-overwrite`, `/tmp/log` already exists:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-overwrite --record-path '/tmp/log'\r\n[Msg] Log path already exists on disk! Existing files will be overwritten.\r\n[Msg] Removing existing path [/tmp/log]\r\n...\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n...\r\n[Msg] Stopping recording\r\n```\r\n\r\n`--log-overwrite --log-compress`, `/tmp/log` exists, `/tmp/log.zip` does not exist:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-compress --log-overwrite --record-path '/tmp/log'\r\n[Msg] Log path already exists on disk! Existing files will be overwritten.\r\n[Msg] Removing existing path [/tmp/log]\r\n...\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n...\r\n[Msg] Compressed log file and resources to [/tmp/log.zip].\r\nRemoving recorded directory [/tmp/log].\r\n[Msg] Stopping recording\r\n```\r\n\r\n`--log-overwrite --log-compress`, `/tmp/log` does not exist, `/tmp/log.zip` exists:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-compress --log-overwrite --record-path '/tmp/log'\r\n[Wrn] [ign.cc:121] Compressed log path already exists on disk! Existing files will be overwritten.\r\n[Msg] Removing existing compressed file [/tmp/log.zip]\r\n...\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n...\r\n[Msg] Compressed log file and resources to [/tmp/log.zip].\r\nRemoving recorded directory [/tmp/log].\r\n[Msg] Stopping recording\r\n```\r\n\r\n`--log-overwrite` only, `/tmp/log.zip` exists, `/tmp/log` does not exist:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-overwrite --record-path '/tmp/log'\r\n[Wrn] [ign.cc:121] Compressed log path already exists on disk! Existing files will be overwritten.\r\n[Msg] Removing existing compressed file [/tmp/log.zip]\r\n...\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n...\r\n[Msg] Stopping recording\r\n```\r\n\r\n`--log-compress` only, both `/tmp/log` and `/tmp/log.zip` already exist:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-compress --record-path '/tmp/log'\r\n[Wrn] [ign.cc:152] Log path already exists on disk! Recording instead to [/tmp/log(1)]\r\n[Wrn] [ign.cc:154] Compressed log path already exists on disk! Recording instead to [/tmp/log(1).zip]\r\n...\r\n[Msg] Recording to log file [/tmp/log(1)/state.tlog]\r\n...\r\n[Msg] Compressed log file and resources to [/tmp/log(1).zip].\r\nRemoving recorded directory [/tmp/log(1)].\r\n[Msg] Stopping recording\r\n$ ls /tmp\r\nlog\r\n'log(1).zip'\r\nlog.zip\r\n```\r\n\r\n`--log-compress` only, `/tmp/log` does not exist, `/tmp/log.zip` exists, `/tmp/log(1).zip` exists:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-compress --record-path '/tmp/log'\r\n[Wrn] [ign.cc:152] Log path already exists on disk! Recording instead to [/tmp/log(2)]\r\n[Wrn] [ign.cc:154] Compressed log path already exists on disk! Recording instead to [/tmp/log(2).zip]\r\n...\r\n[Msg] Recording to log file [/tmp/log(2)/state.tlog]\r\n...\r\n[Msg] Compressed log file and resources to [/tmp/log(2).zip].\r\nRemoving recorded directory [/tmp/log(2)].\r\n[Msg] Stopping recording\r\n```\r\n\r\n## Record Path vs. Console Log Path\r\n\r\nIn Blueprint and Citadel, if `--record` is specified without `--record-path`, and `<path>` exists in SDF, a warning is printed, and recording will go to `<path>`, while console log will go to the default timestamp path.\r\n\r\nAs in this example:\r\n\r\n```\r\n# SDF specifies <path>/tmp/log</path>\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --record --log-compress -log-overwrite\r\n[Wrn] [ServerPrivate.cc:229] --record-path is not specified on command line. <path> is specified in SDF. Will record to <path>. Console will be logged to [/home/master/.ignition/gazebo/log/2019-09-20T19:51:33.996055619]. Note: In Ignition-D, <path> will be ignored, and all recordings will be written to default console log path if no path is specified on command line.\r\n[Msg] Overwriting existing file [/tmp/log/state.tlog]\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n...\r\n[Msg] Removing existing file [/tmp/log.zip].\r\n[Msg] Compressed log file and resources to [/tmp/log.zip].\r\nRemoving recorded directory [/tmp/log].\r\n```\r\n\r\nIn Ignition-D, `<path>` will be permanently ignored. Recordings and console log will go to same default path.\r\n\r\nIf `--record-path` is specified, then recording and console log will go to this path in Blueprint, Citadel, and Ignition-D.\r\n\r\n## Future Work\r\n\r\nFiles are outputted in `/tmp/log` and `/tmp/log.zip` in this example. During record, the original path in `file://` is prepended with the specified path, e.g. `/tmp/log`. During playback, the specified path is prepended to the URIs in the SDF.", "title": "[Blueprint] Logging meshes and materials", "destination": {"commit": {"hash": "2ff2b974cd61", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/commit/2ff2b974cd61.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/commits/2ff2b974cd61"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{f98d11fe-f287-4dfb-99c3-e2b76a13232e}ts=2082645"}}, "type": "repository", "name": "ign-gazebo", "full_name": "ignitionrobotics/ign-gazebo", "uuid": "{f98d11fe-f287-4dfb-99c3-e2b76a13232e}"}, "branch": {"name": "ign-gazebo2"}}, "reason": "", "source": {"commit": {"hash": "1a4b5b9a6228", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/commit/1a4b5b9a6228.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/commits/1a4b5b9a6228"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{f98d11fe-f287-4dfb-99c3-e2b76a13232e}ts=2082645"}}, "type": "repository", "name": "ign-gazebo", "full_name": "ignitionrobotics/ign-gazebo", "uuid": "{f98d11fe-f287-4dfb-99c3-e2b76a13232e}"}, "branch": {"name": "log_resources"}}, "state": "OPEN", "author": {"display_name": "Nate Koenig", "uuid": "{c862cdd9-fcc8-4419-9fc7-e20db14b8fcb}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Bc862cdd9-fcc8-4419-9fc7-e20db14b8fcb%7D"}, "html": {"href": "https://bitbucket.org/%7Bc862cdd9-fcc8-4419-9fc7-e20db14b8fcb%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:095b1e12-74ed-4e20-b44f-2f0745b616e0/ca24bb11-4787-4b14-a20d-d91835e9bde2/128"}}, "nickname": "Nathan Koenig", "type": "user", "account_id": "557058:095b1e12-74ed-4e20-b44f-2f0745b616e0"}, "date": "2019-10-08T21:55:49.719483+00:00"}, "pull_request": {"type": "pullrequest", "id": 397, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397"}}, "title": "[Blueprint] Logging meshes and materials"}}, {"update": {"description": "Depends on [ign-common PR 200](#!/ignitionrobotics/ign-common/pull-requests/200/log-resources/diff).\r\n\r\nPorts [this Gazebo PR](https://bitbucket.org/osrf/gazebo/pull-requests/2811/save-models-material-and-meshes-when/diff) to Ignition.\r\n\r\nImplements `--record-resources`, and `--log-compress` and `--log-overwrite` to support it.\r\n\r\nRecords resources \\(`--record-resources`\\), i.e. meshes and materials, to a directory under the specified log record directory. Optionally compresses \\(`--log-compress`\\) the whole directory, which contains the existing `.tlog` sqlite3 file and any resources, to a zip file. If directory or compressed file already exist, optionally overwrites \\(`--log-overwrite`\\).\r\n\r\nCorresponding SDF plugin parameters: `<record_resources>1</record_resources>`, `<compress>1</compress>.`If both command line and SDF parameters are specified, command line option overwrites SDF parameter. `--log-overwrite` is handled on command line only, outside of the plugin. If recording is only enabled from SDF and not from command line, then behavior is to always overwrite.\r\n\r\n## Usage:\r\n\r\n```\r\nign gazebo [...] --record-resources --log-overwrite --log-compress\r\n```\r\n\r\n## Test --record-resources:\r\n\r\n```\r\n# This SDF specifies the equivalent of --record-resources --record-path '/tmp/log'\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf\r\n$ ign gazebo -v 4 -r examples/worlds/log_playback.sdf\r\n```\r\n\r\nTested with `<include><uri>https://fuel...</uri></include>` and `<mesh><uri>file://...</uri></mesh>`. Paths specified by `model://` are not supported in Ignition yet, so this case in the code is not tested.\r\n\r\n## Test --log-overwrite and --log-compress:\r\n\r\nWhen recording to `path`, the compression file is implied to be `path.zip`. Both are checked for existence.\r\n\r\nNo `--log-overwrite` \\(default\\):\r\n\r\n```\r\n# This SDF specifies the equivalent of --record-path '/tmp/log'\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf\r\n\r\n# Run it again. By default it will always overwrite, because overwrite is now taken care of in ign.cc\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf\r\n[Msg] Overwriting existing file [/tmp/log/state.tlog]\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n```\r\n\r\n`--log-overwrite`, `/tmp/log` already exists:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-overwrite --record-path '/tmp/log'\r\n[Msg] Log path already exists on disk! Existing files will be overwritten.\r\n[Msg] Removing existing path [/tmp/log]\r\n...\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n...\r\n[Msg] Stopping recording\r\n```\r\n\r\n`--log-overwrite --log-compress`, `/tmp/log` exists, `/tmp/log.zip` does not exist:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-compress --log-overwrite --record-path '/tmp/log'\r\n[Msg] Log path already exists on disk! Existing files will be overwritten.\r\n[Msg] Removing existing path [/tmp/log]\r\n...\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n...\r\n[Msg] Compressed log file and resources to [/tmp/log.zip].\r\nRemoving recorded directory [/tmp/log].\r\n[Msg] Stopping recording\r\n```\r\n\r\n`--log-overwrite --log-compress`, `/tmp/log` does not exist, `/tmp/log.zip` exists:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-compress --log-overwrite --record-path '/tmp/log'\r\n[Wrn] [ign.cc:121] Compressed log path already exists on disk! Existing files will be overwritten.\r\n[Msg] Removing existing compressed file [/tmp/log.zip]\r\n...\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n...\r\n[Msg] Compressed log file and resources to [/tmp/log.zip].\r\nRemoving recorded directory [/tmp/log].\r\n[Msg] Stopping recording\r\n```\r\n\r\n`--log-overwrite` only, `/tmp/log.zip` exists, `/tmp/log` does not exist:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-overwrite --record-path '/tmp/log'\r\n[Wrn] [ign.cc:121] Compressed log path already exists on disk! Existing files will be overwritten.\r\n[Msg] Removing existing compressed file [/tmp/log.zip]\r\n...\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n...\r\n[Msg] Stopping recording\r\n```\r\n\r\n`--log-compress` only, both `/tmp/log` and `/tmp/log.zip` already exist:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-compress --record-path '/tmp/log'\r\n[Wrn] [ign.cc:152] Log path already exists on disk! Recording instead to [/tmp/log(1)]\r\n[Wrn] [ign.cc:154] Compressed log path already exists on disk! Recording instead to [/tmp/log(1).zip]\r\n...\r\n[Msg] Recording to log file [/tmp/log(1)/state.tlog]\r\n...\r\n[Msg] Compressed log file and resources to [/tmp/log(1).zip].\r\nRemoving recorded directory [/tmp/log(1)].\r\n[Msg] Stopping recording\r\n$ ls /tmp\r\nlog\r\n'log(1).zip'\r\nlog.zip\r\n```\r\n\r\n`--log-compress` only, `/tmp/log` does not exist, `/tmp/log.zip` exists, `/tmp/log(1).zip` exists:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-compress --record-path '/tmp/log'\r\n[Wrn] [ign.cc:152] Log path already exists on disk! Recording instead to [/tmp/log(2)]\r\n[Wrn] [ign.cc:154] Compressed log path already exists on disk! Recording instead to [/tmp/log(2).zip]\r\n...\r\n[Msg] Recording to log file [/tmp/log(2)/state.tlog]\r\n...\r\n[Msg] Compressed log file and resources to [/tmp/log(2).zip].\r\nRemoving recorded directory [/tmp/log(2)].\r\n[Msg] Stopping recording\r\n```\r\n\r\n## Record Path vs. Console Log Path\r\n\r\nIn Blueprint and Citadel, if `--record` is specified without `--record-path`, and `<path>` exists in SDF, a warning is printed, and recording will go to `<path>`, while console log will go to the default timestamp path.\r\n\r\nAs in this example:\r\n\r\n```\r\n# SDF specifies <path>/tmp/log</path>\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --record --log-compress -log-overwrite\r\n[Wrn] [ServerPrivate.cc:229] --record-path is not specified on command line. <path> is specified in SDF. Will record to <path>. Console will be logged to [/home/master/.ignition/gazebo/log/2019-09-20T19:51:33.996055619]. Note: In Ignition-D, <path> will be ignored, and all recordings will be written to default console log path if no path is specified on command line.\r\n[Msg] Overwriting existing file [/tmp/log/state.tlog]\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n...\r\n[Msg] Removing existing file [/tmp/log.zip].\r\n[Msg] Compressed log file and resources to [/tmp/log.zip].\r\nRemoving recorded directory [/tmp/log].\r\n```\r\n\r\nIn Ignition-D, `<path>` will be permanently ignored. Recordings and console log will go to same default path.\r\n\r\nIf `--record-path` is specified, then recording and console log will go to this path in Blueprint, Citadel, and Ignition-D.\r\n\r\n## Future Work\r\n\r\nFiles are outputted in `/tmp/log` and `/tmp/log.zip` in this example. During record, the original path in `file://` is prepended with the specified path, e.g. `/tmp/log`. During playback, the specified path is prepended to the URIs in the SDF.", "title": "[Blueprint] Logging meshes and materials", "destination": {"commit": {"hash": "2ff2b974cd61", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/commit/2ff2b974cd61.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/commits/2ff2b974cd61"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{f98d11fe-f287-4dfb-99c3-e2b76a13232e}ts=2082645"}}, "type": "repository", "name": "ign-gazebo", "full_name": "ignitionrobotics/ign-gazebo", "uuid": "{f98d11fe-f287-4dfb-99c3-e2b76a13232e}"}, "branch": {"name": "ign-gazebo2"}}, "reason": "", "source": {"commit": {"hash": "1a4b5b9a6228", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/commit/1a4b5b9a6228.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/commits/1a4b5b9a6228"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{f98d11fe-f287-4dfb-99c3-e2b76a13232e}ts=2082645"}}, "type": "repository", "name": "ign-gazebo", "full_name": "ignitionrobotics/ign-gazebo", "uuid": "{f98d11fe-f287-4dfb-99c3-e2b76a13232e}"}, "branch": {"name": "log_resources"}}, "state": "OPEN", "author": {"display_name": "Nate Koenig", "uuid": "{c862cdd9-fcc8-4419-9fc7-e20db14b8fcb}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Bc862cdd9-fcc8-4419-9fc7-e20db14b8fcb%7D"}, "html": {"href": "https://bitbucket.org/%7Bc862cdd9-fcc8-4419-9fc7-e20db14b8fcb%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:095b1e12-74ed-4e20-b44f-2f0745b616e0/ca24bb11-4787-4b14-a20d-d91835e9bde2/128"}}, "nickname": "Nathan Koenig", "type": "user", "account_id": "557058:095b1e12-74ed-4e20-b44f-2f0745b616e0"}, "date": "2019-10-08T21:55:29.201243+00:00"}, "pull_request": {"type": "pullrequest", "id": 397, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397"}}, "title": "[Blueprint] Logging meshes and materials"}}, {"update": {"description": "Depends on [ign-common PR 200](#!/ignitionrobotics/ign-common/pull-requests/200/log-resources/diff).\r\n\r\nPorts [this Gazebo PR](https://bitbucket.org/osrf/gazebo/pull-requests/2811/save-models-material-and-meshes-when/diff) to Ignition.\r\n\r\nImplements `--record-resources`, and `--log-compress` and `--log-overwrite` to support it.\r\n\r\nRecords resources \\(`--record-resources`\\), i.e. meshes and materials, to a directory under the specified log record directory. Optionally compresses \\(`--log-compress`\\) the whole directory, which contains the existing `.tlog` sqlite3 file and any resources, to a zip file. If directory or compressed file already exist, optionally overwrites \\(`--log-overwrite`\\).\r\n\r\nCorresponding SDF plugin parameters: `<record_resources>1</record_resources>`, `<compress>1</compress>.`If both command line and SDF parameters are specified, command line option overwrites SDF parameter. `--log-overwrite` is handled on command line only, outside of the plugin. If recording is only enabled from SDF and not from command line, then behavior is to always overwrite.\r\n\r\n## Usage:\r\n\r\n```\r\nign gazebo [...] --record-resources --log-overwrite --log-compress\r\n```\r\n\r\n## Test --record-resources:\r\n\r\n```\r\n# This SDF specifies the equivalent of --record-resources --record-path '/tmp/log'\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf\r\n$ ign gazebo -v 4 -r examples/worlds/log_playback.sdf\r\n```\r\n\r\nTested with `<include><uri>https://fuel...</uri></include>` and `<mesh><uri>file://...</uri></mesh>`. Paths specified by `model://` are not supported in Ignition yet, so this case in the code is not tested.\r\n\r\n## Test --log-overwrite and --log-compress:\r\n\r\nWhen recording to `path`, the compression file is implied to be `path.zip`. Both are checked for existence.\r\n\r\nNo `--log-overwrite` \\(default\\):\r\n\r\n```\r\n# This SDF specifies the equivalent of --record-path '/tmp/log'\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf\r\n\r\n# Run it again. By default it will always overwrite, because overwrite is now taken care of in ign.cc\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf\r\n[Msg] Overwriting existing file [/tmp/log/state.tlog]\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n```\r\n\r\n`--log-overwrite`, `/tmp/log` already exists:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-overwrite --record-path '/tmp/log'\r\n[Msg] Log path already exists on disk! Existing files will be overwritten.\r\n[Msg] Removing existing path [/tmp/log]\r\n...\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n...\r\n[Msg] Stopping recording\r\n```\r\n\r\n`--log-overwrite --log-compress`, `/tmp/log` exists, `/tmp/log.zip` does not exist:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-compress --log-overwrite --record-path '/tmp/log'\r\n[Msg] Log path already exists on disk! Existing files will be overwritten.\r\n[Msg] Removing existing path [/tmp/log]\r\n...\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n...\r\n[Msg] Compressed log file and resources to [/tmp/log.zip].\r\nRemoving recorded directory [/tmp/log].\r\n[Msg] Stopping recording\r\n```\r\n\r\n`--log-overwrite --log-compress`, `/tmp/log` does not exist, `/tmp/log.zip` exists:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-compress --log-overwrite --record-path '/tmp/log'\r\n[Wrn] [ign.cc:121] Compressed log path already exists on disk! Existing files will be overwritten.\r\n[Msg] Removing existing compressed file [/tmp/log.zip]\r\n...\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n...\r\n[Msg] Compressed log file and resources to [/tmp/log.zip].\r\nRemoving recorded directory [/tmp/log].\r\n[Msg] Stopping recording\r\n```\r\n\r\n`--log-overwrite` only, `/tmp/log.zip` exists, `/tmp/log` does not exist:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-overwrite --record-path '/tmp/log'\r\n[Wrn] [ign.cc:121] Compressed log path already exists on disk! Existing files will be overwritten.\r\n[Msg] Removing existing compressed file [/tmp/log.zip]\r\n...\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n...\r\n[Msg] Stopping recording\r\n```\r\n\r\n`--log-compress` only, both `/tmp/log` and `/tmp/log.zip` already exist:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-compress --record-path '/tmp/log'\r\n[Wrn] [ign.cc:152] Log path already exists on disk! Recording instead to [/tmp/log(1)]\r\n[Wrn] [ign.cc:154] Compressed log path already exists on disk! Recording instead to [/tmp/log(1).zip]\r\n...\r\n[Msg] Recording to log file [/tmp/log(1)/state.tlog]\r\n...\r\n[Msg] Compressed log file and resources to [/tmp/log(1).zip].\r\nRemoving recorded directory [/tmp/log(1)].\r\n[Msg] Stopping recording\r\n$ ls /tmp\r\nlog\r\n'log(1).zip'\r\nlog.zip\r\n```\r\n\r\n`--log-compress` only, `/tmp/log` does not exist, `/tmp/log.zip` exists, `/tmp/log(1).zip` exists:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-compress --record-path '/tmp/log'\r\n[Wrn] [ign.cc:152] Log path already exists on disk! Recording instead to [/tmp/log(2)]\r\n[Wrn] [ign.cc:154] Compressed log path already exists on disk! Recording instead to [/tmp/log(2).zip]\r\n...\r\n[Msg] Recording to log file [/tmp/log(2)/state.tlog]\r\n...\r\n[Msg] Compressed log file and resources to [/tmp/log(2).zip].\r\nRemoving recorded directory [/tmp/log(2)].\r\n[Msg] Stopping recording\r\n```\r\n\r\n## Record Path vs. Console Log Path\r\n\r\nIn Blueprint and Citadel, if `--record` is specified without `--record-path`, and `<path>` exists in SDF, a warning is printed, and recording will go to `<path>`, while console log will go to the default timestamp path.\r\n\r\nAs in this example:\r\n\r\n```\r\n# SDF specifies <path>/tmp/log</path>\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --record --log-compress -log-overwrite\r\n[Wrn] [ServerPrivate.cc:229] --record-path is not specified on command line. <path> is specified in SDF. Will record to <path>. Console will be logged to [/home/master/.ignition/gazebo/log/2019-09-20T19:51:33.996055619]. Note: In Ignition-D, <path> will be ignored, and all recordings will be written to default console log path if no path is specified on command line.\r\n[Msg] Overwriting existing file [/tmp/log/state.tlog]\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n...\r\n[Msg] Removing existing file [/tmp/log.zip].\r\n[Msg] Compressed log file and resources to [/tmp/log.zip].\r\nRemoving recorded directory [/tmp/log].\r\n```\r\n\r\nIn Ignition-D, `<path>` will be permanently ignored. Recordings and console log will go to same default path.\r\n\r\nIf `--record-path` is specified, then recording and console log will go to this path in Blueprint, Citadel, and Ignition-D.\r\n\r\n## Future Work\r\n\r\nFiles are outputted in `/tmp/log` and `/tmp/log.zip` in this example. During record, the original path in `file://` is prepended with the specified path, e.g. `/tmp/log`. During playback, the specified path is prepended to the URIs in the SDF.", "title": "[Blueprint] Logging meshes and materials", "destination": {"commit": {"hash": "2ff2b974cd61", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/commit/2ff2b974cd61.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/commits/2ff2b974cd61"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{f98d11fe-f287-4dfb-99c3-e2b76a13232e}ts=2082645"}}, "type": "repository", "name": "ign-gazebo", "full_name": "ignitionrobotics/ign-gazebo", "uuid": "{f98d11fe-f287-4dfb-99c3-e2b76a13232e}"}, "branch": {"name": "ign-gazebo2"}}, "reason": "", "source": {"commit": {"hash": "1a4b5b9a6228", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/commit/1a4b5b9a6228.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/commits/1a4b5b9a6228"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{f98d11fe-f287-4dfb-99c3-e2b76a13232e}ts=2082645"}}, "type": "repository", "name": "ign-gazebo", "full_name": "ignitionrobotics/ign-gazebo", "uuid": "{f98d11fe-f287-4dfb-99c3-e2b76a13232e}"}, "branch": {"name": "log_resources"}}, "state": "OPEN", "author": {"display_name": "Nate Koenig", "uuid": "{c862cdd9-fcc8-4419-9fc7-e20db14b8fcb}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Bc862cdd9-fcc8-4419-9fc7-e20db14b8fcb%7D"}, "html": {"href": "https://bitbucket.org/%7Bc862cdd9-fcc8-4419-9fc7-e20db14b8fcb%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:095b1e12-74ed-4e20-b44f-2f0745b616e0/ca24bb11-4787-4b14-a20d-d91835e9bde2/128"}}, "nickname": "Nathan Koenig", "type": "user", "account_id": "557058:095b1e12-74ed-4e20-b44f-2f0745b616e0"}, "date": "2019-10-08T21:47:50.288183+00:00"}, "pull_request": {"type": "pullrequest", "id": 397, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397"}}, "title": "[Blueprint] Logging meshes and materials"}}, {"update": {"description": "Depends on [ign-common PR 200](#!/ignitionrobotics/ign-common/pull-requests/200/log-resources/diff).\r\n\r\nPorts [this Gazebo PR](https://bitbucket.org/osrf/gazebo/pull-requests/2811/save-models-material-and-meshes-when/diff) to Ignition.\r\n\r\nImplements `--record-resources`, and `--log-compress` and `--log-overwrite` to support it.\r\n\r\nRecords resources \\(`--record-resources`\\), i.e. meshes and materials, to a directory under the specified log record directory. Optionally compresses \\(`--log-compress`\\) the whole directory, which contains the existing `.tlog` sqlite3 file and any resources, to a zip file. If directory or compressed file already exist, optionally overwrites \\(`--log-overwrite`\\).\r\n\r\nCorresponding SDF plugin parameters: `<record_resources>1</record_resources>`, `<compress>1</compress>.`If both command line and SDF parameters are specified, command line option overwrites SDF parameter. `--log-overwrite` is handled on command line only, outside of the plugin. If recording is only enabled from SDF and not from command line, then behavior is to always overwrite.\r\n\r\n## Usage:\r\n\r\n```\r\nign gazebo [...] --record-resources --log-overwrite --log-compress\r\n```\r\n\r\n## Test --record-resources:\r\n\r\n```\r\n# This SDF specifies the equivalent of --record-resources --record-path '/tmp/log'\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf\r\n$ ign gazebo -v 4 -r examples/worlds/log_playback.sdf\r\n```\r\n\r\nTested with `<include><uri>https://fuel...</uri></include>` and `<mesh><uri>file://...</uri></mesh>`. Paths specified by `model://` are not supported in Ignition yet, so this case in the code is not tested.\r\n\r\n## Test --log-overwrite and --log-compress:\r\n\r\nWhen recording to `path`, the compression file is implied to be `path.zip`. Both are checked for existence.\r\n\r\nNo `--log-overwrite` \\(default\\):\r\n\r\n```\r\n# This SDF specifies the equivalent of --record-path '/tmp/log'\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf\r\n\r\n# Run it again. By default it will always overwrite, because overwrite is now taken care of in ign.cc\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf\r\n[Msg] Overwriting existing file [/tmp/log/state.tlog]\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n```\r\n\r\n`--log-overwrite`, `/tmp/log` already exists:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-overwrite --record-path '/tmp/log'\r\n[Msg] Log path already exists on disk! Existing files will be overwritten.\r\n[Msg] Removing existing path [/tmp/log]\r\n...\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n...\r\n[Msg] Stopping recording\r\n```\r\n\r\n`--log-overwrite --log-compress`, `/tmp/log` exists, `/tmp/log.zip` does not exist:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-compress --log-overwrite --record-path '/tmp/log'\r\n[Msg] Log path already exists on disk! Existing files will be overwritten.\r\n[Msg] Removing existing path [/tmp/log]\r\n...\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n...\r\n[Msg] Compressed log file and resources to [/tmp/log.zip].\r\nRemoving recorded directory [/tmp/log].\r\n[Msg] Stopping recording\r\n```\r\n\r\n`--log-overwrite --log-compress`, `/tmp/log` does not exist, `/tmp/log.zip` exists:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-compress --log-overwrite --record-path '/tmp/log'\r\n[Wrn] [ign.cc:121] Compressed log path already exists on disk! Existing files will be overwritten.\r\n[Msg] Removing existing compressed file [/tmp/log.zip]\r\n...\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n...\r\n[Msg] Compressed log file and resources to [/tmp/log.zip].\r\nRemoving recorded directory [/tmp/log].\r\n[Msg] Stopping recording\r\n```\r\n\r\n`--log-overwrite` only, `/tmp/log.zip` exists, `/tmp/log` does not exist:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-overwrite --record-path '/tmp/log'\r\n[Wrn] [ign.cc:121] Compressed log path already exists on disk! Existing files will be overwritten.\r\n[Msg] Removing existing compressed file [/tmp/log.zip]\r\n...\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n...\r\n[Msg] Stopping recording\r\n```\r\n\r\n`--log-compress` only, both `/tmp/log` and `/tmp/log.zip` already exist:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-compress --record-path '/tmp/log'\r\n[Wrn] [ign.cc:152] Log path already exists on disk! Recording instead to [/tmp/log(1)]\r\n[Wrn] [ign.cc:154] Compressed log path already exists on disk! Recording instead to [/tmp/log(1).zip]\r\n...\r\n[Msg] Recording to log file [/tmp/log(1)/state.tlog]\r\n...\r\n[Msg] Compressed log file and resources to [/tmp/log(1).zip].\r\nRemoving recorded directory [/tmp/log(1)].\r\n[Msg] Stopping recording\r\n$ ls /tmp\r\nlog\r\n'log(1).zip'\r\nlog.zip\r\n```\r\n\r\n`--log-compress` only, `/tmp/log` does not exist, `/tmp/log.zip` exists, `/tmp/log(1).zip` exists:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-compress --record-path '/tmp/log'\r\n[Wrn] [ign.cc:152] Log path already exists on disk! Recording instead to [/tmp/log(2)]\r\n[Wrn] [ign.cc:154] Compressed log path already exists on disk! Recording instead to [/tmp/log(2).zip]\r\n...\r\n[Msg] Recording to log file [/tmp/log(2)/state.tlog]\r\n...\r\n[Msg] Compressed log file and resources to [/tmp/log(2).zip].\r\nRemoving recorded directory [/tmp/log(2)].\r\n[Msg] Stopping recording\r\n```\r\n\r\n## Record Path vs. Console Log Path\r\n\r\nIn Blueprint and Citadel, if `--record` is specified without `--record-path`, and `<path>` exists in SDF, a warning is printed, and recording will go to `<path>`, while console log will go to the default timestamp path.\r\n\r\nAs in this example:\r\n\r\n```\r\n# SDF specifies <path>/tmp/log</path>\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --record --log-compress -log-overwrite\r\n[Wrn] [ServerPrivate.cc:229] --record-path is not specified on command line. <path> is specified in SDF. Will record to <path>. Console will be logged to [/home/master/.ignition/gazebo/log/2019-09-20T19:51:33.996055619]. Note: In Ignition-D, <path> will be ignored, and all recordings will be written to default console log path if no path is specified on command line.\r\n[Msg] Overwriting existing file [/tmp/log/state.tlog]\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n...\r\n[Msg] Removing existing file [/tmp/log.zip].\r\n[Msg] Compressed log file and resources to [/tmp/log.zip].\r\nRemoving recorded directory [/tmp/log].\r\n```\r\n\r\nIn Ignition-D, `<path>` will be permanently ignored. Recordings and console log will go to same default path.\r\n\r\nIf `--record-path` is specified, then recording and console log will go to this path in Blueprint, Citadel, and Ignition-D.\r\n\r\n## Future Work\r\n\r\nFiles are outputted in `/tmp/log` and `/tmp/log.zip` in this example. During record, the original path in `file://` is prepended with the specified path, e.g. `/tmp/log`. During playback, the specified path is prepended to the URIs in the SDF.", "title": "[Blueprint] Logging meshes and materials", "destination": {"commit": {"hash": "2ff2b974cd61", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/commit/2ff2b974cd61.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/commits/2ff2b974cd61"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{f98d11fe-f287-4dfb-99c3-e2b76a13232e}ts=2082645"}}, "type": "repository", "name": "ign-gazebo", "full_name": "ignitionrobotics/ign-gazebo", "uuid": "{f98d11fe-f287-4dfb-99c3-e2b76a13232e}"}, "branch": {"name": "ign-gazebo2"}}, "reason": "", "source": {"commit": {"hash": "444f155c2920", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/commit/444f155c2920.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/commits/444f155c2920"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{f98d11fe-f287-4dfb-99c3-e2b76a13232e}ts=2082645"}}, "type": "repository", "name": "ign-gazebo", "full_name": "ignitionrobotics/ign-gazebo", "uuid": "{f98d11fe-f287-4dfb-99c3-e2b76a13232e}"}, "branch": {"name": "log_resources"}}, "state": "OPEN", "author": {"display_name": "Nate Koenig", "uuid": "{c862cdd9-fcc8-4419-9fc7-e20db14b8fcb}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Bc862cdd9-fcc8-4419-9fc7-e20db14b8fcb%7D"}, "html": {"href": "https://bitbucket.org/%7Bc862cdd9-fcc8-4419-9fc7-e20db14b8fcb%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:095b1e12-74ed-4e20-b44f-2f0745b616e0/ca24bb11-4787-4b14-a20d-d91835e9bde2/128"}}, "nickname": "Nathan Koenig", "type": "user", "account_id": "557058:095b1e12-74ed-4e20-b44f-2f0745b616e0"}, "date": "2019-10-08T16:37:05.982502+00:00"}, "pull_request": {"type": "pullrequest", "id": 397, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397"}}, "title": "[Blueprint] Logging meshes and materials"}}, {"comment": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397/comments/119792831.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397/_/diff#comment-119792831"}}, "parent": {"id": 119221025, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397/comments/119221025.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397/_/diff#comment-119221025"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 397, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397"}}, "title": "[Blueprint] Logging meshes and materials"}, "content": {"raw": "Playback on resources should be fixed now as of 51676dc", "markup": "markdown", "html": "<p>Playback on resources should be fixed now as of <a href=\"#!/ignitionrobotics/ign-gazebo/commits/51676dc\" rel=\"nofollow\" class=\"ap-connect-link\">51676dc</a></p>", "type": "rendered"}, "created_on": "2019-10-07T22:25:03.391964+00:00", "user": {"display_name": "Mabel Zhang", "uuid": "{4b0e38fb-bf50-45c0-a496-61147518b2bf}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B4b0e38fb-bf50-45c0-a496-61147518b2bf%7D"}, "html": {"href": "https://bitbucket.org/%7B4b0e38fb-bf50-45c0-a496-61147518b2bf%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:ceb5942c-6843-408c-8550-3ce4899d299b/4d48e5ea-cf28-4fa7-9715-8fc9e315d831/128"}}, "nickname": "mabelmzhang", "type": "user", "account_id": "557058:ceb5942c-6843-408c-8550-3ce4899d299b"}, "updated_on": "2019-10-07T22:25:03.403734+00:00", "type": "pullrequest_comment", "id": 119792831}, "pull_request": {"type": "pullrequest", "id": 397, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397"}}, "title": "[Blueprint] Logging meshes and materials"}}, {"update": {"description": "Depends on [ign-common PR 200](#!/ignitionrobotics/ign-common/pull-requests/200/log-resources/diff).\r\n\r\nPorts [this Gazebo PR](https://bitbucket.org/osrf/gazebo/pull-requests/2811/save-models-material-and-meshes-when/diff) to Ignition.\r\n\r\nImplements `--record-resources`, and `--log-compress` and `--log-overwrite` to support it.\r\n\r\nRecords resources \\(`--record-resources`\\), i.e. meshes and materials, to a directory under the specified log record directory. Optionally compresses \\(`--log-compress`\\) the whole directory, which contains the existing `.tlog` sqlite3 file and any resources, to a zip file. If directory or compressed file already exist, optionally overwrites \\(`--log-overwrite`\\).\r\n\r\nCorresponding SDF plugin parameters: `<record_resources>1</record_resources>`, `<compress>1</compress>.`If both command line and SDF parameters are specified, command line option overwrites SDF parameter. `--log-overwrite` is handled on command line only, outside of the plugin. If recording is only enabled from SDF and not from command line, then behavior is to always overwrite.\r\n\r\n## Usage:\r\n\r\n```\r\nign gazebo [...] --record-resources --log-overwrite --log-compress\r\n```\r\n\r\n## Test --record-resources:\r\n\r\n```\r\n# This SDF specifies the equivalent of --record-resources --record-path '/tmp/log'\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf\r\n$ ign gazebo -v 4 -r examples/worlds/log_playback.sdf\r\n```\r\n\r\nTested with `<include><uri>https://fuel...</uri></include>` and `<mesh><uri>file://...</uri></mesh>`. Paths specified by `model://` are not supported in Ignition yet, so this case in the code is not tested.\r\n\r\n## Test --log-overwrite and --log-compress:\r\n\r\nWhen recording to `path`, the compression file is implied to be `path.zip`. Both are checked for existence.\r\n\r\nNo `--log-overwrite` \\(default\\):\r\n\r\n```\r\n# This SDF specifies the equivalent of --record-path '/tmp/log'\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf\r\n\r\n# Run it again. By default it will always overwrite, because overwrite is now taken care of in ign.cc\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf\r\n[Msg] Overwriting existing file [/tmp/log/state.tlog]\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n```\r\n\r\n`--log-overwrite`, `/tmp/log` already exists:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-overwrite --record-path '/tmp/log'\r\n[Msg] Log path already exists on disk! Existing files will be overwritten.\r\n[Msg] Removing existing path [/tmp/log]\r\n...\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n...\r\n[Msg] Stopping recording\r\n```\r\n\r\n`--log-overwrite --log-compress`, `/tmp/log` exists, `/tmp/log.zip` does not exist:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-compress --log-overwrite --record-path '/tmp/log'\r\n[Msg] Log path already exists on disk! Existing files will be overwritten.\r\n[Msg] Removing existing path [/tmp/log]\r\n...\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n...\r\n[Msg] Compressed log file and resources to [/tmp/log.zip].\r\nRemoving recorded directory [/tmp/log].\r\n[Msg] Stopping recording\r\n```\r\n\r\n`--log-overwrite --log-compress`, `/tmp/log` does not exist, `/tmp/log.zip` exists:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-compress --log-overwrite --record-path '/tmp/log'\r\n[Wrn] [ign.cc:121] Compressed log path already exists on disk! Existing files will be overwritten.\r\n[Msg] Removing existing compressed file [/tmp/log.zip]\r\n...\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n...\r\n[Msg] Compressed log file and resources to [/tmp/log.zip].\r\nRemoving recorded directory [/tmp/log].\r\n[Msg] Stopping recording\r\n```\r\n\r\n`--log-overwrite` only, `/tmp/log.zip` exists, `/tmp/log` does not exist:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-overwrite --record-path '/tmp/log'\r\n[Wrn] [ign.cc:121] Compressed log path already exists on disk! Existing files will be overwritten.\r\n[Msg] Removing existing compressed file [/tmp/log.zip]\r\n...\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n...\r\n[Msg] Stopping recording\r\n```\r\n\r\n`--log-compress` only, both `/tmp/log` and `/tmp/log.zip` already exist:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-compress --record-path '/tmp/log'\r\n[Wrn] [ign.cc:152] Log path already exists on disk! Recording instead to [/tmp/log(1)]\r\n[Wrn] [ign.cc:154] Compressed log path already exists on disk! Recording instead to [/tmp/log(1).zip]\r\n...\r\n[Msg] Recording to log file [/tmp/log(1)/state.tlog]\r\n...\r\n[Msg] Compressed log file and resources to [/tmp/log(1).zip].\r\nRemoving recorded directory [/tmp/log(1)].\r\n[Msg] Stopping recording\r\n$ ls /tmp\r\nlog\r\n'log(1).zip'\r\nlog.zip\r\n```\r\n\r\n`--log-compress` only, `/tmp/log` does not exist, `/tmp/log.zip` exists, `/tmp/log(1).zip` exists:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-compress --record-path '/tmp/log'\r\n[Wrn] [ign.cc:152] Log path already exists on disk! Recording instead to [/tmp/log(2)]\r\n[Wrn] [ign.cc:154] Compressed log path already exists on disk! Recording instead to [/tmp/log(2).zip]\r\n...\r\n[Msg] Recording to log file [/tmp/log(2)/state.tlog]\r\n...\r\n[Msg] Compressed log file and resources to [/tmp/log(2).zip].\r\nRemoving recorded directory [/tmp/log(2)].\r\n[Msg] Stopping recording\r\n```\r\n\r\n## Record Path vs. Console Log Path\r\n\r\nIn Blueprint and Citadel, if `--record` is specified without `--record-path`, and `<path>` exists in SDF, a warning is printed, and recording will go to `<path>`, while console log will go to the default timestamp path.\r\n\r\nAs in this example:\r\n\r\n```\r\n# SDF specifies <path>/tmp/log</path>\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --record --log-compress -log-overwrite\r\n[Wrn] [ServerPrivate.cc:229] --record-path is not specified on command line. <path> is specified in SDF. Will record to <path>. Console will be logged to [/home/master/.ignition/gazebo/log/2019-09-20T19:51:33.996055619]. Note: In Ignition-D, <path> will be ignored, and all recordings will be written to default console log path if no path is specified on command line.\r\n[Msg] Overwriting existing file [/tmp/log/state.tlog]\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n...\r\n[Msg] Removing existing file [/tmp/log.zip].\r\n[Msg] Compressed log file and resources to [/tmp/log.zip].\r\nRemoving recorded directory [/tmp/log].\r\n```\r\n\r\nIn Ignition-D, `<path>` will be permanently ignored. Recordings and console log will go to same default path.\r\n\r\nIf `--record-path` is specified, then recording and console log will go to this path in Blueprint, Citadel, and Ignition-D.\r\n\r\n## Future Work\r\n\r\nFiles are outputted in `/tmp/log` and `/tmp/log.zip` in this example. During record, the original path in `file://` is prepended with the specified path, e.g. `/tmp/log`. During playback, the specified path is prepended to the URIs in the SDF.", "title": "[Blueprint] Logging meshes and materials", "destination": {"commit": {"hash": "2ff2b974cd61", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/commit/2ff2b974cd61.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/commits/2ff2b974cd61"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{f98d11fe-f287-4dfb-99c3-e2b76a13232e}ts=2082645"}}, "type": "repository", "name": "ign-gazebo", "full_name": "ignitionrobotics/ign-gazebo", "uuid": "{f98d11fe-f287-4dfb-99c3-e2b76a13232e}"}, "branch": {"name": "ign-gazebo2"}}, "reason": "", "source": {"commit": {"hash": "9a97c3e422f0", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/commit/9a97c3e422f0.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/commits/9a97c3e422f0"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{f98d11fe-f287-4dfb-99c3-e2b76a13232e}ts=2082645"}}, "type": "repository", "name": "ign-gazebo", "full_name": "ignitionrobotics/ign-gazebo", "uuid": "{f98d11fe-f287-4dfb-99c3-e2b76a13232e}"}, "branch": {"name": "log_resources"}}, "state": "OPEN", "author": {"display_name": "Mabel Zhang", "uuid": "{4b0e38fb-bf50-45c0-a496-61147518b2bf}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B4b0e38fb-bf50-45c0-a496-61147518b2bf%7D"}, "html": {"href": "https://bitbucket.org/%7B4b0e38fb-bf50-45c0-a496-61147518b2bf%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:ceb5942c-6843-408c-8550-3ce4899d299b/4d48e5ea-cf28-4fa7-9715-8fc9e315d831/128"}}, "nickname": "mabelmzhang", "type": "user", "account_id": "557058:ceb5942c-6843-408c-8550-3ce4899d299b"}, "date": "2019-10-07T22:24:18.530492+00:00"}, "pull_request": {"type": "pullrequest", "id": 397, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397"}}, "title": "[Blueprint] Logging meshes and materials"}}, {"update": {"description": "Depends on [ign-common PR 200](#!/ignitionrobotics/ign-common/pull-requests/200/log-resources/diff).\r\n\r\nPorts [this Gazebo PR](https://bitbucket.org/osrf/gazebo/pull-requests/2811/save-models-material-and-meshes-when/diff) to Ignition.\r\n\r\nImplements `--record-resources`, and `--log-compress` and `--log-overwrite` to support it.\r\n\r\nRecords resources \\(`--record-resources`\\), i.e. meshes and materials, to a directory under the specified log record directory. Optionally compresses \\(`--log-compress`\\) the whole directory, which contains the existing `.tlog` sqlite3 file and any resources, to a zip file. If directory or compressed file already exist, optionally overwrites \\(`--log-overwrite`\\).\r\n\r\nCorresponding SDF plugin parameters: `<record_resources>1</record_resources>`, `<compress>1</compress>.`If both command line and SDF parameters are specified, command line option overwrites SDF parameter. `--log-overwrite` is handled on command line only, outside of the plugin. If recording is only enabled from SDF and not from command line, then behavior is to always overwrite.\r\n\r\n## Usage:\r\n\r\n```\r\nign gazebo [...] --record-resources --log-overwrite --log-compress\r\n```\r\n\r\n## Test --record-resources:\r\n\r\n```\r\n# This SDF specifies the equivalent of --record-resources --record-path '/tmp/log'\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf\r\n$ ign gazebo -v 4 -r examples/worlds/log_playback.sdf\r\n```\r\n\r\nTested with `<include><uri>https://fuel...</uri></include>` and `<mesh><uri>file://...</uri></mesh>`. Paths specified by `model://` are not supported in Ignition yet, so this case in the code is not tested.\r\n\r\n## Test --log-overwrite and --log-compress:\r\n\r\nWhen recording to `path`, the compression file is implied to be `path.zip`. Both are checked for existence.\r\n\r\nNo `--log-overwrite` \\(default\\):\r\n\r\n```\r\n# This SDF specifies the equivalent of --record-path '/tmp/log'\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf\r\n\r\n# Run it again. By default it will always overwrite, because overwrite is now taken care of in ign.cc\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf\r\n[Msg] Overwriting existing file [/tmp/log/state.tlog]\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n```\r\n\r\n`--log-overwrite`, `/tmp/log` already exists:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-overwrite --record-path '/tmp/log'\r\n[Msg] Log path already exists on disk! Existing files will be overwritten.\r\n[Msg] Removing existing path [/tmp/log]\r\n...\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n...\r\n[Msg] Stopping recording\r\n```\r\n\r\n`--log-overwrite --log-compress`, `/tmp/log` exists, `/tmp/log.zip` does not exist:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-compress --log-overwrite --record-path '/tmp/log'\r\n[Msg] Log path already exists on disk! Existing files will be overwritten.\r\n[Msg] Removing existing path [/tmp/log]\r\n...\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n...\r\n[Msg] Compressed log file and resources to [/tmp/log.zip].\r\nRemoving recorded directory [/tmp/log].\r\n[Msg] Stopping recording\r\n```\r\n\r\n`--log-overwrite --log-compress`, `/tmp/log` does not exist, `/tmp/log.zip` exists:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-compress --log-overwrite --record-path '/tmp/log'\r\n[Wrn] [ign.cc:121] Compressed log path already exists on disk! Existing files will be overwritten.\r\n[Msg] Removing existing compressed file [/tmp/log.zip]\r\n...\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n...\r\n[Msg] Compressed log file and resources to [/tmp/log.zip].\r\nRemoving recorded directory [/tmp/log].\r\n[Msg] Stopping recording\r\n```\r\n\r\n`--log-overwrite` only, `/tmp/log.zip` exists, `/tmp/log` does not exist:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-overwrite --record-path '/tmp/log'\r\n[Wrn] [ign.cc:121] Compressed log path already exists on disk! Existing files will be overwritten.\r\n[Msg] Removing existing compressed file [/tmp/log.zip]\r\n...\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n...\r\n[Msg] Stopping recording\r\n```\r\n\r\n`--log-compress` only, both `/tmp/log` and `/tmp/log.zip` already exist:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-compress --record-path '/tmp/log'\r\n[Wrn] [ign.cc:152] Log path already exists on disk! Recording instead to [/tmp/log(1)]\r\n[Wrn] [ign.cc:154] Compressed log path already exists on disk! Recording instead to [/tmp/log(1).zip]\r\n...\r\n[Msg] Recording to log file [/tmp/log(1)/state.tlog]\r\n...\r\n[Msg] Compressed log file and resources to [/tmp/log(1).zip].\r\nRemoving recorded directory [/tmp/log(1)].\r\n[Msg] Stopping recording\r\n$ ls /tmp\r\nlog\r\n'log(1).zip'\r\nlog.zip\r\n```\r\n\r\n`--log-compress` only, `/tmp/log` does not exist, `/tmp/log.zip` exists, `/tmp/log(1).zip` exists:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-compress --record-path '/tmp/log'\r\n[Wrn] [ign.cc:152] Log path already exists on disk! Recording instead to [/tmp/log(2)]\r\n[Wrn] [ign.cc:154] Compressed log path already exists on disk! Recording instead to [/tmp/log(2).zip]\r\n...\r\n[Msg] Recording to log file [/tmp/log(2)/state.tlog]\r\n...\r\n[Msg] Compressed log file and resources to [/tmp/log(2).zip].\r\nRemoving recorded directory [/tmp/log(2)].\r\n[Msg] Stopping recording\r\n```\r\n\r\n## Record Path vs. Console Log Path\r\n\r\nIn Blueprint and Citadel, if `--record` is specified without `--record-path`, and `<path>` exists in SDF, a warning is printed, and recording will go to `<path>`, while console log will go to the default timestamp path.\r\n\r\nAs in this example:\r\n\r\n```\r\n# SDF specifies <path>/tmp/log</path>\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --record --log-compress -log-overwrite\r\n[Wrn] [ServerPrivate.cc:229] --record-path is not specified on command line. <path> is specified in SDF. Will record to <path>. Console will be logged to [/home/master/.ignition/gazebo/log/2019-09-20T19:51:33.996055619]. Note: In Ignition-D, <path> will be ignored, and all recordings will be written to default console log path if no path is specified on command line.\r\n[Msg] Overwriting existing file [/tmp/log/state.tlog]\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n...\r\n[Msg] Removing existing file [/tmp/log.zip].\r\n[Msg] Compressed log file and resources to [/tmp/log.zip].\r\nRemoving recorded directory [/tmp/log].\r\n```\r\n\r\nIn Ignition-D, `<path>` will be permanently ignored. Recordings and console log will go to same default path.\r\n\r\nIf `--record-path` is specified, then recording and console log will go to this path in Blueprint, Citadel, and Ignition-D.\r\n\r\n## Future Work\r\n\r\nFiles are outputted in `/tmp/log` and `/tmp/log.zip` in this example. During record, the original path in `file://` is prepended with the specified path, e.g. `/tmp/log`. During playback, the specified path is prepended to the URIs in the SDF.", "title": "[Blueprint] Logging meshes and materials", "destination": {"commit": {"hash": "2ff2b974cd61", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/commit/2ff2b974cd61.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/commits/2ff2b974cd61"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{f98d11fe-f287-4dfb-99c3-e2b76a13232e}ts=2082645"}}, "type": "repository", "name": "ign-gazebo", "full_name": "ignitionrobotics/ign-gazebo", "uuid": "{f98d11fe-f287-4dfb-99c3-e2b76a13232e}"}, "branch": {"name": "ign-gazebo2"}}, "reason": "", "source": {"commit": {"hash": "51676dc956f7", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/commit/51676dc956f7.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/commits/51676dc956f7"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{f98d11fe-f287-4dfb-99c3-e2b76a13232e}ts=2082645"}}, "type": "repository", "name": "ign-gazebo", "full_name": "ignitionrobotics/ign-gazebo", "uuid": "{f98d11fe-f287-4dfb-99c3-e2b76a13232e}"}, "branch": {"name": "log_resources"}}, "state": "OPEN", "author": {"display_name": "Mabel Zhang", "uuid": "{4b0e38fb-bf50-45c0-a496-61147518b2bf}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B4b0e38fb-bf50-45c0-a496-61147518b2bf%7D"}, "html": {"href": "https://bitbucket.org/%7B4b0e38fb-bf50-45c0-a496-61147518b2bf%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:ceb5942c-6843-408c-8550-3ce4899d299b/4d48e5ea-cf28-4fa7-9715-8fc9e315d831/128"}}, "nickname": "mabelmzhang", "type": "user", "account_id": "557058:ceb5942c-6843-408c-8550-3ce4899d299b"}, "date": "2019-10-07T22:17:47.417675+00:00"}, "pull_request": {"type": "pullrequest", "id": 397, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397"}}, "title": "[Blueprint] Logging meshes and materials"}}, {"update": {"description": "Depends on [ign-common PR 200](#!/ignitionrobotics/ign-common/pull-requests/200/log-resources/diff).\r\n\r\nPorts [this Gazebo PR](https://bitbucket.org/osrf/gazebo/pull-requests/2811/save-models-material-and-meshes-when/diff) to Ignition.\r\n\r\nImplements `--record-resources`, and `--log-compress` and `--log-overwrite` to support it.\r\n\r\nRecords resources \\(`--record-resources`\\), i.e. meshes and materials, to a directory under the specified log record directory. Optionally compresses \\(`--log-compress`\\) the whole directory, which contains the existing `.tlog` sqlite3 file and any resources, to a zip file. If directory or compressed file already exist, optionally overwrites \\(`--log-overwrite`\\).\r\n\r\nCorresponding SDF plugin parameters: `<record_resources>1</record_resources>`, `<compress>1</compress>.`If both command line and SDF parameters are specified, command line option overwrites SDF parameter. `--log-overwrite` is handled on command line only, outside of the plugin. If recording is only enabled from SDF and not from command line, then behavior is to always overwrite.\r\n\r\n## Usage:\r\n\r\n```\r\nign gazebo [...] --record-resources --log-overwrite --log-compress\r\n```\r\n\r\n## Test --record-resources:\r\n\r\n```\r\n# This SDF specifies the equivalent of --record-resources --record-path '/tmp/log'\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf\r\n$ ign gazebo -v 4 -r examples/worlds/log_playback.sdf\r\n```\r\n\r\nTested with `<include><uri>https://fuel...</uri></include>` and `<mesh><uri>file://...</uri></mesh>`. Paths specified by `model://` are not supported in Ignition yet, so this case in the code is not tested.\r\n\r\n## Test --log-overwrite and --log-compress:\r\n\r\nWhen recording to `path`, the compression file is implied to be `path.zip`. Both are checked for existence.\r\n\r\nNo `--log-overwrite` \\(default\\):\r\n\r\n```\r\n# This SDF specifies the equivalent of --record-path '/tmp/log'\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf\r\n\r\n# Run it again. By default it will always overwrite, because overwrite is now taken care of in ign.cc\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf\r\n[Msg] Overwriting existing file [/tmp/log/state.tlog]\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n```\r\n\r\n`--log-overwrite`, `/tmp/log` already exists:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-overwrite --record-path '/tmp/log'\r\n[Msg] Log path already exists on disk! Existing files will be overwritten.\r\n[Msg] Removing existing path [/tmp/log]\r\n...\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n...\r\n[Msg] Stopping recording\r\n```\r\n\r\n`--log-overwrite --log-compress`, `/tmp/log` exists, `/tmp/log.zip` does not exist:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-compress --log-overwrite --record-path '/tmp/log'\r\n[Msg] Log path already exists on disk! Existing files will be overwritten.\r\n[Msg] Removing existing path [/tmp/log]\r\n...\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n...\r\n[Msg] Compressed log file and resources to [/tmp/log.zip].\r\nRemoving recorded directory [/tmp/log].\r\n[Msg] Stopping recording\r\n```\r\n\r\n`--log-overwrite --log-compress`, `/tmp/log` does not exist, `/tmp/log.zip` exists:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-compress --log-overwrite --record-path '/tmp/log'\r\n[Wrn] [ign.cc:121] Compressed log path already exists on disk! Existing files will be overwritten.\r\n[Msg] Removing existing compressed file [/tmp/log.zip]\r\n...\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n...\r\n[Msg] Compressed log file and resources to [/tmp/log.zip].\r\nRemoving recorded directory [/tmp/log].\r\n[Msg] Stopping recording\r\n```\r\n\r\n`--log-overwrite` only, `/tmp/log.zip` exists, `/tmp/log` does not exist:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-overwrite --record-path '/tmp/log'\r\n[Wrn] [ign.cc:121] Compressed log path already exists on disk! Existing files will be overwritten.\r\n[Msg] Removing existing compressed file [/tmp/log.zip]\r\n...\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n...\r\n[Msg] Stopping recording\r\n```\r\n\r\n`--log-compress` only, both `/tmp/log` and `/tmp/log.zip` already exist:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-compress --record-path '/tmp/log'\r\n[Wrn] [ign.cc:152] Log path already exists on disk! Recording instead to [/tmp/log(1)]\r\n[Wrn] [ign.cc:154] Compressed log path already exists on disk! Recording instead to [/tmp/log(1).zip]\r\n...\r\n[Msg] Recording to log file [/tmp/log(1)/state.tlog]\r\n...\r\n[Msg] Compressed log file and resources to [/tmp/log(1).zip].\r\nRemoving recorded directory [/tmp/log(1)].\r\n[Msg] Stopping recording\r\n$ ls /tmp\r\nlog\r\n'log(1).zip'\r\nlog.zip\r\n```\r\n\r\n`--log-compress` only, `/tmp/log` does not exist, `/tmp/log.zip` exists, `/tmp/log(1).zip` exists:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-compress --record-path '/tmp/log'\r\n[Wrn] [ign.cc:152] Log path already exists on disk! Recording instead to [/tmp/log(2)]\r\n[Wrn] [ign.cc:154] Compressed log path already exists on disk! Recording instead to [/tmp/log(2).zip]\r\n...\r\n[Msg] Recording to log file [/tmp/log(2)/state.tlog]\r\n...\r\n[Msg] Compressed log file and resources to [/tmp/log(2).zip].\r\nRemoving recorded directory [/tmp/log(2)].\r\n[Msg] Stopping recording\r\n```\r\n\r\n## Record Path vs. Console Log Path\r\n\r\nIn Blueprint and Citadel, if `--record` is specified without `--record-path`, and `<path>` exists in SDF, a warning is printed, and recording will go to `<path>`, while console log will go to the default timestamp path.\r\n\r\nAs in this example:\r\n\r\n```\r\n# SDF specifies <path>/tmp/log</path>\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --record --log-compress -log-overwrite\r\n[Wrn] [ServerPrivate.cc:229] --record-path is not specified on command line. <path> is specified in SDF. Will record to <path>. Console will be logged to [/home/master/.ignition/gazebo/log/2019-09-20T19:51:33.996055619]. Note: In Ignition-D, <path> will be ignored, and all recordings will be written to default console log path if no path is specified on command line.\r\n[Msg] Overwriting existing file [/tmp/log/state.tlog]\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n...\r\n[Msg] Removing existing file [/tmp/log.zip].\r\n[Msg] Compressed log file and resources to [/tmp/log.zip].\r\nRemoving recorded directory [/tmp/log].\r\n```\r\n\r\nIn Ignition-D, `<path>` will be permanently ignored. Recordings and console log will go to same default path.\r\n\r\nIf `--record-path` is specified, then recording and console log will go to this path in Blueprint, Citadel, and Ignition-D.\r\n\r\n## Future Work\r\n\r\nFiles are outputted in `/tmp/log` and `/tmp/log.zip` in this example. During record, the original path in `file://` is prepended with the specified path, e.g. `/tmp/log`. During playback, the specified path is prepended to the URIs in the SDF.", "title": "[Blueprint] Logging meshes and materials", "destination": {"commit": {"hash": "2ff2b974cd61", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/commit/2ff2b974cd61.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/commits/2ff2b974cd61"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{f98d11fe-f287-4dfb-99c3-e2b76a13232e}ts=2082645"}}, "type": "repository", "name": "ign-gazebo", "full_name": "ignitionrobotics/ign-gazebo", "uuid": "{f98d11fe-f287-4dfb-99c3-e2b76a13232e}"}, "branch": {"name": "ign-gazebo2"}}, "reason": "", "source": {"commit": {"hash": "1a401fe58b0b", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/commit/1a401fe58b0b.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/commits/1a401fe58b0b"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{f98d11fe-f287-4dfb-99c3-e2b76a13232e}ts=2082645"}}, "type": "repository", "name": "ign-gazebo", "full_name": "ignitionrobotics/ign-gazebo", "uuid": "{f98d11fe-f287-4dfb-99c3-e2b76a13232e}"}, "branch": {"name": "log_resources"}}, "state": "OPEN", "author": {"display_name": "Mabel Zhang", "uuid": "{4b0e38fb-bf50-45c0-a496-61147518b2bf}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B4b0e38fb-bf50-45c0-a496-61147518b2bf%7D"}, "html": {"href": "https://bitbucket.org/%7B4b0e38fb-bf50-45c0-a496-61147518b2bf%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:ceb5942c-6843-408c-8550-3ce4899d299b/4d48e5ea-cf28-4fa7-9715-8fc9e315d831/128"}}, "nickname": "mabelmzhang", "type": "user", "account_id": "557058:ceb5942c-6843-408c-8550-3ce4899d299b"}, "date": "2019-10-07T21:59:33.259202+00:00"}, "pull_request": {"type": "pullrequest", "id": 397, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397"}}, "title": "[Blueprint] Logging meshes and materials"}}, {"comment": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397/comments/119221025.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397/_/diff#comment-119221025"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 397, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397"}}, "title": "[Blueprint] Logging meshes and materials"}, "content": {"raw": "I can record the state and meshes, but playback doesn't seem to work. Not sure if this is expected behavior. \n\nMy test procedure:\n\n1. Modify `log_record_resources.sdf` to enable `<record_resources>`.\n1. Run `ign gazebo ../examples/worlds/log_record_resources.sdf`\n1. Quit simulation\n1. Remove/move my `~/.ignition/fuel` directory.\n1. Playback the recorded log file. Here is where I would expect gazebo to use the models stored alongside the state log file. However, I get errors about missing models.", "markup": "markdown", "html": "<p>I can record the state and meshes, but playback doesn't seem to work. Not sure if this is expected behavior. </p>\n<p>My test procedure:</p>\n<ol>\n<li>Modify <code>log_record_resources.sdf</code> to enable <code>&lt;record_resources&gt;</code>.</li>\n<li>Run <code>ign gazebo ../examples/worlds/log_record_resources.sdf</code></li>\n<li>Quit simulation</li>\n<li>Remove/move my <code>~/.ignition/fuel</code> directory.</li>\n<li>Playback the recorded log file. Here is where I would expect gazebo to use the models stored alongside the state log file. However, I get errors about missing models.</li>\n</ol>", "type": "rendered"}, "created_on": "2019-10-02T15:54:30.479372+00:00", "user": {"display_name": "Nate Koenig", "uuid": "{c862cdd9-fcc8-4419-9fc7-e20db14b8fcb}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Bc862cdd9-fcc8-4419-9fc7-e20db14b8fcb%7D"}, "html": {"href": "https://bitbucket.org/%7Bc862cdd9-fcc8-4419-9fc7-e20db14b8fcb%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:095b1e12-74ed-4e20-b44f-2f0745b616e0/ca24bb11-4787-4b14-a20d-d91835e9bde2/128"}}, "nickname": "Nathan Koenig", "type": "user", "account_id": "557058:095b1e12-74ed-4e20-b44f-2f0745b616e0"}, "updated_on": "2019-10-02T15:54:30.493564+00:00", "type": "pullrequest_comment", "id": 119221025}, "pull_request": {"type": "pullrequest", "id": 397, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397"}}, "title": "[Blueprint] Logging meshes and materials"}}, {"update": {"description": "Depends on [ign-common PR 200](#!/ignitionrobotics/ign-common/pull-requests/200/log-resources/diff).\r\n\r\nPorts [this Gazebo PR](https://bitbucket.org/osrf/gazebo/pull-requests/2811/save-models-material-and-meshes-when/diff) to Ignition.\r\n\r\nImplements `--record-resources`, and `--log-compress` and `--log-overwrite` to support it.\r\n\r\nRecords resources \\(`--record-resources`\\), i.e. meshes and materials, to a directory under the specified log record directory. Optionally compresses \\(`--log-compress`\\) the whole directory, which contains the existing `.tlog` sqlite3 file and any resources, to a zip file. If directory or compressed file already exist, optionally overwrites \\(`--log-overwrite`\\).\r\n\r\nCorresponding SDF plugin parameters: `<record_resources>1</record_resources>`, `<compress>1</compress>.`If both command line and SDF parameters are specified, command line option overwrites SDF parameter. `--log-overwrite` is handled on command line only, outside of the plugin. If recording is only enabled from SDF and not from command line, then behavior is to always overwrite.\r\n\r\n## Usage:\r\n\r\n```\r\nign gazebo [...] --record-resources --log-overwrite --log-compress\r\n```\r\n\r\n## Test --record-resources:\r\n\r\n```\r\n# This SDF specifies the equivalent of --record-resources --record-path '/tmp/log'\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf\r\n$ ign gazebo -v 4 -r examples/worlds/log_playback.sdf\r\n```\r\n\r\nTested with `<include><uri>https://fuel...</uri></include>` and `<mesh><uri>file://...</uri></mesh>`. Paths specified by `model://` are not supported in Ignition yet, so this case in the code is not tested.\r\n\r\n## Test --log-overwrite and --log-compress:\r\n\r\nWhen recording to `path`, the compression file is implied to be `path.zip`. Both are checked for existence.\r\n\r\nNo `--log-overwrite` \\(default\\):\r\n\r\n```\r\n# This SDF specifies the equivalent of --record-path '/tmp/log'\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf\r\n\r\n# Run it again. By default it will always overwrite, because overwrite is now taken care of in ign.cc\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf\r\n[Msg] Overwriting existing file [/tmp/log/state.tlog]\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n```\r\n\r\n`--log-overwrite`, `/tmp/log` already exists:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-overwrite --record-path '/tmp/log'\r\n[Msg] Log path already exists on disk! Existing files will be overwritten.\r\n[Msg] Removing existing path [/tmp/log]\r\n...\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n...\r\n[Msg] Stopping recording\r\n```\r\n\r\n`--log-overwrite --log-compress`, `/tmp/log` exists, `/tmp/log.zip` does not exist:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-compress --log-overwrite --record-path '/tmp/log'\r\n[Msg] Log path already exists on disk! Existing files will be overwritten.\r\n[Msg] Removing existing path [/tmp/log]\r\n...\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n...\r\n[Msg] Compressed log file and resources to [/tmp/log.zip].\r\nRemoving recorded directory [/tmp/log].\r\n[Msg] Stopping recording\r\n```\r\n\r\n`--log-overwrite --log-compress`, `/tmp/log` does not exist, `/tmp/log.zip` exists:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-compress --log-overwrite --record-path '/tmp/log'\r\n[Wrn] [ign.cc:121] Compressed log path already exists on disk! Existing files will be overwritten.\r\n[Msg] Removing existing compressed file [/tmp/log.zip]\r\n...\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n...\r\n[Msg] Compressed log file and resources to [/tmp/log.zip].\r\nRemoving recorded directory [/tmp/log].\r\n[Msg] Stopping recording\r\n```\r\n\r\n`--log-overwrite` only, `/tmp/log.zip` exists, `/tmp/log` does not exist:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-overwrite --record-path '/tmp/log'\r\n[Wrn] [ign.cc:121] Compressed log path already exists on disk! Existing files will be overwritten.\r\n[Msg] Removing existing compressed file [/tmp/log.zip]\r\n...\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n...\r\n[Msg] Stopping recording\r\n```\r\n\r\n`--log-compress` only, both `/tmp/log` and `/tmp/log.zip` already exist:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-compress --record-path '/tmp/log'\r\n[Wrn] [ign.cc:152] Log path already exists on disk! Recording instead to [/tmp/log(1)]\r\n[Wrn] [ign.cc:154] Compressed log path already exists on disk! Recording instead to [/tmp/log(1).zip]\r\n...\r\n[Msg] Recording to log file [/tmp/log(1)/state.tlog]\r\n...\r\n[Msg] Compressed log file and resources to [/tmp/log(1).zip].\r\nRemoving recorded directory [/tmp/log(1)].\r\n[Msg] Stopping recording\r\n$ ls /tmp\r\nlog\r\n'log(1).zip'\r\nlog.zip\r\n```\r\n\r\n`--log-compress` only, `/tmp/log` does not exist, `/tmp/log.zip` exists, `/tmp/log(1).zip` exists:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-compress --record-path '/tmp/log'\r\n[Wrn] [ign.cc:152] Log path already exists on disk! Recording instead to [/tmp/log(2)]\r\n[Wrn] [ign.cc:154] Compressed log path already exists on disk! Recording instead to [/tmp/log(2).zip]\r\n...\r\n[Msg] Recording to log file [/tmp/log(2)/state.tlog]\r\n...\r\n[Msg] Compressed log file and resources to [/tmp/log(2).zip].\r\nRemoving recorded directory [/tmp/log(2)].\r\n[Msg] Stopping recording\r\n```\r\n\r\n## Record Path vs. Console Log Path\r\n\r\nIn Blueprint and Citadel, if `--record` is specified without `--record-path`, and `<path>` exists in SDF, a warning is printed, and recording will go to `<path>`, while console log will go to the default timestamp path.\r\n\r\nAs in this example:\r\n\r\n```\r\n# SDF specifies <path>/tmp/log</path>\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --record --log-compress -log-overwrite\r\n[Wrn] [ServerPrivate.cc:229] --record-path is not specified on command line. <path> is specified in SDF. Will record to <path>. Console will be logged to [/home/master/.ignition/gazebo/log/2019-09-20T19:51:33.996055619]. Note: In Ignition-D, <path> will be ignored, and all recordings will be written to default console log path if no path is specified on command line.\r\n[Msg] Overwriting existing file [/tmp/log/state.tlog]\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n...\r\n[Msg] Removing existing file [/tmp/log.zip].\r\n[Msg] Compressed log file and resources to [/tmp/log.zip].\r\nRemoving recorded directory [/tmp/log].\r\n```\r\n\r\nIn Ignition-D, `<path>` will be permanently ignored. Recordings and console log will go to same default path.\r\n\r\nIf `--record-path` is specified, then recording and console log will go to this path in Blueprint, Citadel, and Ignition-D.\r\n\r\n## Future Work\r\n\r\nFiles are outputted in `/tmp/log` and `/tmp/log.zip` in this example. During record, the original path in `file://` is prepended with the specified path, e.g. `/tmp/log`. During playback, the specified path is prepended to the URIs in the SDF.", "title": "[Blueprint] Logging meshes and materials", "destination": {"commit": {"hash": "890e28ea75d0", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/commit/890e28ea75d0.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/commits/890e28ea75d0"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{f98d11fe-f287-4dfb-99c3-e2b76a13232e}ts=2082645"}}, "type": "repository", "name": "ign-gazebo", "full_name": "ignitionrobotics/ign-gazebo", "uuid": "{f98d11fe-f287-4dfb-99c3-e2b76a13232e}"}, "branch": {"name": "ign-gazebo2"}}, "reason": "", "source": {"commit": {"hash": "04e6cb7d4344", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/commit/04e6cb7d4344.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/commits/04e6cb7d4344"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{f98d11fe-f287-4dfb-99c3-e2b76a13232e}ts=2082645"}}, "type": "repository", "name": "ign-gazebo", "full_name": "ignitionrobotics/ign-gazebo", "uuid": "{f98d11fe-f287-4dfb-99c3-e2b76a13232e}"}, "branch": {"name": "log_resources"}}, "state": "OPEN", "author": {"display_name": "Mabel Zhang", "uuid": "{4b0e38fb-bf50-45c0-a496-61147518b2bf}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B4b0e38fb-bf50-45c0-a496-61147518b2bf%7D"}, "html": {"href": "https://bitbucket.org/%7B4b0e38fb-bf50-45c0-a496-61147518b2bf%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:ceb5942c-6843-408c-8550-3ce4899d299b/4d48e5ea-cf28-4fa7-9715-8fc9e315d831/128"}}, "nickname": "mabelmzhang", "type": "user", "account_id": "557058:ceb5942c-6843-408c-8550-3ce4899d299b"}, "date": "2019-10-01T18:26:38.576833+00:00"}, "pull_request": {"type": "pullrequest", "id": 397, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397"}}, "title": "[Blueprint] Logging meshes and materials"}}, {"update": {"description": "Depends on [ign-common PR 200](#!/ignitionrobotics/ign-common/pull-requests/200/log-resources/diff).\r\n\r\nPorts [this Gazebo PR](https://bitbucket.org/osrf/gazebo/pull-requests/2811/save-models-material-and-meshes-when/diff) to Ignition.\r\n\r\nImplements `--record-resources`, and `--log-compress` and `--log-overwrite` to support it.\r\n\r\nRecords resources \\(`--record-resources`\\), i.e. meshes and materials, to a directory under the specified log record directory. Optionally compresses \\(`--log-compress`\\) the whole directory, which contains the existing `.tlog` sqlite3 file and any resources, to a zip file. If directory or compressed file already exist, optionally overwrites \\(`--log-overwrite`\\).\r\n\r\nCorresponding SDF plugin parameters: `<record_resources>1</record_resources>`, `<compress>1</compress>.`If both command line and SDF parameters are specified, command line option overwrites SDF parameter. `--log-overwrite` is handled on command line only, outside of the plugin. If recording is only enabled from SDF and not from command line, then behavior is to always overwrite.\r\n\r\n## Usage:\r\n\r\n```\r\nign gazebo [...] --record-resources --log-overwrite --log-compress\r\n```\r\n\r\n## Test --record-resources:\r\n\r\n```\r\n# This SDF specifies the equivalent of --record-resources --record-path '/tmp/log'\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf\r\n$ ign gazebo -v 4 -r examples/worlds/log_playback.sdf\r\n```\r\n\r\nTested with `<include><uri>https://fuel...</uri></include>` and `<mesh><uri>file://...</uri></mesh>`. Paths specified by `model://` are not supported in Ignition yet, so this case in the code is not tested.\r\n\r\n## Test --log-overwrite and --log-compress:\r\n\r\nWhen recording to `path`, the compression file is implied to be `path.zip`. Both are checked for existence.\r\n\r\nNo `--log-overwrite` \\(default\\):\r\n\r\n```\r\n# This SDF specifies the equivalent of --record-path '/tmp/log'\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf\r\n\r\n# Run it again. By default it will always overwrite, because overwrite is now taken care of in ign.cc\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf\r\n[Msg] Overwriting existing file [/tmp/log/state.tlog]\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n```\r\n\r\n`--log-overwrite`, `/tmp/log` already exists:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-overwrite --record-path '/tmp/log'\r\n[Msg] Log path already exists on disk! Existing files will be overwritten.\r\n[Msg] Removing existing path [/tmp/log]\r\n...\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n...\r\n[Msg] Stopping recording\r\n```\r\n\r\n`--log-overwrite --log-compress`, `/tmp/log` exists, `/tmp/log.zip` does not exist:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-compress --log-overwrite --record-path '/tmp/log'\r\n[Msg] Log path already exists on disk! Existing files will be overwritten.\r\n[Msg] Removing existing path [/tmp/log]\r\n...\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n...\r\n[Msg] Compressed log file and resources to [/tmp/log.zip].\r\nRemoving recorded directory [/tmp/log].\r\n[Msg] Stopping recording\r\n```\r\n\r\n`--log-overwrite --log-compress`,  `/tmp/log` does not exist, `/tmp/log.zip`  exists:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-compress --log-overwrite --record-path '/tmp/log'\r\n[Wrn] [ign.cc:121] Compressed log path already exists on disk! Existing files will be overwritten.\r\n[Msg] Removing existing compressed file [/tmp/log.zip]\r\n...\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n...\r\n[Msg] Compressed log file and resources to [/tmp/log.zip].\r\nRemoving recorded directory [/tmp/log].\r\n[Msg] Stopping recording\r\n```\r\n\r\n`--log-overwrite` only, `/tmp/log.zip` exists, `/tmp/log` does not exist:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-overwrite --record-path '/tmp/log'\r\n[Wrn] [ign.cc:121] Compressed log path already exists on disk! Existing files will be overwritten.\r\n[Msg] Removing existing compressed file [/tmp/log.zip]\r\n...\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n...\r\n[Msg] Stopping recording\r\n```\r\n\r\n`--log-compress` only, both `/tmp/log` and `/tmp/log.zip` already exist:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-compress --record-path '/tmp/log'\r\n[Wrn] [ign.cc:152] Log path already exists on disk! Recording instead to [/tmp/log(1)]\r\n[Wrn] [ign.cc:154] Compressed log path already exists on disk! Recording instead to [/tmp/log(1).zip]\r\n...\r\n[Msg] Recording to log file [/tmp/log(1)/state.tlog]\r\n...\r\n[Msg] Compressed log file and resources to [/tmp/log(1).zip].\r\nRemoving recorded directory [/tmp/log(1)].\r\n[Msg] Stopping recording\r\n$ ls /tmp\r\nlog\r\n'log(1).zip'\r\nlog.zip\r\n```\r\n\r\n`--log-compress` only, `/tmp/log` does not exist, `/tmp/log.zip` exists, `/tmp/log(1).zip` exists:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-compress --record-path '/tmp/log'\r\n[Wrn] [ign.cc:152] Log path already exists on disk! Recording instead to [/tmp/log(2)]\r\n[Wrn] [ign.cc:154] Compressed log path already exists on disk! Recording instead to [/tmp/log(2).zip]\r\n...\r\n[Msg] Recording to log file [/tmp/log(2)/state.tlog]\r\n...\r\n[Msg] Compressed log file and resources to [/tmp/log(2).zip].\r\nRemoving recorded directory [/tmp/log(2)].\r\n[Msg] Stopping recording\r\n```\r\n\r\n## Record Path vs. Console Log Path\r\n\r\nIn Blueprint and Citadel, if `--record` is specified without `--record-path`, and `<path>` exists in SDF, a warning is printed, and recording will go to `<path>`, while console log will go to the default timestamp path.\r\n\r\nAs in this example:\r\n\r\n```\r\n# SDF specifies <path>/tmp/log</path>\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --record --log-compress -log-overwrite\r\n[Wrn] [ServerPrivate.cc:229] --record-path is not specified on command line. <path> is specified in SDF. Will record to <path>. Console will be logged to [/home/master/.ignition/gazebo/log/2019-09-20T19:51:33.996055619]. Note: In Ignition-D, <path> will be ignored, and all recordings will be written to default console log path if no path is specified on command line.\r\n[Msg] Overwriting existing file [/tmp/log/state.tlog]\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n...\r\n[Msg] Removing existing file [/tmp/log.zip].\r\n[Msg] Compressed log file and resources to [/tmp/log.zip].\r\nRemoving recorded directory [/tmp/log].\r\n```\r\n\r\nIn Ignition-D, `<path>` will be permanently ignored. Recordings and console log will go to same default path.\r\n\r\nIf `--record-path` is specified, then recording and console log will go to this path in Blueprint, Citadel, and Ignition-D.\r\n\r\n## Future Work\r\n\r\nFiles are outputted in `/tmp/log` and `/tmp/log.zip` in this example. During record, the original path in `file://` is prepended with the specified path, e.g. `/tmp/log`. During playback, the specified path is prepended to the URIs in the SDF.", "title": "[Blueprint] Logging meshes and materials", "destination": {"commit": {"hash": "890e28ea75d0", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/commit/890e28ea75d0.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/commits/890e28ea75d0"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{f98d11fe-f287-4dfb-99c3-e2b76a13232e}ts=2082645"}}, "type": "repository", "name": "ign-gazebo", "full_name": "ignitionrobotics/ign-gazebo", "uuid": "{f98d11fe-f287-4dfb-99c3-e2b76a13232e}"}, "branch": {"name": "ign-gazebo2"}}, "reason": "", "source": {"commit": {"hash": "04e6cb7d4344", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/commit/04e6cb7d4344.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/commits/04e6cb7d4344"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{f98d11fe-f287-4dfb-99c3-e2b76a13232e}ts=2082645"}}, "type": "repository", "name": "ign-gazebo", "full_name": "ignitionrobotics/ign-gazebo", "uuid": "{f98d11fe-f287-4dfb-99c3-e2b76a13232e}"}, "branch": {"name": "log_resources"}}, "state": "OPEN", "author": {"display_name": "Mabel Zhang", "uuid": "{4b0e38fb-bf50-45c0-a496-61147518b2bf}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B4b0e38fb-bf50-45c0-a496-61147518b2bf%7D"}, "html": {"href": "https://bitbucket.org/%7B4b0e38fb-bf50-45c0-a496-61147518b2bf%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:ceb5942c-6843-408c-8550-3ce4899d299b/4d48e5ea-cf28-4fa7-9715-8fc9e315d831/128"}}, "nickname": "mabelmzhang", "type": "user", "account_id": "557058:ceb5942c-6843-408c-8550-3ce4899d299b"}, "date": "2019-09-30T20:26:15.612660+00:00"}, "pull_request": {"type": "pullrequest", "id": 397, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397"}}, "title": "[Blueprint] Logging meshes and materials"}}, {"update": {"description": "Depends on [ign-common PR 200](#!/ignitionrobotics/ign-common/pull-requests/200/log-resources/diff).\r\n\r\nPorts [this Gazebo PR](https://bitbucket.org/osrf/gazebo/pull-requests/2811/save-models-material-and-meshes-when/diff) to Ignition.\r\n\r\nImplements `--record-resources`, and `--log-compress` and `--log-overwrite` to support it.\r\n\r\nRecords resources \\(`--record-resources`\\), i.e. meshes and materials, to a directory under the specified log record directory. Optionally compresses \\(`--log-compress`\\) the whole directory, which contains the existing `.tlog` sqlite3 file and any resources, to a zip file. If directory or compressed file already exist, optionally overwrites \\(`--log-overwrite`\\).\r\n\r\nCorresponding SDF plugin parameters: `<record_resources>1</record_resources>`, `<compress>1</compress>.`If both command line and SDF parameters are specified, command line option overwrites SDF parameter. `--log-overwrite` is handled on command line only, outside of the plugin. If recording is only enabled from SDF and not from command line, then behavior is to always overwrite.\r\n\r\n## Usage:\r\n\r\n```\r\nign gazebo [...] --record-resources --log-overwrite --log-compress\r\n```\r\n\r\n## Test --record-resources:\r\n\r\n```\r\n# This SDF specifies the equivalent of --record-resources --record-path '/tmp/log'\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf\r\n$ ign gazebo -v 4 -r examples/worlds/log_playback.sdf\r\n```\r\n\r\nTested with `<include><uri>https://fuel...</uri></include>` and `<mesh><uri>file://...</uri></mesh>`. Paths specified by `model://` are not supported in Ignition yet, so this case in the code is not tested.\r\n\r\n## Test --log-overwrite and --log-compress:\r\n\r\nWhen recording to `path`, the compression file is implied to be `path.zip`. Both are checked for existence.\r\n\r\nNo `--log-overwrite` \\(default\\):\r\n\r\n```\r\n# This SDF specifies the equivalent of --record-path '/tmp/log'\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf\r\n\r\n# Run it again. By default it will always overwrite, because overwrite is now taken care of in ign.cc\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf\r\n[Msg] Overwriting existing file [/tmp/log/state.tlog]\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n```\r\n\r\n`--log-overwrite`, `/tmp/log` already exists:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-overwrite --record-path '/tmp/log'\r\n[Msg] Log path already exists on disk! Existing files will be overwritten.\r\n[Msg] Removing existing path [/tmp/log]\r\n...\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n...\r\n[Msg] Stopping recording\r\n```\r\n\r\n`--log-overwrite --log-compress`, `/tmp/log` exists, `/tmp/log.zip` does not exist:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-compress --log-overwrite --record-path '/tmp/log'\r\n[Msg] Log path already exists on disk! Existing files will be overwritten.\r\n[Msg] Removing existing path [/tmp/log]\r\n...\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n...\r\n[Msg] Compressed log file and resources to [/tmp/log.zip].\r\nRemoving recorded directory [/tmp/log].\r\n[Msg] Stopping recording\r\n```\r\n\r\n`--log-overwrite --log-compress`,  `/tmp/log` does not exist, `/tmp/log.zip`  exists:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-compress --log-overwrite --record-path '/tmp/log'\r\n[Wrn] [ign.cc:121] Compressed log path already exists on disk! Existing files will be overwritten.\r\n[Msg] Removing existing compressed file [/tmp/log.zip]\r\n...\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n...\r\n[Msg] Compressed log file and resources to [/tmp/log.zip].\r\nRemoving recorded directory [/tmp/log].\r\n[Msg] Stopping recording\r\n```\r\n\r\n`--log-overwrite` only, `/tmp/log.zip` exists, `/tmp/log` does not exist:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-overwrite --record-path '/tmp/log'\r\n[Wrn] [ign.cc:121] Compressed log path already exists on disk! Existing files will be overwritten.\r\n[Msg] Removing existing compressed file [/tmp/log.zip]\r\n...\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n...\r\n[Msg] Stopping recording\r\n```\r\n\r\n`--log-compress` only, both `/tmp/log` and `/tmp/log.zip` already exist:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-compress --record-path '/tmp/log'\r\n[Wrn] [ign.cc:152] Log path already exists on disk! Recording instead to [/tmp/log(1)]\r\n[Wrn] [ign.cc:154] Compressed log path already exists on disk! Recording instead to [/tmp/log(1).zip]\r\n...\r\n[Msg] Recording to log file [/tmp/log(1)/state.tlog]\r\n...\r\n[Msg] Compressed log file and resources to [/tmp/log(1).zip].\r\nRemoving recorded directory [/tmp/log(1)].\r\n[Msg] Stopping recording\r\n$ ls /tmp\r\nlog\r\n'log(1).zip'\r\nlog.zip\r\n```\r\n\r\n`--log-compress` only, `/tmp/log` does not exist, `/tmp/log.zip` exists, `/tmp/log(1).zip` exists:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-compress --record-path '/tmp/log'\r\n[Wrn] [ign.cc:152] Log path already exists on disk! Recording instead to [/tmp/log(2)]\r\n[Wrn] [ign.cc:154] Compressed log path already exists on disk! Recording instead to [/tmp/log(2).zip]\r\n...\r\n[Msg] Recording to log file [/tmp/log(2)/state.tlog]\r\n...\r\n[Msg] Compressed log file and resources to [/tmp/log(2).zip].\r\nRemoving recorded directory [/tmp/log(2)].\r\n[Msg] Stopping recording\r\n```\r\n\r\n## Record Path vs. Console Log Path\r\n\r\nIn Blueprint and Citadel, if `--record` is specified without `--record-path`, and `<path>` exists in SDF, a warning is printed, and recording will go to `<path>`, while console log will go to the default timestamp path.\r\n\r\nAs in this example:\r\n\r\n```\r\n# SDF specifies <path>/tmp/log</path>\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --record --log-compress -log-overwrite\r\n[Wrn] [ServerPrivate.cc:229] --record-path is not specified on command line. <path> is specified in SDF. Will record to <path>. Console will be logged to [/home/master/.ignition/gazebo/log/2019-09-20T19:51:33.996055619]. Note: In Ignition-D, <path> will be ignored, and all recordings will be written to default console log path if no path is specified on command line.\r\n[Msg] Overwriting existing file [/tmp/log/state.tlog]\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n...\r\n[Msg] Removing existing file [/tmp/log.zip].\r\n[Msg] Compressed log file and resources to [/tmp/log.zip].\r\nRemoving recorded directory [/tmp/log].\r\n```\r\n\r\nIn Ignition-D, `<path>` will be permanently ignored. Recordings and console log will go to same default path.\r\n\r\nIf `--record-path` is specified, then recording and console log will go to this path in Blueprint, Citadel, and Ignition-D.\r\n\r\n## Future Work\r\n\r\nFiles are outputted in `/tmp/log` and `/tmp/log.zip` in this example. During record, the original path in `file://` is prepended with the specified path, e.g. `/tmp/log`. During playback, the specified path is prepended to the URIs in the SDF.", "title": "[Blueprint] Logging meshes and materials", "destination": {"commit": {"hash": "890e28ea75d0", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/commit/890e28ea75d0.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/commits/890e28ea75d0"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{f98d11fe-f287-4dfb-99c3-e2b76a13232e}ts=2082645"}}, "type": "repository", "name": "ign-gazebo", "full_name": "ignitionrobotics/ign-gazebo", "uuid": "{f98d11fe-f287-4dfb-99c3-e2b76a13232e}"}, "branch": {"name": "ign-gazebo2"}}, "reason": "", "source": {"commit": {"hash": "1d293bb83188", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/commit/1d293bb83188.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/commits/1d293bb83188"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{f98d11fe-f287-4dfb-99c3-e2b76a13232e}ts=2082645"}}, "type": "repository", "name": "ign-gazebo", "full_name": "ignitionrobotics/ign-gazebo", "uuid": "{f98d11fe-f287-4dfb-99c3-e2b76a13232e}"}, "branch": {"name": "log_resources"}}, "state": "OPEN", "author": {"display_name": "Mabel Zhang", "uuid": "{4b0e38fb-bf50-45c0-a496-61147518b2bf}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B4b0e38fb-bf50-45c0-a496-61147518b2bf%7D"}, "html": {"href": "https://bitbucket.org/%7B4b0e38fb-bf50-45c0-a496-61147518b2bf%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:ceb5942c-6843-408c-8550-3ce4899d299b/4d48e5ea-cf28-4fa7-9715-8fc9e315d831/128"}}, "nickname": "mabelmzhang", "type": "user", "account_id": "557058:ceb5942c-6843-408c-8550-3ce4899d299b"}, "date": "2019-09-30T18:44:37.166900+00:00"}, "pull_request": {"type": "pullrequest", "id": 397, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397"}}, "title": "[Blueprint] Logging meshes and materials"}}, {"update": {"description": "Depends on [ign-common PR 200](#!/ignitionrobotics/ign-common/pull-requests/200/log-resources/diff).\r\n\r\nPorts [this Gazebo PR](https://bitbucket.org/osrf/gazebo/pull-requests/2811/save-models-material-and-meshes-when/diff) to Ignition.\r\n\r\nImplements `--record-resources`, and `--log-compress` and `--log-overwrite` to support it.\r\n\r\nRecords resources \\(`--record-resources`\\), i.e. meshes and materials, to a directory under the specified log record directory. Optionally compresses \\(`--log-compress`\\) the whole directory, which contains the existing `.tlog` sqlite3 file and any resources, to a zip file. If directory or compressed file already exist, optionally overwrites \\(`--log-overwrite`\\).\r\n\r\nCorresponding SDF plugin parameters: `<record_resources>1</record_resources>`, `<compress>1</compress>.`If both command line and SDF parameters are specified, command line option overwrites SDF parameter. `--log-overwrite` is handled on command line only, outside of the plugin. If recording is only enabled from SDF and not from command line, then behavior is to always overwrite.\r\n\r\n## Usage:\r\n\r\n```\r\nign gazebo [...] --record-resources --log-overwrite --log-compress\r\n```\r\n\r\n## Test --record-resources:\r\n\r\n```\r\n# This SDF specifies the equivalent of --record-resources --record-path '/tmp/log'\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf\r\n$ ign gazebo -v 4 -r examples/worlds/log_playback.sdf\r\n```\r\n\r\nTested with `<include><uri>https://fuel...</uri></include>` and `<mesh><uri>file://...</uri></mesh>`. Paths specified by `model://` are not supported in Ignition yet, so this case in the code is not tested.\r\n\r\n## Test --log-overwrite and --log-compress:\r\n\r\nWhen recording to `path`, the compression file is implied to be `path.zip`. Both are checked for existence.\r\n\r\nNo `--log-overwrite` \\(default\\):\r\n\r\n```\r\n# This SDF specifies the equivalent of --record-path '/tmp/log'\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf\r\n\r\n# Run it again. By default it will always overwrite, because overwrite is now taken care of in ign.cc\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf\r\n[Msg] Overwriting existing file [/tmp/log/state.tlog]\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n```\r\n\r\n`--log-overwrite`, `/tmp/log` already exists:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-overwrite --record-path '/tmp/log'\r\n[Msg] Log path already exists on disk! Existing files will be overwritten.\r\n[Msg] Removing existing path [/tmp/log]\r\n...\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n...\r\n[Msg] Stopping recording\r\n```\r\n\r\n`--log-overwrite --log-compress`, `/tmp/log` exists, `/tmp/log.zip` does not exist:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-compress --log-overwrite --record-path '/tmp/log'\r\n[Msg] Log path already exists on disk! Existing files will be overwritten.\r\n[Msg] Removing existing path [/tmp/log]\r\n...\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n...\r\n[Msg] Compressed log file and resources to [/tmp/log.zip].\r\nRemoving recorded directory [/tmp/log].\r\n[Msg] Stopping recording\r\n```\r\n\r\n`--log-overwrite --log-compress`,  `/tmp/log` does not exist, `/tmp/log.zip`  exists:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-compress --log-overwrite --record-path '/tmp/log'\r\n[Wrn] [ign.cc:121] Compressed log path already exists on disk! Existing files will be overwritten.\r\n[Msg] Removing existing compressed file [/tmp/log.zip]\r\n...\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n...\r\n[Msg] Compressed log file and resources to [/tmp/log.zip].\r\nRemoving recorded directory [/tmp/log].\r\n[Msg] Stopping recording\r\n```\r\n\r\n`--log-overwrite` only, `/tmp/log.zip` exists, `/tmp/log` does not exist:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-overwrite --record-path '/tmp/log'\r\n[Wrn] [ign.cc:121] Compressed log path already exists on disk! Existing files will be overwritten.\r\n[Msg] Removing existing compressed file [/tmp/log.zip]\r\n...\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n...\r\n[Msg] Stopping recording\r\n```\r\n\r\n`--log-compress` only, both `/tmp/log` and `/tmp/log.zip` already exist:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-compress --record-path '/tmp/log'\r\n[Wrn] [ign.cc:152] Log path already exists on disk! Recording instead to [/tmp/log(1)]\r\n[Wrn] [ign.cc:154] Compressed log path already exists on disk! Recording instead to [/tmp/log(1).zip]\r\n...\r\n[Msg] Recording to log file [/tmp/log(1)/state.tlog]\r\n...\r\n[Msg] Compressed log file and resources to [/tmp/log(1).zip].\r\nRemoving recorded directory [/tmp/log(1)].\r\n[Msg] Stopping recording\r\n$ ls /tmp\r\nlog\r\n'log(1).zip'\r\nlog.zip\r\n```\r\n\r\n`--log-compress` only, `/tmp/log` does not exist, `/tmp/log.zip` exists, `/tmp/log(1).zip` exists:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-compress --record-path '/tmp/log'\r\n[Wrn] [ign.cc:152] Log path already exists on disk! Recording instead to [/tmp/log(2)]\r\n[Wrn] [ign.cc:154] Compressed log path already exists on disk! Recording instead to [/tmp/log(2).zip]\r\n...\r\n[Msg] Recording to log file [/tmp/log(2)/state.tlog]\r\n...\r\n[Msg] Compressed log file and resources to [/tmp/log(2).zip].\r\nRemoving recorded directory [/tmp/log(2)].\r\n[Msg] Stopping recording\r\n```\r\n\r\n## Record Path vs. Console Log Path\r\n\r\nIn Blueprint and Citadel, if `--record` is specified without `--record-path`, and `<path>` exists in SDF, a warning is printed, and recording will go to `<path>`, while console log will go to the default timestamp path.\r\n\r\nAs in this example:\r\n\r\n```\r\n# SDF specifies <path>/tmp/log</path>\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --record --log-compress -log-overwrite\r\n[Wrn] [ServerPrivate.cc:229] --record-path is not specified on command line. <path> is specified in SDF. Will record to <path>. Console will be logged to [/home/master/.ignition/gazebo/log/2019-09-20T19:51:33.996055619]. Note: In Ignition-D, <path> will be ignored, and all recordings will be written to default console log path if no path is specified on command line.\r\n[Msg] Overwriting existing file [/tmp/log/state.tlog]\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n...\r\n[Msg] Removing existing file [/tmp/log.zip].\r\n[Msg] Compressed log file and resources to [/tmp/log.zip].\r\nRemoving recorded directory [/tmp/log].\r\n```\r\n\r\nIn Ignition-D, `<path>` will be permanently ignored. Recordings and console log will go to same default path.\r\n\r\nIf `--record-path` is specified, then recording and console log will go to this path in Blueprint, Citadel, and Ignition-D.\r\n\r\n## Future Work\r\n\r\nFiles are outputted in `/tmp/log` and `/tmp/log.zip` in this example. During record, the original path in `file://` is prepended with the specified path, e.g. `/tmp/log`. During playback, the specified path is prepended to the URIs in the SDF.", "title": "[Blueprint] Logging meshes and materials", "destination": {"commit": {"hash": "890e28ea75d0", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/commit/890e28ea75d0.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/commits/890e28ea75d0"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{f98d11fe-f287-4dfb-99c3-e2b76a13232e}ts=2082645"}}, "type": "repository", "name": "ign-gazebo", "full_name": "ignitionrobotics/ign-gazebo", "uuid": "{f98d11fe-f287-4dfb-99c3-e2b76a13232e}"}, "branch": {"name": "ign-gazebo2"}}, "reason": "", "source": {"commit": {"hash": "9b51c00e40ec", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/commit/9b51c00e40ec.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/commits/9b51c00e40ec"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{f98d11fe-f287-4dfb-99c3-e2b76a13232e}ts=2082645"}}, "type": "repository", "name": "ign-gazebo", "full_name": "ignitionrobotics/ign-gazebo", "uuid": "{f98d11fe-f287-4dfb-99c3-e2b76a13232e}"}, "branch": {"name": "log_resources"}}, "state": "OPEN", "author": {"display_name": "Mabel Zhang", "uuid": "{4b0e38fb-bf50-45c0-a496-61147518b2bf}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B4b0e38fb-bf50-45c0-a496-61147518b2bf%7D"}, "html": {"href": "https://bitbucket.org/%7B4b0e38fb-bf50-45c0-a496-61147518b2bf%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:ceb5942c-6843-408c-8550-3ce4899d299b/4d48e5ea-cf28-4fa7-9715-8fc9e315d831/128"}}, "nickname": "mabelmzhang", "type": "user", "account_id": "557058:ceb5942c-6843-408c-8550-3ce4899d299b"}, "date": "2019-09-30T18:41:49.949593+00:00"}, "pull_request": {"type": "pullrequest", "id": 397, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397"}}, "title": "[Blueprint] Logging meshes and materials"}}, {"update": {"description": "Depends on [ign-common PR 200](#!/ignitionrobotics/ign-common/pull-requests/200/log-resources/diff).\r\n\r\nPorts [this Gazebo PR](https://bitbucket.org/osrf/gazebo/pull-requests/2811/save-models-material-and-meshes-when/diff) to Ignition.\r\n\r\nImplements `--record-resources`, and `--log-compress` and `--log-overwrite` to support it.\r\n\r\nRecords resources \\(`--record-resources`\\), i.e. meshes and materials, to a directory under the specified log record directory. Optionally compresses \\(`--log-compress`\\) the whole directory, which contains the existing `.tlog` sqlite3 file and any resources, to a zip file. If directory or compressed file already exist, optionally overwrites \\(`--log-overwrite`\\).\r\n\r\nCorresponding SDF plugin parameters: `<record_resources>1</record_resources>`, `<compress>1</compress>.`If both command line and SDF parameters are specified, command line option overwrites SDF parameter. `--log-overwrite` is handled on command line only, outside of the plugin. If recording is only enabled from SDF and not from command line, then behavior is to always overwrite.\r\n\r\n## Usage:\r\n\r\n```\r\nign gazebo [...] --record-resources --log-overwrite --log-compress\r\n```\r\n\r\n## Test --record-resources:\r\n\r\n```\r\n# This SDF specifies the equivalent of --record-resources --record-path '/tmp/log'\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf\r\n$ ign gazebo -v 4 -r examples/worlds/log_playback.sdf\r\n```\r\n\r\nTested with `<include><uri>https://fuel...</uri></include>` and `<mesh><uri>file://...</uri></mesh>`. Paths specified by `model://` are not supported in Ignition yet, so this case in the code is not tested.\r\n\r\n## Test --log-overwrite and --log-compress:\r\n\r\nWhen recording to `path`, the compression file is implied to be `path.zip`. Both are checked for existence.\r\n\r\nNo `--log-overwrite` \\(default\\):\r\n\r\n```\r\n# This SDF specifies the equivalent of --record-path '/tmp/log'\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf\r\n\r\n# Run it again. By default it will always overwrite, because overwrite is now taken care of in ign.cc\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf\r\n[Msg] Overwriting existing file [/tmp/log/state.tlog]\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n```\r\n\r\n`--log-overwrite`, `/tmp/log` already exists:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-overwrite --record-path '/tmp/log'\r\n[Msg] Log path already exists on disk! Existing files will be overwritten.\r\n[Msg] Removing existing path [/tmp/log]\r\n...\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n...\r\n[Msg] Stopping recording\r\n```\r\n\r\n`--log-overwrite --log-compress`, `/tmp/log` exists, `/tmp/log.zip` does not exist:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-compress --log-overwrite --record-path '/tmp/log'\r\n[Msg] Log path already exists on disk! Existing files will be overwritten.\r\n[Msg] Removing existing path [/tmp/log]\r\n...\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n...\r\n[Msg] Compressed log file and resources to [/tmp/log.zip].\r\nRemoving recorded directory [/tmp/log].\r\n[Msg] Stopping recording\r\n```\r\n\r\n`--log-overwrite --log-compress`,  `/tmp/log` does not exist, `/tmp/log.zip`  exists:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-compress --log-overwrite --record-path '/tmp/log'\r\n[Wrn] [ign.cc:121] Compressed log path already exists on disk! Existing files will be overwritten.\r\n[Msg] Removing existing compressed file [/tmp/log.zip]\r\n...\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n...\r\n[Msg] Compressed log file and resources to [/tmp/log.zip].\r\nRemoving recorded directory [/tmp/log].\r\n[Msg] Stopping recording\r\n```\r\n\r\n`--log-overwrite` only, `/tmp/log.zip` exists, `/tmp/log` does not exist:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-overwrite --record-path '/tmp/log'\r\n[Wrn] [ign.cc:121] Compressed log path already exists on disk! Existing files will be overwritten.\r\n[Msg] Removing existing compressed file [/tmp/log.zip]\r\n...\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n...\r\n[Msg] Stopping recording\r\n```\r\n\r\n`--log-compress` only, both `/tmp/log` and `/tmp/log.zip` already exist:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-compress --record-path '/tmp/log'\r\n[Wrn] [ign.cc:152] Log path already exists on disk! Recording instead to [/tmp/log(1)]\r\n[Wrn] [ign.cc:154] Compressed log path already exists on disk! Recording instead to [/tmp/log(1).zip]\r\n...\r\n[Msg] Recording to log file [/tmp/log(1)/state.tlog]\r\n...\r\n[Msg] Compressed log file and resources to [/tmp/log(1).zip].\r\nRemoving recorded directory [/tmp/log(1)].\r\n[Msg] Stopping recording\r\n$ ls /tmp\r\nlog\r\n'log(1).zip'\r\nlog.zip\r\n```\r\n\r\n`--log-compress` only, `/tmp/log` does not exist, `/tmp/log.zip` exists, `/tmp/log(1).zip` exists:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-compress --record-path '/tmp/log'\r\n[Wrn] [ign.cc:152] Log path already exists on disk! Recording instead to [/tmp/log(2)]\r\n[Wrn] [ign.cc:154] Compressed log path already exists on disk! Recording instead to [/tmp/log(2).zip]\r\n...\r\n[Msg] Recording to log file [/tmp/log(2)/state.tlog]\r\n...\r\n[Msg] Compressed log file and resources to [/tmp/log(2).zip].\r\nRemoving recorded directory [/tmp/log(2)].\r\n[Msg] Stopping recording\r\n```\r\n\r\n## Record Path vs. Console Log Path\r\n\r\nIn Blueprint and Citadel, if `--record` is specified without `--record-path`, and `<path>` exists in SDF, a warning is printed, and recording will go to `<path>`, while console log will go to the default timestamp path.\r\n\r\nAs in this example:\r\n\r\n```\r\n# SDF specifies <path>/tmp/log</path>\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --record --log-compress -log-overwrite\r\n[Wrn] [ServerPrivate.cc:229] --record-path is not specified on command line. <path> is specified in SDF. Will record to <path>. Console will be logged to [/home/master/.ignition/gazebo/log/2019-09-20T19:51:33.996055619]. Note: In Ignition-D, <path> will be ignored, and all recordings will be written to default console log path if no path is specified on command line.\r\n[Msg] Overwriting existing file [/tmp/log/state.tlog]\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n...\r\n[Msg] Removing existing file [/tmp/log.zip].\r\n[Msg] Compressed log file and resources to [/tmp/log.zip].\r\nRemoving recorded directory [/tmp/log].\r\n```\r\n\r\nIn Ignition-D, `<path>` will be permanently ignored. Recordings and console log will go to same default path.\r\n\r\nIf `--record-path` is specified, then recording and console log will go to this path in Blueprint, Citadel, and Ignition-D.\r\n\r\n## Future Work\r\n\r\nFiles are outputted in `/tmp/log` and `/tmp/log.zip` in this example. During record, the original path in `file://` is prepended with the specified path, e.g. `/tmp/log`. During playback, the specified path is prepended to the URIs in the SDF.", "title": "[Blueprint] Logging meshes and materials", "destination": {"commit": {"hash": "890e28ea75d0", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/commit/890e28ea75d0.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/commits/890e28ea75d0"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{f98d11fe-f287-4dfb-99c3-e2b76a13232e}ts=2082645"}}, "type": "repository", "name": "ign-gazebo", "full_name": "ignitionrobotics/ign-gazebo", "uuid": "{f98d11fe-f287-4dfb-99c3-e2b76a13232e}"}, "branch": {"name": "ign-gazebo2"}}, "reason": "", "source": {"commit": {"hash": "2a5c4a9763a4", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/commit/2a5c4a9763a4.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/commits/2a5c4a9763a4"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{f98d11fe-f287-4dfb-99c3-e2b76a13232e}ts=2082645"}}, "type": "repository", "name": "ign-gazebo", "full_name": "ignitionrobotics/ign-gazebo", "uuid": "{f98d11fe-f287-4dfb-99c3-e2b76a13232e}"}, "branch": {"name": "log_resources"}}, "state": "OPEN", "author": {"display_name": "Mabel Zhang", "uuid": "{4b0e38fb-bf50-45c0-a496-61147518b2bf}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B4b0e38fb-bf50-45c0-a496-61147518b2bf%7D"}, "html": {"href": "https://bitbucket.org/%7B4b0e38fb-bf50-45c0-a496-61147518b2bf%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:ceb5942c-6843-408c-8550-3ce4899d299b/4d48e5ea-cf28-4fa7-9715-8fc9e315d831/128"}}, "nickname": "mabelmzhang", "type": "user", "account_id": "557058:ceb5942c-6843-408c-8550-3ce4899d299b"}, "date": "2019-09-30T18:41:06.991729+00:00"}, "pull_request": {"type": "pullrequest", "id": 397, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397"}}, "title": "[Blueprint] Logging meshes and materials"}}, {"update": {"description": "Depends on [ign-common PR 200](#!/ignitionrobotics/ign-common/pull-requests/200/log-resources/diff).\r\n\r\nPorts [this Gazebo PR](https://bitbucket.org/osrf/gazebo/pull-requests/2811/save-models-material-and-meshes-when/diff) to Ignition.\r\n\r\nImplements `--record-resources`, and `--log-compress` and `--log-overwrite` to support it.\r\n\r\nRecords resources \\(`--record-resources`\\), i.e. meshes and materials, to a directory under the specified log record directory. Optionally compresses \\(`--log-compress`\\) the whole directory, which contains the existing `.tlog` sqlite3 file and any resources, to a zip file. If directory or compressed file already exist, optionally overwrites \\(`--log-overwrite`\\).\r\n\r\nCorresponding SDF plugin parameters: `<record_resources>1</record_resources>`, `<compress>1</compress>.`If both command line and SDF parameters are specified, command line option overwrites SDF parameter. `--log-overwrite` is handled on command line only, outside of the plugin. If recording is only enabled from SDF and not from command line, then behavior is to always overwrite.\r\n\r\n## Usage:\r\n\r\n```\r\nign gazebo [...] --record-resources --log-overwrite --log-compress\r\n```\r\n\r\n## Test --record-resources:\r\n\r\n```\r\n# This SDF specifies the equivalent of --record-resources --record-path '/tmp/log'\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf\r\n$ ign gazebo -v 4 -r examples/worlds/log_playback.sdf\r\n```\r\n\r\nTested with `<include><uri>https://fuel...</uri></include>` and `<mesh><uri>file://...</uri></mesh>`. Paths specified by `model://` are not supported in Ignition yet, so this case in the code is not tested.\r\n\r\n## Test --log-overwrite and --log-compress:\r\n\r\nWhen recording to `path`, the compression file is implied to be `path.zip`. Both are checked for existence.\r\n\r\nNo `--log-overwrite` \\(default\\):\r\n\r\n```\r\n# This SDF specifies the equivalent of --record-resources --record-path '/tmp/log'\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf\r\n\r\n# Run it again, and it should write to new directory\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf\r\n[Wrn] [LogRecord.cc:260] Log path already exists on disk! Recording instead to [/tmp/log(1)]\r\n[Msg] Recording to log file [/tmp/log(1)/state.tlog]\r\n```\r\n\r\n`--log-overwrite`, `/tmp/log` already exists:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-overwrite --record-path '/tmp/log'\r\n[Wrn] [LogRecord.cc:292] Log path already exists on disk! Existing files will be overwritten.\r\n[Msg] Overwriting existing path [/tmp/log]\r\n...\r\n[Msg] Stopping recording\r\n```\r\n\r\n`--log-overwrite --log-compress`, `/tmp/log.zip` already exists:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-compress --log-overwrite --record-path '/tmp/log'\r\n[Wrn] [LogRecord.cc:291] Log path already exists on disk! Existing files will be overwritten.\r\n...\r\n[Msg] Overwriting existing file [/tmp/log.zip]\r\n[Msg] Compressed log file and resources to [/tmp/log.zip]. Removing recorded directory [/tmp/log].\r\n[Msg] Stopping recording\r\n```\r\n\r\n`--log-overwrite` only, `/tmp/log.zip` exists, `/tmp/log` does not exist:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-overwrite --record-path '/tmp/log'\r\n[Wrn] [LogRecord.cc:291] Log path already exists on disk! Existing files will be overwritten.\r\n[Msg] Overwriting existing path [/tmp/log]\r\n...\r\n[Msg] Stopping recording\r\n```\r\n\r\n`--log-compress` only, both `/tmp/log` and `/tmp/log.zip` already exist:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-compress --record-path '/tmp/log'\r\n[Wrn] [LogRecord.cc:299] Log path already exists on disk! Recording instead to [/tmp/log(1)]\r\n...\r\n[Msg] Compressed log file and resources to [/tmp/log(1).zip]. Removing recorded directory [/tmp/log(1)].\r\n[Msg] Stopping recording\r\n$ ls /tmp\r\nlog\r\n'log(1).zip'\r\nlog.zip\r\n```\r\n\r\n`--log-compress` only, `/tmp/log` does not exist, `/tmp/log.zip` already exists:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-compress --record-path '/tmp/log'\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n...\r\n[Err] [Zip.cc:42] Error adding directory to zip: /tmp/log\r\n[Err] [Zip.cc:103] Error compressing file: /tmp/log\r\n[Err] [LogRecord.cc:639] Failed to compressed log file and resources to [/tmp/log.zip]. Keeping recorded directory [/tmp/log].\r\n[Msg] Stopping recording\r\n```\r\n\r\n## Record Path vs. Console Log Path\r\n\r\nIn Blueprint and Citadel, if `--record` is specified without `--record-path`, and `<path>` exists in SDF, a warning is printed, and recording will go to `<path>`, while console log will go to the default timestamp path.\r\n\r\nAs in this example:\r\n\r\n```\r\n# SDF specifies <path>/tmp/log</path>\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --record --log-compress -log-overwrite\r\n[Wrn] [ServerPrivate.cc:229] --record-path is not specified on command line. <path> is specified in SDF. Will record to <path>. Console will be logged to [/home/master/.ignition/gazebo/log/2019-09-20T19:51:33.996055619]. Note: In Ignition-D, <path> will be ignored, and all recordings will be written to default console log path if no path is specified on command line.\r\n[Msg] Overwriting existing file [/tmp/log/state.tlog]\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n...\r\n[Msg] Removing existing file [/tmp/log.zip].\r\n[Msg] Compressed log file and resources to [/tmp/log.zip].\r\nRemoving recorded directory [/tmp/log].\r\n```\r\n\r\nIn Ignition-D, `<path>` will be permanently ignored. Recordings and console log will go to same default path.\r\n\r\nIf `--record-path` is specified, then recording and console log will go to this path in Blueprint, Citadel, and Ignition-D.\r\n\r\n## Future Work\r\n\r\nFiles are outputted in `/tmp/log` and `/tmp/log.zip` in this example. During record, the original path in `file://` is prepended with the specified path, e.g. `/tmp/log`. During playback, the specified path is prepended to the URIs in the SDF.", "title": "[Blueprint] Logging meshes and materials", "destination": {"commit": {"hash": "890e28ea75d0", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/commit/890e28ea75d0.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/commits/890e28ea75d0"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{f98d11fe-f287-4dfb-99c3-e2b76a13232e}ts=2082645"}}, "type": "repository", "name": "ign-gazebo", "full_name": "ignitionrobotics/ign-gazebo", "uuid": "{f98d11fe-f287-4dfb-99c3-e2b76a13232e}"}, "branch": {"name": "ign-gazebo2"}}, "reason": "", "source": {"commit": {"hash": "2a5c4a9763a4", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/commit/2a5c4a9763a4.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/commits/2a5c4a9763a4"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{f98d11fe-f287-4dfb-99c3-e2b76a13232e}ts=2082645"}}, "type": "repository", "name": "ign-gazebo", "full_name": "ignitionrobotics/ign-gazebo", "uuid": "{f98d11fe-f287-4dfb-99c3-e2b76a13232e}"}, "branch": {"name": "log_resources"}}, "state": "OPEN", "author": {"display_name": "Mabel Zhang", "uuid": "{4b0e38fb-bf50-45c0-a496-61147518b2bf}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B4b0e38fb-bf50-45c0-a496-61147518b2bf%7D"}, "html": {"href": "https://bitbucket.org/%7B4b0e38fb-bf50-45c0-a496-61147518b2bf%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:ceb5942c-6843-408c-8550-3ce4899d299b/4d48e5ea-cf28-4fa7-9715-8fc9e315d831/128"}}, "nickname": "mabelmzhang", "type": "user", "account_id": "557058:ceb5942c-6843-408c-8550-3ce4899d299b"}, "date": "2019-09-24T06:05:55.709630+00:00"}, "pull_request": {"type": "pullrequest", "id": 397, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397"}}, "title": "[Blueprint] Logging meshes and materials"}}, {"update": {"description": "Depends on [ign-common PR 200](#!/ignitionrobotics/ign-common/pull-requests/200/log-resources/diff).\r\n\r\nPorts [this Gazebo PR](https://bitbucket.org/osrf/gazebo/pull-requests/2811/save-models-material-and-meshes-when/diff) to Ignition.\r\n\r\nImplements `--record-resources`, and `--log-compress` and `--log-overwrite` to support it.\r\n\r\nRecords resources \\(`--record-resources`\\), i.e. meshes and materials, to a directory under the specified log record directory. Optionally compresses \\(`--log-compress`\\) the whole directory, which contains the existing `.tlog` sqlite3 file and any resources, to a zip file. If directory or compressed file already exist, optionally overwrites \\(`--log-overwrite`\\).\r\n\r\nCorresponding SDF plugin parameters: `<record_resources>1</record_resources>`, `<compress>1</compress>`, `<record_overwrite>1</record_overwrite>.`If both command line and SDF parameters are specified, command line option overwrites SDF parameter.\r\n\r\n## Usage:\r\n\r\n```\r\nign gazebo [...] --record-resources --log-overwrite --log-compress\r\n```\r\n\r\n## Test --record-resources:\r\n\r\n```\r\n# This SDF specifies the equivalent of --record-resources --record-path '/tmp/log'\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf\r\n$ ign gazebo -v 4 -r examples/worlds/log_playback.sdf\r\n```\r\n\r\nTested with `<include><uri>https://fuel...</uri></include>` and `<mesh><uri>file://...</uri></mesh>`. Paths specified by `model://` are not supported in Ignition yet, so this case in the code is not tested.\r\n\r\n## Test --log-overwrite and --log-compress:\r\n\r\nWhen recording to `path`, the compression file is implied to be `path.zip`. Both are checked for existence.\r\n\r\nNo `--log-overwrite` \\(default\\):\r\n\r\n```\r\n# This SDF specifies the equivalent of --record-resources --record-path '/tmp/log'\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf\r\n\r\n# Run it again, and it should write to new directory\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf\r\n[Wrn] [LogRecord.cc:260] Log path already exists on disk! Recording instead to [/tmp/log(1)]\r\n[Msg] Recording to log file [/tmp/log(1)/state.tlog]\r\n```\r\n\r\n`--log-overwrite`, `/tmp/log` already exists:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-overwrite --record-path '/tmp/log'\r\n[Wrn] [LogRecord.cc:292] Log path already exists on disk! Existing files will be overwritten.\r\n[Msg] Overwriting existing path [/tmp/log]\r\n...\r\n[Msg] Stopping recording\r\n```\r\n\r\n`--log-overwrite --log-compress`, `/tmp/log.zip` already exists:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-compress --log-overwrite --record-path '/tmp/log'\r\n[Wrn] [LogRecord.cc:291] Log path already exists on disk! Existing files will be overwritten.\r\n...\r\n[Msg] Overwriting existing file [/tmp/log.zip]\r\n[Msg] Compressed log file and resources to [/tmp/log.zip]. Removing recorded directory [/tmp/log].\r\n[Msg] Stopping recording\r\n```\r\n\r\n`--log-overwrite` only, `/tmp/log.zip` exists, `/tmp/log` does not exist:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-overwrite --record-path '/tmp/log'\r\n[Wrn] [LogRecord.cc:291] Log path already exists on disk! Existing files will be overwritten.\r\n[Msg] Overwriting existing path [/tmp/log]\r\n...\r\n[Msg] Stopping recording\r\n```\r\n\r\n`--log-compress` only, both `/tmp/log` and `/tmp/log.zip` already exist:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-compress --record-path '/tmp/log'\r\n[Wrn] [LogRecord.cc:299] Log path already exists on disk! Recording instead to [/tmp/log(1)]\r\n...\r\n[Msg] Compressed log file and resources to [/tmp/log(1).zip]. Removing recorded directory [/tmp/log(1)].\r\n[Msg] Stopping recording\r\n$ ls /tmp\r\nlog\r\n'log(1).zip'\r\nlog.zip\r\n```\r\n\r\n`--log-compress` only, `/tmp/log` does not exist, `/tmp/log.zip` already exists:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-compress --record-path '/tmp/log'\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n...\r\n[Err] [Zip.cc:42] Error adding directory to zip: /tmp/log\r\n[Err] [Zip.cc:103] Error compressing file: /tmp/log\r\n[Err] [LogRecord.cc:639] Failed to compressed log file and resources to [/tmp/log.zip]. Keeping recorded directory [/tmp/log].\r\n[Msg] Stopping recording\r\n```\r\n\r\n## Record Path vs. Console Log Path\r\n\r\nIn Blueprint and Citadel, if `--record` is specified without `--record-path`, and `<path>` exists in SDF, a warning is printed, and recording will go to `<path>`, while console log will go to the default timestamp path.\r\n\r\nAs in this example:\r\n\r\n```\r\n# SDF specifies <path>/tmp/log</path>\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --record --log-compress -log-overwrite\r\n[Wrn] [ServerPrivate.cc:229] --record-path is not specified on command line. <path> is specified in SDF. Will record to <path>. Console will be logged to [/home/master/.ignition/gazebo/log/2019-09-20T19:51:33.996055619]. Note: In Ignition-D, <path> will be ignored, and all recordings will be written to default console log path if no path is specified on command line.\r\n[Msg] Overwriting existing file [/tmp/log/state.tlog]\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n...\r\n[Msg] Removing existing file [/tmp/log.zip].\r\n[Msg] Compressed log file and resources to [/tmp/log.zip].\r\nRemoving recorded directory [/tmp/log].\r\n```\r\n\r\nIn Ignition-D, `<path>` will be permanently ignored. Recordings and console log will go to same default path.\r\n\r\nIf `--record-path` is specified, then recording and console log will go to this path in Blueprint, Citadel, and Ignition-D.\r\n\r\n## Future Work\r\n\r\nFiles are outputted in `/tmp/log` and `/tmp/log.zip` in this example. During record, the original path in `file://` is prepended with the specified path, e.g. `/tmp/log`. During playback, the specified path is prepended to the URIs in the SDF.", "title": "[Blueprint] Logging meshes and materials", "destination": {"commit": {"hash": "890e28ea75d0", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/commit/890e28ea75d0.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/commits/890e28ea75d0"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{f98d11fe-f287-4dfb-99c3-e2b76a13232e}ts=2082645"}}, "type": "repository", "name": "ign-gazebo", "full_name": "ignitionrobotics/ign-gazebo", "uuid": "{f98d11fe-f287-4dfb-99c3-e2b76a13232e}"}, "branch": {"name": "ign-gazebo2"}}, "reason": "", "source": {"commit": {"hash": "2a5c4a9763a4", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/commit/2a5c4a9763a4.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/commits/2a5c4a9763a4"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{f98d11fe-f287-4dfb-99c3-e2b76a13232e}ts=2082645"}}, "type": "repository", "name": "ign-gazebo", "full_name": "ignitionrobotics/ign-gazebo", "uuid": "{f98d11fe-f287-4dfb-99c3-e2b76a13232e}"}, "branch": {"name": "log_resources"}}, "state": "OPEN", "author": {"display_name": "Mabel Zhang", "uuid": "{4b0e38fb-bf50-45c0-a496-61147518b2bf}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B4b0e38fb-bf50-45c0-a496-61147518b2bf%7D"}, "html": {"href": "https://bitbucket.org/%7B4b0e38fb-bf50-45c0-a496-61147518b2bf%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:ceb5942c-6843-408c-8550-3ce4899d299b/4d48e5ea-cf28-4fa7-9715-8fc9e315d831/128"}}, "nickname": "mabelmzhang", "type": "user", "account_id": "557058:ceb5942c-6843-408c-8550-3ce4899d299b"}, "date": "2019-09-24T06:02:47.392827+00:00"}, "pull_request": {"type": "pullrequest", "id": 397, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397"}}, "title": "[Blueprint] Logging meshes and materials"}}, {"update": {"description": "Depends on [ign-common PR 200](#!/ignitionrobotics/ign-common/pull-requests/200/log-resources/diff).\r\n\r\nPorts [this Gazebo PR](https://bitbucket.org/osrf/gazebo/pull-requests/2811/save-models-material-and-meshes-when/diff) to Ignition.\r\n\r\nImplements `--record-resources`, and `--compress` and `--record-overwrite` to support it.\r\n\r\nRecords resources \\(`--record-resources`\\), i.e. meshes and materials, to a directory under the specified log record directory. Optionally compresses \\(`--compress`\\) the whole directory, which contains the existing `.tlog` sqlite3 file and any resources, to a zip file. If directory or compressed file already exist, optionally overwrites \\(`--record-overwrite`\\).\r\n\r\nCorresponding SDF plugin parameters: `<record_resources>1</record_resources>`, `<compress>1</compress>`, `<record_overwrite>1</record_overwrite>.`If both command line and SDF parameters are specified, command line option overwrites SDF parameter.\r\n\r\n## Usage:\r\n\r\n```\r\nign gazebo [...] --record-resources --record-overwrite --compress\r\n```\r\n\r\n## Test --record-resources:\r\n\r\n```\r\n# This SDF specifies the equivalent of --record-resources --record-path '/tmp/log'\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf\r\n$ ign gazebo -v 4 -r examples/worlds/log_playback.sdf\r\n```\r\n\r\nTested with `<include><uri>https://fuel...</uri></include>` and `<mesh><uri>file://...</uri></mesh>`. Paths specified by `model://` are not supported in Ignition yet, so this case in the code is not tested.\r\n\r\n## Test --log-overwrite and --compress:\r\n\r\nWhen recording to `path`, the compression file is implied to be `path.zip`. Both are checked for existence.\r\n\r\nNo `--log-overwrite` \\(default\\):\r\n\r\n```\r\n# This SDF specifies the equivalent of --record-resources --record-path '/tmp/log'\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf\r\n\r\n# Run it again, and it should write to new directory\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf\r\n[Wrn] [LogRecord.cc:260] Log path already exists on disk! Recording instead to [/tmp/log(1)]\r\n[Msg] Recording to log file [/tmp/log(1)/state.tlog]\r\n```\r\n\r\n`--log-overwrite`, `/tmp/log` already exists:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-overwrite --record-path '/tmp/log'\r\n[Wrn] [LogRecord.cc:292] Log path already exists on disk! Existing files will be overwritten.\r\n[Msg] Overwriting existing path [/tmp/log]\r\n...\r\n[Msg] Stopping recording\r\n```\r\n\r\n`--log-overwrite --compress`, `/tmp/log.zip` already exists:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --compress --log-overwrite --record-path '/tmp/log'\r\n[Wrn] [LogRecord.cc:291] Log path already exists on disk! Existing files will be overwritten.\r\n...\r\n[Msg] Overwriting existing file [/tmp/log.zip]\r\n[Msg] Compressed log file and resources to [/tmp/log.zip]. Removing recorded directory [/tmp/log].\r\n[Msg] Stopping recording\r\n```\r\n\r\n`--log-overwrite` only, `/tmp/log.zip` exists, `/tmp/log` does not exist:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-overwrite --record-path '/tmp/log'\r\n[Wrn] [LogRecord.cc:291] Log path already exists on disk! Existing files will be overwritten.\r\n[Msg] Overwriting existing path [/tmp/log]\r\n...\r\n[Msg] Stopping recording\r\n```\r\n\r\n`--compress` only, both `/tmp/log` and `/tmp/log.zip` already exist:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --compress --record-path '/tmp/log'\r\n[Wrn] [LogRecord.cc:299] Log path already exists on disk! Recording instead to [/tmp/log(1)]\r\n...\r\n[Msg] Compressed log file and resources to [/tmp/log(1).zip]. Removing recorded directory [/tmp/log(1)].\r\n[Msg] Stopping recording\r\n$ ls /tmp\r\nlog\r\n'log(1).zip'\r\nlog.zip\r\n```\r\n\r\n`--compress` only, `/tmp/log` does not exist, `/tmp/log.zip` already exists:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --compress --record-path '/tmp/log'\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n...\r\n[Err] [Zip.cc:42] Error adding directory to zip: /tmp/log\r\n[Err] [Zip.cc:103] Error compressing file: /tmp/log\r\n[Err] [LogRecord.cc:639] Failed to compressed log file and resources to [/tmp/log.zip]. Keeping recorded directory [/tmp/log].\r\n[Msg] Stopping recording\r\n```\r\n\r\n## Record Path vs. Console Log Path\r\n\r\nIn Blueprint and Citadel, if `--record` is specified without `--record-path`, and `<path>` exists in SDF, a warning is printed, and recording will go to `<path>`, while console log will go to the default timestamp path.\r\n\r\nAs in this example:\r\n\r\n```\r\n# SDF specifies <path>/tmp/log</path>\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --record --compress -log-overwrite\r\n[Wrn] [ServerPrivate.cc:229] --record-path is not specified on command line. <path> is specified in SDF. Will record to <path>. Console will be logged to [/home/master/.ignition/gazebo/log/2019-09-20T19:51:33.996055619]. Note: In Ignition-D, <path> will be ignored, and all recordings will be written to default console log path if no path is specified on command line.\r\n[Msg] Overwriting existing file [/tmp/log/state.tlog]\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n...\r\n[Msg] Removing existing file [/tmp/log.zip].\r\n[Msg] Compressed log file and resources to [/tmp/log.zip].\r\nRemoving recorded directory [/tmp/log].\r\n```\r\n\r\nIn Ignition-D, `<path>` will be permanently ignored. Recordings and console log will go to same default path.\r\n\r\nIf `--record-path` is specified, then recording and console log will go to this path in Blueprint, Citadel, and Ignition-D.\r\n\r\n## Future Work\r\n\r\nFiles are outputted in `/tmp/log` and `/tmp/log.zip` in this example. During record, the original path in `file://` is prepended with the specified path, e.g. `/tmp/log`. During playback, the specified path is prepended to the URIs in the SDF.", "title": "[Blueprint] Logging meshes and materials", "destination": {"commit": {"hash": "890e28ea75d0", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/commit/890e28ea75d0.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/commits/890e28ea75d0"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{f98d11fe-f287-4dfb-99c3-e2b76a13232e}ts=2082645"}}, "type": "repository", "name": "ign-gazebo", "full_name": "ignitionrobotics/ign-gazebo", "uuid": "{f98d11fe-f287-4dfb-99c3-e2b76a13232e}"}, "branch": {"name": "ign-gazebo2"}}, "reason": "", "source": {"commit": {"hash": "2a5c4a9763a4", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/commit/2a5c4a9763a4.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/commits/2a5c4a9763a4"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{f98d11fe-f287-4dfb-99c3-e2b76a13232e}ts=2082645"}}, "type": "repository", "name": "ign-gazebo", "full_name": "ignitionrobotics/ign-gazebo", "uuid": "{f98d11fe-f287-4dfb-99c3-e2b76a13232e}"}, "branch": {"name": "log_resources"}}, "state": "OPEN", "author": {"display_name": "Mabel Zhang", "uuid": "{4b0e38fb-bf50-45c0-a496-61147518b2bf}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B4b0e38fb-bf50-45c0-a496-61147518b2bf%7D"}, "html": {"href": "https://bitbucket.org/%7B4b0e38fb-bf50-45c0-a496-61147518b2bf%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:ceb5942c-6843-408c-8550-3ce4899d299b/4d48e5ea-cf28-4fa7-9715-8fc9e315d831/128"}}, "nickname": "mabelmzhang", "type": "user", "account_id": "557058:ceb5942c-6843-408c-8550-3ce4899d299b"}, "date": "2019-09-24T06:01:43.295073+00:00"}, "pull_request": {"type": "pullrequest", "id": 397, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397"}}, "title": "[Blueprint] Logging meshes and materials"}}, {"update": {"description": "Depends on [ign-common PR 200](#!/ignitionrobotics/ign-common/pull-requests/200/log-resources/diff).\r\n\r\nPorts [this Gazebo PR](https://bitbucket.org/osrf/gazebo/pull-requests/2811/save-models-material-and-meshes-when/diff) to Ignition.\r\n\r\nImplements `--record-resources`, and `--compress` and `--record-overwrite` to support it.\r\n\r\nRecords resources \\(`--record-resources`\\), i.e. meshes and materials, to a directory under the specified log record directory. Optionally compresses \\(`--compress`\\) the whole directory, which contains the existing `.tlog` sqlite3 file and any resources, to a zip file. If directory or compressed file already exist, optionally overwrites \\(`--record-overwrite`\\).\r\n\r\nCorresponding SDF plugin parameters: `<record_resources>1</record_resources>`, `<compress>1</compress>`, `<record_overwrite>1</record_overwrite>.`If both command line and SDF parameters are specified, command line option overwrites SDF parameter.\r\n\r\n## Usage:\r\n\r\n```\r\nign gazebo [...] --record-resources --record-overwrite --compress\r\n```\r\n\r\n## Test --record-resources:\r\n\r\n```\r\n# This SDF specifies the equivalent of --record-resources --record-path '/tmp/log'\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf\r\n$ ign gazebo -v 4 -r examples/worlds/log_playback.sdf\r\n```\r\n\r\nTested with `<include><uri>https://fuel...</uri></include>` and `<mesh><uri>file://...</uri></mesh>`. Paths specified by `model://` are not supported in Ignition yet, so this case in the code is not tested.\r\n\r\n## Test --log-overwrite and --compress:\r\n\r\nWhen recording to `path`, the compression file is implied to be `path.zip`. Both are checked for existence.\r\n\r\nNo `--log-overwrite` \\(default\\):\r\n\r\n```\r\n# This SDF specifies the equivalent of --record-resources --record-path '/tmp/log'\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf\r\n\r\n# Run it again, and it should write to new directory\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf\r\n[Wrn] [LogRecord.cc:260] Log path already exists on disk! Recording instead to [/tmp/log(1)]\r\n[Msg] Recording to log file [/tmp/log(1)/state.tlog]\r\n```\r\n\r\n`--log-overwrite`, `/tmp/log` already exists:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-overwrite --record-path '/tmp/log'\r\n[Wrn] [LogRecord.cc:292] Log path already exists on disk! Existing files will be overwritten.\r\n[Msg] Overwriting existing path [/tmp/log]\r\n...\r\n[Msg] Stopping recording\r\n```\r\n\r\n`--log-overwrite --compress`, `/tmp/log.zip` already exists:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --compress --log-overwrite --record-path '/tmp/log'\r\n[Wrn] [LogRecord.cc:291] Log path already exists on disk! Existing files will be overwritten.\r\n...\r\n[Msg] Overwriting existing file [/tmp/log.zip]\r\n[Msg] Compressed log file and resources to [/tmp/log.zip]. Removing recorded directory [/tmp/log].\r\n[Msg] Stopping recording\r\n```\r\n\r\n`--log-overwrite` only, `/tmp/log.zip` exists, `/tmp/log` does not exist:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-overwrite --record-path '/tmp/log'\r\n[Wrn] [LogRecord.cc:291] Log path already exists on disk! Existing files will be overwritten.\r\n[Msg] Overwriting existing path [/tmp/log]\r\n...\r\n[Msg] Stopping recording\r\n```\r\n\r\n`--compress` only, both `/tmp/log` and `/tmp/log.zip` already exist:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --compress --record-path '/tmp/log'\r\n[Wrn] [LogRecord.cc:299] Log path already exists on disk! Recording instead to [/tmp/log(1)]\r\n...\r\n[Msg] Compressed log file and resources to [/tmp/log(1).zip]. Removing recorded directory [/tmp/log(1)].\r\n[Msg] Stopping recording\r\n$ ls /tmp\r\nlog\r\n'log(1).zip'\r\nlog.zip\r\n```\r\n\r\n`--compress` only, `/tmp/log` does not exist, `/tmp/log.zip` already exists:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --compress --record-path '/tmp/log'\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n...\r\n[Err] [Zip.cc:42] Error adding directory to zip: /tmp/log\r\n[Err] [Zip.cc:103] Error compressing file: /tmp/log\r\n[Err] [LogRecord.cc:639] Failed to compressed log file and resources to [/tmp/log.zip]. Keeping recorded directory [/tmp/log].\r\n[Msg] Stopping recording\r\n```\r\n\r\n## Record Path vs. Console Log Path\r\n\r\nIn Blueprint and Citadel, if `--record` is specified without `--record-path`, and `<path>` exists in SDF, a warning is printed, and recording will go to `<path>`, while console log will go to the default timestamp path.\r\n\r\nAs in this example:\r\n\r\n```\r\n# SDF specifies <path>/tmp/log</path>\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --record --compress -log-overwrite\r\n[Wrn] [ServerPrivate.cc:229] --record-path is not specified on command line. <path> is specified in SDF. Will record to <path>. Console will be logged to [/home/master/.ignition/gazebo/log/2019-09-20T19:51:33.996055619]. Note: In Ignition-D, <path> will be ignored, and all recordings will be written to default console log path if no path is specified on command line.\r\n[Msg] Overwriting existing file [/tmp/log/state.tlog]\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n...\r\n[Msg] Removing existing file [/tmp/log.zip].\r\n[Msg] Compressed log file and resources to [/tmp/log.zip].\r\nRemoving recorded directory [/tmp/log].\r\n```\r\n\r\nIn Ignition-D, `<path>` will be permanently ignored. Recordings and console log will go to same default path.\r\n\r\nIf `--record-path` is specified, then recording and console log will go to this path in Blueprint, Citadel, and Ignition-D.\r\n\r\n## Future Work\r\n\r\nFiles are outputted in `/tmp/log` and `/tmp/log.zip` in this example. During record, the original path in `file://` is prepended with the specified path, e.g. `/tmp/log`. During playback, the specified path is prepended to the URIs in the SDF.", "title": "[Blueprint] Logging meshes and materials", "destination": {"commit": {"hash": "890e28ea75d0", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/commit/890e28ea75d0.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/commits/890e28ea75d0"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{f98d11fe-f287-4dfb-99c3-e2b76a13232e}ts=2082645"}}, "type": "repository", "name": "ign-gazebo", "full_name": "ignitionrobotics/ign-gazebo", "uuid": "{f98d11fe-f287-4dfb-99c3-e2b76a13232e}"}, "branch": {"name": "ign-gazebo2"}}, "reason": "", "source": {"commit": {"hash": "b6d588b9b661", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/commit/b6d588b9b661.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/commits/b6d588b9b661"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{f98d11fe-f287-4dfb-99c3-e2b76a13232e}ts=2082645"}}, "type": "repository", "name": "ign-gazebo", "full_name": "ignitionrobotics/ign-gazebo", "uuid": "{f98d11fe-f287-4dfb-99c3-e2b76a13232e}"}, "branch": {"name": "log_resources"}}, "state": "OPEN", "author": {"display_name": "Mabel Zhang", "uuid": "{4b0e38fb-bf50-45c0-a496-61147518b2bf}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B4b0e38fb-bf50-45c0-a496-61147518b2bf%7D"}, "html": {"href": "https://bitbucket.org/%7B4b0e38fb-bf50-45c0-a496-61147518b2bf%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:ceb5942c-6843-408c-8550-3ce4899d299b/4d48e5ea-cf28-4fa7-9715-8fc9e315d831/128"}}, "nickname": "mabelmzhang", "type": "user", "account_id": "557058:ceb5942c-6843-408c-8550-3ce4899d299b"}, "date": "2019-09-24T05:41:24.347827+00:00"}, "pull_request": {"type": "pullrequest", "id": 397, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397"}}, "title": "[Blueprint] Logging meshes and materials"}}, {"comment": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397/comments/117810543.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397/_/diff#comment-117810543"}}, "parent": {"id": 117502896, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397/comments/117502896.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397/_/diff#comment-117502896"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 397, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397"}}, "title": "[Blueprint] Logging meshes and materials"}, "content": {"raw": "Don't worry about it, I think the problem was introduced on pull request #429", "markup": "markdown", "html": "<p>Don't worry about it, I think the problem was introduced on <a href=\"#!/ignitionrobotics/ign-gazebo/pull-requests/429/rewind-reset-and-seek\" rel=\"nofollow\" class=\"ap-connect-link\">pull request #429</a></p>", "type": "rendered"}, "created_on": "2019-09-21T00:12:28.759680+00:00", "user": {"display_name": "Louise Poubel", "uuid": "{5cfa2075-477b-4ded-bdb9-8d2479544ec4}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D"}, "html": {"href": "https://bitbucket.org/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8/7d903d90-c5ea-4182-b7ef-0d467e9e1c74/128"}}, "nickname": "chapulina", "type": "user", "account_id": "557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8"}, "updated_on": "2019-09-21T00:12:28.770645+00:00", "type": "pullrequest_comment", "id": 117810543}, "pull_request": {"type": "pullrequest", "id": 397, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397"}}, "title": "[Blueprint] Logging meshes and materials"}}, {"comment": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397/comments/117810530.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397/_/diff#comment-117810530"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 397, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397"}}, "title": "[Blueprint] Logging meshes and materials"}, "content": {"raw": "Accompanying [ign-launch PR](#!/ignitionrobotics/ign-launch/pull-requests/45/more-logging-options/diff)", "markup": "markdown", "html": "<p>Accompanying <a data-is-external-link=\"true\" href=\"#!/ignitionrobotics/ign-launch/pull-requests/45/more-logging-options/diff\" rel=\"nofollow\">ign-launch PR</a></p>", "type": "rendered"}, "created_on": "2019-09-21T00:11:44.751412+00:00", "user": {"display_name": "Louise Poubel", "uuid": "{5cfa2075-477b-4ded-bdb9-8d2479544ec4}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D"}, "html": {"href": "https://bitbucket.org/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8/7d903d90-c5ea-4182-b7ef-0d467e9e1c74/128"}}, "nickname": "chapulina", "type": "user", "account_id": "557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8"}, "updated_on": "2019-09-21T00:11:44.758557+00:00", "type": "pullrequest_comment", "id": 117810530}, "pull_request": {"type": "pullrequest", "id": 397, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397"}}, "title": "[Blueprint] Logging meshes and materials"}}, {"comment": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397/comments/117810351.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397/_/diff#comment-117810351"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 397, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397"}}, "title": "[Blueprint] Logging meshes and materials"}, "content": {"raw": "Nit: the 2 flags, `LogRecordCompress` and `LogRecordCompressPath` are a bit redundant. What happens if the user sets a path but not to compress, or the other way around?\n\nWe could even recalculate the compress path within `LogRecord` or only set the path and check whether to compress with `bool compress = !config.LogRecordCompressPath().empty();`", "markup": "markdown", "html": "<p>Nit: the 2 flags, <code>LogRecordCompress</code> and <code>LogRecordCompressPath</code> are a bit redundant. What happens if the user sets a path but not to compress, or the other way around?</p>\n<p>We could even recalculate the compress path within <code>LogRecord</code> or only set the path and check whether to compress with <code>bool compress = !config.LogRecordCompressPath().empty();</code></p>", "type": "rendered"}, "created_on": "2019-09-21T00:04:14.404900+00:00", "user": {"display_name": "Louise Poubel", "uuid": "{5cfa2075-477b-4ded-bdb9-8d2479544ec4}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D"}, "html": {"href": "https://bitbucket.org/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8/7d903d90-c5ea-4182-b7ef-0d467e9e1c74/128"}}, "nickname": "chapulina", "type": "user", "account_id": "557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8"}, "inline": {}, "updated_on": "2019-09-21T00:04:14.412374+00:00", "type": "pullrequest_comment", "id": 117810351}, "pull_request": {"type": "pullrequest", "id": 397, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397"}}, "title": "[Blueprint] Logging meshes and materials"}}], "next": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397/activity_ctx=ndesXKtGsg.json"}