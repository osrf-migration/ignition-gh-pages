{"pagelen": 50, "values": [{"update": {"description": "Depends on [ign-common PR 200](#!/ignitionrobotics/ign-common/pull-requests/200/log-resources/diff).\r\n\r\nPorts [this Gazebo PR](https://bitbucket.org/osrf/gazebo/pull-requests/2811/save-models-material-and-meshes-when/diff) to Ignition.\r\n\r\nImplements `--record-resources`, and `--log-compress` and `--log-overwrite` to support it.\r\n\r\nRecords resources \\(`--record-resources`\\), i.e. meshes and materials, to a directory under the specified log record directory. Optionally compresses \\(`--log-compress`\\) the whole directory, which contains the existing `.tlog` sqlite3 file and any resources, to a zip file. If directory or compressed file already exist, optionally overwrites \\(`--log-overwrite`\\).\r\n\r\nCorresponding SDF plugin parameters: `<record_resources>1</record_resources>`, `<compress>1</compress>.`If both command line and SDF parameters are specified, command line option overwrites SDF parameter. `--log-overwrite` is handled on command line only, outside of the plugin. If recording is only enabled from SDF and not from command line, then behavior is to always overwrite.\r\n\r\n## Usage:\r\n\r\n```\r\nign gazebo [...] --record-resources --log-overwrite --log-compress\r\n```\r\n\r\n## Test --record-resources:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-overwrite --record-path /tmp/log\r\n# (Re)move local downloaded Fuel copy of resources\r\n$ mv ~/.ignition/fuel ~/.ignition/fuel_bak\r\n# Play back from recorded resources\r\n$ ign gazebo -v 4 -r --playback /tmp/log\r\n```\r\n\r\nTested with `<include><uri>https://fuel...</uri></include>` and `<mesh><uri>file://...</uri></mesh>`. Paths specified by `model://` are not supported in Ignition yet, so this case in the code is not tested.\r\n\r\n## Test --log-overwrite and --log-compress:\r\n\r\nWhen recording to `path`, the compression file is implied to be `path.zip`. Both are checked for existence.\r\n\r\nNo `--log-overwrite` \\(default\\):\r\n\r\n```\r\n# This SDF specifies the equivalent of --record-path '/tmp/log'\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf\r\n\r\n# Run it again. By default it will always overwrite, because overwrite is now taken care of in ign.cc\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf\r\n[Msg] Overwriting existing file [/tmp/log/state.tlog]\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n```\r\n\r\n`--log-overwrite`, `/tmp/log` already exists:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-overwrite --record-path '/tmp/log'\r\n[Msg] Log path already exists on disk! Existing files will be overwritten.\r\n[Msg] Removing existing path [/tmp/log]\r\n...\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n...\r\n[Msg] Stopping recording\r\n```\r\n\r\n`--log-overwrite --log-compress`, `/tmp/log` exists, `/tmp/log.zip` does not exist:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-compress --log-overwrite --record-path '/tmp/log'\r\n[Msg] Log path already exists on disk! Existing files will be overwritten.\r\n[Msg] Removing existing path [/tmp/log]\r\n...\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n...\r\n[Msg] Compressed log file and resources to [/tmp/log.zip].\r\nRemoving recorded directory [/tmp/log].\r\n[Msg] Stopping recording\r\n```\r\n\r\n`--log-overwrite --log-compress`, `/tmp/log` does not exist, `/tmp/log.zip` exists:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-compress --log-overwrite --record-path '/tmp/log'\r\n[Wrn] [ign.cc:121] Compressed log path already exists on disk! Existing files will be overwritten.\r\n[Msg] Removing existing compressed file [/tmp/log.zip]\r\n...\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n...\r\n[Msg] Compressed log file and resources to [/tmp/log.zip].\r\nRemoving recorded directory [/tmp/log].\r\n[Msg] Stopping recording\r\n```\r\n\r\n`--log-overwrite` only, `/tmp/log.zip` exists, `/tmp/log` does not exist:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-overwrite --record-path '/tmp/log'\r\n[Msg] Removing existing compressed file [/tmp/log.zip]\r\n...\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n...\r\n[Msg] Stopping recording\r\n```\r\n\r\n`--log-compress` only, both `/tmp/log` and `/tmp/log.zip` already exist:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-compress --record-path '/tmp/log'\r\n[Wrn] [ign.cc:152] Log path already exists on disk! Recording instead to [/tmp/log(1)]\r\n[Wrn] [ign.cc:154] Compressed log path already exists on disk! Recording instead to [/tmp/log(1).zip]\r\n...\r\n[Msg] Recording to log file [/tmp/log(1)/state.tlog]\r\n...\r\n[Msg] Compressed log file and resources to [/tmp/log(1).zip].\r\nRemoving recorded directory [/tmp/log(1)].\r\n[Msg] Stopping recording\r\n$ ls /tmp\r\nlog\r\n'log(1).zip'\r\nlog.zip\r\n```\r\n\r\n`--log-compress` only, `/tmp/log` does not exist, `/tmp/log.zip` exists, `/tmp/log(1).zip` exists:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-compress --record-path '/tmp/log'\r\n[Wrn] [ign.cc:152] Log path already exists on disk! Recording instead to [/tmp/log(2)]\r\n[Wrn] [ign.cc:154] Compressed log path already exists on disk! Recording instead to [/tmp/log(2).zip]\r\n...\r\n[Msg] Recording to log file [/tmp/log(2)/state.tlog]\r\n...\r\n[Msg] Compressed log file and resources to [/tmp/log(2).zip].\r\nRemoving recorded directory [/tmp/log(2)].\r\n[Msg] Stopping recording\r\n```\r\n\r\n## Record Path vs. Console Log Path\r\n\r\nIn Blueprint and Citadel, if `--record` is specified without `--record-path`, and `<path>` exists in SDF, a warning is printed, and recording will go to `<path>`, while console log will go to the default timestamp path.\r\n\r\nAs in this example:\r\n\r\n```\r\n# SDF specifies <path>/tmp/log</path>\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --record --log-compress -log-overwrite\r\n[Wrn] [ServerPrivate.cc:229] --record-path is not specified on command line. <path> is specified in SDF. Will record to <path>. Console will be logged to [/home/master/.ignition/gazebo/log/2019-09-20T19:51:33.996055619]. Note: In Ignition-D, <path> will be ignored, and all recordings will be written to default console log path if no path is specified on command line.\r\n[Msg] Overwriting existing file [/tmp/log/state.tlog]\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n...\r\n[Msg] Removing existing file [/tmp/log.zip].\r\n[Msg] Compressed log file and resources to [/tmp/log.zip].\r\nRemoving recorded directory [/tmp/log].\r\n```\r\n\r\nIn Ignition-D, `<path>` will be permanently ignored. Recordings and console log will go to same default path.\r\n\r\nIf `--record-path` is specified, then recording and console log will go to this path in Blueprint, Citadel, and Ignition-D.\r\n\r\n## Future Work\r\n\r\nFiles are outputted in `/tmp/log` and `/tmp/log.zip` in this example. During record, the original path in `file://` is prepended with the specified path, e.g. `/tmp/log`. During playback, the specified path is prepended to the URIs in the SDF.", "title": "[Blueprint] Logging meshes and materials", "destination": {"commit": {"hash": "80ec42737b5a", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/commit/80ec42737b5a.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/commits/80ec42737b5a"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{f98d11fe-f287-4dfb-99c3-e2b76a13232e}ts=2082645"}}, "type": "repository", "name": "ign-gazebo", "full_name": "ignitionrobotics/ign-gazebo", "uuid": "{f98d11fe-f287-4dfb-99c3-e2b76a13232e}"}, "branch": {"name": "ign-gazebo2"}}, "reason": "", "source": {"commit": {"hash": "b2f3c65a8610", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/commit/b2f3c65a8610.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/commits/b2f3c65a8610"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{f98d11fe-f287-4dfb-99c3-e2b76a13232e}ts=2082645"}}, "type": "repository", "name": "ign-gazebo", "full_name": "ignitionrobotics/ign-gazebo", "uuid": "{f98d11fe-f287-4dfb-99c3-e2b76a13232e}"}, "branch": {"name": "log_resources"}}, "state": "MERGED", "author": {"display_name": "Louise Poubel", "uuid": "{5cfa2075-477b-4ded-bdb9-8d2479544ec4}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D"}, "html": {"href": "https://bitbucket.org/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8/7d903d90-c5ea-4182-b7ef-0d467e9e1c74/128"}}, "nickname": "chapulina", "type": "user", "account_id": "557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8"}, "date": "2020-03-21T00:45:52.796740+00:00"}, "pull_request": {"type": "pullrequest", "id": 397, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397"}}, "title": "[Blueprint] Logging meshes and materials"}}, {"comment": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397/comments/141263243.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397/_/diff#comment-141263243"}}, "parent": {"id": 141258354, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397/comments/141258354.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397/_/diff#comment-141258354"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 397, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397"}}, "title": "[Blueprint] Logging meshes and materials"}, "content": {"raw": "Looks great, merging! :tada: ", "markup": "markdown", "html": "<p>Looks great, merging! <img class=\"emoji\" src=\"data/pf-emoji-service--cdn.us-east-1.prod.public.atl-paas.net/standard/551c9814-1d37-4573-819d-afab3afeaf32/48x48/1f389.png\" alt=\"\ud83c\udf89\" title=\":tada:\" data-emoji-short-name=\":tada:\" /> </p>", "type": "rendered"}, "created_on": "2020-03-21T00:45:42.173549+00:00", "user": {"display_name": "Louise Poubel", "uuid": "{5cfa2075-477b-4ded-bdb9-8d2479544ec4}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D"}, "html": {"href": "https://bitbucket.org/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8/7d903d90-c5ea-4182-b7ef-0d467e9e1c74/128"}}, "nickname": "chapulina", "type": "user", "account_id": "557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8"}, "inline": {}, "updated_on": "2020-03-21T00:45:42.179853+00:00", "type": "pullrequest_comment", "id": 141263243}, "pull_request": {"type": "pullrequest", "id": 397, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397"}}, "title": "[Blueprint] Logging meshes and materials"}}, {"approval": {"date": "2020-03-21T00:45:09.081483+00:00", "pullrequest": {"type": "pullrequest", "id": 397, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397"}}, "title": "[Blueprint] Logging meshes and materials"}, "user": {"display_name": "Louise Poubel", "uuid": "{5cfa2075-477b-4ded-bdb9-8d2479544ec4}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D"}, "html": {"href": "https://bitbucket.org/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8/7d903d90-c5ea-4182-b7ef-0d467e9e1c74/128"}}, "nickname": "chapulina", "type": "user", "account_id": "557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8"}}, "pull_request": {"type": "pullrequest", "id": 397, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397"}}, "title": "[Blueprint] Logging meshes and materials"}}, {"update": {"description": "Depends on [ign-common PR 200](#!/ignitionrobotics/ign-common/pull-requests/200/log-resources/diff).\r\n\r\nPorts [this Gazebo PR](https://bitbucket.org/osrf/gazebo/pull-requests/2811/save-models-material-and-meshes-when/diff) to Ignition.\r\n\r\nImplements `--record-resources`, and `--log-compress` and `--log-overwrite` to support it.\r\n\r\nRecords resources \\(`--record-resources`\\), i.e. meshes and materials, to a directory under the specified log record directory. Optionally compresses \\(`--log-compress`\\) the whole directory, which contains the existing `.tlog` sqlite3 file and any resources, to a zip file. If directory or compressed file already exist, optionally overwrites \\(`--log-overwrite`\\).\r\n\r\nCorresponding SDF plugin parameters: `<record_resources>1</record_resources>`, `<compress>1</compress>.`If both command line and SDF parameters are specified, command line option overwrites SDF parameter. `--log-overwrite` is handled on command line only, outside of the plugin. If recording is only enabled from SDF and not from command line, then behavior is to always overwrite.\r\n\r\n## Usage:\r\n\r\n```\r\nign gazebo [...] --record-resources --log-overwrite --log-compress\r\n```\r\n\r\n## Test --record-resources:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-overwrite --record-path /tmp/log\r\n# (Re)move local downloaded Fuel copy of resources\r\n$ mv ~/.ignition/fuel ~/.ignition/fuel_bak\r\n# Play back from recorded resources\r\n$ ign gazebo -v 4 -r --playback /tmp/log\r\n```\r\n\r\nTested with `<include><uri>https://fuel...</uri></include>` and `<mesh><uri>file://...</uri></mesh>`. Paths specified by `model://` are not supported in Ignition yet, so this case in the code is not tested.\r\n\r\n## Test --log-overwrite and --log-compress:\r\n\r\nWhen recording to `path`, the compression file is implied to be `path.zip`. Both are checked for existence.\r\n\r\nNo `--log-overwrite` \\(default\\):\r\n\r\n```\r\n# This SDF specifies the equivalent of --record-path '/tmp/log'\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf\r\n\r\n# Run it again. By default it will always overwrite, because overwrite is now taken care of in ign.cc\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf\r\n[Msg] Overwriting existing file [/tmp/log/state.tlog]\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n```\r\n\r\n`--log-overwrite`, `/tmp/log` already exists:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-overwrite --record-path '/tmp/log'\r\n[Msg] Log path already exists on disk! Existing files will be overwritten.\r\n[Msg] Removing existing path [/tmp/log]\r\n...\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n...\r\n[Msg] Stopping recording\r\n```\r\n\r\n`--log-overwrite --log-compress`, `/tmp/log` exists, `/tmp/log.zip` does not exist:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-compress --log-overwrite --record-path '/tmp/log'\r\n[Msg] Log path already exists on disk! Existing files will be overwritten.\r\n[Msg] Removing existing path [/tmp/log]\r\n...\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n...\r\n[Msg] Compressed log file and resources to [/tmp/log.zip].\r\nRemoving recorded directory [/tmp/log].\r\n[Msg] Stopping recording\r\n```\r\n\r\n`--log-overwrite --log-compress`, `/tmp/log` does not exist, `/tmp/log.zip` exists:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-compress --log-overwrite --record-path '/tmp/log'\r\n[Wrn] [ign.cc:121] Compressed log path already exists on disk! Existing files will be overwritten.\r\n[Msg] Removing existing compressed file [/tmp/log.zip]\r\n...\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n...\r\n[Msg] Compressed log file and resources to [/tmp/log.zip].\r\nRemoving recorded directory [/tmp/log].\r\n[Msg] Stopping recording\r\n```\r\n\r\n`--log-overwrite` only, `/tmp/log.zip` exists, `/tmp/log` does not exist:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-overwrite --record-path '/tmp/log'\r\n[Msg] Removing existing compressed file [/tmp/log.zip]\r\n...\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n...\r\n[Msg] Stopping recording\r\n```\r\n\r\n`--log-compress` only, both `/tmp/log` and `/tmp/log.zip` already exist:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-compress --record-path '/tmp/log'\r\n[Wrn] [ign.cc:152] Log path already exists on disk! Recording instead to [/tmp/log(1)]\r\n[Wrn] [ign.cc:154] Compressed log path already exists on disk! Recording instead to [/tmp/log(1).zip]\r\n...\r\n[Msg] Recording to log file [/tmp/log(1)/state.tlog]\r\n...\r\n[Msg] Compressed log file and resources to [/tmp/log(1).zip].\r\nRemoving recorded directory [/tmp/log(1)].\r\n[Msg] Stopping recording\r\n$ ls /tmp\r\nlog\r\n'log(1).zip'\r\nlog.zip\r\n```\r\n\r\n`--log-compress` only, `/tmp/log` does not exist, `/tmp/log.zip` exists, `/tmp/log(1).zip` exists:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-compress --record-path '/tmp/log'\r\n[Wrn] [ign.cc:152] Log path already exists on disk! Recording instead to [/tmp/log(2)]\r\n[Wrn] [ign.cc:154] Compressed log path already exists on disk! Recording instead to [/tmp/log(2).zip]\r\n...\r\n[Msg] Recording to log file [/tmp/log(2)/state.tlog]\r\n...\r\n[Msg] Compressed log file and resources to [/tmp/log(2).zip].\r\nRemoving recorded directory [/tmp/log(2)].\r\n[Msg] Stopping recording\r\n```\r\n\r\n## Record Path vs. Console Log Path\r\n\r\nIn Blueprint and Citadel, if `--record` is specified without `--record-path`, and `<path>` exists in SDF, a warning is printed, and recording will go to `<path>`, while console log will go to the default timestamp path.\r\n\r\nAs in this example:\r\n\r\n```\r\n# SDF specifies <path>/tmp/log</path>\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --record --log-compress -log-overwrite\r\n[Wrn] [ServerPrivate.cc:229] --record-path is not specified on command line. <path> is specified in SDF. Will record to <path>. Console will be logged to [/home/master/.ignition/gazebo/log/2019-09-20T19:51:33.996055619]. Note: In Ignition-D, <path> will be ignored, and all recordings will be written to default console log path if no path is specified on command line.\r\n[Msg] Overwriting existing file [/tmp/log/state.tlog]\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n...\r\n[Msg] Removing existing file [/tmp/log.zip].\r\n[Msg] Compressed log file and resources to [/tmp/log.zip].\r\nRemoving recorded directory [/tmp/log].\r\n```\r\n\r\nIn Ignition-D, `<path>` will be permanently ignored. Recordings and console log will go to same default path.\r\n\r\nIf `--record-path` is specified, then recording and console log will go to this path in Blueprint, Citadel, and Ignition-D.\r\n\r\n## Future Work\r\n\r\nFiles are outputted in `/tmp/log` and `/tmp/log.zip` in this example. During record, the original path in `file://` is prepended with the specified path, e.g. `/tmp/log`. During playback, the specified path is prepended to the URIs in the SDF.", "title": "[Blueprint] Logging meshes and materials", "destination": {"commit": {"hash": "d8c02a385cf8", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/commit/d8c02a385cf8.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/commits/d8c02a385cf8"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{f98d11fe-f287-4dfb-99c3-e2b76a13232e}ts=2082645"}}, "type": "repository", "name": "ign-gazebo", "full_name": "ignitionrobotics/ign-gazebo", "uuid": "{f98d11fe-f287-4dfb-99c3-e2b76a13232e}"}, "branch": {"name": "ign-gazebo2"}}, "reason": "", "source": {"commit": {"hash": "b2f3c65a8610", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/commit/b2f3c65a8610.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/commits/b2f3c65a8610"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{f98d11fe-f287-4dfb-99c3-e2b76a13232e}ts=2082645"}}, "type": "repository", "name": "ign-gazebo", "full_name": "ignitionrobotics/ign-gazebo", "uuid": "{f98d11fe-f287-4dfb-99c3-e2b76a13232e}"}, "branch": {"name": "log_resources"}}, "state": "OPEN", "author": {"display_name": "Mabel Zhang", "uuid": "{4b0e38fb-bf50-45c0-a496-61147518b2bf}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B4b0e38fb-bf50-45c0-a496-61147518b2bf%7D"}, "html": {"href": "https://bitbucket.org/%7B4b0e38fb-bf50-45c0-a496-61147518b2bf%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:ceb5942c-6843-408c-8550-3ce4899d299b/4d48e5ea-cf28-4fa7-9715-8fc9e315d831/128"}}, "nickname": "mabelmzhang", "type": "user", "account_id": "557058:ceb5942c-6843-408c-8550-3ce4899d299b"}, "date": "2020-03-20T22:56:43.750680+00:00"}, "pull_request": {"type": "pullrequest", "id": 397, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397"}}, "title": "[Blueprint] Logging meshes and materials"}}, {"comment": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397/comments/141258354.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397/_/diff#comment-141258354"}}, "parent": {"id": 141214526, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397/comments/141214526.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397/_/diff#comment-141214526"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 397, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397"}}, "title": "[Blueprint] Logging meshes and materials"}, "content": {"raw": "Oh yes, forgot that doesn\u2019t work for Apple. fa017a8 adds test using `ServerConfig`.", "markup": "markdown", "html": "<p>Oh yes, forgot that doesn\u2019t work for Apple. <a href=\"#!/ignitionrobotics/ign-gazebo/commits/fa017a8\" rel=\"nofollow\" class=\"ap-connect-link\">fa017a8</a> adds test using <code>ServerConfig</code>.</p>", "type": "rendered"}, "created_on": "2020-03-20T22:37:34.967420+00:00", "user": {"display_name": "Mabel Zhang", "uuid": "{4b0e38fb-bf50-45c0-a496-61147518b2bf}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B4b0e38fb-bf50-45c0-a496-61147518b2bf%7D"}, "html": {"href": "https://bitbucket.org/%7B4b0e38fb-bf50-45c0-a496-61147518b2bf%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:ceb5942c-6843-408c-8550-3ce4899d299b/4d48e5ea-cf28-4fa7-9715-8fc9e315d831/128"}}, "nickname": "mabelmzhang", "type": "user", "account_id": "557058:ceb5942c-6843-408c-8550-3ce4899d299b"}, "inline": {}, "updated_on": "2020-03-20T22:37:34.978582+00:00", "type": "pullrequest_comment", "id": 141258354}, "pull_request": {"type": "pullrequest", "id": 397, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397"}}, "title": "[Blueprint] Logging meshes and materials"}}, {"update": {"description": "Depends on [ign-common PR 200](#!/ignitionrobotics/ign-common/pull-requests/200/log-resources/diff).\r\n\r\nPorts [this Gazebo PR](https://bitbucket.org/osrf/gazebo/pull-requests/2811/save-models-material-and-meshes-when/diff) to Ignition.\r\n\r\nImplements `--record-resources`, and `--log-compress` and `--log-overwrite` to support it.\r\n\r\nRecords resources \\(`--record-resources`\\), i.e. meshes and materials, to a directory under the specified log record directory. Optionally compresses \\(`--log-compress`\\) the whole directory, which contains the existing `.tlog` sqlite3 file and any resources, to a zip file. If directory or compressed file already exist, optionally overwrites \\(`--log-overwrite`\\).\r\n\r\nCorresponding SDF plugin parameters: `<record_resources>1</record_resources>`, `<compress>1</compress>.`If both command line and SDF parameters are specified, command line option overwrites SDF parameter. `--log-overwrite` is handled on command line only, outside of the plugin. If recording is only enabled from SDF and not from command line, then behavior is to always overwrite.\r\n\r\n## Usage:\r\n\r\n```\r\nign gazebo [...] --record-resources --log-overwrite --log-compress\r\n```\r\n\r\n## Test --record-resources:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-overwrite --record-path /tmp/log\r\n# (Re)move local downloaded Fuel copy of resources\r\n$ mv ~/.ignition/fuel ~/.ignition/fuel_bak\r\n# Play back from recorded resources\r\n$ ign gazebo -v 4 -r --playback /tmp/log\r\n```\r\n\r\nTested with `<include><uri>https://fuel...</uri></include>` and `<mesh><uri>file://...</uri></mesh>`. Paths specified by `model://` are not supported in Ignition yet, so this case in the code is not tested.\r\n\r\n## Test --log-overwrite and --log-compress:\r\n\r\nWhen recording to `path`, the compression file is implied to be `path.zip`. Both are checked for existence.\r\n\r\nNo `--log-overwrite` \\(default\\):\r\n\r\n```\r\n# This SDF specifies the equivalent of --record-path '/tmp/log'\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf\r\n\r\n# Run it again. By default it will always overwrite, because overwrite is now taken care of in ign.cc\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf\r\n[Msg] Overwriting existing file [/tmp/log/state.tlog]\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n```\r\n\r\n`--log-overwrite`, `/tmp/log` already exists:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-overwrite --record-path '/tmp/log'\r\n[Msg] Log path already exists on disk! Existing files will be overwritten.\r\n[Msg] Removing existing path [/tmp/log]\r\n...\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n...\r\n[Msg] Stopping recording\r\n```\r\n\r\n`--log-overwrite --log-compress`, `/tmp/log` exists, `/tmp/log.zip` does not exist:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-compress --log-overwrite --record-path '/tmp/log'\r\n[Msg] Log path already exists on disk! Existing files will be overwritten.\r\n[Msg] Removing existing path [/tmp/log]\r\n...\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n...\r\n[Msg] Compressed log file and resources to [/tmp/log.zip].\r\nRemoving recorded directory [/tmp/log].\r\n[Msg] Stopping recording\r\n```\r\n\r\n`--log-overwrite --log-compress`, `/tmp/log` does not exist, `/tmp/log.zip` exists:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-compress --log-overwrite --record-path '/tmp/log'\r\n[Wrn] [ign.cc:121] Compressed log path already exists on disk! Existing files will be overwritten.\r\n[Msg] Removing existing compressed file [/tmp/log.zip]\r\n...\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n...\r\n[Msg] Compressed log file and resources to [/tmp/log.zip].\r\nRemoving recorded directory [/tmp/log].\r\n[Msg] Stopping recording\r\n```\r\n\r\n`--log-overwrite` only, `/tmp/log.zip` exists, `/tmp/log` does not exist:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-overwrite --record-path '/tmp/log'\r\n[Msg] Removing existing compressed file [/tmp/log.zip]\r\n...\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n...\r\n[Msg] Stopping recording\r\n```\r\n\r\n`--log-compress` only, both `/tmp/log` and `/tmp/log.zip` already exist:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-compress --record-path '/tmp/log'\r\n[Wrn] [ign.cc:152] Log path already exists on disk! Recording instead to [/tmp/log(1)]\r\n[Wrn] [ign.cc:154] Compressed log path already exists on disk! Recording instead to [/tmp/log(1).zip]\r\n...\r\n[Msg] Recording to log file [/tmp/log(1)/state.tlog]\r\n...\r\n[Msg] Compressed log file and resources to [/tmp/log(1).zip].\r\nRemoving recorded directory [/tmp/log(1)].\r\n[Msg] Stopping recording\r\n$ ls /tmp\r\nlog\r\n'log(1).zip'\r\nlog.zip\r\n```\r\n\r\n`--log-compress` only, `/tmp/log` does not exist, `/tmp/log.zip` exists, `/tmp/log(1).zip` exists:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-compress --record-path '/tmp/log'\r\n[Wrn] [ign.cc:152] Log path already exists on disk! Recording instead to [/tmp/log(2)]\r\n[Wrn] [ign.cc:154] Compressed log path already exists on disk! Recording instead to [/tmp/log(2).zip]\r\n...\r\n[Msg] Recording to log file [/tmp/log(2)/state.tlog]\r\n...\r\n[Msg] Compressed log file and resources to [/tmp/log(2).zip].\r\nRemoving recorded directory [/tmp/log(2)].\r\n[Msg] Stopping recording\r\n```\r\n\r\n## Record Path vs. Console Log Path\r\n\r\nIn Blueprint and Citadel, if `--record` is specified without `--record-path`, and `<path>` exists in SDF, a warning is printed, and recording will go to `<path>`, while console log will go to the default timestamp path.\r\n\r\nAs in this example:\r\n\r\n```\r\n# SDF specifies <path>/tmp/log</path>\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --record --log-compress -log-overwrite\r\n[Wrn] [ServerPrivate.cc:229] --record-path is not specified on command line. <path> is specified in SDF. Will record to <path>. Console will be logged to [/home/master/.ignition/gazebo/log/2019-09-20T19:51:33.996055619]. Note: In Ignition-D, <path> will be ignored, and all recordings will be written to default console log path if no path is specified on command line.\r\n[Msg] Overwriting existing file [/tmp/log/state.tlog]\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n...\r\n[Msg] Removing existing file [/tmp/log.zip].\r\n[Msg] Compressed log file and resources to [/tmp/log.zip].\r\nRemoving recorded directory [/tmp/log].\r\n```\r\n\r\nIn Ignition-D, `<path>` will be permanently ignored. Recordings and console log will go to same default path.\r\n\r\nIf `--record-path` is specified, then recording and console log will go to this path in Blueprint, Citadel, and Ignition-D.\r\n\r\n## Future Work\r\n\r\nFiles are outputted in `/tmp/log` and `/tmp/log.zip` in this example. During record, the original path in `file://` is prepended with the specified path, e.g. `/tmp/log`. During playback, the specified path is prepended to the URIs in the SDF.", "title": "[Blueprint] Logging meshes and materials", "destination": {"commit": {"hash": "d8c02a385cf8", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/commit/d8c02a385cf8.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/commits/d8c02a385cf8"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{f98d11fe-f287-4dfb-99c3-e2b76a13232e}ts=2082645"}}, "type": "repository", "name": "ign-gazebo", "full_name": "ignitionrobotics/ign-gazebo", "uuid": "{f98d11fe-f287-4dfb-99c3-e2b76a13232e}"}, "branch": {"name": "ign-gazebo2"}}, "reason": "", "source": {"commit": {"hash": "fa017a872756", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/commit/fa017a872756.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/commits/fa017a872756"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{f98d11fe-f287-4dfb-99c3-e2b76a13232e}ts=2082645"}}, "type": "repository", "name": "ign-gazebo", "full_name": "ignitionrobotics/ign-gazebo", "uuid": "{f98d11fe-f287-4dfb-99c3-e2b76a13232e}"}, "branch": {"name": "log_resources"}}, "state": "OPEN", "author": {"display_name": "Mabel Zhang", "uuid": "{4b0e38fb-bf50-45c0-a496-61147518b2bf}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B4b0e38fb-bf50-45c0-a496-61147518b2bf%7D"}, "html": {"href": "https://bitbucket.org/%7B4b0e38fb-bf50-45c0-a496-61147518b2bf%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:ceb5942c-6843-408c-8550-3ce4899d299b/4d48e5ea-cf28-4fa7-9715-8fc9e315d831/128"}}, "nickname": "mabelmzhang", "type": "user", "account_id": "557058:ceb5942c-6843-408c-8550-3ce4899d299b"}, "date": "2020-03-20T22:36:50.611593+00:00"}, "pull_request": {"type": "pullrequest", "id": 397, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397"}}, "title": "[Blueprint] Logging meshes and materials"}}, {"comment": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397/comments/141214526.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397/_/diff#comment-141214526"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 397, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397"}}, "title": "[Blueprint] Logging meshes and materials"}, "content": {"raw": "This is [failing on OSX](https://build.osrfoundation.org/job/ignition_gazebo-ci-pr_any-homebrew-amd64/2666/testReport/junit/(root)/LogSystemTest/LogResources/), probably because the command line tool is used:\n\n```\n/Users/jenkins/workspace/ignition_gazebo-ci-pr_any-homebrew-amd64/ign-gazebo/test/integration/log_system.cc:1736\nValue of: common::exists(consolePath)\n  Actual: false\nExpected: true\n```\n\n@{mabelmzhang} , how about disabling this test on APPLE and creating another test that records resources, but using `ServerConfig` instead? That should work on OSX.", "markup": "markdown", "html": "<p>This is <a data-is-external-link=\"true\" href=\"https://build.osrfoundation.org/job/ignition_gazebo-ci-pr_any-homebrew-amd64/2666/testReport/junit/(root)/LogSystemTest/LogResources/\" rel=\"nofollow\">failing on OSX</a>, probably because the command line tool is used:</p>\n<div class=\"codehilite\"><pre><span></span>/Users/jenkins/workspace/ignition_gazebo-ci-pr_any-homebrew-amd64/ign-gazebo/test/integration/log_system.cc:1736\nValue of: common::exists(consolePath)\n  Actual: false\nExpected: true\n</pre></div>\n\n\n<p><span class=\"ap-mention\" data-atlassian-id=\"557058:ceb5942c-6843-408c-8550-3ce4899d299b\">@Mabel Zhang</span> , how about disabling this test on APPLE and creating another test that records resources, but using <code>ServerConfig</code> instead? That should work on OSX.</p>", "type": "rendered"}, "created_on": "2020-03-20T16:26:16.507633+00:00", "user": {"display_name": "Louise Poubel", "uuid": "{5cfa2075-477b-4ded-bdb9-8d2479544ec4}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D"}, "html": {"href": "https://bitbucket.org/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8/7d903d90-c5ea-4182-b7ef-0d467e9e1c74/128"}}, "nickname": "chapulina", "type": "user", "account_id": "557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8"}, "inline": {}, "updated_on": "2020-03-20T16:26:16.522047+00:00", "type": "pullrequest_comment", "id": 141214526}, "pull_request": {"type": "pullrequest", "id": 397, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397"}}, "title": "[Blueprint] Logging meshes and materials"}}, {"comment": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397/comments/141070612.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397/_/diff#comment-141070612"}}, "parent": {"id": 141067067, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397/comments/141067067.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397/_/diff#comment-141067067"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 397, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397"}}, "title": "[Blueprint] Logging meshes and materials"}, "content": {"raw": "5800675 Let me know if there should be more information.", "markup": "markdown", "html": "<p><a href=\"#!/ignitionrobotics/ign-gazebo/commits/5800675\" rel=\"nofollow\" class=\"ap-connect-link\">5800675</a> Let me know if there should be more information.</p>", "type": "rendered"}, "created_on": "2020-03-20T01:31:15.603918+00:00", "user": {"display_name": "Mabel Zhang", "uuid": "{4b0e38fb-bf50-45c0-a496-61147518b2bf}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B4b0e38fb-bf50-45c0-a496-61147518b2bf%7D"}, "html": {"href": "https://bitbucket.org/%7B4b0e38fb-bf50-45c0-a496-61147518b2bf%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:ceb5942c-6843-408c-8550-3ce4899d299b/4d48e5ea-cf28-4fa7-9715-8fc9e315d831/128"}}, "nickname": "mabelmzhang", "type": "user", "account_id": "557058:ceb5942c-6843-408c-8550-3ce4899d299b"}, "inline": {}, "updated_on": "2020-03-20T01:31:15.615614+00:00", "type": "pullrequest_comment", "id": 141070612}, "pull_request": {"type": "pullrequest", "id": 397, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397"}}, "title": "[Blueprint] Logging meshes and materials"}}, {"comment": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397/comments/141070590.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397/_/diff#comment-141070590"}}, "parent": {"id": 141066972, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397/comments/141066972.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397/_/diff#comment-141066972"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 397, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397"}}, "title": "[Blueprint] Logging meshes and materials"}, "content": {"raw": "5800675", "markup": "markdown", "html": "<p><a href=\"#!/ignitionrobotics/ign-gazebo/commits/5800675\" rel=\"nofollow\" class=\"ap-connect-link\">5800675</a></p>", "type": "rendered"}, "created_on": "2020-03-20T01:30:45.148326+00:00", "user": {"display_name": "Mabel Zhang", "uuid": "{4b0e38fb-bf50-45c0-a496-61147518b2bf}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B4b0e38fb-bf50-45c0-a496-61147518b2bf%7D"}, "html": {"href": "https://bitbucket.org/%7B4b0e38fb-bf50-45c0-a496-61147518b2bf%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:ceb5942c-6843-408c-8550-3ce4899d299b/4d48e5ea-cf28-4fa7-9715-8fc9e315d831/128"}}, "nickname": "mabelmzhang", "type": "user", "account_id": "557058:ceb5942c-6843-408c-8550-3ce4899d299b"}, "inline": {}, "updated_on": "2020-03-20T01:30:45.156968+00:00", "type": "pullrequest_comment", "id": 141070590}, "pull_request": {"type": "pullrequest", "id": 397, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397"}}, "title": "[Blueprint] Logging meshes and materials"}}, {"comment": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397/comments/141070584.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397/_/diff#comment-141070584"}}, "parent": {"id": 141067161, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397/comments/141067161.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397/_/diff#comment-141067161"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 397, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397"}}, "title": "[Blueprint] Logging meshes and materials"}, "content": {"raw": "5800675", "markup": "markdown", "html": "<p><a href=\"#!/ignitionrobotics/ign-gazebo/commits/5800675\" rel=\"nofollow\" class=\"ap-connect-link\">5800675</a></p>", "type": "rendered"}, "created_on": "2020-03-20T01:30:37.394181+00:00", "user": {"display_name": "Mabel Zhang", "uuid": "{4b0e38fb-bf50-45c0-a496-61147518b2bf}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B4b0e38fb-bf50-45c0-a496-61147518b2bf%7D"}, "html": {"href": "https://bitbucket.org/%7B4b0e38fb-bf50-45c0-a496-61147518b2bf%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:ceb5942c-6843-408c-8550-3ce4899d299b/4d48e5ea-cf28-4fa7-9715-8fc9e315d831/128"}}, "nickname": "mabelmzhang", "type": "user", "account_id": "557058:ceb5942c-6843-408c-8550-3ce4899d299b"}, "inline": {}, "updated_on": "2020-03-20T01:30:37.403717+00:00", "type": "pullrequest_comment", "id": 141070584}, "pull_request": {"type": "pullrequest", "id": 397, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397"}}, "title": "[Blueprint] Logging meshes and materials"}}, {"update": {"description": "Depends on [ign-common PR 200](#!/ignitionrobotics/ign-common/pull-requests/200/log-resources/diff).\r\n\r\nPorts [this Gazebo PR](https://bitbucket.org/osrf/gazebo/pull-requests/2811/save-models-material-and-meshes-when/diff) to Ignition.\r\n\r\nImplements `--record-resources`, and `--log-compress` and `--log-overwrite` to support it.\r\n\r\nRecords resources \\(`--record-resources`\\), i.e. meshes and materials, to a directory under the specified log record directory. Optionally compresses \\(`--log-compress`\\) the whole directory, which contains the existing `.tlog` sqlite3 file and any resources, to a zip file. If directory or compressed file already exist, optionally overwrites \\(`--log-overwrite`\\).\r\n\r\nCorresponding SDF plugin parameters: `<record_resources>1</record_resources>`, `<compress>1</compress>.`If both command line and SDF parameters are specified, command line option overwrites SDF parameter. `--log-overwrite` is handled on command line only, outside of the plugin. If recording is only enabled from SDF and not from command line, then behavior is to always overwrite.\r\n\r\n## Usage:\r\n\r\n```\r\nign gazebo [...] --record-resources --log-overwrite --log-compress\r\n```\r\n\r\n## Test --record-resources:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-overwrite --record-path /tmp/log\r\n# (Re)move local downloaded Fuel copy of resources\r\n$ mv ~/.ignition/fuel ~/.ignition/fuel_bak\r\n# Play back from recorded resources\r\n$ ign gazebo -v 4 -r --playback /tmp/log\r\n```\r\n\r\nTested with `<include><uri>https://fuel...</uri></include>` and `<mesh><uri>file://...</uri></mesh>`. Paths specified by `model://` are not supported in Ignition yet, so this case in the code is not tested.\r\n\r\n## Test --log-overwrite and --log-compress:\r\n\r\nWhen recording to `path`, the compression file is implied to be `path.zip`. Both are checked for existence.\r\n\r\nNo `--log-overwrite` \\(default\\):\r\n\r\n```\r\n# This SDF specifies the equivalent of --record-path '/tmp/log'\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf\r\n\r\n# Run it again. By default it will always overwrite, because overwrite is now taken care of in ign.cc\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf\r\n[Msg] Overwriting existing file [/tmp/log/state.tlog]\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n```\r\n\r\n`--log-overwrite`, `/tmp/log` already exists:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-overwrite --record-path '/tmp/log'\r\n[Msg] Log path already exists on disk! Existing files will be overwritten.\r\n[Msg] Removing existing path [/tmp/log]\r\n...\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n...\r\n[Msg] Stopping recording\r\n```\r\n\r\n`--log-overwrite --log-compress`, `/tmp/log` exists, `/tmp/log.zip` does not exist:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-compress --log-overwrite --record-path '/tmp/log'\r\n[Msg] Log path already exists on disk! Existing files will be overwritten.\r\n[Msg] Removing existing path [/tmp/log]\r\n...\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n...\r\n[Msg] Compressed log file and resources to [/tmp/log.zip].\r\nRemoving recorded directory [/tmp/log].\r\n[Msg] Stopping recording\r\n```\r\n\r\n`--log-overwrite --log-compress`, `/tmp/log` does not exist, `/tmp/log.zip` exists:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-compress --log-overwrite --record-path '/tmp/log'\r\n[Wrn] [ign.cc:121] Compressed log path already exists on disk! Existing files will be overwritten.\r\n[Msg] Removing existing compressed file [/tmp/log.zip]\r\n...\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n...\r\n[Msg] Compressed log file and resources to [/tmp/log.zip].\r\nRemoving recorded directory [/tmp/log].\r\n[Msg] Stopping recording\r\n```\r\n\r\n`--log-overwrite` only, `/tmp/log.zip` exists, `/tmp/log` does not exist:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-overwrite --record-path '/tmp/log'\r\n[Msg] Removing existing compressed file [/tmp/log.zip]\r\n...\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n...\r\n[Msg] Stopping recording\r\n```\r\n\r\n`--log-compress` only, both `/tmp/log` and `/tmp/log.zip` already exist:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-compress --record-path '/tmp/log'\r\n[Wrn] [ign.cc:152] Log path already exists on disk! Recording instead to [/tmp/log(1)]\r\n[Wrn] [ign.cc:154] Compressed log path already exists on disk! Recording instead to [/tmp/log(1).zip]\r\n...\r\n[Msg] Recording to log file [/tmp/log(1)/state.tlog]\r\n...\r\n[Msg] Compressed log file and resources to [/tmp/log(1).zip].\r\nRemoving recorded directory [/tmp/log(1)].\r\n[Msg] Stopping recording\r\n$ ls /tmp\r\nlog\r\n'log(1).zip'\r\nlog.zip\r\n```\r\n\r\n`--log-compress` only, `/tmp/log` does not exist, `/tmp/log.zip` exists, `/tmp/log(1).zip` exists:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-compress --record-path '/tmp/log'\r\n[Wrn] [ign.cc:152] Log path already exists on disk! Recording instead to [/tmp/log(2)]\r\n[Wrn] [ign.cc:154] Compressed log path already exists on disk! Recording instead to [/tmp/log(2).zip]\r\n...\r\n[Msg] Recording to log file [/tmp/log(2)/state.tlog]\r\n...\r\n[Msg] Compressed log file and resources to [/tmp/log(2).zip].\r\nRemoving recorded directory [/tmp/log(2)].\r\n[Msg] Stopping recording\r\n```\r\n\r\n## Record Path vs. Console Log Path\r\n\r\nIn Blueprint and Citadel, if `--record` is specified without `--record-path`, and `<path>` exists in SDF, a warning is printed, and recording will go to `<path>`, while console log will go to the default timestamp path.\r\n\r\nAs in this example:\r\n\r\n```\r\n# SDF specifies <path>/tmp/log</path>\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --record --log-compress -log-overwrite\r\n[Wrn] [ServerPrivate.cc:229] --record-path is not specified on command line. <path> is specified in SDF. Will record to <path>. Console will be logged to [/home/master/.ignition/gazebo/log/2019-09-20T19:51:33.996055619]. Note: In Ignition-D, <path> will be ignored, and all recordings will be written to default console log path if no path is specified on command line.\r\n[Msg] Overwriting existing file [/tmp/log/state.tlog]\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n...\r\n[Msg] Removing existing file [/tmp/log.zip].\r\n[Msg] Compressed log file and resources to [/tmp/log.zip].\r\nRemoving recorded directory [/tmp/log].\r\n```\r\n\r\nIn Ignition-D, `<path>` will be permanently ignored. Recordings and console log will go to same default path.\r\n\r\nIf `--record-path` is specified, then recording and console log will go to this path in Blueprint, Citadel, and Ignition-D.\r\n\r\n## Future Work\r\n\r\nFiles are outputted in `/tmp/log` and `/tmp/log.zip` in this example. During record, the original path in `file://` is prepended with the specified path, e.g. `/tmp/log`. During playback, the specified path is prepended to the URIs in the SDF.", "title": "[Blueprint] Logging meshes and materials", "destination": {"commit": {"hash": "90c40e37584b", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/commit/90c40e37584b.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/commits/90c40e37584b"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{f98d11fe-f287-4dfb-99c3-e2b76a13232e}ts=2082645"}}, "type": "repository", "name": "ign-gazebo", "full_name": "ignitionrobotics/ign-gazebo", "uuid": "{f98d11fe-f287-4dfb-99c3-e2b76a13232e}"}, "branch": {"name": "ign-gazebo2"}}, "reason": "", "source": {"commit": {"hash": "c7372750baed", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/commit/c7372750baed.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/commits/c7372750baed"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{f98d11fe-f287-4dfb-99c3-e2b76a13232e}ts=2082645"}}, "type": "repository", "name": "ign-gazebo", "full_name": "ignitionrobotics/ign-gazebo", "uuid": "{f98d11fe-f287-4dfb-99c3-e2b76a13232e}"}, "branch": {"name": "log_resources"}}, "state": "OPEN", "author": {"display_name": "Mabel Zhang", "uuid": "{4b0e38fb-bf50-45c0-a496-61147518b2bf}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B4b0e38fb-bf50-45c0-a496-61147518b2bf%7D"}, "html": {"href": "https://bitbucket.org/%7B4b0e38fb-bf50-45c0-a496-61147518b2bf%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:ceb5942c-6843-408c-8550-3ce4899d299b/4d48e5ea-cf28-4fa7-9715-8fc9e315d831/128"}}, "nickname": "mabelmzhang", "type": "user", "account_id": "557058:ceb5942c-6843-408c-8550-3ce4899d299b"}, "date": "2020-03-20T01:30:18.265886+00:00"}, "pull_request": {"type": "pullrequest", "id": 397, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397"}}, "title": "[Blueprint] Logging meshes and materials"}}, {"update": {"description": "Depends on [ign-common PR 200](#!/ignitionrobotics/ign-common/pull-requests/200/log-resources/diff).\r\n\r\nPorts [this Gazebo PR](https://bitbucket.org/osrf/gazebo/pull-requests/2811/save-models-material-and-meshes-when/diff) to Ignition.\r\n\r\nImplements `--record-resources`, and `--log-compress` and `--log-overwrite` to support it.\r\n\r\nRecords resources \\(`--record-resources`\\), i.e. meshes and materials, to a directory under the specified log record directory. Optionally compresses \\(`--log-compress`\\) the whole directory, which contains the existing `.tlog` sqlite3 file and any resources, to a zip file. If directory or compressed file already exist, optionally overwrites \\(`--log-overwrite`\\).\r\n\r\nCorresponding SDF plugin parameters: `<record_resources>1</record_resources>`, `<compress>1</compress>.`If both command line and SDF parameters are specified, command line option overwrites SDF parameter. `--log-overwrite` is handled on command line only, outside of the plugin. If recording is only enabled from SDF and not from command line, then behavior is to always overwrite.\r\n\r\n## Usage:\r\n\r\n```\r\nign gazebo [...] --record-resources --log-overwrite --log-compress\r\n```\r\n\r\n## Test --record-resources:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-overwrite --record-path /tmp/log\r\n# (Re)move local downloaded Fuel copy of resources\r\n$ mv ~/.ignition/fuel ~/.ignition/fuel_bak\r\n# Play back from recorded resources\r\n$ ign gazebo -v 4 -r --playback /tmp/log\r\n```\r\n\r\nTested with `<include><uri>https://fuel...</uri></include>` and `<mesh><uri>file://...</uri></mesh>`. Paths specified by `model://` are not supported in Ignition yet, so this case in the code is not tested.\r\n\r\n## Test --log-overwrite and --log-compress:\r\n\r\nWhen recording to `path`, the compression file is implied to be `path.zip`. Both are checked for existence.\r\n\r\nNo `--log-overwrite` \\(default\\):\r\n\r\n```\r\n# This SDF specifies the equivalent of --record-path '/tmp/log'\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf\r\n\r\n# Run it again. By default it will always overwrite, because overwrite is now taken care of in ign.cc\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf\r\n[Msg] Overwriting existing file [/tmp/log/state.tlog]\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n```\r\n\r\n`--log-overwrite`, `/tmp/log` already exists:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-overwrite --record-path '/tmp/log'\r\n[Msg] Log path already exists on disk! Existing files will be overwritten.\r\n[Msg] Removing existing path [/tmp/log]\r\n...\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n...\r\n[Msg] Stopping recording\r\n```\r\n\r\n`--log-overwrite --log-compress`, `/tmp/log` exists, `/tmp/log.zip` does not exist:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-compress --log-overwrite --record-path '/tmp/log'\r\n[Msg] Log path already exists on disk! Existing files will be overwritten.\r\n[Msg] Removing existing path [/tmp/log]\r\n...\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n...\r\n[Msg] Compressed log file and resources to [/tmp/log.zip].\r\nRemoving recorded directory [/tmp/log].\r\n[Msg] Stopping recording\r\n```\r\n\r\n`--log-overwrite --log-compress`, `/tmp/log` does not exist, `/tmp/log.zip` exists:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-compress --log-overwrite --record-path '/tmp/log'\r\n[Wrn] [ign.cc:121] Compressed log path already exists on disk! Existing files will be overwritten.\r\n[Msg] Removing existing compressed file [/tmp/log.zip]\r\n...\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n...\r\n[Msg] Compressed log file and resources to [/tmp/log.zip].\r\nRemoving recorded directory [/tmp/log].\r\n[Msg] Stopping recording\r\n```\r\n\r\n`--log-overwrite` only, `/tmp/log.zip` exists, `/tmp/log` does not exist:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-overwrite --record-path '/tmp/log'\r\n[Msg] Removing existing compressed file [/tmp/log.zip]\r\n...\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n...\r\n[Msg] Stopping recording\r\n```\r\n\r\n`--log-compress` only, both `/tmp/log` and `/tmp/log.zip` already exist:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-compress --record-path '/tmp/log'\r\n[Wrn] [ign.cc:152] Log path already exists on disk! Recording instead to [/tmp/log(1)]\r\n[Wrn] [ign.cc:154] Compressed log path already exists on disk! Recording instead to [/tmp/log(1).zip]\r\n...\r\n[Msg] Recording to log file [/tmp/log(1)/state.tlog]\r\n...\r\n[Msg] Compressed log file and resources to [/tmp/log(1).zip].\r\nRemoving recorded directory [/tmp/log(1)].\r\n[Msg] Stopping recording\r\n$ ls /tmp\r\nlog\r\n'log(1).zip'\r\nlog.zip\r\n```\r\n\r\n`--log-compress` only, `/tmp/log` does not exist, `/tmp/log.zip` exists, `/tmp/log(1).zip` exists:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-compress --record-path '/tmp/log'\r\n[Wrn] [ign.cc:152] Log path already exists on disk! Recording instead to [/tmp/log(2)]\r\n[Wrn] [ign.cc:154] Compressed log path already exists on disk! Recording instead to [/tmp/log(2).zip]\r\n...\r\n[Msg] Recording to log file [/tmp/log(2)/state.tlog]\r\n...\r\n[Msg] Compressed log file and resources to [/tmp/log(2).zip].\r\nRemoving recorded directory [/tmp/log(2)].\r\n[Msg] Stopping recording\r\n```\r\n\r\n## Record Path vs. Console Log Path\r\n\r\nIn Blueprint and Citadel, if `--record` is specified without `--record-path`, and `<path>` exists in SDF, a warning is printed, and recording will go to `<path>`, while console log will go to the default timestamp path.\r\n\r\nAs in this example:\r\n\r\n```\r\n# SDF specifies <path>/tmp/log</path>\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --record --log-compress -log-overwrite\r\n[Wrn] [ServerPrivate.cc:229] --record-path is not specified on command line. <path> is specified in SDF. Will record to <path>. Console will be logged to [/home/master/.ignition/gazebo/log/2019-09-20T19:51:33.996055619]. Note: In Ignition-D, <path> will be ignored, and all recordings will be written to default console log path if no path is specified on command line.\r\n[Msg] Overwriting existing file [/tmp/log/state.tlog]\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n...\r\n[Msg] Removing existing file [/tmp/log.zip].\r\n[Msg] Compressed log file and resources to [/tmp/log.zip].\r\nRemoving recorded directory [/tmp/log].\r\n```\r\n\r\nIn Ignition-D, `<path>` will be permanently ignored. Recordings and console log will go to same default path.\r\n\r\nIf `--record-path` is specified, then recording and console log will go to this path in Blueprint, Citadel, and Ignition-D.\r\n\r\n## Future Work\r\n\r\nFiles are outputted in `/tmp/log` and `/tmp/log.zip` in this example. During record, the original path in `file://` is prepended with the specified path, e.g. `/tmp/log`. During playback, the specified path is prepended to the URIs in the SDF.", "title": "[Blueprint] Logging meshes and materials", "destination": {"commit": {"hash": "90c40e37584b", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/commit/90c40e37584b.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/commits/90c40e37584b"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{f98d11fe-f287-4dfb-99c3-e2b76a13232e}ts=2082645"}}, "type": "repository", "name": "ign-gazebo", "full_name": "ignitionrobotics/ign-gazebo", "uuid": "{f98d11fe-f287-4dfb-99c3-e2b76a13232e}"}, "branch": {"name": "ign-gazebo2"}}, "reason": "", "source": {"commit": {"hash": "58006752078c", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/commit/58006752078c.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/commits/58006752078c"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{f98d11fe-f287-4dfb-99c3-e2b76a13232e}ts=2082645"}}, "type": "repository", "name": "ign-gazebo", "full_name": "ignitionrobotics/ign-gazebo", "uuid": "{f98d11fe-f287-4dfb-99c3-e2b76a13232e}"}, "branch": {"name": "log_resources"}}, "state": "OPEN", "author": {"display_name": "Mabel Zhang", "uuid": "{4b0e38fb-bf50-45c0-a496-61147518b2bf}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B4b0e38fb-bf50-45c0-a496-61147518b2bf%7D"}, "html": {"href": "https://bitbucket.org/%7B4b0e38fb-bf50-45c0-a496-61147518b2bf%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:ceb5942c-6843-408c-8550-3ce4899d299b/4d48e5ea-cf28-4fa7-9715-8fc9e315d831/128"}}, "nickname": "mabelmzhang", "type": "user", "account_id": "557058:ceb5942c-6843-408c-8550-3ce4899d299b"}, "date": "2020-03-20T01:27:20.066703+00:00"}, "pull_request": {"type": "pullrequest", "id": 397, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397"}}, "title": "[Blueprint] Logging meshes and materials"}}, {"comment": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397/comments/141067161.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397/_/diff#comment-141067161"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 397, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397"}}, "title": "[Blueprint] Logging meshes and materials"}, "content": {"raw": "Style nit: the `*` should be touching the variable name, i.e. `sdf::Model *model`. There are several instances of this on this PR.", "markup": "markdown", "html": "<p>Style nit: the <code>*</code> should be touching the variable name, i.e. <code>sdf::Model *model</code>. There are several instances of this on this PR.</p>", "type": "rendered"}, "created_on": "2020-03-20T00:26:58.052392+00:00", "user": {"display_name": "Louise Poubel", "uuid": "{5cfa2075-477b-4ded-bdb9-8d2479544ec4}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D"}, "html": {"href": "https://bitbucket.org/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8/7d903d90-c5ea-4182-b7ef-0d467e9e1c74/128"}}, "nickname": "chapulina", "type": "user", "account_id": "557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8"}, "inline": {}, "updated_on": "2020-03-20T00:26:58.057808+00:00", "type": "pullrequest_comment", "id": 141067161}, "pull_request": {"type": "pullrequest", "id": 397, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397"}}, "title": "[Blueprint] Logging meshes and materials"}}, {"comment": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397/comments/141067067.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397/_/diff#comment-141067067"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 397, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397"}}, "title": "[Blueprint] Logging meshes and materials"}, "content": {"raw": "Could you add some comments here about what this function is doing? ", "markup": "markdown", "html": "<p>Could you add some comments here about what this function is doing? </p>", "type": "rendered"}, "created_on": "2020-03-20T00:25:14.972786+00:00", "user": {"display_name": "Louise Poubel", "uuid": "{5cfa2075-477b-4ded-bdb9-8d2479544ec4}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D"}, "html": {"href": "https://bitbucket.org/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8/7d903d90-c5ea-4182-b7ef-0d467e9e1c74/128"}}, "nickname": "chapulina", "type": "user", "account_id": "557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8"}, "inline": {}, "updated_on": "2020-03-20T00:25:14.979432+00:00", "type": "pullrequest_comment", "id": 141067067}, "pull_request": {"type": "pullrequest", "id": 397, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397"}}, "title": "[Blueprint] Logging meshes and materials"}}, {"comment": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397/comments/141066972.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397/_/diff#comment-141066972"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 397, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397"}}, "title": "[Blueprint] Logging meshes and materials"}, "content": {"raw": "We should check if `pathComp` is not null just in case some model was created without it.", "markup": "markdown", "html": "<p>We should check if <code>pathComp</code> is not null just in case some model was created without it.</p>", "type": "rendered"}, "created_on": "2020-03-20T00:23:36.038309+00:00", "user": {"display_name": "Louise Poubel", "uuid": "{5cfa2075-477b-4ded-bdb9-8d2479544ec4}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D"}, "html": {"href": "https://bitbucket.org/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8/7d903d90-c5ea-4182-b7ef-0d467e9e1c74/128"}}, "nickname": "chapulina", "type": "user", "account_id": "557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8"}, "inline": {}, "updated_on": "2020-03-20T00:23:36.049169+00:00", "type": "pullrequest_comment", "id": 141066972}, "pull_request": {"type": "pullrequest", "id": 397, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397"}}, "title": "[Blueprint] Logging meshes and materials"}}, {"comment": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397/comments/141057385.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397/_/diff#comment-141057385"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 397, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397"}}, "title": "[Blueprint] Logging meshes and materials"}, "content": {"raw": "Some manual testing I did that worked great:\n\n---\n\n1. `ign gazebo -v 3 -r --record-resources --record-path /tmp/lala fuel.sdf`\n1. Resources are recorded to `/tmp/lala/` together with other log files.\n1. `rm -rf ~/.ignition/fuel/fuel.ignitionrobotics.org`\n1. `ign gazebo -v 3 -r -p /tmp/lala`\n1. Resources show up correctly and are not downloaded again.\n\n---\n\n1. `ign gazebo -v 3 -r --record-resources --log-compress --record-path /tmp/lele fuel.sdf`\n1. `/tmp/lele.zip` is recorded\n1. `rm -rf ~/.ignition/fuel/fuel.ignitionrobotics.org`\n1. `ign gazebo -v 3 -r -p /tmp/lele.zip`\n1. Resources show up correctly and are not downloaded again.\n\n---\n\n", "markup": "markdown", "html": "<p>Some manual testing I did that worked great:</p>\n<hr />\n<ol>\n<li><code>ign gazebo -v 3 -r --record-resources --record-path /tmp/lala fuel.sdf</code></li>\n<li>Resources are recorded to <code>/tmp/lala/</code> together with other log files.</li>\n<li><code>rm -rf ~/.ignition/fuel/fuel.ignitionrobotics.org</code></li>\n<li><code>ign gazebo -v 3 -r -p /tmp/lala</code></li>\n<li>Resources show up correctly and are not downloaded again.</li>\n</ol>\n<hr />\n<ol>\n<li><code>ign gazebo -v 3 -r --record-resources --log-compress --record-path /tmp/lele fuel.sdf</code></li>\n<li><code>/tmp/lele.zip</code> is recorded</li>\n<li><code>rm -rf ~/.ignition/fuel/fuel.ignitionrobotics.org</code></li>\n<li><code>ign gazebo -v 3 -r -p /tmp/lele.zip</code></li>\n<li>Resources show up correctly and are not downloaded again.</li>\n</ol>\n<hr />", "type": "rendered"}, "created_on": "2020-03-19T22:23:12.368470+00:00", "user": {"display_name": "Louise Poubel", "uuid": "{5cfa2075-477b-4ded-bdb9-8d2479544ec4}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D"}, "html": {"href": "https://bitbucket.org/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8/7d903d90-c5ea-4182-b7ef-0d467e9e1c74/128"}}, "nickname": "chapulina", "type": "user", "account_id": "557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8"}, "updated_on": "2020-03-19T22:23:12.377207+00:00", "type": "pullrequest_comment", "id": 141057385}, "pull_request": {"type": "pullrequest", "id": 397, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397"}}, "title": "[Blueprint] Logging meshes and materials"}}, {"update": {"description": "Depends on [ign-common PR 200](#!/ignitionrobotics/ign-common/pull-requests/200/log-resources/diff).\r\n\r\nPorts [this Gazebo PR](https://bitbucket.org/osrf/gazebo/pull-requests/2811/save-models-material-and-meshes-when/diff) to Ignition.\r\n\r\nImplements `--record-resources`, and `--log-compress` and `--log-overwrite` to support it.\r\n\r\nRecords resources \\(`--record-resources`\\), i.e. meshes and materials, to a directory under the specified log record directory. Optionally compresses \\(`--log-compress`\\) the whole directory, which contains the existing `.tlog` sqlite3 file and any resources, to a zip file. If directory or compressed file already exist, optionally overwrites \\(`--log-overwrite`\\).\r\n\r\nCorresponding SDF plugin parameters: `<record_resources>1</record_resources>`, `<compress>1</compress>.`If both command line and SDF parameters are specified, command line option overwrites SDF parameter. `--log-overwrite` is handled on command line only, outside of the plugin. If recording is only enabled from SDF and not from command line, then behavior is to always overwrite.\r\n\r\n## Usage:\r\n\r\n```\r\nign gazebo [...] --record-resources --log-overwrite --log-compress\r\n```\r\n\r\n## Test --record-resources:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-overwrite --record-path /tmp/log\r\n# (Re)move local downloaded Fuel copy of resources\r\n$ mv ~/.ignition/fuel ~/.ignition/fuel_bak\r\n# Play back from recorded resources\r\n$ ign gazebo -v 4 -r --playback /tmp/log\r\n```\r\n\r\nTested with `<include><uri>https://fuel...</uri></include>` and `<mesh><uri>file://...</uri></mesh>`. Paths specified by `model://` are not supported in Ignition yet, so this case in the code is not tested.\r\n\r\n## Test --log-overwrite and --log-compress:\r\n\r\nWhen recording to `path`, the compression file is implied to be `path.zip`. Both are checked for existence.\r\n\r\nNo `--log-overwrite` \\(default\\):\r\n\r\n```\r\n# This SDF specifies the equivalent of --record-path '/tmp/log'\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf\r\n\r\n# Run it again. By default it will always overwrite, because overwrite is now taken care of in ign.cc\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf\r\n[Msg] Overwriting existing file [/tmp/log/state.tlog]\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n```\r\n\r\n`--log-overwrite`, `/tmp/log` already exists:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-overwrite --record-path '/tmp/log'\r\n[Msg] Log path already exists on disk! Existing files will be overwritten.\r\n[Msg] Removing existing path [/tmp/log]\r\n...\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n...\r\n[Msg] Stopping recording\r\n```\r\n\r\n`--log-overwrite --log-compress`, `/tmp/log` exists, `/tmp/log.zip` does not exist:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-compress --log-overwrite --record-path '/tmp/log'\r\n[Msg] Log path already exists on disk! Existing files will be overwritten.\r\n[Msg] Removing existing path [/tmp/log]\r\n...\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n...\r\n[Msg] Compressed log file and resources to [/tmp/log.zip].\r\nRemoving recorded directory [/tmp/log].\r\n[Msg] Stopping recording\r\n```\r\n\r\n`--log-overwrite --log-compress`, `/tmp/log` does not exist, `/tmp/log.zip` exists:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-compress --log-overwrite --record-path '/tmp/log'\r\n[Wrn] [ign.cc:121] Compressed log path already exists on disk! Existing files will be overwritten.\r\n[Msg] Removing existing compressed file [/tmp/log.zip]\r\n...\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n...\r\n[Msg] Compressed log file and resources to [/tmp/log.zip].\r\nRemoving recorded directory [/tmp/log].\r\n[Msg] Stopping recording\r\n```\r\n\r\n`--log-overwrite` only, `/tmp/log.zip` exists, `/tmp/log` does not exist:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-overwrite --record-path '/tmp/log'\r\n[Msg] Removing existing compressed file [/tmp/log.zip]\r\n...\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n...\r\n[Msg] Stopping recording\r\n```\r\n\r\n`--log-compress` only, both `/tmp/log` and `/tmp/log.zip` already exist:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-compress --record-path '/tmp/log'\r\n[Wrn] [ign.cc:152] Log path already exists on disk! Recording instead to [/tmp/log(1)]\r\n[Wrn] [ign.cc:154] Compressed log path already exists on disk! Recording instead to [/tmp/log(1).zip]\r\n...\r\n[Msg] Recording to log file [/tmp/log(1)/state.tlog]\r\n...\r\n[Msg] Compressed log file and resources to [/tmp/log(1).zip].\r\nRemoving recorded directory [/tmp/log(1)].\r\n[Msg] Stopping recording\r\n$ ls /tmp\r\nlog\r\n'log(1).zip'\r\nlog.zip\r\n```\r\n\r\n`--log-compress` only, `/tmp/log` does not exist, `/tmp/log.zip` exists, `/tmp/log(1).zip` exists:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-compress --record-path '/tmp/log'\r\n[Wrn] [ign.cc:152] Log path already exists on disk! Recording instead to [/tmp/log(2)]\r\n[Wrn] [ign.cc:154] Compressed log path already exists on disk! Recording instead to [/tmp/log(2).zip]\r\n...\r\n[Msg] Recording to log file [/tmp/log(2)/state.tlog]\r\n...\r\n[Msg] Compressed log file and resources to [/tmp/log(2).zip].\r\nRemoving recorded directory [/tmp/log(2)].\r\n[Msg] Stopping recording\r\n```\r\n\r\n## Record Path vs. Console Log Path\r\n\r\nIn Blueprint and Citadel, if `--record` is specified without `--record-path`, and `<path>` exists in SDF, a warning is printed, and recording will go to `<path>`, while console log will go to the default timestamp path.\r\n\r\nAs in this example:\r\n\r\n```\r\n# SDF specifies <path>/tmp/log</path>\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --record --log-compress -log-overwrite\r\n[Wrn] [ServerPrivate.cc:229] --record-path is not specified on command line. <path> is specified in SDF. Will record to <path>. Console will be logged to [/home/master/.ignition/gazebo/log/2019-09-20T19:51:33.996055619]. Note: In Ignition-D, <path> will be ignored, and all recordings will be written to default console log path if no path is specified on command line.\r\n[Msg] Overwriting existing file [/tmp/log/state.tlog]\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n...\r\n[Msg] Removing existing file [/tmp/log.zip].\r\n[Msg] Compressed log file and resources to [/tmp/log.zip].\r\nRemoving recorded directory [/tmp/log].\r\n```\r\n\r\nIn Ignition-D, `<path>` will be permanently ignored. Recordings and console log will go to same default path.\r\n\r\nIf `--record-path` is specified, then recording and console log will go to this path in Blueprint, Citadel, and Ignition-D.\r\n\r\n## Future Work\r\n\r\nFiles are outputted in `/tmp/log` and `/tmp/log.zip` in this example. During record, the original path in `file://` is prepended with the specified path, e.g. `/tmp/log`. During playback, the specified path is prepended to the URIs in the SDF.", "title": "[Blueprint] Logging meshes and materials", "destination": {"commit": {"hash": "90c40e37584b", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/commit/90c40e37584b.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/commits/90c40e37584b"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{f98d11fe-f287-4dfb-99c3-e2b76a13232e}ts=2082645"}}, "type": "repository", "name": "ign-gazebo", "full_name": "ignitionrobotics/ign-gazebo", "uuid": "{f98d11fe-f287-4dfb-99c3-e2b76a13232e}"}, "branch": {"name": "ign-gazebo2"}}, "reason": "", "source": {"commit": {"hash": "5cfc04605b5b", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/commit/5cfc04605b5b.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/commits/5cfc04605b5b"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{f98d11fe-f287-4dfb-99c3-e2b76a13232e}ts=2082645"}}, "type": "repository", "name": "ign-gazebo", "full_name": "ignitionrobotics/ign-gazebo", "uuid": "{f98d11fe-f287-4dfb-99c3-e2b76a13232e}"}, "branch": {"name": "log_resources"}}, "state": "OPEN", "author": {"display_name": "Mabel Zhang", "uuid": "{4b0e38fb-bf50-45c0-a496-61147518b2bf}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B4b0e38fb-bf50-45c0-a496-61147518b2bf%7D"}, "html": {"href": "https://bitbucket.org/%7B4b0e38fb-bf50-45c0-a496-61147518b2bf%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:ceb5942c-6843-408c-8550-3ce4899d299b/4d48e5ea-cf28-4fa7-9715-8fc9e315d831/128"}}, "nickname": "mabelmzhang", "type": "user", "account_id": "557058:ceb5942c-6843-408c-8550-3ce4899d299b"}, "date": "2020-03-19T06:06:52.593345+00:00"}, "pull_request": {"type": "pullrequest", "id": 397, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397"}}, "title": "[Blueprint] Logging meshes and materials"}}, {"comment": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397/comments/140858478.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397/_/diff#comment-140858478"}}, "parent": {"id": 139481710, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397/comments/139481710.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397/_/diff#comment-139481710"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 397, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397"}}, "title": "[Blueprint] Logging meshes and materials"}, "content": {"raw": "Thanks! 22c9482 uses the new `SourceFilePath` component. Things seem to work.", "markup": "markdown", "html": "<p>Thanks! <a href=\"#!/ignitionrobotics/ign-gazebo/commits/22c9482\" rel=\"nofollow\" class=\"ap-connect-link\">22c9482</a> uses the new <code>SourceFilePath</code> component. Things seem to work.</p>", "type": "rendered"}, "created_on": "2020-03-19T05:58:52.743139+00:00", "user": {"display_name": "Mabel Zhang", "uuid": "{4b0e38fb-bf50-45c0-a496-61147518b2bf}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B4b0e38fb-bf50-45c0-a496-61147518b2bf%7D"}, "html": {"href": "https://bitbucket.org/%7B4b0e38fb-bf50-45c0-a496-61147518b2bf%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:ceb5942c-6843-408c-8550-3ce4899d299b/4d48e5ea-cf28-4fa7-9715-8fc9e315d831/128"}}, "nickname": "mabelmzhang", "type": "user", "account_id": "557058:ceb5942c-6843-408c-8550-3ce4899d299b"}, "updated_on": "2020-03-19T05:58:52.751771+00:00", "type": "pullrequest_comment", "id": 140858478}, "pull_request": {"type": "pullrequest", "id": 397, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397"}}, "title": "[Blueprint] Logging meshes and materials"}}, {"comment": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397/comments/140858328.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397/_/diff#comment-140858328"}}, "parent": {"id": 138901411, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397/comments/138901411.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397/_/diff#comment-138901411"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 397, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397"}}, "title": "[Blueprint] Logging meshes and materials"}, "content": {"raw": "Updated to be more Ignition-like in 22c9482", "markup": "markdown", "html": "<p>Updated to be more Ignition-like in <a href=\"#!/ignitionrobotics/ign-gazebo/commits/22c9482\" rel=\"nofollow\" class=\"ap-connect-link\">22c9482</a></p>", "type": "rendered"}, "created_on": "2020-03-19T05:57:02.200332+00:00", "user": {"display_name": "Mabel Zhang", "uuid": "{4b0e38fb-bf50-45c0-a496-61147518b2bf}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B4b0e38fb-bf50-45c0-a496-61147518b2bf%7D"}, "html": {"href": "https://bitbucket.org/%7B4b0e38fb-bf50-45c0-a496-61147518b2bf%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:ceb5942c-6843-408c-8550-3ce4899d299b/4d48e5ea-cf28-4fa7-9715-8fc9e315d831/128"}}, "nickname": "mabelmzhang", "type": "user", "account_id": "557058:ceb5942c-6843-408c-8550-3ce4899d299b"}, "inline": {}, "updated_on": "2020-03-19T05:57:02.210227+00:00", "type": "pullrequest_comment", "id": 140858328}, "pull_request": {"type": "pullrequest", "id": 397, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397"}}, "title": "[Blueprint] Logging meshes and materials"}}, {"comment": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397/comments/140858321.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397/_/diff#comment-140858321"}}, "parent": {"id": 138901122, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397/comments/138901122.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397/_/diff#comment-138901122"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 397, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397"}}, "title": "[Blueprint] Logging meshes and materials"}, "content": {"raw": "Updated to be more Ignition-like in 22c9482", "markup": "markdown", "html": "<p>Updated to be more Ignition-like in <a href=\"#!/ignitionrobotics/ign-gazebo/commits/22c9482\" rel=\"nofollow\" class=\"ap-connect-link\">22c9482</a></p>", "type": "rendered"}, "created_on": "2020-03-19T05:56:58.845838+00:00", "user": {"display_name": "Mabel Zhang", "uuid": "{4b0e38fb-bf50-45c0-a496-61147518b2bf}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B4b0e38fb-bf50-45c0-a496-61147518b2bf%7D"}, "html": {"href": "https://bitbucket.org/%7B4b0e38fb-bf50-45c0-a496-61147518b2bf%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:ceb5942c-6843-408c-8550-3ce4899d299b/4d48e5ea-cf28-4fa7-9715-8fc9e315d831/128"}}, "nickname": "mabelmzhang", "type": "user", "account_id": "557058:ceb5942c-6843-408c-8550-3ce4899d299b"}, "inline": {}, "updated_on": "2020-03-19T05:56:58.855284+00:00", "type": "pullrequest_comment", "id": 140858321}, "pull_request": {"type": "pullrequest", "id": 397, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397"}}, "title": "[Blueprint] Logging meshes and materials"}}, {"update": {"description": "Depends on [ign-common PR 200](#!/ignitionrobotics/ign-common/pull-requests/200/log-resources/diff).\r\n\r\nPorts [this Gazebo PR](https://bitbucket.org/osrf/gazebo/pull-requests/2811/save-models-material-and-meshes-when/diff) to Ignition.\r\n\r\nImplements `--record-resources`, and `--log-compress` and `--log-overwrite` to support it.\r\n\r\nRecords resources \\(`--record-resources`\\), i.e. meshes and materials, to a directory under the specified log record directory. Optionally compresses \\(`--log-compress`\\) the whole directory, which contains the existing `.tlog` sqlite3 file and any resources, to a zip file. If directory or compressed file already exist, optionally overwrites \\(`--log-overwrite`\\).\r\n\r\nCorresponding SDF plugin parameters: `<record_resources>1</record_resources>`, `<compress>1</compress>.`If both command line and SDF parameters are specified, command line option overwrites SDF parameter. `--log-overwrite` is handled on command line only, outside of the plugin. If recording is only enabled from SDF and not from command line, then behavior is to always overwrite.\r\n\r\n## Usage:\r\n\r\n```\r\nign gazebo [...] --record-resources --log-overwrite --log-compress\r\n```\r\n\r\n## Test --record-resources:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-overwrite --record-path /tmp/log\r\n# (Re)move local downloaded Fuel copy of resources\r\n$ mv ~/.ignition/fuel ~/.ignition/fuel_bak\r\n# Play back from recorded resources\r\n$ ign gazebo -v 4 -r --playback /tmp/log\r\n```\r\n\r\nTested with `<include><uri>https://fuel...</uri></include>` and `<mesh><uri>file://...</uri></mesh>`. Paths specified by `model://` are not supported in Ignition yet, so this case in the code is not tested.\r\n\r\n## Test --log-overwrite and --log-compress:\r\n\r\nWhen recording to `path`, the compression file is implied to be `path.zip`. Both are checked for existence.\r\n\r\nNo `--log-overwrite` \\(default\\):\r\n\r\n```\r\n# This SDF specifies the equivalent of --record-path '/tmp/log'\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf\r\n\r\n# Run it again. By default it will always overwrite, because overwrite is now taken care of in ign.cc\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf\r\n[Msg] Overwriting existing file [/tmp/log/state.tlog]\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n```\r\n\r\n`--log-overwrite`, `/tmp/log` already exists:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-overwrite --record-path '/tmp/log'\r\n[Msg] Log path already exists on disk! Existing files will be overwritten.\r\n[Msg] Removing existing path [/tmp/log]\r\n...\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n...\r\n[Msg] Stopping recording\r\n```\r\n\r\n`--log-overwrite --log-compress`, `/tmp/log` exists, `/tmp/log.zip` does not exist:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-compress --log-overwrite --record-path '/tmp/log'\r\n[Msg] Log path already exists on disk! Existing files will be overwritten.\r\n[Msg] Removing existing path [/tmp/log]\r\n...\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n...\r\n[Msg] Compressed log file and resources to [/tmp/log.zip].\r\nRemoving recorded directory [/tmp/log].\r\n[Msg] Stopping recording\r\n```\r\n\r\n`--log-overwrite --log-compress`, `/tmp/log` does not exist, `/tmp/log.zip` exists:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-compress --log-overwrite --record-path '/tmp/log'\r\n[Wrn] [ign.cc:121] Compressed log path already exists on disk! Existing files will be overwritten.\r\n[Msg] Removing existing compressed file [/tmp/log.zip]\r\n...\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n...\r\n[Msg] Compressed log file and resources to [/tmp/log.zip].\r\nRemoving recorded directory [/tmp/log].\r\n[Msg] Stopping recording\r\n```\r\n\r\n`--log-overwrite` only, `/tmp/log.zip` exists, `/tmp/log` does not exist:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-overwrite --record-path '/tmp/log'\r\n[Msg] Removing existing compressed file [/tmp/log.zip]\r\n...\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n...\r\n[Msg] Stopping recording\r\n```\r\n\r\n`--log-compress` only, both `/tmp/log` and `/tmp/log.zip` already exist:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-compress --record-path '/tmp/log'\r\n[Wrn] [ign.cc:152] Log path already exists on disk! Recording instead to [/tmp/log(1)]\r\n[Wrn] [ign.cc:154] Compressed log path already exists on disk! Recording instead to [/tmp/log(1).zip]\r\n...\r\n[Msg] Recording to log file [/tmp/log(1)/state.tlog]\r\n...\r\n[Msg] Compressed log file and resources to [/tmp/log(1).zip].\r\nRemoving recorded directory [/tmp/log(1)].\r\n[Msg] Stopping recording\r\n$ ls /tmp\r\nlog\r\n'log(1).zip'\r\nlog.zip\r\n```\r\n\r\n`--log-compress` only, `/tmp/log` does not exist, `/tmp/log.zip` exists, `/tmp/log(1).zip` exists:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-compress --record-path '/tmp/log'\r\n[Wrn] [ign.cc:152] Log path already exists on disk! Recording instead to [/tmp/log(2)]\r\n[Wrn] [ign.cc:154] Compressed log path already exists on disk! Recording instead to [/tmp/log(2).zip]\r\n...\r\n[Msg] Recording to log file [/tmp/log(2)/state.tlog]\r\n...\r\n[Msg] Compressed log file and resources to [/tmp/log(2).zip].\r\nRemoving recorded directory [/tmp/log(2)].\r\n[Msg] Stopping recording\r\n```\r\n\r\n## Record Path vs. Console Log Path\r\n\r\nIn Blueprint and Citadel, if `--record` is specified without `--record-path`, and `<path>` exists in SDF, a warning is printed, and recording will go to `<path>`, while console log will go to the default timestamp path.\r\n\r\nAs in this example:\r\n\r\n```\r\n# SDF specifies <path>/tmp/log</path>\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --record --log-compress -log-overwrite\r\n[Wrn] [ServerPrivate.cc:229] --record-path is not specified on command line. <path> is specified in SDF. Will record to <path>. Console will be logged to [/home/master/.ignition/gazebo/log/2019-09-20T19:51:33.996055619]. Note: In Ignition-D, <path> will be ignored, and all recordings will be written to default console log path if no path is specified on command line.\r\n[Msg] Overwriting existing file [/tmp/log/state.tlog]\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n...\r\n[Msg] Removing existing file [/tmp/log.zip].\r\n[Msg] Compressed log file and resources to [/tmp/log.zip].\r\nRemoving recorded directory [/tmp/log].\r\n```\r\n\r\nIn Ignition-D, `<path>` will be permanently ignored. Recordings and console log will go to same default path.\r\n\r\nIf `--record-path` is specified, then recording and console log will go to this path in Blueprint, Citadel, and Ignition-D.\r\n\r\n## Future Work\r\n\r\nFiles are outputted in `/tmp/log` and `/tmp/log.zip` in this example. During record, the original path in `file://` is prepended with the specified path, e.g. `/tmp/log`. During playback, the specified path is prepended to the URIs in the SDF.", "title": "[Blueprint] Logging meshes and materials", "destination": {"commit": {"hash": "90c40e37584b", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/commit/90c40e37584b.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/commits/90c40e37584b"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{f98d11fe-f287-4dfb-99c3-e2b76a13232e}ts=2082645"}}, "type": "repository", "name": "ign-gazebo", "full_name": "ignitionrobotics/ign-gazebo", "uuid": "{f98d11fe-f287-4dfb-99c3-e2b76a13232e}"}, "branch": {"name": "ign-gazebo2"}}, "reason": "", "source": {"commit": {"hash": "22c948264490", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/commit/22c948264490.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/commits/22c948264490"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{f98d11fe-f287-4dfb-99c3-e2b76a13232e}ts=2082645"}}, "type": "repository", "name": "ign-gazebo", "full_name": "ignitionrobotics/ign-gazebo", "uuid": "{f98d11fe-f287-4dfb-99c3-e2b76a13232e}"}, "branch": {"name": "log_resources"}}, "state": "OPEN", "author": {"display_name": "Mabel Zhang", "uuid": "{4b0e38fb-bf50-45c0-a496-61147518b2bf}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B4b0e38fb-bf50-45c0-a496-61147518b2bf%7D"}, "html": {"href": "https://bitbucket.org/%7B4b0e38fb-bf50-45c0-a496-61147518b2bf%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:ceb5942c-6843-408c-8550-3ce4899d299b/4d48e5ea-cf28-4fa7-9715-8fc9e315d831/128"}}, "nickname": "mabelmzhang", "type": "user", "account_id": "557058:ceb5942c-6843-408c-8550-3ce4899d299b"}, "date": "2020-03-19T05:56:04.682141+00:00"}, "pull_request": {"type": "pullrequest", "id": 397, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397"}}, "title": "[Blueprint] Logging meshes and materials"}}, {"update": {"description": "Depends on [ign-common PR 200](#!/ignitionrobotics/ign-common/pull-requests/200/log-resources/diff).\r\n\r\nPorts [this Gazebo PR](https://bitbucket.org/osrf/gazebo/pull-requests/2811/save-models-material-and-meshes-when/diff) to Ignition.\r\n\r\nImplements `--record-resources`, and `--log-compress` and `--log-overwrite` to support it.\r\n\r\nRecords resources \\(`--record-resources`\\), i.e. meshes and materials, to a directory under the specified log record directory. Optionally compresses \\(`--log-compress`\\) the whole directory, which contains the existing `.tlog` sqlite3 file and any resources, to a zip file. If directory or compressed file already exist, optionally overwrites \\(`--log-overwrite`\\).\r\n\r\nCorresponding SDF plugin parameters: `<record_resources>1</record_resources>`, `<compress>1</compress>.`If both command line and SDF parameters are specified, command line option overwrites SDF parameter. `--log-overwrite` is handled on command line only, outside of the plugin. If recording is only enabled from SDF and not from command line, then behavior is to always overwrite.\r\n\r\n## Usage:\r\n\r\n```\r\nign gazebo [...] --record-resources --log-overwrite --log-compress\r\n```\r\n\r\n## Test --record-resources:\r\n\r\n```\r\n# This SDF specifies the equivalent of --record-resources --record-path '/tmp/log'\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf\r\n$ ign gazebo -v 4 -r examples/worlds/log_playback.sdf\r\n```\r\n\r\nTested with `<include><uri>https://fuel...</uri></include>` and `<mesh><uri>file://...</uri></mesh>`. Paths specified by `model://` are not supported in Ignition yet, so this case in the code is not tested.\r\n\r\n## Test --log-overwrite and --log-compress:\r\n\r\nWhen recording to `path`, the compression file is implied to be `path.zip`. Both are checked for existence.\r\n\r\nNo `--log-overwrite` \\(default\\):\r\n\r\n```\r\n# This SDF specifies the equivalent of --record-path '/tmp/log'\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf\r\n\r\n# Run it again. By default it will always overwrite, because overwrite is now taken care of in ign.cc\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf\r\n[Msg] Overwriting existing file [/tmp/log/state.tlog]\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n```\r\n\r\n`--log-overwrite`, `/tmp/log` already exists:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-overwrite --record-path '/tmp/log'\r\n[Msg] Log path already exists on disk! Existing files will be overwritten.\r\n[Msg] Removing existing path [/tmp/log]\r\n...\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n...\r\n[Msg] Stopping recording\r\n```\r\n\r\n`--log-overwrite --log-compress`, `/tmp/log` exists, `/tmp/log.zip` does not exist:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-compress --log-overwrite --record-path '/tmp/log'\r\n[Msg] Log path already exists on disk! Existing files will be overwritten.\r\n[Msg] Removing existing path [/tmp/log]\r\n...\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n...\r\n[Msg] Compressed log file and resources to [/tmp/log.zip].\r\nRemoving recorded directory [/tmp/log].\r\n[Msg] Stopping recording\r\n```\r\n\r\n`--log-overwrite --log-compress`, `/tmp/log` does not exist, `/tmp/log.zip` exists:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-compress --log-overwrite --record-path '/tmp/log'\r\n[Wrn] [ign.cc:121] Compressed log path already exists on disk! Existing files will be overwritten.\r\n[Msg] Removing existing compressed file [/tmp/log.zip]\r\n...\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n...\r\n[Msg] Compressed log file and resources to [/tmp/log.zip].\r\nRemoving recorded directory [/tmp/log].\r\n[Msg] Stopping recording\r\n```\r\n\r\n`--log-overwrite` only, `/tmp/log.zip` exists, `/tmp/log` does not exist:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-overwrite --record-path '/tmp/log'\r\n[Msg] Removing existing compressed file [/tmp/log.zip]\r\n...\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n...\r\n[Msg] Stopping recording\r\n```\r\n\r\n`--log-compress` only, both `/tmp/log` and `/tmp/log.zip` already exist:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-compress --record-path '/tmp/log'\r\n[Wrn] [ign.cc:152] Log path already exists on disk! Recording instead to [/tmp/log(1)]\r\n[Wrn] [ign.cc:154] Compressed log path already exists on disk! Recording instead to [/tmp/log(1).zip]\r\n...\r\n[Msg] Recording to log file [/tmp/log(1)/state.tlog]\r\n...\r\n[Msg] Compressed log file and resources to [/tmp/log(1).zip].\r\nRemoving recorded directory [/tmp/log(1)].\r\n[Msg] Stopping recording\r\n$ ls /tmp\r\nlog\r\n'log(1).zip'\r\nlog.zip\r\n```\r\n\r\n`--log-compress` only, `/tmp/log` does not exist, `/tmp/log.zip` exists, `/tmp/log(1).zip` exists:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-compress --record-path '/tmp/log'\r\n[Wrn] [ign.cc:152] Log path already exists on disk! Recording instead to [/tmp/log(2)]\r\n[Wrn] [ign.cc:154] Compressed log path already exists on disk! Recording instead to [/tmp/log(2).zip]\r\n...\r\n[Msg] Recording to log file [/tmp/log(2)/state.tlog]\r\n...\r\n[Msg] Compressed log file and resources to [/tmp/log(2).zip].\r\nRemoving recorded directory [/tmp/log(2)].\r\n[Msg] Stopping recording\r\n```\r\n\r\n## Record Path vs. Console Log Path\r\n\r\nIn Blueprint and Citadel, if `--record` is specified without `--record-path`, and `<path>` exists in SDF, a warning is printed, and recording will go to `<path>`, while console log will go to the default timestamp path.\r\n\r\nAs in this example:\r\n\r\n```\r\n# SDF specifies <path>/tmp/log</path>\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --record --log-compress -log-overwrite\r\n[Wrn] [ServerPrivate.cc:229] --record-path is not specified on command line. <path> is specified in SDF. Will record to <path>. Console will be logged to [/home/master/.ignition/gazebo/log/2019-09-20T19:51:33.996055619]. Note: In Ignition-D, <path> will be ignored, and all recordings will be written to default console log path if no path is specified on command line.\r\n[Msg] Overwriting existing file [/tmp/log/state.tlog]\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n...\r\n[Msg] Removing existing file [/tmp/log.zip].\r\n[Msg] Compressed log file and resources to [/tmp/log.zip].\r\nRemoving recorded directory [/tmp/log].\r\n```\r\n\r\nIn Ignition-D, `<path>` will be permanently ignored. Recordings and console log will go to same default path.\r\n\r\nIf `--record-path` is specified, then recording and console log will go to this path in Blueprint, Citadel, and Ignition-D.\r\n\r\n## Future Work\r\n\r\nFiles are outputted in `/tmp/log` and `/tmp/log.zip` in this example. During record, the original path in `file://` is prepended with the specified path, e.g. `/tmp/log`. During playback, the specified path is prepended to the URIs in the SDF.", "title": "[Blueprint] Logging meshes and materials", "destination": {"commit": {"hash": "90c40e37584b", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/commit/90c40e37584b.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/commits/90c40e37584b"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{f98d11fe-f287-4dfb-99c3-e2b76a13232e}ts=2082645"}}, "type": "repository", "name": "ign-gazebo", "full_name": "ignitionrobotics/ign-gazebo", "uuid": "{f98d11fe-f287-4dfb-99c3-e2b76a13232e}"}, "branch": {"name": "ign-gazebo2"}}, "reason": "", "source": {"commit": {"hash": "22c948264490", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/commit/22c948264490.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/commits/22c948264490"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{f98d11fe-f287-4dfb-99c3-e2b76a13232e}ts=2082645"}}, "type": "repository", "name": "ign-gazebo", "full_name": "ignitionrobotics/ign-gazebo", "uuid": "{f98d11fe-f287-4dfb-99c3-e2b76a13232e}"}, "branch": {"name": "log_resources"}}, "state": "OPEN", "author": {"display_name": "Mabel Zhang", "uuid": "{4b0e38fb-bf50-45c0-a496-61147518b2bf}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B4b0e38fb-bf50-45c0-a496-61147518b2bf%7D"}, "html": {"href": "https://bitbucket.org/%7B4b0e38fb-bf50-45c0-a496-61147518b2bf%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:ceb5942c-6843-408c-8550-3ce4899d299b/4d48e5ea-cf28-4fa7-9715-8fc9e315d831/128"}}, "nickname": "mabelmzhang", "type": "user", "account_id": "557058:ceb5942c-6843-408c-8550-3ce4899d299b"}, "date": "2020-03-19T05:54:04.675202+00:00"}, "pull_request": {"type": "pullrequest", "id": 397, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397"}}, "title": "[Blueprint] Logging meshes and materials"}}, {"update": {"description": "Depends on [ign-common PR 200](#!/ignitionrobotics/ign-common/pull-requests/200/log-resources/diff).\r\n\r\nPorts [this Gazebo PR](https://bitbucket.org/osrf/gazebo/pull-requests/2811/save-models-material-and-meshes-when/diff) to Ignition.\r\n\r\nImplements `--record-resources`, and `--log-compress` and `--log-overwrite` to support it.\r\n\r\nRecords resources \\(`--record-resources`\\), i.e. meshes and materials, to a directory under the specified log record directory. Optionally compresses \\(`--log-compress`\\) the whole directory, which contains the existing `.tlog` sqlite3 file and any resources, to a zip file. If directory or compressed file already exist, optionally overwrites \\(`--log-overwrite`\\).\r\n\r\nCorresponding SDF plugin parameters: `<record_resources>1</record_resources>`, `<compress>1</compress>.`If both command line and SDF parameters are specified, command line option overwrites SDF parameter. `--log-overwrite` is handled on command line only, outside of the plugin. If recording is only enabled from SDF and not from command line, then behavior is to always overwrite.\r\n\r\n## Usage:\r\n\r\n```\r\nign gazebo [...] --record-resources --log-overwrite --log-compress\r\n```\r\n\r\n## Test --record-resources:\r\n\r\n```\r\n# This SDF specifies the equivalent of --record-resources --record-path '/tmp/log'\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf\r\n$ ign gazebo -v 4 -r examples/worlds/log_playback.sdf\r\n```\r\n\r\nTested with `<include><uri>https://fuel...</uri></include>` and `<mesh><uri>file://...</uri></mesh>`. Paths specified by `model://` are not supported in Ignition yet, so this case in the code is not tested.\r\n\r\n## Test --log-overwrite and --log-compress:\r\n\r\nWhen recording to `path`, the compression file is implied to be `path.zip`. Both are checked for existence.\r\n\r\nNo `--log-overwrite` \\(default\\):\r\n\r\n```\r\n# This SDF specifies the equivalent of --record-path '/tmp/log'\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf\r\n\r\n# Run it again. By default it will always overwrite, because overwrite is now taken care of in ign.cc\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf\r\n[Msg] Overwriting existing file [/tmp/log/state.tlog]\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n```\r\n\r\n`--log-overwrite`, `/tmp/log` already exists:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-overwrite --record-path '/tmp/log'\r\n[Msg] Log path already exists on disk! Existing files will be overwritten.\r\n[Msg] Removing existing path [/tmp/log]\r\n...\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n...\r\n[Msg] Stopping recording\r\n```\r\n\r\n`--log-overwrite --log-compress`, `/tmp/log` exists, `/tmp/log.zip` does not exist:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-compress --log-overwrite --record-path '/tmp/log'\r\n[Msg] Log path already exists on disk! Existing files will be overwritten.\r\n[Msg] Removing existing path [/tmp/log]\r\n...\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n...\r\n[Msg] Compressed log file and resources to [/tmp/log.zip].\r\nRemoving recorded directory [/tmp/log].\r\n[Msg] Stopping recording\r\n```\r\n\r\n`--log-overwrite --log-compress`, `/tmp/log` does not exist, `/tmp/log.zip` exists:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-compress --log-overwrite --record-path '/tmp/log'\r\n[Wrn] [ign.cc:121] Compressed log path already exists on disk! Existing files will be overwritten.\r\n[Msg] Removing existing compressed file [/tmp/log.zip]\r\n...\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n...\r\n[Msg] Compressed log file and resources to [/tmp/log.zip].\r\nRemoving recorded directory [/tmp/log].\r\n[Msg] Stopping recording\r\n```\r\n\r\n`--log-overwrite` only, `/tmp/log.zip` exists, `/tmp/log` does not exist:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-overwrite --record-path '/tmp/log'\r\n[Msg] Removing existing compressed file [/tmp/log.zip]\r\n...\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n...\r\n[Msg] Stopping recording\r\n```\r\n\r\n`--log-compress` only, both `/tmp/log` and `/tmp/log.zip` already exist:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-compress --record-path '/tmp/log'\r\n[Wrn] [ign.cc:152] Log path already exists on disk! Recording instead to [/tmp/log(1)]\r\n[Wrn] [ign.cc:154] Compressed log path already exists on disk! Recording instead to [/tmp/log(1).zip]\r\n...\r\n[Msg] Recording to log file [/tmp/log(1)/state.tlog]\r\n...\r\n[Msg] Compressed log file and resources to [/tmp/log(1).zip].\r\nRemoving recorded directory [/tmp/log(1)].\r\n[Msg] Stopping recording\r\n$ ls /tmp\r\nlog\r\n'log(1).zip'\r\nlog.zip\r\n```\r\n\r\n`--log-compress` only, `/tmp/log` does not exist, `/tmp/log.zip` exists, `/tmp/log(1).zip` exists:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-compress --record-path '/tmp/log'\r\n[Wrn] [ign.cc:152] Log path already exists on disk! Recording instead to [/tmp/log(2)]\r\n[Wrn] [ign.cc:154] Compressed log path already exists on disk! Recording instead to [/tmp/log(2).zip]\r\n...\r\n[Msg] Recording to log file [/tmp/log(2)/state.tlog]\r\n...\r\n[Msg] Compressed log file and resources to [/tmp/log(2).zip].\r\nRemoving recorded directory [/tmp/log(2)].\r\n[Msg] Stopping recording\r\n```\r\n\r\n## Record Path vs. Console Log Path\r\n\r\nIn Blueprint and Citadel, if `--record` is specified without `--record-path`, and `<path>` exists in SDF, a warning is printed, and recording will go to `<path>`, while console log will go to the default timestamp path.\r\n\r\nAs in this example:\r\n\r\n```\r\n# SDF specifies <path>/tmp/log</path>\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --record --log-compress -log-overwrite\r\n[Wrn] [ServerPrivate.cc:229] --record-path is not specified on command line. <path> is specified in SDF. Will record to <path>. Console will be logged to [/home/master/.ignition/gazebo/log/2019-09-20T19:51:33.996055619]. Note: In Ignition-D, <path> will be ignored, and all recordings will be written to default console log path if no path is specified on command line.\r\n[Msg] Overwriting existing file [/tmp/log/state.tlog]\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n...\r\n[Msg] Removing existing file [/tmp/log.zip].\r\n[Msg] Compressed log file and resources to [/tmp/log.zip].\r\nRemoving recorded directory [/tmp/log].\r\n```\r\n\r\nIn Ignition-D, `<path>` will be permanently ignored. Recordings and console log will go to same default path.\r\n\r\nIf `--record-path` is specified, then recording and console log will go to this path in Blueprint, Citadel, and Ignition-D.\r\n\r\n## Future Work\r\n\r\nFiles are outputted in `/tmp/log` and `/tmp/log.zip` in this example. During record, the original path in `file://` is prepended with the specified path, e.g. `/tmp/log`. During playback, the specified path is prepended to the URIs in the SDF.", "title": "[Blueprint] Logging meshes and materials", "destination": {"commit": {"hash": "ad8a6ce72565", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/commit/ad8a6ce72565.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/commits/ad8a6ce72565"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{f98d11fe-f287-4dfb-99c3-e2b76a13232e}ts=2082645"}}, "type": "repository", "name": "ign-gazebo", "full_name": "ignitionrobotics/ign-gazebo", "uuid": "{f98d11fe-f287-4dfb-99c3-e2b76a13232e}"}, "branch": {"name": "ign-gazebo2"}}, "reason": "", "source": {"commit": {"hash": "acf824316220", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/commit/acf824316220.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/commits/acf824316220"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{f98d11fe-f287-4dfb-99c3-e2b76a13232e}ts=2082645"}}, "type": "repository", "name": "ign-gazebo", "full_name": "ignitionrobotics/ign-gazebo", "uuid": "{f98d11fe-f287-4dfb-99c3-e2b76a13232e}"}, "branch": {"name": "log_resources"}}, "state": "OPEN", "author": {"display_name": "Mabel Zhang", "uuid": "{4b0e38fb-bf50-45c0-a496-61147518b2bf}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B4b0e38fb-bf50-45c0-a496-61147518b2bf%7D"}, "html": {"href": "https://bitbucket.org/%7B4b0e38fb-bf50-45c0-a496-61147518b2bf%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:ceb5942c-6843-408c-8550-3ce4899d299b/4d48e5ea-cf28-4fa7-9715-8fc9e315d831/128"}}, "nickname": "mabelmzhang", "type": "user", "account_id": "557058:ceb5942c-6843-408c-8550-3ce4899d299b"}, "date": "2020-03-14T03:37:39.868815+00:00"}, "pull_request": {"type": "pullrequest", "id": 397, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397"}}, "title": "[Blueprint] Logging meshes and materials"}}, {"comment": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397/comments/139481710.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397/_/diff#comment-139481710"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 397, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397"}}, "title": "[Blueprint] Logging meshes and materials"}, "content": {"raw": "Per our f2f, I've added the component `SourceFilePath` in 92516a8. Model entities now have this component set to the entity's SDFormat file path.", "markup": "markdown", "html": "<p>Per our f2f, I've added the component <code>SourceFilePath</code> in <a href=\"#!/ignitionrobotics/ign-gazebo/commits/92516a8\" rel=\"nofollow\" class=\"ap-connect-link\">92516a8</a>. Model entities now have this component set to the entity's SDFormat file path.</p>", "type": "rendered"}, "created_on": "2020-03-10T17:10:57.191745+00:00", "user": {"display_name": "Addisu Z. Taddese", "uuid": "{9d7fdc68-d270-4080-bf03-4df0d0dbf635}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B9d7fdc68-d270-4080-bf03-4df0d0dbf635%7D"}, "html": {"href": "https://bitbucket.org/%7B9d7fdc68-d270-4080-bf03-4df0d0dbf635%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:90bc87b0-2886-4377-a17c-3a6629a697ff/afbf9be5-1e4c-4810-89d4-e58831f34b11/128"}}, "nickname": "azeey", "type": "user", "account_id": "557058:90bc87b0-2886-4377-a17c-3a6629a697ff"}, "updated_on": "2020-03-10T17:10:57.200594+00:00", "type": "pullrequest_comment", "id": 139481710}, "pull_request": {"type": "pullrequest", "id": 397, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397"}}, "title": "[Blueprint] Logging meshes and materials"}}, {"update": {"description": "Depends on [ign-common PR 200](#!/ignitionrobotics/ign-common/pull-requests/200/log-resources/diff).\r\n\r\nPorts [this Gazebo PR](https://bitbucket.org/osrf/gazebo/pull-requests/2811/save-models-material-and-meshes-when/diff) to Ignition.\r\n\r\nImplements `--record-resources`, and `--log-compress` and `--log-overwrite` to support it.\r\n\r\nRecords resources \\(`--record-resources`\\), i.e. meshes and materials, to a directory under the specified log record directory. Optionally compresses \\(`--log-compress`\\) the whole directory, which contains the existing `.tlog` sqlite3 file and any resources, to a zip file. If directory or compressed file already exist, optionally overwrites \\(`--log-overwrite`\\).\r\n\r\nCorresponding SDF plugin parameters: `<record_resources>1</record_resources>`, `<compress>1</compress>.`If both command line and SDF parameters are specified, command line option overwrites SDF parameter. `--log-overwrite` is handled on command line only, outside of the plugin. If recording is only enabled from SDF and not from command line, then behavior is to always overwrite.\r\n\r\n## Usage:\r\n\r\n```\r\nign gazebo [...] --record-resources --log-overwrite --log-compress\r\n```\r\n\r\n## Test --record-resources:\r\n\r\n```\r\n# This SDF specifies the equivalent of --record-resources --record-path '/tmp/log'\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf\r\n$ ign gazebo -v 4 -r examples/worlds/log_playback.sdf\r\n```\r\n\r\nTested with `<include><uri>https://fuel...</uri></include>` and `<mesh><uri>file://...</uri></mesh>`. Paths specified by `model://` are not supported in Ignition yet, so this case in the code is not tested.\r\n\r\n## Test --log-overwrite and --log-compress:\r\n\r\nWhen recording to `path`, the compression file is implied to be `path.zip`. Both are checked for existence.\r\n\r\nNo `--log-overwrite` \\(default\\):\r\n\r\n```\r\n# This SDF specifies the equivalent of --record-path '/tmp/log'\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf\r\n\r\n# Run it again. By default it will always overwrite, because overwrite is now taken care of in ign.cc\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf\r\n[Msg] Overwriting existing file [/tmp/log/state.tlog]\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n```\r\n\r\n`--log-overwrite`, `/tmp/log` already exists:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-overwrite --record-path '/tmp/log'\r\n[Msg] Log path already exists on disk! Existing files will be overwritten.\r\n[Msg] Removing existing path [/tmp/log]\r\n...\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n...\r\n[Msg] Stopping recording\r\n```\r\n\r\n`--log-overwrite --log-compress`, `/tmp/log` exists, `/tmp/log.zip` does not exist:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-compress --log-overwrite --record-path '/tmp/log'\r\n[Msg] Log path already exists on disk! Existing files will be overwritten.\r\n[Msg] Removing existing path [/tmp/log]\r\n...\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n...\r\n[Msg] Compressed log file and resources to [/tmp/log.zip].\r\nRemoving recorded directory [/tmp/log].\r\n[Msg] Stopping recording\r\n```\r\n\r\n`--log-overwrite --log-compress`, `/tmp/log` does not exist, `/tmp/log.zip` exists:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-compress --log-overwrite --record-path '/tmp/log'\r\n[Wrn] [ign.cc:121] Compressed log path already exists on disk! Existing files will be overwritten.\r\n[Msg] Removing existing compressed file [/tmp/log.zip]\r\n...\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n...\r\n[Msg] Compressed log file and resources to [/tmp/log.zip].\r\nRemoving recorded directory [/tmp/log].\r\n[Msg] Stopping recording\r\n```\r\n\r\n`--log-overwrite` only, `/tmp/log.zip` exists, `/tmp/log` does not exist:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-overwrite --record-path '/tmp/log'\r\n[Msg] Removing existing compressed file [/tmp/log.zip]\r\n...\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n...\r\n[Msg] Stopping recording\r\n```\r\n\r\n`--log-compress` only, both `/tmp/log` and `/tmp/log.zip` already exist:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-compress --record-path '/tmp/log'\r\n[Wrn] [ign.cc:152] Log path already exists on disk! Recording instead to [/tmp/log(1)]\r\n[Wrn] [ign.cc:154] Compressed log path already exists on disk! Recording instead to [/tmp/log(1).zip]\r\n...\r\n[Msg] Recording to log file [/tmp/log(1)/state.tlog]\r\n...\r\n[Msg] Compressed log file and resources to [/tmp/log(1).zip].\r\nRemoving recorded directory [/tmp/log(1)].\r\n[Msg] Stopping recording\r\n$ ls /tmp\r\nlog\r\n'log(1).zip'\r\nlog.zip\r\n```\r\n\r\n`--log-compress` only, `/tmp/log` does not exist, `/tmp/log.zip` exists, `/tmp/log(1).zip` exists:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-compress --record-path '/tmp/log'\r\n[Wrn] [ign.cc:152] Log path already exists on disk! Recording instead to [/tmp/log(2)]\r\n[Wrn] [ign.cc:154] Compressed log path already exists on disk! Recording instead to [/tmp/log(2).zip]\r\n...\r\n[Msg] Recording to log file [/tmp/log(2)/state.tlog]\r\n...\r\n[Msg] Compressed log file and resources to [/tmp/log(2).zip].\r\nRemoving recorded directory [/tmp/log(2)].\r\n[Msg] Stopping recording\r\n```\r\n\r\n## Record Path vs. Console Log Path\r\n\r\nIn Blueprint and Citadel, if `--record` is specified without `--record-path`, and `<path>` exists in SDF, a warning is printed, and recording will go to `<path>`, while console log will go to the default timestamp path.\r\n\r\nAs in this example:\r\n\r\n```\r\n# SDF specifies <path>/tmp/log</path>\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --record --log-compress -log-overwrite\r\n[Wrn] [ServerPrivate.cc:229] --record-path is not specified on command line. <path> is specified in SDF. Will record to <path>. Console will be logged to [/home/master/.ignition/gazebo/log/2019-09-20T19:51:33.996055619]. Note: In Ignition-D, <path> will be ignored, and all recordings will be written to default console log path if no path is specified on command line.\r\n[Msg] Overwriting existing file [/tmp/log/state.tlog]\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n...\r\n[Msg] Removing existing file [/tmp/log.zip].\r\n[Msg] Compressed log file and resources to [/tmp/log.zip].\r\nRemoving recorded directory [/tmp/log].\r\n```\r\n\r\nIn Ignition-D, `<path>` will be permanently ignored. Recordings and console log will go to same default path.\r\n\r\nIf `--record-path` is specified, then recording and console log will go to this path in Blueprint, Citadel, and Ignition-D.\r\n\r\n## Future Work\r\n\r\nFiles are outputted in `/tmp/log` and `/tmp/log.zip` in this example. During record, the original path in `file://` is prepended with the specified path, e.g. `/tmp/log`. During playback, the specified path is prepended to the URIs in the SDF.", "title": "[Blueprint] Logging meshes and materials", "destination": {"commit": {"hash": "543c4e90ec47", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/commit/543c4e90ec47.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/commits/543c4e90ec47"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{f98d11fe-f287-4dfb-99c3-e2b76a13232e}ts=2082645"}}, "type": "repository", "name": "ign-gazebo", "full_name": "ignitionrobotics/ign-gazebo", "uuid": "{f98d11fe-f287-4dfb-99c3-e2b76a13232e}"}, "branch": {"name": "ign-gazebo2"}}, "reason": "", "source": {"commit": {"hash": "92516a80b90a", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/commit/92516a80b90a.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/commits/92516a80b90a"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{f98d11fe-f287-4dfb-99c3-e2b76a13232e}ts=2082645"}}, "type": "repository", "name": "ign-gazebo", "full_name": "ignitionrobotics/ign-gazebo", "uuid": "{f98d11fe-f287-4dfb-99c3-e2b76a13232e}"}, "branch": {"name": "log_resources"}}, "state": "OPEN", "author": {"display_name": "Addisu Z. Taddese", "uuid": "{9d7fdc68-d270-4080-bf03-4df0d0dbf635}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B9d7fdc68-d270-4080-bf03-4df0d0dbf635%7D"}, "html": {"href": "https://bitbucket.org/%7B9d7fdc68-d270-4080-bf03-4df0d0dbf635%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:90bc87b0-2886-4377-a17c-3a6629a697ff/afbf9be5-1e4c-4810-89d4-e58831f34b11/128"}}, "nickname": "azeey", "type": "user", "account_id": "557058:90bc87b0-2886-4377-a17c-3a6629a697ff"}, "date": "2020-03-10T17:08:02.408608+00:00"}, "pull_request": {"type": "pullrequest", "id": 397, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397"}}, "title": "[Blueprint] Logging meshes and materials"}}, {"comment": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397/comments/139328806.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397/_/diff#comment-139328806"}}, "parent": {"id": 138900138, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397/comments/138900138.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397/_/diff#comment-138900138"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 397, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397"}}, "title": "[Blueprint] Logging meshes and materials"}, "content": {"raw": "b7f4172", "markup": "markdown", "html": "<p><a href=\"#!/ignitionrobotics/ign-gazebo/commits/b7f4172\" rel=\"nofollow\" class=\"ap-connect-link\">b7f4172</a></p>", "type": "rendered"}, "created_on": "2020-03-10T01:19:55.460950+00:00", "user": {"display_name": "Mabel Zhang", "uuid": "{4b0e38fb-bf50-45c0-a496-61147518b2bf}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B4b0e38fb-bf50-45c0-a496-61147518b2bf%7D"}, "html": {"href": "https://bitbucket.org/%7B4b0e38fb-bf50-45c0-a496-61147518b2bf%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:ceb5942c-6843-408c-8550-3ce4899d299b/4d48e5ea-cf28-4fa7-9715-8fc9e315d831/128"}}, "nickname": "mabelmzhang", "type": "user", "account_id": "557058:ceb5942c-6843-408c-8550-3ce4899d299b"}, "inline": {}, "updated_on": "2020-03-10T01:19:55.468108+00:00", "type": "pullrequest_comment", "id": 139328806}, "pull_request": {"type": "pullrequest", "id": 397, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397"}}, "title": "[Blueprint] Logging meshes and materials"}}, {"comment": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397/comments/139328805.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397/_/diff#comment-139328805"}}, "parent": {"id": 138900549, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397/comments/138900549.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397/_/diff#comment-138900549"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 397, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397"}}, "title": "[Blueprint] Logging meshes and materials"}, "content": {"raw": "b7f4172", "markup": "markdown", "html": "<p><a href=\"#!/ignitionrobotics/ign-gazebo/commits/b7f4172\" rel=\"nofollow\" class=\"ap-connect-link\">b7f4172</a></p>", "type": "rendered"}, "created_on": "2020-03-10T01:19:51.040859+00:00", "user": {"display_name": "Mabel Zhang", "uuid": "{4b0e38fb-bf50-45c0-a496-61147518b2bf}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B4b0e38fb-bf50-45c0-a496-61147518b2bf%7D"}, "html": {"href": "https://bitbucket.org/%7B4b0e38fb-bf50-45c0-a496-61147518b2bf%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:ceb5942c-6843-408c-8550-3ce4899d299b/4d48e5ea-cf28-4fa7-9715-8fc9e315d831/128"}}, "nickname": "mabelmzhang", "type": "user", "account_id": "557058:ceb5942c-6843-408c-8550-3ce4899d299b"}, "inline": {}, "updated_on": "2020-03-10T01:19:51.048340+00:00", "type": "pullrequest_comment", "id": 139328805}, "pull_request": {"type": "pullrequest", "id": 397, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397"}}, "title": "[Blueprint] Logging meshes and materials"}}, {"update": {"description": "Depends on [ign-common PR 200](#!/ignitionrobotics/ign-common/pull-requests/200/log-resources/diff).\r\n\r\nPorts [this Gazebo PR](https://bitbucket.org/osrf/gazebo/pull-requests/2811/save-models-material-and-meshes-when/diff) to Ignition.\r\n\r\nImplements `--record-resources`, and `--log-compress` and `--log-overwrite` to support it.\r\n\r\nRecords resources \\(`--record-resources`\\), i.e. meshes and materials, to a directory under the specified log record directory. Optionally compresses \\(`--log-compress`\\) the whole directory, which contains the existing `.tlog` sqlite3 file and any resources, to a zip file. If directory or compressed file already exist, optionally overwrites \\(`--log-overwrite`\\).\r\n\r\nCorresponding SDF plugin parameters: `<record_resources>1</record_resources>`, `<compress>1</compress>.`If both command line and SDF parameters are specified, command line option overwrites SDF parameter. `--log-overwrite` is handled on command line only, outside of the plugin. If recording is only enabled from SDF and not from command line, then behavior is to always overwrite.\r\n\r\n## Usage:\r\n\r\n```\r\nign gazebo [...] --record-resources --log-overwrite --log-compress\r\n```\r\n\r\n## Test --record-resources:\r\n\r\n```\r\n# This SDF specifies the equivalent of --record-resources --record-path '/tmp/log'\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf\r\n$ ign gazebo -v 4 -r examples/worlds/log_playback.sdf\r\n```\r\n\r\nTested with `<include><uri>https://fuel...</uri></include>` and `<mesh><uri>file://...</uri></mesh>`. Paths specified by `model://` are not supported in Ignition yet, so this case in the code is not tested.\r\n\r\n## Test --log-overwrite and --log-compress:\r\n\r\nWhen recording to `path`, the compression file is implied to be `path.zip`. Both are checked for existence.\r\n\r\nNo `--log-overwrite` \\(default\\):\r\n\r\n```\r\n# This SDF specifies the equivalent of --record-path '/tmp/log'\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf\r\n\r\n# Run it again. By default it will always overwrite, because overwrite is now taken care of in ign.cc\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf\r\n[Msg] Overwriting existing file [/tmp/log/state.tlog]\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n```\r\n\r\n`--log-overwrite`, `/tmp/log` already exists:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-overwrite --record-path '/tmp/log'\r\n[Msg] Log path already exists on disk! Existing files will be overwritten.\r\n[Msg] Removing existing path [/tmp/log]\r\n...\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n...\r\n[Msg] Stopping recording\r\n```\r\n\r\n`--log-overwrite --log-compress`, `/tmp/log` exists, `/tmp/log.zip` does not exist:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-compress --log-overwrite --record-path '/tmp/log'\r\n[Msg] Log path already exists on disk! Existing files will be overwritten.\r\n[Msg] Removing existing path [/tmp/log]\r\n...\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n...\r\n[Msg] Compressed log file and resources to [/tmp/log.zip].\r\nRemoving recorded directory [/tmp/log].\r\n[Msg] Stopping recording\r\n```\r\n\r\n`--log-overwrite --log-compress`, `/tmp/log` does not exist, `/tmp/log.zip` exists:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-compress --log-overwrite --record-path '/tmp/log'\r\n[Wrn] [ign.cc:121] Compressed log path already exists on disk! Existing files will be overwritten.\r\n[Msg] Removing existing compressed file [/tmp/log.zip]\r\n...\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n...\r\n[Msg] Compressed log file and resources to [/tmp/log.zip].\r\nRemoving recorded directory [/tmp/log].\r\n[Msg] Stopping recording\r\n```\r\n\r\n`--log-overwrite` only, `/tmp/log.zip` exists, `/tmp/log` does not exist:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-overwrite --record-path '/tmp/log'\r\n[Msg] Removing existing compressed file [/tmp/log.zip]\r\n...\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n...\r\n[Msg] Stopping recording\r\n```\r\n\r\n`--log-compress` only, both `/tmp/log` and `/tmp/log.zip` already exist:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-compress --record-path '/tmp/log'\r\n[Wrn] [ign.cc:152] Log path already exists on disk! Recording instead to [/tmp/log(1)]\r\n[Wrn] [ign.cc:154] Compressed log path already exists on disk! Recording instead to [/tmp/log(1).zip]\r\n...\r\n[Msg] Recording to log file [/tmp/log(1)/state.tlog]\r\n...\r\n[Msg] Compressed log file and resources to [/tmp/log(1).zip].\r\nRemoving recorded directory [/tmp/log(1)].\r\n[Msg] Stopping recording\r\n$ ls /tmp\r\nlog\r\n'log(1).zip'\r\nlog.zip\r\n```\r\n\r\n`--log-compress` only, `/tmp/log` does not exist, `/tmp/log.zip` exists, `/tmp/log(1).zip` exists:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-compress --record-path '/tmp/log'\r\n[Wrn] [ign.cc:152] Log path already exists on disk! Recording instead to [/tmp/log(2)]\r\n[Wrn] [ign.cc:154] Compressed log path already exists on disk! Recording instead to [/tmp/log(2).zip]\r\n...\r\n[Msg] Recording to log file [/tmp/log(2)/state.tlog]\r\n...\r\n[Msg] Compressed log file and resources to [/tmp/log(2).zip].\r\nRemoving recorded directory [/tmp/log(2)].\r\n[Msg] Stopping recording\r\n```\r\n\r\n## Record Path vs. Console Log Path\r\n\r\nIn Blueprint and Citadel, if `--record` is specified without `--record-path`, and `<path>` exists in SDF, a warning is printed, and recording will go to `<path>`, while console log will go to the default timestamp path.\r\n\r\nAs in this example:\r\n\r\n```\r\n# SDF specifies <path>/tmp/log</path>\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --record --log-compress -log-overwrite\r\n[Wrn] [ServerPrivate.cc:229] --record-path is not specified on command line. <path> is specified in SDF. Will record to <path>. Console will be logged to [/home/master/.ignition/gazebo/log/2019-09-20T19:51:33.996055619]. Note: In Ignition-D, <path> will be ignored, and all recordings will be written to default console log path if no path is specified on command line.\r\n[Msg] Overwriting existing file [/tmp/log/state.tlog]\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n...\r\n[Msg] Removing existing file [/tmp/log.zip].\r\n[Msg] Compressed log file and resources to [/tmp/log.zip].\r\nRemoving recorded directory [/tmp/log].\r\n```\r\n\r\nIn Ignition-D, `<path>` will be permanently ignored. Recordings and console log will go to same default path.\r\n\r\nIf `--record-path` is specified, then recording and console log will go to this path in Blueprint, Citadel, and Ignition-D.\r\n\r\n## Future Work\r\n\r\nFiles are outputted in `/tmp/log` and `/tmp/log.zip` in this example. During record, the original path in `file://` is prepended with the specified path, e.g. `/tmp/log`. During playback, the specified path is prepended to the URIs in the SDF.", "title": "[Blueprint] Logging meshes and materials", "destination": {"commit": {"hash": "543c4e90ec47", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/commit/543c4e90ec47.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/commits/543c4e90ec47"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{f98d11fe-f287-4dfb-99c3-e2b76a13232e}ts=2082645"}}, "type": "repository", "name": "ign-gazebo", "full_name": "ignitionrobotics/ign-gazebo", "uuid": "{f98d11fe-f287-4dfb-99c3-e2b76a13232e}"}, "branch": {"name": "ign-gazebo2"}}, "reason": "", "source": {"commit": {"hash": "b7f4172b1877", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/commit/b7f4172b1877.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/commits/b7f4172b1877"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{f98d11fe-f287-4dfb-99c3-e2b76a13232e}ts=2082645"}}, "type": "repository", "name": "ign-gazebo", "full_name": "ignitionrobotics/ign-gazebo", "uuid": "{f98d11fe-f287-4dfb-99c3-e2b76a13232e}"}, "branch": {"name": "log_resources"}}, "state": "OPEN", "author": {"display_name": "Mabel Zhang", "uuid": "{4b0e38fb-bf50-45c0-a496-61147518b2bf}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B4b0e38fb-bf50-45c0-a496-61147518b2bf%7D"}, "html": {"href": "https://bitbucket.org/%7B4b0e38fb-bf50-45c0-a496-61147518b2bf%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:ceb5942c-6843-408c-8550-3ce4899d299b/4d48e5ea-cf28-4fa7-9715-8fc9e315d831/128"}}, "nickname": "mabelmzhang", "type": "user", "account_id": "557058:ceb5942c-6843-408c-8550-3ce4899d299b"}, "date": "2020-03-10T01:19:30.089267+00:00"}, "pull_request": {"type": "pullrequest", "id": 397, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397"}}, "title": "[Blueprint] Logging meshes and materials"}}, {"comment": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397/comments/138901411.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397/_/diff#comment-138901411"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 397, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397"}}, "title": "[Blueprint] Logging meshes and materials"}, "content": {"raw": "We need to find a better way of handling this, because there's nothing in Ignition that requires meshes to be under a `meshes` directory.", "markup": "markdown", "html": "<p>We need to find a better way of handling this, because there's nothing in Ignition that requires meshes to be under a <code>meshes</code> directory.</p>", "type": "rendered"}, "created_on": "2020-03-05T19:45:01.089606+00:00", "user": {"display_name": "Louise Poubel", "uuid": "{5cfa2075-477b-4ded-bdb9-8d2479544ec4}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D"}, "html": {"href": "https://bitbucket.org/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8/7d903d90-c5ea-4182-b7ef-0d467e9e1c74/128"}}, "nickname": "chapulina", "type": "user", "account_id": "557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8"}, "inline": {}, "updated_on": "2020-03-05T19:45:01.111656+00:00", "type": "pullrequest_comment", "id": 138901411}, "pull_request": {"type": "pullrequest", "id": 397, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397"}}, "title": "[Blueprint] Logging meshes and materials"}}, {"comment": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397/comments/138901122.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397/_/diff#comment-138901122"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 397, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397"}}, "title": "[Blueprint] Logging meshes and materials"}, "content": {"raw": "Is this correct? `GAZEBO_MODEL_PATH` is not supposed to work with Ignition.", "markup": "markdown", "html": "<p>Is this correct? <code>GAZEBO_MODEL_PATH</code> is not supposed to work with Ignition.</p>", "type": "rendered"}, "created_on": "2020-03-05T19:42:57.681280+00:00", "user": {"display_name": "Louise Poubel", "uuid": "{5cfa2075-477b-4ded-bdb9-8d2479544ec4}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D"}, "html": {"href": "https://bitbucket.org/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8/7d903d90-c5ea-4182-b7ef-0d467e9e1c74/128"}}, "nickname": "chapulina", "type": "user", "account_id": "557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8"}, "inline": {}, "updated_on": "2020-03-05T19:42:57.695493+00:00", "type": "pullrequest_comment", "id": 138901122}, "pull_request": {"type": "pullrequest", "id": 397, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397"}}, "title": "[Blueprint] Logging meshes and materials"}}, {"comment": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397/comments/138900549.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397/_/diff#comment-138900549"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 397, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397"}}, "title": "[Blueprint] Logging meshes and materials"}, "content": {"raw": "Missing `param[in]` for these 3 functions", "markup": "markdown", "html": "<p>Missing <code>param[in]</code> for these 3 functions</p>", "type": "rendered"}, "created_on": "2020-03-05T19:38:44.684600+00:00", "user": {"display_name": "Louise Poubel", "uuid": "{5cfa2075-477b-4ded-bdb9-8d2479544ec4}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D"}, "html": {"href": "https://bitbucket.org/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8/7d903d90-c5ea-4182-b7ef-0d467e9e1c74/128"}}, "nickname": "chapulina", "type": "user", "account_id": "557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8"}, "inline": {}, "updated_on": "2020-03-05T19:38:44.692972+00:00", "type": "pullrequest_comment", "id": 138900549}, "pull_request": {"type": "pullrequest", "id": 397, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397"}}, "title": "[Blueprint] Logging meshes and materials"}}, {"comment": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397/comments/138900138.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397/_/diff#comment-138900138"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 397, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397"}}, "title": "[Blueprint] Logging meshes and materials"}, "content": {"raw": "We should add a TODO to also handle actor skin and animation files when merging forward to Citadel.", "markup": "markdown", "html": "<p>We should add a TODO to also handle actor skin and animation files when merging forward to Citadel.</p>", "type": "rendered"}, "created_on": "2020-03-05T19:35:21.954879+00:00", "user": {"display_name": "Louise Poubel", "uuid": "{5cfa2075-477b-4ded-bdb9-8d2479544ec4}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D"}, "html": {"href": "https://bitbucket.org/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8/7d903d90-c5ea-4182-b7ef-0d467e9e1c74/128"}}, "nickname": "chapulina", "type": "user", "account_id": "557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8"}, "inline": {}, "updated_on": "2020-03-05T19:35:21.963655+00:00", "type": "pullrequest_comment", "id": 138900138}, "pull_request": {"type": "pullrequest", "id": 397, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397"}}, "title": "[Blueprint] Logging meshes and materials"}}, {"update": {"description": "Depends on [ign-common PR 200](#!/ignitionrobotics/ign-common/pull-requests/200/log-resources/diff).\r\n\r\nPorts [this Gazebo PR](https://bitbucket.org/osrf/gazebo/pull-requests/2811/save-models-material-and-meshes-when/diff) to Ignition.\r\n\r\nImplements `--record-resources`, and `--log-compress` and `--log-overwrite` to support it.\r\n\r\nRecords resources \\(`--record-resources`\\), i.e. meshes and materials, to a directory under the specified log record directory. Optionally compresses \\(`--log-compress`\\) the whole directory, which contains the existing `.tlog` sqlite3 file and any resources, to a zip file. If directory or compressed file already exist, optionally overwrites \\(`--log-overwrite`\\).\r\n\r\nCorresponding SDF plugin parameters: `<record_resources>1</record_resources>`, `<compress>1</compress>.`If both command line and SDF parameters are specified, command line option overwrites SDF parameter. `--log-overwrite` is handled on command line only, outside of the plugin. If recording is only enabled from SDF and not from command line, then behavior is to always overwrite.\r\n\r\n## Usage:\r\n\r\n```\r\nign gazebo [...] --record-resources --log-overwrite --log-compress\r\n```\r\n\r\n## Test --record-resources:\r\n\r\n```\r\n# This SDF specifies the equivalent of --record-resources --record-path '/tmp/log'\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf\r\n$ ign gazebo -v 4 -r examples/worlds/log_playback.sdf\r\n```\r\n\r\nTested with `<include><uri>https://fuel...</uri></include>` and `<mesh><uri>file://...</uri></mesh>`. Paths specified by `model://` are not supported in Ignition yet, so this case in the code is not tested.\r\n\r\n## Test --log-overwrite and --log-compress:\r\n\r\nWhen recording to `path`, the compression file is implied to be `path.zip`. Both are checked for existence.\r\n\r\nNo `--log-overwrite` \\(default\\):\r\n\r\n```\r\n# This SDF specifies the equivalent of --record-path '/tmp/log'\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf\r\n\r\n# Run it again. By default it will always overwrite, because overwrite is now taken care of in ign.cc\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf\r\n[Msg] Overwriting existing file [/tmp/log/state.tlog]\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n```\r\n\r\n`--log-overwrite`, `/tmp/log` already exists:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-overwrite --record-path '/tmp/log'\r\n[Msg] Log path already exists on disk! Existing files will be overwritten.\r\n[Msg] Removing existing path [/tmp/log]\r\n...\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n...\r\n[Msg] Stopping recording\r\n```\r\n\r\n`--log-overwrite --log-compress`, `/tmp/log` exists, `/tmp/log.zip` does not exist:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-compress --log-overwrite --record-path '/tmp/log'\r\n[Msg] Log path already exists on disk! Existing files will be overwritten.\r\n[Msg] Removing existing path [/tmp/log]\r\n...\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n...\r\n[Msg] Compressed log file and resources to [/tmp/log.zip].\r\nRemoving recorded directory [/tmp/log].\r\n[Msg] Stopping recording\r\n```\r\n\r\n`--log-overwrite --log-compress`, `/tmp/log` does not exist, `/tmp/log.zip` exists:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-compress --log-overwrite --record-path '/tmp/log'\r\n[Wrn] [ign.cc:121] Compressed log path already exists on disk! Existing files will be overwritten.\r\n[Msg] Removing existing compressed file [/tmp/log.zip]\r\n...\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n...\r\n[Msg] Compressed log file and resources to [/tmp/log.zip].\r\nRemoving recorded directory [/tmp/log].\r\n[Msg] Stopping recording\r\n```\r\n\r\n`--log-overwrite` only, `/tmp/log.zip` exists, `/tmp/log` does not exist:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-overwrite --record-path '/tmp/log'\r\n[Msg] Removing existing compressed file [/tmp/log.zip]\r\n...\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n...\r\n[Msg] Stopping recording\r\n```\r\n\r\n`--log-compress` only, both `/tmp/log` and `/tmp/log.zip` already exist:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-compress --record-path '/tmp/log'\r\n[Wrn] [ign.cc:152] Log path already exists on disk! Recording instead to [/tmp/log(1)]\r\n[Wrn] [ign.cc:154] Compressed log path already exists on disk! Recording instead to [/tmp/log(1).zip]\r\n...\r\n[Msg] Recording to log file [/tmp/log(1)/state.tlog]\r\n...\r\n[Msg] Compressed log file and resources to [/tmp/log(1).zip].\r\nRemoving recorded directory [/tmp/log(1)].\r\n[Msg] Stopping recording\r\n$ ls /tmp\r\nlog\r\n'log(1).zip'\r\nlog.zip\r\n```\r\n\r\n`--log-compress` only, `/tmp/log` does not exist, `/tmp/log.zip` exists, `/tmp/log(1).zip` exists:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-compress --record-path '/tmp/log'\r\n[Wrn] [ign.cc:152] Log path already exists on disk! Recording instead to [/tmp/log(2)]\r\n[Wrn] [ign.cc:154] Compressed log path already exists on disk! Recording instead to [/tmp/log(2).zip]\r\n...\r\n[Msg] Recording to log file [/tmp/log(2)/state.tlog]\r\n...\r\n[Msg] Compressed log file and resources to [/tmp/log(2).zip].\r\nRemoving recorded directory [/tmp/log(2)].\r\n[Msg] Stopping recording\r\n```\r\n\r\n## Record Path vs. Console Log Path\r\n\r\nIn Blueprint and Citadel, if `--record` is specified without `--record-path`, and `<path>` exists in SDF, a warning is printed, and recording will go to `<path>`, while console log will go to the default timestamp path.\r\n\r\nAs in this example:\r\n\r\n```\r\n# SDF specifies <path>/tmp/log</path>\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --record --log-compress -log-overwrite\r\n[Wrn] [ServerPrivate.cc:229] --record-path is not specified on command line. <path> is specified in SDF. Will record to <path>. Console will be logged to [/home/master/.ignition/gazebo/log/2019-09-20T19:51:33.996055619]. Note: In Ignition-D, <path> will be ignored, and all recordings will be written to default console log path if no path is specified on command line.\r\n[Msg] Overwriting existing file [/tmp/log/state.tlog]\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n...\r\n[Msg] Removing existing file [/tmp/log.zip].\r\n[Msg] Compressed log file and resources to [/tmp/log.zip].\r\nRemoving recorded directory [/tmp/log].\r\n```\r\n\r\nIn Ignition-D, `<path>` will be permanently ignored. Recordings and console log will go to same default path.\r\n\r\nIf `--record-path` is specified, then recording and console log will go to this path in Blueprint, Citadel, and Ignition-D.\r\n\r\n## Future Work\r\n\r\nFiles are outputted in `/tmp/log` and `/tmp/log.zip` in this example. During record, the original path in `file://` is prepended with the specified path, e.g. `/tmp/log`. During playback, the specified path is prepended to the URIs in the SDF.", "title": "[Blueprint] Logging meshes and materials", "destination": {"commit": {"hash": "d68fec68079b", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/commit/d68fec68079b.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/commits/d68fec68079b"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{f98d11fe-f287-4dfb-99c3-e2b76a13232e}ts=2082645"}}, "type": "repository", "name": "ign-gazebo", "full_name": "ignitionrobotics/ign-gazebo", "uuid": "{f98d11fe-f287-4dfb-99c3-e2b76a13232e}"}, "branch": {"name": "ign-gazebo2"}}, "reason": "", "source": {"commit": {"hash": "b0e794bb639d", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/commit/b0e794bb639d.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/commits/b0e794bb639d"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{f98d11fe-f287-4dfb-99c3-e2b76a13232e}ts=2082645"}}, "type": "repository", "name": "ign-gazebo", "full_name": "ignitionrobotics/ign-gazebo", "uuid": "{f98d11fe-f287-4dfb-99c3-e2b76a13232e}"}, "branch": {"name": "log_resources"}}, "state": "OPEN", "author": {"display_name": "Mabel Zhang", "uuid": "{4b0e38fb-bf50-45c0-a496-61147518b2bf}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B4b0e38fb-bf50-45c0-a496-61147518b2bf%7D"}, "html": {"href": "https://bitbucket.org/%7B4b0e38fb-bf50-45c0-a496-61147518b2bf%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:ceb5942c-6843-408c-8550-3ce4899d299b/4d48e5ea-cf28-4fa7-9715-8fc9e315d831/128"}}, "nickname": "mabelmzhang", "type": "user", "account_id": "557058:ceb5942c-6843-408c-8550-3ce4899d299b"}, "date": "2020-03-05T02:17:37.737813+00:00"}, "pull_request": {"type": "pullrequest", "id": 397, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397"}}, "title": "[Blueprint] Logging meshes and materials"}}, {"update": {"description": "Depends on [ign-common PR 200](#!/ignitionrobotics/ign-common/pull-requests/200/log-resources/diff).\r\n\r\nPorts [this Gazebo PR](https://bitbucket.org/osrf/gazebo/pull-requests/2811/save-models-material-and-meshes-when/diff) to Ignition.\r\n\r\nImplements `--record-resources`, and `--log-compress` and `--log-overwrite` to support it.\r\n\r\nRecords resources \\(`--record-resources`\\), i.e. meshes and materials, to a directory under the specified log record directory. Optionally compresses \\(`--log-compress`\\) the whole directory, which contains the existing `.tlog` sqlite3 file and any resources, to a zip file. If directory or compressed file already exist, optionally overwrites \\(`--log-overwrite`\\).\r\n\r\nCorresponding SDF plugin parameters: `<record_resources>1</record_resources>`, `<compress>1</compress>.`If both command line and SDF parameters are specified, command line option overwrites SDF parameter. `--log-overwrite` is handled on command line only, outside of the plugin. If recording is only enabled from SDF and not from command line, then behavior is to always overwrite.\r\n\r\n## Usage:\r\n\r\n```\r\nign gazebo [...] --record-resources --log-overwrite --log-compress\r\n```\r\n\r\n## Test --record-resources:\r\n\r\n```\r\n# This SDF specifies the equivalent of --record-resources --record-path '/tmp/log'\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf\r\n$ ign gazebo -v 4 -r examples/worlds/log_playback.sdf\r\n```\r\n\r\nTested with `<include><uri>https://fuel...</uri></include>` and `<mesh><uri>file://...</uri></mesh>`. Paths specified by `model://` are not supported in Ignition yet, so this case in the code is not tested.\r\n\r\n## Test --log-overwrite and --log-compress:\r\n\r\nWhen recording to `path`, the compression file is implied to be `path.zip`. Both are checked for existence.\r\n\r\nNo `--log-overwrite` \\(default\\):\r\n\r\n```\r\n# This SDF specifies the equivalent of --record-path '/tmp/log'\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf\r\n\r\n# Run it again. By default it will always overwrite, because overwrite is now taken care of in ign.cc\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf\r\n[Msg] Overwriting existing file [/tmp/log/state.tlog]\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n```\r\n\r\n`--log-overwrite`, `/tmp/log` already exists:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-overwrite --record-path '/tmp/log'\r\n[Msg] Log path already exists on disk! Existing files will be overwritten.\r\n[Msg] Removing existing path [/tmp/log]\r\n...\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n...\r\n[Msg] Stopping recording\r\n```\r\n\r\n`--log-overwrite --log-compress`, `/tmp/log` exists, `/tmp/log.zip` does not exist:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-compress --log-overwrite --record-path '/tmp/log'\r\n[Msg] Log path already exists on disk! Existing files will be overwritten.\r\n[Msg] Removing existing path [/tmp/log]\r\n...\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n...\r\n[Msg] Compressed log file and resources to [/tmp/log.zip].\r\nRemoving recorded directory [/tmp/log].\r\n[Msg] Stopping recording\r\n```\r\n\r\n`--log-overwrite --log-compress`, `/tmp/log` does not exist, `/tmp/log.zip` exists:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-compress --log-overwrite --record-path '/tmp/log'\r\n[Wrn] [ign.cc:121] Compressed log path already exists on disk! Existing files will be overwritten.\r\n[Msg] Removing existing compressed file [/tmp/log.zip]\r\n...\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n...\r\n[Msg] Compressed log file and resources to [/tmp/log.zip].\r\nRemoving recorded directory [/tmp/log].\r\n[Msg] Stopping recording\r\n```\r\n\r\n`--log-overwrite` only, `/tmp/log.zip` exists, `/tmp/log` does not exist:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-overwrite --record-path '/tmp/log'\r\n[Msg] Removing existing compressed file [/tmp/log.zip]\r\n...\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n...\r\n[Msg] Stopping recording\r\n```\r\n\r\n`--log-compress` only, both `/tmp/log` and `/tmp/log.zip` already exist:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-compress --record-path '/tmp/log'\r\n[Wrn] [ign.cc:152] Log path already exists on disk! Recording instead to [/tmp/log(1)]\r\n[Wrn] [ign.cc:154] Compressed log path already exists on disk! Recording instead to [/tmp/log(1).zip]\r\n...\r\n[Msg] Recording to log file [/tmp/log(1)/state.tlog]\r\n...\r\n[Msg] Compressed log file and resources to [/tmp/log(1).zip].\r\nRemoving recorded directory [/tmp/log(1)].\r\n[Msg] Stopping recording\r\n$ ls /tmp\r\nlog\r\n'log(1).zip'\r\nlog.zip\r\n```\r\n\r\n`--log-compress` only, `/tmp/log` does not exist, `/tmp/log.zip` exists, `/tmp/log(1).zip` exists:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-compress --record-path '/tmp/log'\r\n[Wrn] [ign.cc:152] Log path already exists on disk! Recording instead to [/tmp/log(2)]\r\n[Wrn] [ign.cc:154] Compressed log path already exists on disk! Recording instead to [/tmp/log(2).zip]\r\n...\r\n[Msg] Recording to log file [/tmp/log(2)/state.tlog]\r\n...\r\n[Msg] Compressed log file and resources to [/tmp/log(2).zip].\r\nRemoving recorded directory [/tmp/log(2)].\r\n[Msg] Stopping recording\r\n```\r\n\r\n## Record Path vs. Console Log Path\r\n\r\nIn Blueprint and Citadel, if `--record` is specified without `--record-path`, and `<path>` exists in SDF, a warning is printed, and recording will go to `<path>`, while console log will go to the default timestamp path.\r\n\r\nAs in this example:\r\n\r\n```\r\n# SDF specifies <path>/tmp/log</path>\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --record --log-compress -log-overwrite\r\n[Wrn] [ServerPrivate.cc:229] --record-path is not specified on command line. <path> is specified in SDF. Will record to <path>. Console will be logged to [/home/master/.ignition/gazebo/log/2019-09-20T19:51:33.996055619]. Note: In Ignition-D, <path> will be ignored, and all recordings will be written to default console log path if no path is specified on command line.\r\n[Msg] Overwriting existing file [/tmp/log/state.tlog]\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n...\r\n[Msg] Removing existing file [/tmp/log.zip].\r\n[Msg] Compressed log file and resources to [/tmp/log.zip].\r\nRemoving recorded directory [/tmp/log].\r\n```\r\n\r\nIn Ignition-D, `<path>` will be permanently ignored. Recordings and console log will go to same default path.\r\n\r\nIf `--record-path` is specified, then recording and console log will go to this path in Blueprint, Citadel, and Ignition-D.\r\n\r\n## Future Work\r\n\r\nFiles are outputted in `/tmp/log` and `/tmp/log.zip` in this example. During record, the original path in `file://` is prepended with the specified path, e.g. `/tmp/log`. During playback, the specified path is prepended to the URIs in the SDF.", "title": "[Blueprint] Logging meshes and materials", "destination": {"commit": {"hash": "d68fec68079b", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/commit/d68fec68079b.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/commits/d68fec68079b"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{f98d11fe-f287-4dfb-99c3-e2b76a13232e}ts=2082645"}}, "type": "repository", "name": "ign-gazebo", "full_name": "ignitionrobotics/ign-gazebo", "uuid": "{f98d11fe-f287-4dfb-99c3-e2b76a13232e}"}, "branch": {"name": "ign-gazebo2"}}, "reason": "", "source": {"commit": {"hash": "5c9b456d48b2", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/commit/5c9b456d48b2.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/commits/5c9b456d48b2"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{f98d11fe-f287-4dfb-99c3-e2b76a13232e}ts=2082645"}}, "type": "repository", "name": "ign-gazebo", "full_name": "ignitionrobotics/ign-gazebo", "uuid": "{f98d11fe-f287-4dfb-99c3-e2b76a13232e}"}, "branch": {"name": "log_resources"}}, "state": "OPEN", "author": {"display_name": "Louise Poubel", "uuid": "{5cfa2075-477b-4ded-bdb9-8d2479544ec4}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D"}, "html": {"href": "https://bitbucket.org/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8/7d903d90-c5ea-4182-b7ef-0d467e9e1c74/128"}}, "nickname": "chapulina", "type": "user", "account_id": "557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8"}, "date": "2020-03-05T01:52:39.851033+00:00"}, "pull_request": {"type": "pullrequest", "id": 397, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397"}}, "title": "[Blueprint] Logging meshes and materials"}}, {"update": {"description": "Depends on [ign-common PR 200](#!/ignitionrobotics/ign-common/pull-requests/200/log-resources/diff).\r\n\r\nPorts [this Gazebo PR](https://bitbucket.org/osrf/gazebo/pull-requests/2811/save-models-material-and-meshes-when/diff) to Ignition.\r\n\r\nImplements `--record-resources`, and `--log-compress` and `--log-overwrite` to support it.\r\n\r\nRecords resources \\(`--record-resources`\\), i.e. meshes and materials, to a directory under the specified log record directory. Optionally compresses \\(`--log-compress`\\) the whole directory, which contains the existing `.tlog` sqlite3 file and any resources, to a zip file. If directory or compressed file already exist, optionally overwrites \\(`--log-overwrite`\\).\r\n\r\nCorresponding SDF plugin parameters: `<record_resources>1</record_resources>`, `<compress>1</compress>.`If both command line and SDF parameters are specified, command line option overwrites SDF parameter. `--log-overwrite` is handled on command line only, outside of the plugin. If recording is only enabled from SDF and not from command line, then behavior is to always overwrite.\r\n\r\n## Usage:\r\n\r\n```\r\nign gazebo [...] --record-resources --log-overwrite --log-compress\r\n```\r\n\r\n## Test --record-resources:\r\n\r\n```\r\n# This SDF specifies the equivalent of --record-resources --record-path '/tmp/log'\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf\r\n$ ign gazebo -v 4 -r examples/worlds/log_playback.sdf\r\n```\r\n\r\nTested with `<include><uri>https://fuel...</uri></include>` and `<mesh><uri>file://...</uri></mesh>`. Paths specified by `model://` are not supported in Ignition yet, so this case in the code is not tested.\r\n\r\n## Test --log-overwrite and --log-compress:\r\n\r\nWhen recording to `path`, the compression file is implied to be `path.zip`. Both are checked for existence.\r\n\r\nNo `--log-overwrite` \\(default\\):\r\n\r\n```\r\n# This SDF specifies the equivalent of --record-path '/tmp/log'\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf\r\n\r\n# Run it again. By default it will always overwrite, because overwrite is now taken care of in ign.cc\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf\r\n[Msg] Overwriting existing file [/tmp/log/state.tlog]\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n```\r\n\r\n`--log-overwrite`, `/tmp/log` already exists:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-overwrite --record-path '/tmp/log'\r\n[Msg] Log path already exists on disk! Existing files will be overwritten.\r\n[Msg] Removing existing path [/tmp/log]\r\n...\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n...\r\n[Msg] Stopping recording\r\n```\r\n\r\n`--log-overwrite --log-compress`, `/tmp/log` exists, `/tmp/log.zip` does not exist:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-compress --log-overwrite --record-path '/tmp/log'\r\n[Msg] Log path already exists on disk! Existing files will be overwritten.\r\n[Msg] Removing existing path [/tmp/log]\r\n...\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n...\r\n[Msg] Compressed log file and resources to [/tmp/log.zip].\r\nRemoving recorded directory [/tmp/log].\r\n[Msg] Stopping recording\r\n```\r\n\r\n`--log-overwrite --log-compress`, `/tmp/log` does not exist, `/tmp/log.zip` exists:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-compress --log-overwrite --record-path '/tmp/log'\r\n[Wrn] [ign.cc:121] Compressed log path already exists on disk! Existing files will be overwritten.\r\n[Msg] Removing existing compressed file [/tmp/log.zip]\r\n...\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n...\r\n[Msg] Compressed log file and resources to [/tmp/log.zip].\r\nRemoving recorded directory [/tmp/log].\r\n[Msg] Stopping recording\r\n```\r\n\r\n`--log-overwrite` only, `/tmp/log.zip` exists, `/tmp/log` does not exist:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-overwrite --record-path '/tmp/log'\r\n[Msg] Removing existing compressed file [/tmp/log.zip]\r\n...\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n...\r\n[Msg] Stopping recording\r\n```\r\n\r\n`--log-compress` only, both `/tmp/log` and `/tmp/log.zip` already exist:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-compress --record-path '/tmp/log'\r\n[Wrn] [ign.cc:152] Log path already exists on disk! Recording instead to [/tmp/log(1)]\r\n[Wrn] [ign.cc:154] Compressed log path already exists on disk! Recording instead to [/tmp/log(1).zip]\r\n...\r\n[Msg] Recording to log file [/tmp/log(1)/state.tlog]\r\n...\r\n[Msg] Compressed log file and resources to [/tmp/log(1).zip].\r\nRemoving recorded directory [/tmp/log(1)].\r\n[Msg] Stopping recording\r\n$ ls /tmp\r\nlog\r\n'log(1).zip'\r\nlog.zip\r\n```\r\n\r\n`--log-compress` only, `/tmp/log` does not exist, `/tmp/log.zip` exists, `/tmp/log(1).zip` exists:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-compress --record-path '/tmp/log'\r\n[Wrn] [ign.cc:152] Log path already exists on disk! Recording instead to [/tmp/log(2)]\r\n[Wrn] [ign.cc:154] Compressed log path already exists on disk! Recording instead to [/tmp/log(2).zip]\r\n...\r\n[Msg] Recording to log file [/tmp/log(2)/state.tlog]\r\n...\r\n[Msg] Compressed log file and resources to [/tmp/log(2).zip].\r\nRemoving recorded directory [/tmp/log(2)].\r\n[Msg] Stopping recording\r\n```\r\n\r\n## Record Path vs. Console Log Path\r\n\r\nIn Blueprint and Citadel, if `--record` is specified without `--record-path`, and `<path>` exists in SDF, a warning is printed, and recording will go to `<path>`, while console log will go to the default timestamp path.\r\n\r\nAs in this example:\r\n\r\n```\r\n# SDF specifies <path>/tmp/log</path>\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --record --log-compress -log-overwrite\r\n[Wrn] [ServerPrivate.cc:229] --record-path is not specified on command line. <path> is specified in SDF. Will record to <path>. Console will be logged to [/home/master/.ignition/gazebo/log/2019-09-20T19:51:33.996055619]. Note: In Ignition-D, <path> will be ignored, and all recordings will be written to default console log path if no path is specified on command line.\r\n[Msg] Overwriting existing file [/tmp/log/state.tlog]\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n...\r\n[Msg] Removing existing file [/tmp/log.zip].\r\n[Msg] Compressed log file and resources to [/tmp/log.zip].\r\nRemoving recorded directory [/tmp/log].\r\n```\r\n\r\nIn Ignition-D, `<path>` will be permanently ignored. Recordings and console log will go to same default path.\r\n\r\nIf `--record-path` is specified, then recording and console log will go to this path in Blueprint, Citadel, and Ignition-D.\r\n\r\n## Future Work\r\n\r\nFiles are outputted in `/tmp/log` and `/tmp/log.zip` in this example. During record, the original path in `file://` is prepended with the specified path, e.g. `/tmp/log`. During playback, the specified path is prepended to the URIs in the SDF.", "title": "[Blueprint] Logging meshes and materials", "destination": {"commit": {"hash": "d68fec68079b", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/commit/d68fec68079b.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/commits/d68fec68079b"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{f98d11fe-f287-4dfb-99c3-e2b76a13232e}ts=2082645"}}, "type": "repository", "name": "ign-gazebo", "full_name": "ignitionrobotics/ign-gazebo", "uuid": "{f98d11fe-f287-4dfb-99c3-e2b76a13232e}"}, "branch": {"name": "ign-gazebo2"}}, "reason": "", "source": {"commit": {"hash": "5c9b456d48b2", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/commit/5c9b456d48b2.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/commits/5c9b456d48b2"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{f98d11fe-f287-4dfb-99c3-e2b76a13232e}ts=2082645"}}, "type": "repository", "name": "ign-gazebo", "full_name": "ignitionrobotics/ign-gazebo", "uuid": "{f98d11fe-f287-4dfb-99c3-e2b76a13232e}"}, "branch": {"name": "log_resources"}}, "state": "OPEN", "author": {"display_name": "Louise Poubel", "uuid": "{5cfa2075-477b-4ded-bdb9-8d2479544ec4}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D"}, "html": {"href": "https://bitbucket.org/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8/7d903d90-c5ea-4182-b7ef-0d467e9e1c74/128"}}, "nickname": "chapulina", "type": "user", "account_id": "557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8"}, "date": "2020-03-05T01:52:39.793205+00:00"}, "pull_request": {"type": "pullrequest", "id": 397, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397"}}, "title": "[Blueprint] Logging meshes and materials"}}, {"update": {"description": "Depends on [ign-common PR 200](#!/ignitionrobotics/ign-common/pull-requests/200/log-resources/diff).\r\n\r\nPorts [this Gazebo PR](https://bitbucket.org/osrf/gazebo/pull-requests/2811/save-models-material-and-meshes-when/diff) to Ignition.\r\n\r\nImplements `--record-resources`, and `--log-compress` and `--log-overwrite` to support it.\r\n\r\nRecords resources \\(`--record-resources`\\), i.e. meshes and materials, to a directory under the specified log record directory. Optionally compresses \\(`--log-compress`\\) the whole directory, which contains the existing `.tlog` sqlite3 file and any resources, to a zip file. If directory or compressed file already exist, optionally overwrites \\(`--log-overwrite`\\).\r\n\r\nCorresponding SDF plugin parameters: `<record_resources>1</record_resources>`, `<compress>1</compress>.`If both command line and SDF parameters are specified, command line option overwrites SDF parameter. `--log-overwrite` is handled on command line only, outside of the plugin. If recording is only enabled from SDF and not from command line, then behavior is to always overwrite.\r\n\r\n## Usage:\r\n\r\n```\r\nign gazebo [...] --record-resources --log-overwrite --log-compress\r\n```\r\n\r\n## Test --record-resources:\r\n\r\n```\r\n# This SDF specifies the equivalent of --record-resources --record-path '/tmp/log'\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf\r\n$ ign gazebo -v 4 -r examples/worlds/log_playback.sdf\r\n```\r\n\r\nTested with `<include><uri>https://fuel...</uri></include>` and `<mesh><uri>file://...</uri></mesh>`. Paths specified by `model://` are not supported in Ignition yet, so this case in the code is not tested.\r\n\r\n## Test --log-overwrite and --log-compress:\r\n\r\nWhen recording to `path`, the compression file is implied to be `path.zip`. Both are checked for existence.\r\n\r\nNo `--log-overwrite` \\(default\\):\r\n\r\n```\r\n# This SDF specifies the equivalent of --record-path '/tmp/log'\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf\r\n\r\n# Run it again. By default it will always overwrite, because overwrite is now taken care of in ign.cc\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf\r\n[Msg] Overwriting existing file [/tmp/log/state.tlog]\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n```\r\n\r\n`--log-overwrite`, `/tmp/log` already exists:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-overwrite --record-path '/tmp/log'\r\n[Msg] Log path already exists on disk! Existing files will be overwritten.\r\n[Msg] Removing existing path [/tmp/log]\r\n...\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n...\r\n[Msg] Stopping recording\r\n```\r\n\r\n`--log-overwrite --log-compress`, `/tmp/log` exists, `/tmp/log.zip` does not exist:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-compress --log-overwrite --record-path '/tmp/log'\r\n[Msg] Log path already exists on disk! Existing files will be overwritten.\r\n[Msg] Removing existing path [/tmp/log]\r\n...\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n...\r\n[Msg] Compressed log file and resources to [/tmp/log.zip].\r\nRemoving recorded directory [/tmp/log].\r\n[Msg] Stopping recording\r\n```\r\n\r\n`--log-overwrite --log-compress`, `/tmp/log` does not exist, `/tmp/log.zip` exists:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-compress --log-overwrite --record-path '/tmp/log'\r\n[Wrn] [ign.cc:121] Compressed log path already exists on disk! Existing files will be overwritten.\r\n[Msg] Removing existing compressed file [/tmp/log.zip]\r\n...\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n...\r\n[Msg] Compressed log file and resources to [/tmp/log.zip].\r\nRemoving recorded directory [/tmp/log].\r\n[Msg] Stopping recording\r\n```\r\n\r\n`--log-overwrite` only, `/tmp/log.zip` exists, `/tmp/log` does not exist:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-overwrite --record-path '/tmp/log'\r\n[Msg] Removing existing compressed file [/tmp/log.zip]\r\n...\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n...\r\n[Msg] Stopping recording\r\n```\r\n\r\n`--log-compress` only, both `/tmp/log` and `/tmp/log.zip` already exist:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-compress --record-path '/tmp/log'\r\n[Wrn] [ign.cc:152] Log path already exists on disk! Recording instead to [/tmp/log(1)]\r\n[Wrn] [ign.cc:154] Compressed log path already exists on disk! Recording instead to [/tmp/log(1).zip]\r\n...\r\n[Msg] Recording to log file [/tmp/log(1)/state.tlog]\r\n...\r\n[Msg] Compressed log file and resources to [/tmp/log(1).zip].\r\nRemoving recorded directory [/tmp/log(1)].\r\n[Msg] Stopping recording\r\n$ ls /tmp\r\nlog\r\n'log(1).zip'\r\nlog.zip\r\n```\r\n\r\n`--log-compress` only, `/tmp/log` does not exist, `/tmp/log.zip` exists, `/tmp/log(1).zip` exists:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-compress --record-path '/tmp/log'\r\n[Wrn] [ign.cc:152] Log path already exists on disk! Recording instead to [/tmp/log(2)]\r\n[Wrn] [ign.cc:154] Compressed log path already exists on disk! Recording instead to [/tmp/log(2).zip]\r\n...\r\n[Msg] Recording to log file [/tmp/log(2)/state.tlog]\r\n...\r\n[Msg] Compressed log file and resources to [/tmp/log(2).zip].\r\nRemoving recorded directory [/tmp/log(2)].\r\n[Msg] Stopping recording\r\n```\r\n\r\n## Record Path vs. Console Log Path\r\n\r\nIn Blueprint and Citadel, if `--record` is specified without `--record-path`, and `<path>` exists in SDF, a warning is printed, and recording will go to `<path>`, while console log will go to the default timestamp path.\r\n\r\nAs in this example:\r\n\r\n```\r\n# SDF specifies <path>/tmp/log</path>\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --record --log-compress -log-overwrite\r\n[Wrn] [ServerPrivate.cc:229] --record-path is not specified on command line. <path> is specified in SDF. Will record to <path>. Console will be logged to [/home/master/.ignition/gazebo/log/2019-09-20T19:51:33.996055619]. Note: In Ignition-D, <path> will be ignored, and all recordings will be written to default console log path if no path is specified on command line.\r\n[Msg] Overwriting existing file [/tmp/log/state.tlog]\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n...\r\n[Msg] Removing existing file [/tmp/log.zip].\r\n[Msg] Compressed log file and resources to [/tmp/log.zip].\r\nRemoving recorded directory [/tmp/log].\r\n```\r\n\r\nIn Ignition-D, `<path>` will be permanently ignored. Recordings and console log will go to same default path.\r\n\r\nIf `--record-path` is specified, then recording and console log will go to this path in Blueprint, Citadel, and Ignition-D.\r\n\r\n## Future Work\r\n\r\nFiles are outputted in `/tmp/log` and `/tmp/log.zip` in this example. During record, the original path in `file://` is prepended with the specified path, e.g. `/tmp/log`. During playback, the specified path is prepended to the URIs in the SDF.", "title": "[Blueprint] Logging meshes and materials", "destination": {"commit": {"hash": "99cea19b6de4", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/commit/99cea19b6de4.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/commits/99cea19b6de4"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{f98d11fe-f287-4dfb-99c3-e2b76a13232e}ts=2082645"}}, "type": "repository", "name": "ign-gazebo", "full_name": "ignitionrobotics/ign-gazebo", "uuid": "{f98d11fe-f287-4dfb-99c3-e2b76a13232e}"}, "branch": {"name": "ign-gazebo2"}}, "reason": "", "source": {"commit": {"hash": "5c9b456d48b2", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/commit/5c9b456d48b2.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/commits/5c9b456d48b2"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{f98d11fe-f287-4dfb-99c3-e2b76a13232e}ts=2082645"}}, "type": "repository", "name": "ign-gazebo", "full_name": "ignitionrobotics/ign-gazebo", "uuid": "{f98d11fe-f287-4dfb-99c3-e2b76a13232e}"}, "branch": {"name": "log_resources"}}, "state": "OPEN", "author": {"display_name": "Mabel Zhang", "uuid": "{4b0e38fb-bf50-45c0-a496-61147518b2bf}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B4b0e38fb-bf50-45c0-a496-61147518b2bf%7D"}, "html": {"href": "https://bitbucket.org/%7B4b0e38fb-bf50-45c0-a496-61147518b2bf%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:ceb5942c-6843-408c-8550-3ce4899d299b/4d48e5ea-cf28-4fa7-9715-8fc9e315d831/128"}}, "nickname": "mabelmzhang", "type": "user", "account_id": "557058:ceb5942c-6843-408c-8550-3ce4899d299b"}, "date": "2020-02-28T23:51:53.960126+00:00"}, "pull_request": {"type": "pullrequest", "id": 397, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397"}}, "title": "[Blueprint] Logging meshes and materials"}}, {"update": {"description": "Depends on [ign-common PR 200](#!/ignitionrobotics/ign-common/pull-requests/200/log-resources/diff).\r\n\r\nPorts [this Gazebo PR](https://bitbucket.org/osrf/gazebo/pull-requests/2811/save-models-material-and-meshes-when/diff) to Ignition.\r\n\r\nImplements `--record-resources`, and `--log-compress` and `--log-overwrite` to support it.\r\n\r\nRecords resources \\(`--record-resources`\\), i.e. meshes and materials, to a directory under the specified log record directory. Optionally compresses \\(`--log-compress`\\) the whole directory, which contains the existing `.tlog` sqlite3 file and any resources, to a zip file. If directory or compressed file already exist, optionally overwrites \\(`--log-overwrite`\\).\r\n\r\nCorresponding SDF plugin parameters: `<record_resources>1</record_resources>`, `<compress>1</compress>.`If both command line and SDF parameters are specified, command line option overwrites SDF parameter. `--log-overwrite` is handled on command line only, outside of the plugin. If recording is only enabled from SDF and not from command line, then behavior is to always overwrite.\r\n\r\n## Usage:\r\n\r\n```\r\nign gazebo [...] --record-resources --log-overwrite --log-compress\r\n```\r\n\r\n## Test --record-resources:\r\n\r\n```\r\n# This SDF specifies the equivalent of --record-resources --record-path '/tmp/log'\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf\r\n$ ign gazebo -v 4 -r examples/worlds/log_playback.sdf\r\n```\r\n\r\nTested with `<include><uri>https://fuel...</uri></include>` and `<mesh><uri>file://...</uri></mesh>`. Paths specified by `model://` are not supported in Ignition yet, so this case in the code is not tested.\r\n\r\n## Test --log-overwrite and --log-compress:\r\n\r\nWhen recording to `path`, the compression file is implied to be `path.zip`. Both are checked for existence.\r\n\r\nNo `--log-overwrite` \\(default\\):\r\n\r\n```\r\n# This SDF specifies the equivalent of --record-path '/tmp/log'\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf\r\n\r\n# Run it again. By default it will always overwrite, because overwrite is now taken care of in ign.cc\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf\r\n[Msg] Overwriting existing file [/tmp/log/state.tlog]\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n```\r\n\r\n`--log-overwrite`, `/tmp/log` already exists:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-overwrite --record-path '/tmp/log'\r\n[Msg] Log path already exists on disk! Existing files will be overwritten.\r\n[Msg] Removing existing path [/tmp/log]\r\n...\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n...\r\n[Msg] Stopping recording\r\n```\r\n\r\n`--log-overwrite --log-compress`, `/tmp/log` exists, `/tmp/log.zip` does not exist:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-compress --log-overwrite --record-path '/tmp/log'\r\n[Msg] Log path already exists on disk! Existing files will be overwritten.\r\n[Msg] Removing existing path [/tmp/log]\r\n...\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n...\r\n[Msg] Compressed log file and resources to [/tmp/log.zip].\r\nRemoving recorded directory [/tmp/log].\r\n[Msg] Stopping recording\r\n```\r\n\r\n`--log-overwrite --log-compress`, `/tmp/log` does not exist, `/tmp/log.zip` exists:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-compress --log-overwrite --record-path '/tmp/log'\r\n[Wrn] [ign.cc:121] Compressed log path already exists on disk! Existing files will be overwritten.\r\n[Msg] Removing existing compressed file [/tmp/log.zip]\r\n...\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n...\r\n[Msg] Compressed log file and resources to [/tmp/log.zip].\r\nRemoving recorded directory [/tmp/log].\r\n[Msg] Stopping recording\r\n```\r\n\r\n`--log-overwrite` only, `/tmp/log.zip` exists, `/tmp/log` does not exist:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-overwrite --record-path '/tmp/log'\r\n[Msg] Removing existing compressed file [/tmp/log.zip]\r\n...\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n...\r\n[Msg] Stopping recording\r\n```\r\n\r\n`--log-compress` only, both `/tmp/log` and `/tmp/log.zip` already exist:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-compress --record-path '/tmp/log'\r\n[Wrn] [ign.cc:152] Log path already exists on disk! Recording instead to [/tmp/log(1)]\r\n[Wrn] [ign.cc:154] Compressed log path already exists on disk! Recording instead to [/tmp/log(1).zip]\r\n...\r\n[Msg] Recording to log file [/tmp/log(1)/state.tlog]\r\n...\r\n[Msg] Compressed log file and resources to [/tmp/log(1).zip].\r\nRemoving recorded directory [/tmp/log(1)].\r\n[Msg] Stopping recording\r\n$ ls /tmp\r\nlog\r\n'log(1).zip'\r\nlog.zip\r\n```\r\n\r\n`--log-compress` only, `/tmp/log` does not exist, `/tmp/log.zip` exists, `/tmp/log(1).zip` exists:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-compress --record-path '/tmp/log'\r\n[Wrn] [ign.cc:152] Log path already exists on disk! Recording instead to [/tmp/log(2)]\r\n[Wrn] [ign.cc:154] Compressed log path already exists on disk! Recording instead to [/tmp/log(2).zip]\r\n...\r\n[Msg] Recording to log file [/tmp/log(2)/state.tlog]\r\n...\r\n[Msg] Compressed log file and resources to [/tmp/log(2).zip].\r\nRemoving recorded directory [/tmp/log(2)].\r\n[Msg] Stopping recording\r\n```\r\n\r\n## Record Path vs. Console Log Path\r\n\r\nIn Blueprint and Citadel, if `--record` is specified without `--record-path`, and `<path>` exists in SDF, a warning is printed, and recording will go to `<path>`, while console log will go to the default timestamp path.\r\n\r\nAs in this example:\r\n\r\n```\r\n# SDF specifies <path>/tmp/log</path>\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --record --log-compress -log-overwrite\r\n[Wrn] [ServerPrivate.cc:229] --record-path is not specified on command line. <path> is specified in SDF. Will record to <path>. Console will be logged to [/home/master/.ignition/gazebo/log/2019-09-20T19:51:33.996055619]. Note: In Ignition-D, <path> will be ignored, and all recordings will be written to default console log path if no path is specified on command line.\r\n[Msg] Overwriting existing file [/tmp/log/state.tlog]\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n...\r\n[Msg] Removing existing file [/tmp/log.zip].\r\n[Msg] Compressed log file and resources to [/tmp/log.zip].\r\nRemoving recorded directory [/tmp/log].\r\n```\r\n\r\nIn Ignition-D, `<path>` will be permanently ignored. Recordings and console log will go to same default path.\r\n\r\nIf `--record-path` is specified, then recording and console log will go to this path in Blueprint, Citadel, and Ignition-D.\r\n\r\n## Future Work\r\n\r\nFiles are outputted in `/tmp/log` and `/tmp/log.zip` in this example. During record, the original path in `file://` is prepended with the specified path, e.g. `/tmp/log`. During playback, the specified path is prepended to the URIs in the SDF.", "title": "[Blueprint] Logging meshes and materials", "destination": {"commit": {"hash": "99cea19b6de4", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/commit/99cea19b6de4.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/commits/99cea19b6de4"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{f98d11fe-f287-4dfb-99c3-e2b76a13232e}ts=2082645"}}, "type": "repository", "name": "ign-gazebo", "full_name": "ignitionrobotics/ign-gazebo", "uuid": "{f98d11fe-f287-4dfb-99c3-e2b76a13232e}"}, "branch": {"name": "ign-gazebo2"}}, "reason": "", "source": {"commit": {"hash": "d0c4918072e5", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/commit/d0c4918072e5.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/commits/d0c4918072e5"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{f98d11fe-f287-4dfb-99c3-e2b76a13232e}ts=2082645"}}, "type": "repository", "name": "ign-gazebo", "full_name": "ignitionrobotics/ign-gazebo", "uuid": "{f98d11fe-f287-4dfb-99c3-e2b76a13232e}"}, "branch": {"name": "log_resources"}}, "state": "OPEN", "author": {"display_name": "Mabel Zhang", "uuid": "{4b0e38fb-bf50-45c0-a496-61147518b2bf}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B4b0e38fb-bf50-45c0-a496-61147518b2bf%7D"}, "html": {"href": "https://bitbucket.org/%7B4b0e38fb-bf50-45c0-a496-61147518b2bf%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:ceb5942c-6843-408c-8550-3ce4899d299b/4d48e5ea-cf28-4fa7-9715-8fc9e315d831/128"}}, "nickname": "mabelmzhang", "type": "user", "account_id": "557058:ceb5942c-6843-408c-8550-3ce4899d299b"}, "date": "2020-02-28T22:27:40.377562+00:00"}, "pull_request": {"type": "pullrequest", "id": 397, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397"}}, "title": "[Blueprint] Logging meshes and materials"}}, {"update": {"description": "Depends on [ign-common PR 200](#!/ignitionrobotics/ign-common/pull-requests/200/log-resources/diff).\r\n\r\nPorts [this Gazebo PR](https://bitbucket.org/osrf/gazebo/pull-requests/2811/save-models-material-and-meshes-when/diff) to Ignition.\r\n\r\nImplements `--record-resources`, and `--log-compress` and `--log-overwrite` to support it.\r\n\r\nRecords resources \\(`--record-resources`\\), i.e. meshes and materials, to a directory under the specified log record directory. Optionally compresses \\(`--log-compress`\\) the whole directory, which contains the existing `.tlog` sqlite3 file and any resources, to a zip file. If directory or compressed file already exist, optionally overwrites \\(`--log-overwrite`\\).\r\n\r\nCorresponding SDF plugin parameters: `<record_resources>1</record_resources>`, `<compress>1</compress>.`If both command line and SDF parameters are specified, command line option overwrites SDF parameter. `--log-overwrite` is handled on command line only, outside of the plugin. If recording is only enabled from SDF and not from command line, then behavior is to always overwrite.\r\n\r\n## Usage:\r\n\r\n```\r\nign gazebo [...] --record-resources --log-overwrite --log-compress\r\n```\r\n\r\n## Test --record-resources:\r\n\r\n```\r\n# This SDF specifies the equivalent of --record-resources --record-path '/tmp/log'\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf\r\n$ ign gazebo -v 4 -r examples/worlds/log_playback.sdf\r\n```\r\n\r\nTested with `<include><uri>https://fuel...</uri></include>` and `<mesh><uri>file://...</uri></mesh>`. Paths specified by `model://` are not supported in Ignition yet, so this case in the code is not tested.\r\n\r\n## Test --log-overwrite and --log-compress:\r\n\r\nWhen recording to `path`, the compression file is implied to be `path.zip`. Both are checked for existence.\r\n\r\nNo `--log-overwrite` \\(default\\):\r\n\r\n```\r\n# This SDF specifies the equivalent of --record-path '/tmp/log'\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf\r\n\r\n# Run it again. By default it will always overwrite, because overwrite is now taken care of in ign.cc\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf\r\n[Msg] Overwriting existing file [/tmp/log/state.tlog]\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n```\r\n\r\n`--log-overwrite`, `/tmp/log` already exists:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-overwrite --record-path '/tmp/log'\r\n[Msg] Log path already exists on disk! Existing files will be overwritten.\r\n[Msg] Removing existing path [/tmp/log]\r\n...\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n...\r\n[Msg] Stopping recording\r\n```\r\n\r\n`--log-overwrite --log-compress`, `/tmp/log` exists, `/tmp/log.zip` does not exist:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-compress --log-overwrite --record-path '/tmp/log'\r\n[Msg] Log path already exists on disk! Existing files will be overwritten.\r\n[Msg] Removing existing path [/tmp/log]\r\n...\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n...\r\n[Msg] Compressed log file and resources to [/tmp/log.zip].\r\nRemoving recorded directory [/tmp/log].\r\n[Msg] Stopping recording\r\n```\r\n\r\n`--log-overwrite --log-compress`, `/tmp/log` does not exist, `/tmp/log.zip` exists:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-compress --log-overwrite --record-path '/tmp/log'\r\n[Wrn] [ign.cc:121] Compressed log path already exists on disk! Existing files will be overwritten.\r\n[Msg] Removing existing compressed file [/tmp/log.zip]\r\n...\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n...\r\n[Msg] Compressed log file and resources to [/tmp/log.zip].\r\nRemoving recorded directory [/tmp/log].\r\n[Msg] Stopping recording\r\n```\r\n\r\n`--log-overwrite` only, `/tmp/log.zip` exists, `/tmp/log` does not exist:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-overwrite --record-path '/tmp/log'\r\n[Msg] Removing existing compressed file [/tmp/log.zip]\r\n...\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n...\r\n[Msg] Stopping recording\r\n```\r\n\r\n`--log-compress` only, both `/tmp/log` and `/tmp/log.zip` already exist:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-compress --record-path '/tmp/log'\r\n[Wrn] [ign.cc:152] Log path already exists on disk! Recording instead to [/tmp/log(1)]\r\n[Wrn] [ign.cc:154] Compressed log path already exists on disk! Recording instead to [/tmp/log(1).zip]\r\n...\r\n[Msg] Recording to log file [/tmp/log(1)/state.tlog]\r\n...\r\n[Msg] Compressed log file and resources to [/tmp/log(1).zip].\r\nRemoving recorded directory [/tmp/log(1)].\r\n[Msg] Stopping recording\r\n$ ls /tmp\r\nlog\r\n'log(1).zip'\r\nlog.zip\r\n```\r\n\r\n`--log-compress` only, `/tmp/log` does not exist, `/tmp/log.zip` exists, `/tmp/log(1).zip` exists:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-compress --record-path '/tmp/log'\r\n[Wrn] [ign.cc:152] Log path already exists on disk! Recording instead to [/tmp/log(2)]\r\n[Wrn] [ign.cc:154] Compressed log path already exists on disk! Recording instead to [/tmp/log(2).zip]\r\n...\r\n[Msg] Recording to log file [/tmp/log(2)/state.tlog]\r\n...\r\n[Msg] Compressed log file and resources to [/tmp/log(2).zip].\r\nRemoving recorded directory [/tmp/log(2)].\r\n[Msg] Stopping recording\r\n```\r\n\r\n## Record Path vs. Console Log Path\r\n\r\nIn Blueprint and Citadel, if `--record` is specified without `--record-path`, and `<path>` exists in SDF, a warning is printed, and recording will go to `<path>`, while console log will go to the default timestamp path.\r\n\r\nAs in this example:\r\n\r\n```\r\n# SDF specifies <path>/tmp/log</path>\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --record --log-compress -log-overwrite\r\n[Wrn] [ServerPrivate.cc:229] --record-path is not specified on command line. <path> is specified in SDF. Will record to <path>. Console will be logged to [/home/master/.ignition/gazebo/log/2019-09-20T19:51:33.996055619]. Note: In Ignition-D, <path> will be ignored, and all recordings will be written to default console log path if no path is specified on command line.\r\n[Msg] Overwriting existing file [/tmp/log/state.tlog]\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n...\r\n[Msg] Removing existing file [/tmp/log.zip].\r\n[Msg] Compressed log file and resources to [/tmp/log.zip].\r\nRemoving recorded directory [/tmp/log].\r\n```\r\n\r\nIn Ignition-D, `<path>` will be permanently ignored. Recordings and console log will go to same default path.\r\n\r\nIf `--record-path` is specified, then recording and console log will go to this path in Blueprint, Citadel, and Ignition-D.\r\n\r\n## Future Work\r\n\r\nFiles are outputted in `/tmp/log` and `/tmp/log.zip` in this example. During record, the original path in `file://` is prepended with the specified path, e.g. `/tmp/log`. During playback, the specified path is prepended to the URIs in the SDF.", "title": "[Blueprint] Logging meshes and materials", "destination": {"commit": {"hash": "08ac453ea8f6", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/commit/08ac453ea8f6.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/commits/08ac453ea8f6"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{f98d11fe-f287-4dfb-99c3-e2b76a13232e}ts=2082645"}}, "type": "repository", "name": "ign-gazebo", "full_name": "ignitionrobotics/ign-gazebo", "uuid": "{f98d11fe-f287-4dfb-99c3-e2b76a13232e}"}, "branch": {"name": "ign-gazebo2"}}, "reason": "", "source": {"commit": {"hash": "7da209db72ff", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/commit/7da209db72ff.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/commits/7da209db72ff"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{f98d11fe-f287-4dfb-99c3-e2b76a13232e}ts=2082645"}}, "type": "repository", "name": "ign-gazebo", "full_name": "ignitionrobotics/ign-gazebo", "uuid": "{f98d11fe-f287-4dfb-99c3-e2b76a13232e}"}, "branch": {"name": "log_resources"}}, "state": "OPEN", "author": {"display_name": "Mabel Zhang", "uuid": "{4b0e38fb-bf50-45c0-a496-61147518b2bf}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B4b0e38fb-bf50-45c0-a496-61147518b2bf%7D"}, "html": {"href": "https://bitbucket.org/%7B4b0e38fb-bf50-45c0-a496-61147518b2bf%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:ceb5942c-6843-408c-8550-3ce4899d299b/4d48e5ea-cf28-4fa7-9715-8fc9e315d831/128"}}, "nickname": "mabelmzhang", "type": "user", "account_id": "557058:ceb5942c-6843-408c-8550-3ce4899d299b"}, "date": "2020-01-03T09:53:18.239577+00:00"}, "pull_request": {"type": "pullrequest", "id": 397, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397"}}, "title": "[Blueprint] Logging meshes and materials"}}, {"update": {"description": "Depends on [ign-common PR 200](#!/ignitionrobotics/ign-common/pull-requests/200/log-resources/diff).\r\n\r\nPorts [this Gazebo PR](https://bitbucket.org/osrf/gazebo/pull-requests/2811/save-models-material-and-meshes-when/diff) to Ignition.\r\n\r\nImplements `--record-resources`, and `--log-compress` and `--log-overwrite` to support it.\r\n\r\nRecords resources \\(`--record-resources`\\), i.e. meshes and materials, to a directory under the specified log record directory. Optionally compresses \\(`--log-compress`\\) the whole directory, which contains the existing `.tlog` sqlite3 file and any resources, to a zip file. If directory or compressed file already exist, optionally overwrites \\(`--log-overwrite`\\).\r\n\r\nCorresponding SDF plugin parameters: `<record_resources>1</record_resources>`, `<compress>1</compress>.`If both command line and SDF parameters are specified, command line option overwrites SDF parameter. `--log-overwrite` is handled on command line only, outside of the plugin. If recording is only enabled from SDF and not from command line, then behavior is to always overwrite.\r\n\r\n## Usage:\r\n\r\n```\r\nign gazebo [...] --record-resources --log-overwrite --log-compress\r\n```\r\n\r\n## Test --record-resources:\r\n\r\n```\r\n# This SDF specifies the equivalent of --record-resources --record-path '/tmp/log'\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf\r\n$ ign gazebo -v 4 -r examples/worlds/log_playback.sdf\r\n```\r\n\r\nTested with `<include><uri>https://fuel...</uri></include>` and `<mesh><uri>file://...</uri></mesh>`. Paths specified by `model://` are not supported in Ignition yet, so this case in the code is not tested.\r\n\r\n## Test --log-overwrite and --log-compress:\r\n\r\nWhen recording to `path`, the compression file is implied to be `path.zip`. Both are checked for existence.\r\n\r\nNo `--log-overwrite` \\(default\\):\r\n\r\n```\r\n# This SDF specifies the equivalent of --record-path '/tmp/log'\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf\r\n\r\n# Run it again. By default it will always overwrite, because overwrite is now taken care of in ign.cc\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf\r\n[Msg] Overwriting existing file [/tmp/log/state.tlog]\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n```\r\n\r\n`--log-overwrite`, `/tmp/log` already exists:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-overwrite --record-path '/tmp/log'\r\n[Msg] Log path already exists on disk! Existing files will be overwritten.\r\n[Msg] Removing existing path [/tmp/log]\r\n...\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n...\r\n[Msg] Stopping recording\r\n```\r\n\r\n`--log-overwrite --log-compress`, `/tmp/log` exists, `/tmp/log.zip` does not exist:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-compress --log-overwrite --record-path '/tmp/log'\r\n[Msg] Log path already exists on disk! Existing files will be overwritten.\r\n[Msg] Removing existing path [/tmp/log]\r\n...\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n...\r\n[Msg] Compressed log file and resources to [/tmp/log.zip].\r\nRemoving recorded directory [/tmp/log].\r\n[Msg] Stopping recording\r\n```\r\n\r\n`--log-overwrite --log-compress`, `/tmp/log` does not exist, `/tmp/log.zip` exists:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-compress --log-overwrite --record-path '/tmp/log'\r\n[Wrn] [ign.cc:121] Compressed log path already exists on disk! Existing files will be overwritten.\r\n[Msg] Removing existing compressed file [/tmp/log.zip]\r\n...\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n...\r\n[Msg] Compressed log file and resources to [/tmp/log.zip].\r\nRemoving recorded directory [/tmp/log].\r\n[Msg] Stopping recording\r\n```\r\n\r\n`--log-overwrite` only, `/tmp/log.zip` exists, `/tmp/log` does not exist:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-overwrite --record-path '/tmp/log'\r\n[Msg] Removing existing compressed file [/tmp/log.zip]\r\n...\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n...\r\n[Msg] Stopping recording\r\n```\r\n\r\n`--log-compress` only, both `/tmp/log` and `/tmp/log.zip` already exist:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-compress --record-path '/tmp/log'\r\n[Wrn] [ign.cc:152] Log path already exists on disk! Recording instead to [/tmp/log(1)]\r\n[Wrn] [ign.cc:154] Compressed log path already exists on disk! Recording instead to [/tmp/log(1).zip]\r\n...\r\n[Msg] Recording to log file [/tmp/log(1)/state.tlog]\r\n...\r\n[Msg] Compressed log file and resources to [/tmp/log(1).zip].\r\nRemoving recorded directory [/tmp/log(1)].\r\n[Msg] Stopping recording\r\n$ ls /tmp\r\nlog\r\n'log(1).zip'\r\nlog.zip\r\n```\r\n\r\n`--log-compress` only, `/tmp/log` does not exist, `/tmp/log.zip` exists, `/tmp/log(1).zip` exists:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-compress --record-path '/tmp/log'\r\n[Wrn] [ign.cc:152] Log path already exists on disk! Recording instead to [/tmp/log(2)]\r\n[Wrn] [ign.cc:154] Compressed log path already exists on disk! Recording instead to [/tmp/log(2).zip]\r\n...\r\n[Msg] Recording to log file [/tmp/log(2)/state.tlog]\r\n...\r\n[Msg] Compressed log file and resources to [/tmp/log(2).zip].\r\nRemoving recorded directory [/tmp/log(2)].\r\n[Msg] Stopping recording\r\n```\r\n\r\n## Record Path vs. Console Log Path\r\n\r\nIn Blueprint and Citadel, if `--record` is specified without `--record-path`, and `<path>` exists in SDF, a warning is printed, and recording will go to `<path>`, while console log will go to the default timestamp path.\r\n\r\nAs in this example:\r\n\r\n```\r\n# SDF specifies <path>/tmp/log</path>\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --record --log-compress -log-overwrite\r\n[Wrn] [ServerPrivate.cc:229] --record-path is not specified on command line. <path> is specified in SDF. Will record to <path>. Console will be logged to [/home/master/.ignition/gazebo/log/2019-09-20T19:51:33.996055619]. Note: In Ignition-D, <path> will be ignored, and all recordings will be written to default console log path if no path is specified on command line.\r\n[Msg] Overwriting existing file [/tmp/log/state.tlog]\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n...\r\n[Msg] Removing existing file [/tmp/log.zip].\r\n[Msg] Compressed log file and resources to [/tmp/log.zip].\r\nRemoving recorded directory [/tmp/log].\r\n```\r\n\r\nIn Ignition-D, `<path>` will be permanently ignored. Recordings and console log will go to same default path.\r\n\r\nIf `--record-path` is specified, then recording and console log will go to this path in Blueprint, Citadel, and Ignition-D.\r\n\r\n## Future Work\r\n\r\nFiles are outputted in `/tmp/log` and `/tmp/log.zip` in this example. During record, the original path in `file://` is prepended with the specified path, e.g. `/tmp/log`. During playback, the specified path is prepended to the URIs in the SDF.", "title": "[Blueprint] Logging meshes and materials", "destination": {"commit": {"hash": "08ac453ea8f6", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/commit/08ac453ea8f6.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/commits/08ac453ea8f6"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{f98d11fe-f287-4dfb-99c3-e2b76a13232e}ts=2082645"}}, "type": "repository", "name": "ign-gazebo", "full_name": "ignitionrobotics/ign-gazebo", "uuid": "{f98d11fe-f287-4dfb-99c3-e2b76a13232e}"}, "branch": {"name": "ign-gazebo2"}}, "reason": "", "source": {"commit": {"hash": "7da209db72ff", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/commit/7da209db72ff.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/commits/7da209db72ff"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{f98d11fe-f287-4dfb-99c3-e2b76a13232e}ts=2082645"}}, "type": "repository", "name": "ign-gazebo", "full_name": "ignitionrobotics/ign-gazebo", "uuid": "{f98d11fe-f287-4dfb-99c3-e2b76a13232e}"}, "branch": {"name": "log_resources"}}, "state": "OPEN", "author": {"display_name": "Mabel Zhang", "uuid": "{4b0e38fb-bf50-45c0-a496-61147518b2bf}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B4b0e38fb-bf50-45c0-a496-61147518b2bf%7D"}, "html": {"href": "https://bitbucket.org/%7B4b0e38fb-bf50-45c0-a496-61147518b2bf%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:ceb5942c-6843-408c-8550-3ce4899d299b/4d48e5ea-cf28-4fa7-9715-8fc9e315d831/128"}}, "nickname": "mabelmzhang", "type": "user", "account_id": "557058:ceb5942c-6843-408c-8550-3ce4899d299b"}, "date": "2020-01-03T09:53:18.162188+00:00"}, "pull_request": {"type": "pullrequest", "id": 397, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397"}}, "title": "[Blueprint] Logging meshes and materials"}}, {"comment": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397/comments/130067816.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397/_/diff#comment-130067816"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 397, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397"}}, "title": "[Blueprint] Logging meshes and materials"}, "content": {"raw": "WIP: Don\u2019t mind the conflicts\u2026 I will resolve them later after a branch splitting off `--log-compress` is added on top of `--log-overwrite`.", "markup": "markdown", "html": "<p>WIP: Don\u2019t mind the conflicts\u2026 I will resolve them later after a branch splitting off <code>--log-compress</code> is added on top of <code>--log-overwrite</code>.</p>", "type": "rendered"}, "created_on": "2019-12-28T10:02:04.964043+00:00", "user": {"display_name": "Mabel Zhang", "uuid": "{4b0e38fb-bf50-45c0-a496-61147518b2bf}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B4b0e38fb-bf50-45c0-a496-61147518b2bf%7D"}, "html": {"href": "https://bitbucket.org/%7B4b0e38fb-bf50-45c0-a496-61147518b2bf%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:ceb5942c-6843-408c-8550-3ce4899d299b/4d48e5ea-cf28-4fa7-9715-8fc9e315d831/128"}}, "nickname": "mabelmzhang", "type": "user", "account_id": "557058:ceb5942c-6843-408c-8550-3ce4899d299b"}, "updated_on": "2019-12-28T10:02:04.969996+00:00", "type": "pullrequest_comment", "id": 130067816}, "pull_request": {"type": "pullrequest", "id": 397, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397"}}, "title": "[Blueprint] Logging meshes and materials"}}, {"update": {"description": "Depends on [ign-common PR 200](#!/ignitionrobotics/ign-common/pull-requests/200/log-resources/diff).\r\n\r\nPorts [this Gazebo PR](https://bitbucket.org/osrf/gazebo/pull-requests/2811/save-models-material-and-meshes-when/diff) to Ignition.\r\n\r\nImplements `--record-resources`, and `--log-compress` and `--log-overwrite` to support it.\r\n\r\nRecords resources \\(`--record-resources`\\), i.e. meshes and materials, to a directory under the specified log record directory. Optionally compresses \\(`--log-compress`\\) the whole directory, which contains the existing `.tlog` sqlite3 file and any resources, to a zip file. If directory or compressed file already exist, optionally overwrites \\(`--log-overwrite`\\).\r\n\r\nCorresponding SDF plugin parameters: `<record_resources>1</record_resources>`, `<compress>1</compress>.`If both command line and SDF parameters are specified, command line option overwrites SDF parameter. `--log-overwrite` is handled on command line only, outside of the plugin. If recording is only enabled from SDF and not from command line, then behavior is to always overwrite.\r\n\r\n## Usage:\r\n\r\n```\r\nign gazebo [...] --record-resources --log-overwrite --log-compress\r\n```\r\n\r\n## Test --record-resources:\r\n\r\n```\r\n# This SDF specifies the equivalent of --record-resources --record-path '/tmp/log'\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf\r\n$ ign gazebo -v 4 -r examples/worlds/log_playback.sdf\r\n```\r\n\r\nTested with `<include><uri>https://fuel...</uri></include>` and `<mesh><uri>file://...</uri></mesh>`. Paths specified by `model://` are not supported in Ignition yet, so this case in the code is not tested.\r\n\r\n## Test --log-overwrite and --log-compress:\r\n\r\nWhen recording to `path`, the compression file is implied to be `path.zip`. Both are checked for existence.\r\n\r\nNo `--log-overwrite` \\(default\\):\r\n\r\n```\r\n# This SDF specifies the equivalent of --record-path '/tmp/log'\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf\r\n\r\n# Run it again. By default it will always overwrite, because overwrite is now taken care of in ign.cc\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf\r\n[Msg] Overwriting existing file [/tmp/log/state.tlog]\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n```\r\n\r\n`--log-overwrite`, `/tmp/log` already exists:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-overwrite --record-path '/tmp/log'\r\n[Msg] Log path already exists on disk! Existing files will be overwritten.\r\n[Msg] Removing existing path [/tmp/log]\r\n...\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n...\r\n[Msg] Stopping recording\r\n```\r\n\r\n`--log-overwrite --log-compress`, `/tmp/log` exists, `/tmp/log.zip` does not exist:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-compress --log-overwrite --record-path '/tmp/log'\r\n[Msg] Log path already exists on disk! Existing files will be overwritten.\r\n[Msg] Removing existing path [/tmp/log]\r\n...\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n...\r\n[Msg] Compressed log file and resources to [/tmp/log.zip].\r\nRemoving recorded directory [/tmp/log].\r\n[Msg] Stopping recording\r\n```\r\n\r\n`--log-overwrite --log-compress`, `/tmp/log` does not exist, `/tmp/log.zip` exists:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-compress --log-overwrite --record-path '/tmp/log'\r\n[Wrn] [ign.cc:121] Compressed log path already exists on disk! Existing files will be overwritten.\r\n[Msg] Removing existing compressed file [/tmp/log.zip]\r\n...\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n...\r\n[Msg] Compressed log file and resources to [/tmp/log.zip].\r\nRemoving recorded directory [/tmp/log].\r\n[Msg] Stopping recording\r\n```\r\n\r\n`--log-overwrite` only, `/tmp/log.zip` exists, `/tmp/log` does not exist:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-overwrite --record-path '/tmp/log'\r\n[Msg] Removing existing compressed file [/tmp/log.zip]\r\n...\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n...\r\n[Msg] Stopping recording\r\n```\r\n\r\n`--log-compress` only, both `/tmp/log` and `/tmp/log.zip` already exist:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-compress --record-path '/tmp/log'\r\n[Wrn] [ign.cc:152] Log path already exists on disk! Recording instead to [/tmp/log(1)]\r\n[Wrn] [ign.cc:154] Compressed log path already exists on disk! Recording instead to [/tmp/log(1).zip]\r\n...\r\n[Msg] Recording to log file [/tmp/log(1)/state.tlog]\r\n...\r\n[Msg] Compressed log file and resources to [/tmp/log(1).zip].\r\nRemoving recorded directory [/tmp/log(1)].\r\n[Msg] Stopping recording\r\n$ ls /tmp\r\nlog\r\n'log(1).zip'\r\nlog.zip\r\n```\r\n\r\n`--log-compress` only, `/tmp/log` does not exist, `/tmp/log.zip` exists, `/tmp/log(1).zip` exists:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-compress --record-path '/tmp/log'\r\n[Wrn] [ign.cc:152] Log path already exists on disk! Recording instead to [/tmp/log(2)]\r\n[Wrn] [ign.cc:154] Compressed log path already exists on disk! Recording instead to [/tmp/log(2).zip]\r\n...\r\n[Msg] Recording to log file [/tmp/log(2)/state.tlog]\r\n...\r\n[Msg] Compressed log file and resources to [/tmp/log(2).zip].\r\nRemoving recorded directory [/tmp/log(2)].\r\n[Msg] Stopping recording\r\n```\r\n\r\n## Record Path vs. Console Log Path\r\n\r\nIn Blueprint and Citadel, if `--record` is specified without `--record-path`, and `<path>` exists in SDF, a warning is printed, and recording will go to `<path>`, while console log will go to the default timestamp path.\r\n\r\nAs in this example:\r\n\r\n```\r\n# SDF specifies <path>/tmp/log</path>\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --record --log-compress -log-overwrite\r\n[Wrn] [ServerPrivate.cc:229] --record-path is not specified on command line. <path> is specified in SDF. Will record to <path>. Console will be logged to [/home/master/.ignition/gazebo/log/2019-09-20T19:51:33.996055619]. Note: In Ignition-D, <path> will be ignored, and all recordings will be written to default console log path if no path is specified on command line.\r\n[Msg] Overwriting existing file [/tmp/log/state.tlog]\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n...\r\n[Msg] Removing existing file [/tmp/log.zip].\r\n[Msg] Compressed log file and resources to [/tmp/log.zip].\r\nRemoving recorded directory [/tmp/log].\r\n```\r\n\r\nIn Ignition-D, `<path>` will be permanently ignored. Recordings and console log will go to same default path.\r\n\r\nIf `--record-path` is specified, then recording and console log will go to this path in Blueprint, Citadel, and Ignition-D.\r\n\r\n## Future Work\r\n\r\nFiles are outputted in `/tmp/log` and `/tmp/log.zip` in this example. During record, the original path in `file://` is prepended with the specified path, e.g. `/tmp/log`. During playback, the specified path is prepended to the URIs in the SDF.", "title": "[Blueprint] Logging meshes and materials", "destination": {"commit": {"hash": "e5d756cccc46", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/commit/e5d756cccc46.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/commits/e5d756cccc46"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{f98d11fe-f287-4dfb-99c3-e2b76a13232e}ts=2082645"}}, "type": "repository", "name": "ign-gazebo", "full_name": "ignitionrobotics/ign-gazebo", "uuid": "{f98d11fe-f287-4dfb-99c3-e2b76a13232e}"}, "branch": {"name": "ign-gazebo2"}}, "reason": "", "source": {"commit": {"hash": "7da209db72ff", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/commit/7da209db72ff.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/commits/7da209db72ff"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{f98d11fe-f287-4dfb-99c3-e2b76a13232e}ts=2082645"}}, "type": "repository", "name": "ign-gazebo", "full_name": "ignitionrobotics/ign-gazebo", "uuid": "{f98d11fe-f287-4dfb-99c3-e2b76a13232e}"}, "branch": {"name": "log_resources"}}, "state": "OPEN", "author": {"display_name": "Mabel Zhang", "uuid": "{4b0e38fb-bf50-45c0-a496-61147518b2bf}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B4b0e38fb-bf50-45c0-a496-61147518b2bf%7D"}, "html": {"href": "https://bitbucket.org/%7B4b0e38fb-bf50-45c0-a496-61147518b2bf%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:ceb5942c-6843-408c-8550-3ce4899d299b/4d48e5ea-cf28-4fa7-9715-8fc9e315d831/128"}}, "nickname": "mabelmzhang", "type": "user", "account_id": "557058:ceb5942c-6843-408c-8550-3ce4899d299b"}, "date": "2019-12-28T10:00:09.339094+00:00"}, "pull_request": {"type": "pullrequest", "id": 397, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397"}}, "title": "[Blueprint] Logging meshes and materials"}}, {"update": {"description": "Depends on [ign-common PR 200](#!/ignitionrobotics/ign-common/pull-requests/200/log-resources/diff).\r\n\r\nPorts [this Gazebo PR](https://bitbucket.org/osrf/gazebo/pull-requests/2811/save-models-material-and-meshes-when/diff) to Ignition.\r\n\r\nImplements `--record-resources`, and `--log-compress` and `--log-overwrite` to support it.\r\n\r\nRecords resources \\(`--record-resources`\\), i.e. meshes and materials, to a directory under the specified log record directory. Optionally compresses \\(`--log-compress`\\) the whole directory, which contains the existing `.tlog` sqlite3 file and any resources, to a zip file. If directory or compressed file already exist, optionally overwrites \\(`--log-overwrite`\\).\r\n\r\nCorresponding SDF plugin parameters: `<record_resources>1</record_resources>`, `<compress>1</compress>.`If both command line and SDF parameters are specified, command line option overwrites SDF parameter. `--log-overwrite` is handled on command line only, outside of the plugin. If recording is only enabled from SDF and not from command line, then behavior is to always overwrite.\r\n\r\n## Usage:\r\n\r\n```\r\nign gazebo [...] --record-resources --log-overwrite --log-compress\r\n```\r\n\r\n## Test --record-resources:\r\n\r\n```\r\n# This SDF specifies the equivalent of --record-resources --record-path '/tmp/log'\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf\r\n$ ign gazebo -v 4 -r examples/worlds/log_playback.sdf\r\n```\r\n\r\nTested with `<include><uri>https://fuel...</uri></include>` and `<mesh><uri>file://...</uri></mesh>`. Paths specified by `model://` are not supported in Ignition yet, so this case in the code is not tested.\r\n\r\n## Test --log-overwrite and --log-compress:\r\n\r\nWhen recording to `path`, the compression file is implied to be `path.zip`. Both are checked for existence.\r\n\r\nNo `--log-overwrite` \\(default\\):\r\n\r\n```\r\n# This SDF specifies the equivalent of --record-path '/tmp/log'\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf\r\n\r\n# Run it again. By default it will always overwrite, because overwrite is now taken care of in ign.cc\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf\r\n[Msg] Overwriting existing file [/tmp/log/state.tlog]\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n```\r\n\r\n`--log-overwrite`, `/tmp/log` already exists:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-overwrite --record-path '/tmp/log'\r\n[Msg] Log path already exists on disk! Existing files will be overwritten.\r\n[Msg] Removing existing path [/tmp/log]\r\n...\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n...\r\n[Msg] Stopping recording\r\n```\r\n\r\n`--log-overwrite --log-compress`, `/tmp/log` exists, `/tmp/log.zip` does not exist:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-compress --log-overwrite --record-path '/tmp/log'\r\n[Msg] Log path already exists on disk! Existing files will be overwritten.\r\n[Msg] Removing existing path [/tmp/log]\r\n...\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n...\r\n[Msg] Compressed log file and resources to [/tmp/log.zip].\r\nRemoving recorded directory [/tmp/log].\r\n[Msg] Stopping recording\r\n```\r\n\r\n`--log-overwrite --log-compress`, `/tmp/log` does not exist, `/tmp/log.zip` exists:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-compress --log-overwrite --record-path '/tmp/log'\r\n[Wrn] [ign.cc:121] Compressed log path already exists on disk! Existing files will be overwritten.\r\n[Msg] Removing existing compressed file [/tmp/log.zip]\r\n...\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n...\r\n[Msg] Compressed log file and resources to [/tmp/log.zip].\r\nRemoving recorded directory [/tmp/log].\r\n[Msg] Stopping recording\r\n```\r\n\r\n`--log-overwrite` only, `/tmp/log.zip` exists, `/tmp/log` does not exist:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-overwrite --record-path '/tmp/log'\r\n[Msg] Removing existing compressed file [/tmp/log.zip]\r\n...\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n...\r\n[Msg] Stopping recording\r\n```\r\n\r\n`--log-compress` only, both `/tmp/log` and `/tmp/log.zip` already exist:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-compress --record-path '/tmp/log'\r\n[Wrn] [ign.cc:152] Log path already exists on disk! Recording instead to [/tmp/log(1)]\r\n[Wrn] [ign.cc:154] Compressed log path already exists on disk! Recording instead to [/tmp/log(1).zip]\r\n...\r\n[Msg] Recording to log file [/tmp/log(1)/state.tlog]\r\n...\r\n[Msg] Compressed log file and resources to [/tmp/log(1).zip].\r\nRemoving recorded directory [/tmp/log(1)].\r\n[Msg] Stopping recording\r\n$ ls /tmp\r\nlog\r\n'log(1).zip'\r\nlog.zip\r\n```\r\n\r\n`--log-compress` only, `/tmp/log` does not exist, `/tmp/log.zip` exists, `/tmp/log(1).zip` exists:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-compress --record-path '/tmp/log'\r\n[Wrn] [ign.cc:152] Log path already exists on disk! Recording instead to [/tmp/log(2)]\r\n[Wrn] [ign.cc:154] Compressed log path already exists on disk! Recording instead to [/tmp/log(2).zip]\r\n...\r\n[Msg] Recording to log file [/tmp/log(2)/state.tlog]\r\n...\r\n[Msg] Compressed log file and resources to [/tmp/log(2).zip].\r\nRemoving recorded directory [/tmp/log(2)].\r\n[Msg] Stopping recording\r\n```\r\n\r\n## Record Path vs. Console Log Path\r\n\r\nIn Blueprint and Citadel, if `--record` is specified without `--record-path`, and `<path>` exists in SDF, a warning is printed, and recording will go to `<path>`, while console log will go to the default timestamp path.\r\n\r\nAs in this example:\r\n\r\n```\r\n# SDF specifies <path>/tmp/log</path>\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --record --log-compress -log-overwrite\r\n[Wrn] [ServerPrivate.cc:229] --record-path is not specified on command line. <path> is specified in SDF. Will record to <path>. Console will be logged to [/home/master/.ignition/gazebo/log/2019-09-20T19:51:33.996055619]. Note: In Ignition-D, <path> will be ignored, and all recordings will be written to default console log path if no path is specified on command line.\r\n[Msg] Overwriting existing file [/tmp/log/state.tlog]\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n...\r\n[Msg] Removing existing file [/tmp/log.zip].\r\n[Msg] Compressed log file and resources to [/tmp/log.zip].\r\nRemoving recorded directory [/tmp/log].\r\n```\r\n\r\nIn Ignition-D, `<path>` will be permanently ignored. Recordings and console log will go to same default path.\r\n\r\nIf `--record-path` is specified, then recording and console log will go to this path in Blueprint, Citadel, and Ignition-D.\r\n\r\n## Future Work\r\n\r\nFiles are outputted in `/tmp/log` and `/tmp/log.zip` in this example. During record, the original path in `file://` is prepended with the specified path, e.g. `/tmp/log`. During playback, the specified path is prepended to the URIs in the SDF.", "title": "[Blueprint] Logging meshes and materials", "destination": {"commit": {"hash": "e5d756cccc46", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/commit/e5d756cccc46.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/commits/e5d756cccc46"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{f98d11fe-f287-4dfb-99c3-e2b76a13232e}ts=2082645"}}, "type": "repository", "name": "ign-gazebo", "full_name": "ignitionrobotics/ign-gazebo", "uuid": "{f98d11fe-f287-4dfb-99c3-e2b76a13232e}"}, "branch": {"name": "ign-gazebo2"}}, "reason": "", "source": {"commit": {"hash": "7da209db72ff", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/commit/7da209db72ff.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/commits/7da209db72ff"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{f98d11fe-f287-4dfb-99c3-e2b76a13232e}ts=2082645"}}, "type": "repository", "name": "ign-gazebo", "full_name": "ignitionrobotics/ign-gazebo", "uuid": "{f98d11fe-f287-4dfb-99c3-e2b76a13232e}"}, "branch": {"name": "log_resources"}}, "state": "OPEN", "author": {"display_name": "Mabel Zhang", "uuid": "{4b0e38fb-bf50-45c0-a496-61147518b2bf}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B4b0e38fb-bf50-45c0-a496-61147518b2bf%7D"}, "html": {"href": "https://bitbucket.org/%7B4b0e38fb-bf50-45c0-a496-61147518b2bf%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:ceb5942c-6843-408c-8550-3ce4899d299b/4d48e5ea-cf28-4fa7-9715-8fc9e315d831/128"}}, "nickname": "mabelmzhang", "type": "user", "account_id": "557058:ceb5942c-6843-408c-8550-3ce4899d299b"}, "date": "2019-12-28T10:00:09.270750+00:00"}, "pull_request": {"type": "pullrequest", "id": 397, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397"}}, "title": "[Blueprint] Logging meshes and materials"}}, {"update": {"description": "Depends on [ign-common PR 200](#!/ignitionrobotics/ign-common/pull-requests/200/log-resources/diff).\r\n\r\nPorts [this Gazebo PR](https://bitbucket.org/osrf/gazebo/pull-requests/2811/save-models-material-and-meshes-when/diff) to Ignition.\r\n\r\nImplements `--record-resources`, and `--log-compress` and `--log-overwrite` to support it.\r\n\r\nRecords resources \\(`--record-resources`\\), i.e. meshes and materials, to a directory under the specified log record directory. Optionally compresses \\(`--log-compress`\\) the whole directory, which contains the existing `.tlog` sqlite3 file and any resources, to a zip file. If directory or compressed file already exist, optionally overwrites \\(`--log-overwrite`\\).\r\n\r\nCorresponding SDF plugin parameters: `<record_resources>1</record_resources>`, `<compress>1</compress>.`If both command line and SDF parameters are specified, command line option overwrites SDF parameter. `--log-overwrite` is handled on command line only, outside of the plugin. If recording is only enabled from SDF and not from command line, then behavior is to always overwrite.\r\n\r\n## Usage:\r\n\r\n```\r\nign gazebo [...] --record-resources --log-overwrite --log-compress\r\n```\r\n\r\n## Test --record-resources:\r\n\r\n```\r\n# This SDF specifies the equivalent of --record-resources --record-path '/tmp/log'\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf\r\n$ ign gazebo -v 4 -r examples/worlds/log_playback.sdf\r\n```\r\n\r\nTested with `<include><uri>https://fuel...</uri></include>` and `<mesh><uri>file://...</uri></mesh>`. Paths specified by `model://` are not supported in Ignition yet, so this case in the code is not tested.\r\n\r\n## Test --log-overwrite and --log-compress:\r\n\r\nWhen recording to `path`, the compression file is implied to be `path.zip`. Both are checked for existence.\r\n\r\nNo `--log-overwrite` \\(default\\):\r\n\r\n```\r\n# This SDF specifies the equivalent of --record-path '/tmp/log'\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf\r\n\r\n# Run it again. By default it will always overwrite, because overwrite is now taken care of in ign.cc\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf\r\n[Msg] Overwriting existing file [/tmp/log/state.tlog]\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n```\r\n\r\n`--log-overwrite`, `/tmp/log` already exists:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-overwrite --record-path '/tmp/log'\r\n[Msg] Log path already exists on disk! Existing files will be overwritten.\r\n[Msg] Removing existing path [/tmp/log]\r\n...\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n...\r\n[Msg] Stopping recording\r\n```\r\n\r\n`--log-overwrite --log-compress`, `/tmp/log` exists, `/tmp/log.zip` does not exist:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-compress --log-overwrite --record-path '/tmp/log'\r\n[Msg] Log path already exists on disk! Existing files will be overwritten.\r\n[Msg] Removing existing path [/tmp/log]\r\n...\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n...\r\n[Msg] Compressed log file and resources to [/tmp/log.zip].\r\nRemoving recorded directory [/tmp/log].\r\n[Msg] Stopping recording\r\n```\r\n\r\n`--log-overwrite --log-compress`, `/tmp/log` does not exist, `/tmp/log.zip` exists:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-compress --log-overwrite --record-path '/tmp/log'\r\n[Wrn] [ign.cc:121] Compressed log path already exists on disk! Existing files will be overwritten.\r\n[Msg] Removing existing compressed file [/tmp/log.zip]\r\n...\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n...\r\n[Msg] Compressed log file and resources to [/tmp/log.zip].\r\nRemoving recorded directory [/tmp/log].\r\n[Msg] Stopping recording\r\n```\r\n\r\n`--log-overwrite` only, `/tmp/log.zip` exists, `/tmp/log` does not exist:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-overwrite --record-path '/tmp/log'\r\n[Msg] Removing existing compressed file [/tmp/log.zip]\r\n...\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n...\r\n[Msg] Stopping recording\r\n```\r\n\r\n`--log-compress` only, both `/tmp/log` and `/tmp/log.zip` already exist:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-compress --record-path '/tmp/log'\r\n[Wrn] [ign.cc:152] Log path already exists on disk! Recording instead to [/tmp/log(1)]\r\n[Wrn] [ign.cc:154] Compressed log path already exists on disk! Recording instead to [/tmp/log(1).zip]\r\n...\r\n[Msg] Recording to log file [/tmp/log(1)/state.tlog]\r\n...\r\n[Msg] Compressed log file and resources to [/tmp/log(1).zip].\r\nRemoving recorded directory [/tmp/log(1)].\r\n[Msg] Stopping recording\r\n$ ls /tmp\r\nlog\r\n'log(1).zip'\r\nlog.zip\r\n```\r\n\r\n`--log-compress` only, `/tmp/log` does not exist, `/tmp/log.zip` exists, `/tmp/log(1).zip` exists:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-compress --record-path '/tmp/log'\r\n[Wrn] [ign.cc:152] Log path already exists on disk! Recording instead to [/tmp/log(2)]\r\n[Wrn] [ign.cc:154] Compressed log path already exists on disk! Recording instead to [/tmp/log(2).zip]\r\n...\r\n[Msg] Recording to log file [/tmp/log(2)/state.tlog]\r\n...\r\n[Msg] Compressed log file and resources to [/tmp/log(2).zip].\r\nRemoving recorded directory [/tmp/log(2)].\r\n[Msg] Stopping recording\r\n```\r\n\r\n## Record Path vs. Console Log Path\r\n\r\nIn Blueprint and Citadel, if `--record` is specified without `--record-path`, and `<path>` exists in SDF, a warning is printed, and recording will go to `<path>`, while console log will go to the default timestamp path.\r\n\r\nAs in this example:\r\n\r\n```\r\n# SDF specifies <path>/tmp/log</path>\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --record --log-compress -log-overwrite\r\n[Wrn] [ServerPrivate.cc:229] --record-path is not specified on command line. <path> is specified in SDF. Will record to <path>. Console will be logged to [/home/master/.ignition/gazebo/log/2019-09-20T19:51:33.996055619]. Note: In Ignition-D, <path> will be ignored, and all recordings will be written to default console log path if no path is specified on command line.\r\n[Msg] Overwriting existing file [/tmp/log/state.tlog]\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n...\r\n[Msg] Removing existing file [/tmp/log.zip].\r\n[Msg] Compressed log file and resources to [/tmp/log.zip].\r\nRemoving recorded directory [/tmp/log].\r\n```\r\n\r\nIn Ignition-D, `<path>` will be permanently ignored. Recordings and console log will go to same default path.\r\n\r\nIf `--record-path` is specified, then recording and console log will go to this path in Blueprint, Citadel, and Ignition-D.\r\n\r\n## Future Work\r\n\r\nFiles are outputted in `/tmp/log` and `/tmp/log.zip` in this example. During record, the original path in `file://` is prepended with the specified path, e.g. `/tmp/log`. During playback, the specified path is prepended to the URIs in the SDF.", "title": "[Blueprint] Logging meshes and materials", "destination": {"commit": {"hash": "a78ad6231b8e", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/commit/a78ad6231b8e.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/commits/a78ad6231b8e"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{f98d11fe-f287-4dfb-99c3-e2b76a13232e}ts=2082645"}}, "type": "repository", "name": "ign-gazebo", "full_name": "ignitionrobotics/ign-gazebo", "uuid": "{f98d11fe-f287-4dfb-99c3-e2b76a13232e}"}, "branch": {"name": "ign-gazebo2"}}, "reason": "", "source": {"commit": {"hash": "7da209db72ff", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/commit/7da209db72ff.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/commits/7da209db72ff"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{f98d11fe-f287-4dfb-99c3-e2b76a13232e}ts=2082645"}}, "type": "repository", "name": "ign-gazebo", "full_name": "ignitionrobotics/ign-gazebo", "uuid": "{f98d11fe-f287-4dfb-99c3-e2b76a13232e}"}, "branch": {"name": "log_resources"}}, "state": "OPEN", "author": {"display_name": "Mabel Zhang", "uuid": "{4b0e38fb-bf50-45c0-a496-61147518b2bf}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B4b0e38fb-bf50-45c0-a496-61147518b2bf%7D"}, "html": {"href": "https://bitbucket.org/%7B4b0e38fb-bf50-45c0-a496-61147518b2bf%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:ceb5942c-6843-408c-8550-3ce4899d299b/4d48e5ea-cf28-4fa7-9715-8fc9e315d831/128"}}, "nickname": "mabelmzhang", "type": "user", "account_id": "557058:ceb5942c-6843-408c-8550-3ce4899d299b"}, "date": "2019-12-27T06:23:34.079283+00:00"}, "pull_request": {"type": "pullrequest", "id": 397, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397"}}, "title": "[Blueprint] Logging meshes and materials"}}, {"update": {"description": "Depends on [ign-common PR 200](#!/ignitionrobotics/ign-common/pull-requests/200/log-resources/diff).\r\n\r\nPorts [this Gazebo PR](https://bitbucket.org/osrf/gazebo/pull-requests/2811/save-models-material-and-meshes-when/diff) to Ignition.\r\n\r\nImplements `--record-resources`, and `--log-compress` and `--log-overwrite` to support it.\r\n\r\nRecords resources \\(`--record-resources`\\), i.e. meshes and materials, to a directory under the specified log record directory. Optionally compresses \\(`--log-compress`\\) the whole directory, which contains the existing `.tlog` sqlite3 file and any resources, to a zip file. If directory or compressed file already exist, optionally overwrites \\(`--log-overwrite`\\).\r\n\r\nCorresponding SDF plugin parameters: `<record_resources>1</record_resources>`, `<compress>1</compress>.`If both command line and SDF parameters are specified, command line option overwrites SDF parameter. `--log-overwrite` is handled on command line only, outside of the plugin. If recording is only enabled from SDF and not from command line, then behavior is to always overwrite.\r\n\r\n## Usage:\r\n\r\n```\r\nign gazebo [...] --record-resources --log-overwrite --log-compress\r\n```\r\n\r\n## Test --record-resources:\r\n\r\n```\r\n# This SDF specifies the equivalent of --record-resources --record-path '/tmp/log'\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf\r\n$ ign gazebo -v 4 -r examples/worlds/log_playback.sdf\r\n```\r\n\r\nTested with `<include><uri>https://fuel...</uri></include>` and `<mesh><uri>file://...</uri></mesh>`. Paths specified by `model://` are not supported in Ignition yet, so this case in the code is not tested.\r\n\r\n## Test --log-overwrite and --log-compress:\r\n\r\nWhen recording to `path`, the compression file is implied to be `path.zip`. Both are checked for existence.\r\n\r\nNo `--log-overwrite` \\(default\\):\r\n\r\n```\r\n# This SDF specifies the equivalent of --record-path '/tmp/log'\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf\r\n\r\n# Run it again. By default it will always overwrite, because overwrite is now taken care of in ign.cc\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf\r\n[Msg] Overwriting existing file [/tmp/log/state.tlog]\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n```\r\n\r\n`--log-overwrite`, `/tmp/log` already exists:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-overwrite --record-path '/tmp/log'\r\n[Msg] Log path already exists on disk! Existing files will be overwritten.\r\n[Msg] Removing existing path [/tmp/log]\r\n...\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n...\r\n[Msg] Stopping recording\r\n```\r\n\r\n`--log-overwrite --log-compress`, `/tmp/log` exists, `/tmp/log.zip` does not exist:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-compress --log-overwrite --record-path '/tmp/log'\r\n[Msg] Log path already exists on disk! Existing files will be overwritten.\r\n[Msg] Removing existing path [/tmp/log]\r\n...\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n...\r\n[Msg] Compressed log file and resources to [/tmp/log.zip].\r\nRemoving recorded directory [/tmp/log].\r\n[Msg] Stopping recording\r\n```\r\n\r\n`--log-overwrite --log-compress`, `/tmp/log` does not exist, `/tmp/log.zip` exists:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-compress --log-overwrite --record-path '/tmp/log'\r\n[Wrn] [ign.cc:121] Compressed log path already exists on disk! Existing files will be overwritten.\r\n[Msg] Removing existing compressed file [/tmp/log.zip]\r\n...\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n...\r\n[Msg] Compressed log file and resources to [/tmp/log.zip].\r\nRemoving recorded directory [/tmp/log].\r\n[Msg] Stopping recording\r\n```\r\n\r\n`--log-overwrite` only, `/tmp/log.zip` exists, `/tmp/log` does not exist:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-overwrite --record-path '/tmp/log'\r\n[Msg] Removing existing compressed file [/tmp/log.zip]\r\n...\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n...\r\n[Msg] Stopping recording\r\n```\r\n\r\n`--log-compress` only, both `/tmp/log` and `/tmp/log.zip` already exist:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-compress --record-path '/tmp/log'\r\n[Wrn] [ign.cc:152] Log path already exists on disk! Recording instead to [/tmp/log(1)]\r\n[Wrn] [ign.cc:154] Compressed log path already exists on disk! Recording instead to [/tmp/log(1).zip]\r\n...\r\n[Msg] Recording to log file [/tmp/log(1)/state.tlog]\r\n...\r\n[Msg] Compressed log file and resources to [/tmp/log(1).zip].\r\nRemoving recorded directory [/tmp/log(1)].\r\n[Msg] Stopping recording\r\n$ ls /tmp\r\nlog\r\n'log(1).zip'\r\nlog.zip\r\n```\r\n\r\n`--log-compress` only, `/tmp/log` does not exist, `/tmp/log.zip` exists, `/tmp/log(1).zip` exists:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-compress --record-path '/tmp/log'\r\n[Wrn] [ign.cc:152] Log path already exists on disk! Recording instead to [/tmp/log(2)]\r\n[Wrn] [ign.cc:154] Compressed log path already exists on disk! Recording instead to [/tmp/log(2).zip]\r\n...\r\n[Msg] Recording to log file [/tmp/log(2)/state.tlog]\r\n...\r\n[Msg] Compressed log file and resources to [/tmp/log(2).zip].\r\nRemoving recorded directory [/tmp/log(2)].\r\n[Msg] Stopping recording\r\n```\r\n\r\n## Record Path vs. Console Log Path\r\n\r\nIn Blueprint and Citadel, if `--record` is specified without `--record-path`, and `<path>` exists in SDF, a warning is printed, and recording will go to `<path>`, while console log will go to the default timestamp path.\r\n\r\nAs in this example:\r\n\r\n```\r\n# SDF specifies <path>/tmp/log</path>\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --record --log-compress -log-overwrite\r\n[Wrn] [ServerPrivate.cc:229] --record-path is not specified on command line. <path> is specified in SDF. Will record to <path>. Console will be logged to [/home/master/.ignition/gazebo/log/2019-09-20T19:51:33.996055619]. Note: In Ignition-D, <path> will be ignored, and all recordings will be written to default console log path if no path is specified on command line.\r\n[Msg] Overwriting existing file [/tmp/log/state.tlog]\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n...\r\n[Msg] Removing existing file [/tmp/log.zip].\r\n[Msg] Compressed log file and resources to [/tmp/log.zip].\r\nRemoving recorded directory [/tmp/log].\r\n```\r\n\r\nIn Ignition-D, `<path>` will be permanently ignored. Recordings and console log will go to same default path.\r\n\r\nIf `--record-path` is specified, then recording and console log will go to this path in Blueprint, Citadel, and Ignition-D.\r\n\r\n## Future Work\r\n\r\nFiles are outputted in `/tmp/log` and `/tmp/log.zip` in this example. During record, the original path in `file://` is prepended with the specified path, e.g. `/tmp/log`. During playback, the specified path is prepended to the URIs in the SDF.", "title": "[Blueprint] Logging meshes and materials", "destination": {"commit": {"hash": "a78ad6231b8e", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/commit/a78ad6231b8e.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/commits/a78ad6231b8e"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{f98d11fe-f287-4dfb-99c3-e2b76a13232e}ts=2082645"}}, "type": "repository", "name": "ign-gazebo", "full_name": "ignitionrobotics/ign-gazebo", "uuid": "{f98d11fe-f287-4dfb-99c3-e2b76a13232e}"}, "branch": {"name": "ign-gazebo2"}}, "reason": "", "source": {"commit": {"hash": "7da209db72ff", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/commit/7da209db72ff.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/commits/7da209db72ff"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{f98d11fe-f287-4dfb-99c3-e2b76a13232e}ts=2082645"}}, "type": "repository", "name": "ign-gazebo", "full_name": "ignitionrobotics/ign-gazebo", "uuid": "{f98d11fe-f287-4dfb-99c3-e2b76a13232e}"}, "branch": {"name": "log_resources"}}, "state": "OPEN", "author": {"display_name": "Mabel Zhang", "uuid": "{4b0e38fb-bf50-45c0-a496-61147518b2bf}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B4b0e38fb-bf50-45c0-a496-61147518b2bf%7D"}, "html": {"href": "https://bitbucket.org/%7B4b0e38fb-bf50-45c0-a496-61147518b2bf%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:ceb5942c-6843-408c-8550-3ce4899d299b/4d48e5ea-cf28-4fa7-9715-8fc9e315d831/128"}}, "nickname": "mabelmzhang", "type": "user", "account_id": "557058:ceb5942c-6843-408c-8550-3ce4899d299b"}, "date": "2019-12-26T20:57:19.223483+00:00"}, "pull_request": {"type": "pullrequest", "id": 397, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397"}}, "title": "[Blueprint] Logging meshes and materials"}}, {"comment": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397/comments/129033298.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397/_/diff#comment-129033298"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 397, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397"}}, "title": "[Blueprint] Logging meshes and materials"}, "content": {"raw": "@{mabelmzhang} , I started adding some simple tests in af781cb", "markup": "markdown", "html": "<p><span class=\"ap-mention\" data-atlassian-id=\"557058:ceb5942c-6843-408c-8550-3ce4899d299b\">@Mabel Zhang</span> , I started adding some simple tests in <a href=\"#!/ignitionrobotics/ign-gazebo/commits/af781cb\" rel=\"nofollow\" class=\"ap-connect-link\">af781cb</a></p>", "type": "rendered"}, "created_on": "2019-12-17T03:03:51.199576+00:00", "user": {"display_name": "Louise Poubel", "uuid": "{5cfa2075-477b-4ded-bdb9-8d2479544ec4}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D"}, "html": {"href": "https://bitbucket.org/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8/7d903d90-c5ea-4182-b7ef-0d467e9e1c74/128"}}, "nickname": "chapulina", "type": "user", "account_id": "557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8"}, "updated_on": "2019-12-17T03:03:51.208623+00:00", "type": "pullrequest_comment", "id": 129033298}, "pull_request": {"type": "pullrequest", "id": 397, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397"}}, "title": "[Blueprint] Logging meshes and materials"}}, {"update": {"description": "Depends on [ign-common PR 200](#!/ignitionrobotics/ign-common/pull-requests/200/log-resources/diff).\r\n\r\nPorts [this Gazebo PR](https://bitbucket.org/osrf/gazebo/pull-requests/2811/save-models-material-and-meshes-when/diff) to Ignition.\r\n\r\nImplements `--record-resources`, and `--log-compress` and `--log-overwrite` to support it.\r\n\r\nRecords resources \\(`--record-resources`\\), i.e. meshes and materials, to a directory under the specified log record directory. Optionally compresses \\(`--log-compress`\\) the whole directory, which contains the existing `.tlog` sqlite3 file and any resources, to a zip file. If directory or compressed file already exist, optionally overwrites \\(`--log-overwrite`\\).\r\n\r\nCorresponding SDF plugin parameters: `<record_resources>1</record_resources>`, `<compress>1</compress>.`If both command line and SDF parameters are specified, command line option overwrites SDF parameter. `--log-overwrite` is handled on command line only, outside of the plugin. If recording is only enabled from SDF and not from command line, then behavior is to always overwrite.\r\n\r\n## Usage:\r\n\r\n```\r\nign gazebo [...] --record-resources --log-overwrite --log-compress\r\n```\r\n\r\n## Test --record-resources:\r\n\r\n```\r\n# This SDF specifies the equivalent of --record-resources --record-path '/tmp/log'\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf\r\n$ ign gazebo -v 4 -r examples/worlds/log_playback.sdf\r\n```\r\n\r\nTested with `<include><uri>https://fuel...</uri></include>` and `<mesh><uri>file://...</uri></mesh>`. Paths specified by `model://` are not supported in Ignition yet, so this case in the code is not tested.\r\n\r\n## Test --log-overwrite and --log-compress:\r\n\r\nWhen recording to `path`, the compression file is implied to be `path.zip`. Both are checked for existence.\r\n\r\nNo `--log-overwrite` \\(default\\):\r\n\r\n```\r\n# This SDF specifies the equivalent of --record-path '/tmp/log'\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf\r\n\r\n# Run it again. By default it will always overwrite, because overwrite is now taken care of in ign.cc\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf\r\n[Msg] Overwriting existing file [/tmp/log/state.tlog]\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n```\r\n\r\n`--log-overwrite`, `/tmp/log` already exists:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-overwrite --record-path '/tmp/log'\r\n[Msg] Log path already exists on disk! Existing files will be overwritten.\r\n[Msg] Removing existing path [/tmp/log]\r\n...\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n...\r\n[Msg] Stopping recording\r\n```\r\n\r\n`--log-overwrite --log-compress`, `/tmp/log` exists, `/tmp/log.zip` does not exist:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-compress --log-overwrite --record-path '/tmp/log'\r\n[Msg] Log path already exists on disk! Existing files will be overwritten.\r\n[Msg] Removing existing path [/tmp/log]\r\n...\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n...\r\n[Msg] Compressed log file and resources to [/tmp/log.zip].\r\nRemoving recorded directory [/tmp/log].\r\n[Msg] Stopping recording\r\n```\r\n\r\n`--log-overwrite --log-compress`, `/tmp/log` does not exist, `/tmp/log.zip` exists:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-compress --log-overwrite --record-path '/tmp/log'\r\n[Wrn] [ign.cc:121] Compressed log path already exists on disk! Existing files will be overwritten.\r\n[Msg] Removing existing compressed file [/tmp/log.zip]\r\n...\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n...\r\n[Msg] Compressed log file and resources to [/tmp/log.zip].\r\nRemoving recorded directory [/tmp/log].\r\n[Msg] Stopping recording\r\n```\r\n\r\n`--log-overwrite` only, `/tmp/log.zip` exists, `/tmp/log` does not exist:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-overwrite --record-path '/tmp/log'\r\n[Msg] Removing existing compressed file [/tmp/log.zip]\r\n...\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n...\r\n[Msg] Stopping recording\r\n```\r\n\r\n`--log-compress` only, both `/tmp/log` and `/tmp/log.zip` already exist:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-compress --record-path '/tmp/log'\r\n[Wrn] [ign.cc:152] Log path already exists on disk! Recording instead to [/tmp/log(1)]\r\n[Wrn] [ign.cc:154] Compressed log path already exists on disk! Recording instead to [/tmp/log(1).zip]\r\n...\r\n[Msg] Recording to log file [/tmp/log(1)/state.tlog]\r\n...\r\n[Msg] Compressed log file and resources to [/tmp/log(1).zip].\r\nRemoving recorded directory [/tmp/log(1)].\r\n[Msg] Stopping recording\r\n$ ls /tmp\r\nlog\r\n'log(1).zip'\r\nlog.zip\r\n```\r\n\r\n`--log-compress` only, `/tmp/log` does not exist, `/tmp/log.zip` exists, `/tmp/log(1).zip` exists:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-compress --record-path '/tmp/log'\r\n[Wrn] [ign.cc:152] Log path already exists on disk! Recording instead to [/tmp/log(2)]\r\n[Wrn] [ign.cc:154] Compressed log path already exists on disk! Recording instead to [/tmp/log(2).zip]\r\n...\r\n[Msg] Recording to log file [/tmp/log(2)/state.tlog]\r\n...\r\n[Msg] Compressed log file and resources to [/tmp/log(2).zip].\r\nRemoving recorded directory [/tmp/log(2)].\r\n[Msg] Stopping recording\r\n```\r\n\r\n## Record Path vs. Console Log Path\r\n\r\nIn Blueprint and Citadel, if `--record` is specified without `--record-path`, and `<path>` exists in SDF, a warning is printed, and recording will go to `<path>`, while console log will go to the default timestamp path.\r\n\r\nAs in this example:\r\n\r\n```\r\n# SDF specifies <path>/tmp/log</path>\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --record --log-compress -log-overwrite\r\n[Wrn] [ServerPrivate.cc:229] --record-path is not specified on command line. <path> is specified in SDF. Will record to <path>. Console will be logged to [/home/master/.ignition/gazebo/log/2019-09-20T19:51:33.996055619]. Note: In Ignition-D, <path> will be ignored, and all recordings will be written to default console log path if no path is specified on command line.\r\n[Msg] Overwriting existing file [/tmp/log/state.tlog]\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n...\r\n[Msg] Removing existing file [/tmp/log.zip].\r\n[Msg] Compressed log file and resources to [/tmp/log.zip].\r\nRemoving recorded directory [/tmp/log].\r\n```\r\n\r\nIn Ignition-D, `<path>` will be permanently ignored. Recordings and console log will go to same default path.\r\n\r\nIf `--record-path` is specified, then recording and console log will go to this path in Blueprint, Citadel, and Ignition-D.\r\n\r\n## Future Work\r\n\r\nFiles are outputted in `/tmp/log` and `/tmp/log.zip` in this example. During record, the original path in `file://` is prepended with the specified path, e.g. `/tmp/log`. During playback, the specified path is prepended to the URIs in the SDF.", "title": "[Blueprint] Logging meshes and materials", "destination": {"commit": {"hash": "d21db16d0d03", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/commit/d21db16d0d03.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/commits/d21db16d0d03"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{f98d11fe-f287-4dfb-99c3-e2b76a13232e}ts=2082645"}}, "type": "repository", "name": "ign-gazebo", "full_name": "ignitionrobotics/ign-gazebo", "uuid": "{f98d11fe-f287-4dfb-99c3-e2b76a13232e}"}, "branch": {"name": "ign-gazebo2"}}, "reason": "", "source": {"commit": {"hash": "4901b192062c", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/commit/4901b192062c.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/commits/4901b192062c"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{f98d11fe-f287-4dfb-99c3-e2b76a13232e}ts=2082645"}}, "type": "repository", "name": "ign-gazebo", "full_name": "ignitionrobotics/ign-gazebo", "uuid": "{f98d11fe-f287-4dfb-99c3-e2b76a13232e}"}, "branch": {"name": "log_resources"}}, "state": "OPEN", "author": {"display_name": "Louise Poubel", "uuid": "{5cfa2075-477b-4ded-bdb9-8d2479544ec4}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D"}, "html": {"href": "https://bitbucket.org/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8/7d903d90-c5ea-4182-b7ef-0d467e9e1c74/128"}}, "nickname": "chapulina", "type": "user", "account_id": "557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8"}, "date": "2019-12-17T03:03:11.863687+00:00"}, "pull_request": {"type": "pullrequest", "id": 397, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397"}}, "title": "[Blueprint] Logging meshes and materials"}}, {"comment": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397/comments/129030739.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397/_/diff#comment-129030739"}}, "parent": {"id": 129026686, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397/comments/129026686.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397/_/diff#comment-129026686"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 397, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397"}}, "title": "[Blueprint] Logging meshes and materials"}, "content": {"raw": "d81edaf", "markup": "markdown", "html": "<p><a href=\"#!/ignitionrobotics/ign-gazebo/commits/d81edaf\" rel=\"nofollow\" class=\"ap-connect-link\">d81edaf</a></p>", "type": "rendered"}, "created_on": "2019-12-17T02:11:01.579589+00:00", "user": {"display_name": "Mabel Zhang", "uuid": "{4b0e38fb-bf50-45c0-a496-61147518b2bf}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B4b0e38fb-bf50-45c0-a496-61147518b2bf%7D"}, "html": {"href": "https://bitbucket.org/%7B4b0e38fb-bf50-45c0-a496-61147518b2bf%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:ceb5942c-6843-408c-8550-3ce4899d299b/4d48e5ea-cf28-4fa7-9715-8fc9e315d831/128"}}, "nickname": "mabelmzhang", "type": "user", "account_id": "557058:ceb5942c-6843-408c-8550-3ce4899d299b"}, "inline": {}, "updated_on": "2019-12-17T02:11:01.587790+00:00", "type": "pullrequest_comment", "id": 129030739}, "pull_request": {"type": "pullrequest", "id": 397, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397"}}, "title": "[Blueprint] Logging meshes and materials"}}, {"update": {"description": "Depends on [ign-common PR 200](#!/ignitionrobotics/ign-common/pull-requests/200/log-resources/diff).\r\n\r\nPorts [this Gazebo PR](https://bitbucket.org/osrf/gazebo/pull-requests/2811/save-models-material-and-meshes-when/diff) to Ignition.\r\n\r\nImplements `--record-resources`, and `--log-compress` and `--log-overwrite` to support it.\r\n\r\nRecords resources \\(`--record-resources`\\), i.e. meshes and materials, to a directory under the specified log record directory. Optionally compresses \\(`--log-compress`\\) the whole directory, which contains the existing `.tlog` sqlite3 file and any resources, to a zip file. If directory or compressed file already exist, optionally overwrites \\(`--log-overwrite`\\).\r\n\r\nCorresponding SDF plugin parameters: `<record_resources>1</record_resources>`, `<compress>1</compress>.`If both command line and SDF parameters are specified, command line option overwrites SDF parameter. `--log-overwrite` is handled on command line only, outside of the plugin. If recording is only enabled from SDF and not from command line, then behavior is to always overwrite.\r\n\r\n## Usage:\r\n\r\n```\r\nign gazebo [...] --record-resources --log-overwrite --log-compress\r\n```\r\n\r\n## Test --record-resources:\r\n\r\n```\r\n# This SDF specifies the equivalent of --record-resources --record-path '/tmp/log'\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf\r\n$ ign gazebo -v 4 -r examples/worlds/log_playback.sdf\r\n```\r\n\r\nTested with `<include><uri>https://fuel...</uri></include>` and `<mesh><uri>file://...</uri></mesh>`. Paths specified by `model://` are not supported in Ignition yet, so this case in the code is not tested.\r\n\r\n## Test --log-overwrite and --log-compress:\r\n\r\nWhen recording to `path`, the compression file is implied to be `path.zip`. Both are checked for existence.\r\n\r\nNo `--log-overwrite` \\(default\\):\r\n\r\n```\r\n# This SDF specifies the equivalent of --record-path '/tmp/log'\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf\r\n\r\n# Run it again. By default it will always overwrite, because overwrite is now taken care of in ign.cc\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf\r\n[Msg] Overwriting existing file [/tmp/log/state.tlog]\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n```\r\n\r\n`--log-overwrite`, `/tmp/log` already exists:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-overwrite --record-path '/tmp/log'\r\n[Msg] Log path already exists on disk! Existing files will be overwritten.\r\n[Msg] Removing existing path [/tmp/log]\r\n...\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n...\r\n[Msg] Stopping recording\r\n```\r\n\r\n`--log-overwrite --log-compress`, `/tmp/log` exists, `/tmp/log.zip` does not exist:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-compress --log-overwrite --record-path '/tmp/log'\r\n[Msg] Log path already exists on disk! Existing files will be overwritten.\r\n[Msg] Removing existing path [/tmp/log]\r\n...\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n...\r\n[Msg] Compressed log file and resources to [/tmp/log.zip].\r\nRemoving recorded directory [/tmp/log].\r\n[Msg] Stopping recording\r\n```\r\n\r\n`--log-overwrite --log-compress`, `/tmp/log` does not exist, `/tmp/log.zip` exists:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-compress --log-overwrite --record-path '/tmp/log'\r\n[Wrn] [ign.cc:121] Compressed log path already exists on disk! Existing files will be overwritten.\r\n[Msg] Removing existing compressed file [/tmp/log.zip]\r\n...\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n...\r\n[Msg] Compressed log file and resources to [/tmp/log.zip].\r\nRemoving recorded directory [/tmp/log].\r\n[Msg] Stopping recording\r\n```\r\n\r\n`--log-overwrite` only, `/tmp/log.zip` exists, `/tmp/log` does not exist:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-overwrite --record-path '/tmp/log'\r\n[Msg] Removing existing compressed file [/tmp/log.zip]\r\n...\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n...\r\n[Msg] Stopping recording\r\n```\r\n\r\n`--log-compress` only, both `/tmp/log` and `/tmp/log.zip` already exist:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-compress --record-path '/tmp/log'\r\n[Wrn] [ign.cc:152] Log path already exists on disk! Recording instead to [/tmp/log(1)]\r\n[Wrn] [ign.cc:154] Compressed log path already exists on disk! Recording instead to [/tmp/log(1).zip]\r\n...\r\n[Msg] Recording to log file [/tmp/log(1)/state.tlog]\r\n...\r\n[Msg] Compressed log file and resources to [/tmp/log(1).zip].\r\nRemoving recorded directory [/tmp/log(1)].\r\n[Msg] Stopping recording\r\n$ ls /tmp\r\nlog\r\n'log(1).zip'\r\nlog.zip\r\n```\r\n\r\n`--log-compress` only, `/tmp/log` does not exist, `/tmp/log.zip` exists, `/tmp/log(1).zip` exists:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-compress --record-path '/tmp/log'\r\n[Wrn] [ign.cc:152] Log path already exists on disk! Recording instead to [/tmp/log(2)]\r\n[Wrn] [ign.cc:154] Compressed log path already exists on disk! Recording instead to [/tmp/log(2).zip]\r\n...\r\n[Msg] Recording to log file [/tmp/log(2)/state.tlog]\r\n...\r\n[Msg] Compressed log file and resources to [/tmp/log(2).zip].\r\nRemoving recorded directory [/tmp/log(2)].\r\n[Msg] Stopping recording\r\n```\r\n\r\n## Record Path vs. Console Log Path\r\n\r\nIn Blueprint and Citadel, if `--record` is specified without `--record-path`, and `<path>` exists in SDF, a warning is printed, and recording will go to `<path>`, while console log will go to the default timestamp path.\r\n\r\nAs in this example:\r\n\r\n```\r\n# SDF specifies <path>/tmp/log</path>\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --record --log-compress -log-overwrite\r\n[Wrn] [ServerPrivate.cc:229] --record-path is not specified on command line. <path> is specified in SDF. Will record to <path>. Console will be logged to [/home/master/.ignition/gazebo/log/2019-09-20T19:51:33.996055619]. Note: In Ignition-D, <path> will be ignored, and all recordings will be written to default console log path if no path is specified on command line.\r\n[Msg] Overwriting existing file [/tmp/log/state.tlog]\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n...\r\n[Msg] Removing existing file [/tmp/log.zip].\r\n[Msg] Compressed log file and resources to [/tmp/log.zip].\r\nRemoving recorded directory [/tmp/log].\r\n```\r\n\r\nIn Ignition-D, `<path>` will be permanently ignored. Recordings and console log will go to same default path.\r\n\r\nIf `--record-path` is specified, then recording and console log will go to this path in Blueprint, Citadel, and Ignition-D.\r\n\r\n## Future Work\r\n\r\nFiles are outputted in `/tmp/log` and `/tmp/log.zip` in this example. During record, the original path in `file://` is prepended with the specified path, e.g. `/tmp/log`. During playback, the specified path is prepended to the URIs in the SDF.", "title": "[Blueprint] Logging meshes and materials", "destination": {"commit": {"hash": "d21db16d0d03", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/commit/d21db16d0d03.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/commits/d21db16d0d03"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{f98d11fe-f287-4dfb-99c3-e2b76a13232e}ts=2082645"}}, "type": "repository", "name": "ign-gazebo", "full_name": "ignitionrobotics/ign-gazebo", "uuid": "{f98d11fe-f287-4dfb-99c3-e2b76a13232e}"}, "branch": {"name": "ign-gazebo2"}}, "reason": "", "source": {"commit": {"hash": "d81edaf1c328", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/commit/d81edaf1c328.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/commits/d81edaf1c328"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{f98d11fe-f287-4dfb-99c3-e2b76a13232e}ts=2082645"}}, "type": "repository", "name": "ign-gazebo", "full_name": "ignitionrobotics/ign-gazebo", "uuid": "{f98d11fe-f287-4dfb-99c3-e2b76a13232e}"}, "branch": {"name": "log_resources"}}, "state": "OPEN", "author": {"display_name": "Mabel Zhang", "uuid": "{4b0e38fb-bf50-45c0-a496-61147518b2bf}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B4b0e38fb-bf50-45c0-a496-61147518b2bf%7D"}, "html": {"href": "https://bitbucket.org/%7B4b0e38fb-bf50-45c0-a496-61147518b2bf%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:ceb5942c-6843-408c-8550-3ce4899d299b/4d48e5ea-cf28-4fa7-9715-8fc9e315d831/128"}}, "nickname": "mabelmzhang", "type": "user", "account_id": "557058:ceb5942c-6843-408c-8550-3ce4899d299b"}, "date": "2019-12-17T02:10:39.547069+00:00"}, "pull_request": {"type": "pullrequest", "id": 397, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397"}}, "title": "[Blueprint] Logging meshes and materials"}}, {"update": {"description": "Depends on [ign-common PR 200](#!/ignitionrobotics/ign-common/pull-requests/200/log-resources/diff).\r\n\r\nPorts [this Gazebo PR](https://bitbucket.org/osrf/gazebo/pull-requests/2811/save-models-material-and-meshes-when/diff) to Ignition.\r\n\r\nImplements `--record-resources`, and `--log-compress` and `--log-overwrite` to support it.\r\n\r\nRecords resources \\(`--record-resources`\\), i.e. meshes and materials, to a directory under the specified log record directory. Optionally compresses \\(`--log-compress`\\) the whole directory, which contains the existing `.tlog` sqlite3 file and any resources, to a zip file. If directory or compressed file already exist, optionally overwrites \\(`--log-overwrite`\\).\r\n\r\nCorresponding SDF plugin parameters: `<record_resources>1</record_resources>`, `<compress>1</compress>.`If both command line and SDF parameters are specified, command line option overwrites SDF parameter. `--log-overwrite` is handled on command line only, outside of the plugin. If recording is only enabled from SDF and not from command line, then behavior is to always overwrite.\r\n\r\n## Usage:\r\n\r\n```\r\nign gazebo [...] --record-resources --log-overwrite --log-compress\r\n```\r\n\r\n## Test --record-resources:\r\n\r\n```\r\n# This SDF specifies the equivalent of --record-resources --record-path '/tmp/log'\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf\r\n$ ign gazebo -v 4 -r examples/worlds/log_playback.sdf\r\n```\r\n\r\nTested with `<include><uri>https://fuel...</uri></include>` and `<mesh><uri>file://...</uri></mesh>`. Paths specified by `model://` are not supported in Ignition yet, so this case in the code is not tested.\r\n\r\n## Test --log-overwrite and --log-compress:\r\n\r\nWhen recording to `path`, the compression file is implied to be `path.zip`. Both are checked for existence.\r\n\r\nNo `--log-overwrite` \\(default\\):\r\n\r\n```\r\n# This SDF specifies the equivalent of --record-path '/tmp/log'\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf\r\n\r\n# Run it again. By default it will always overwrite, because overwrite is now taken care of in ign.cc\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf\r\n[Msg] Overwriting existing file [/tmp/log/state.tlog]\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n```\r\n\r\n`--log-overwrite`, `/tmp/log` already exists:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-overwrite --record-path '/tmp/log'\r\n[Msg] Log path already exists on disk! Existing files will be overwritten.\r\n[Msg] Removing existing path [/tmp/log]\r\n...\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n...\r\n[Msg] Stopping recording\r\n```\r\n\r\n`--log-overwrite --log-compress`, `/tmp/log` exists, `/tmp/log.zip` does not exist:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-compress --log-overwrite --record-path '/tmp/log'\r\n[Msg] Log path already exists on disk! Existing files will be overwritten.\r\n[Msg] Removing existing path [/tmp/log]\r\n...\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n...\r\n[Msg] Compressed log file and resources to [/tmp/log.zip].\r\nRemoving recorded directory [/tmp/log].\r\n[Msg] Stopping recording\r\n```\r\n\r\n`--log-overwrite --log-compress`, `/tmp/log` does not exist, `/tmp/log.zip` exists:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-compress --log-overwrite --record-path '/tmp/log'\r\n[Wrn] [ign.cc:121] Compressed log path already exists on disk! Existing files will be overwritten.\r\n[Msg] Removing existing compressed file [/tmp/log.zip]\r\n...\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n...\r\n[Msg] Compressed log file and resources to [/tmp/log.zip].\r\nRemoving recorded directory [/tmp/log].\r\n[Msg] Stopping recording\r\n```\r\n\r\n`--log-overwrite` only, `/tmp/log.zip` exists, `/tmp/log` does not exist:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-overwrite --record-path '/tmp/log'\r\n[Msg] Removing existing compressed file [/tmp/log.zip]\r\n...\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n...\r\n[Msg] Stopping recording\r\n```\r\n\r\n`--log-compress` only, both `/tmp/log` and `/tmp/log.zip` already exist:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-compress --record-path '/tmp/log'\r\n[Wrn] [ign.cc:152] Log path already exists on disk! Recording instead to [/tmp/log(1)]\r\n[Wrn] [ign.cc:154] Compressed log path already exists on disk! Recording instead to [/tmp/log(1).zip]\r\n...\r\n[Msg] Recording to log file [/tmp/log(1)/state.tlog]\r\n...\r\n[Msg] Compressed log file and resources to [/tmp/log(1).zip].\r\nRemoving recorded directory [/tmp/log(1)].\r\n[Msg] Stopping recording\r\n$ ls /tmp\r\nlog\r\n'log(1).zip'\r\nlog.zip\r\n```\r\n\r\n`--log-compress` only, `/tmp/log` does not exist, `/tmp/log.zip` exists, `/tmp/log(1).zip` exists:\r\n\r\n```\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --log-compress --record-path '/tmp/log'\r\n[Wrn] [ign.cc:152] Log path already exists on disk! Recording instead to [/tmp/log(2)]\r\n[Wrn] [ign.cc:154] Compressed log path already exists on disk! Recording instead to [/tmp/log(2).zip]\r\n...\r\n[Msg] Recording to log file [/tmp/log(2)/state.tlog]\r\n...\r\n[Msg] Compressed log file and resources to [/tmp/log(2).zip].\r\nRemoving recorded directory [/tmp/log(2)].\r\n[Msg] Stopping recording\r\n```\r\n\r\n## Record Path vs. Console Log Path\r\n\r\nIn Blueprint and Citadel, if `--record` is specified without `--record-path`, and `<path>` exists in SDF, a warning is printed, and recording will go to `<path>`, while console log will go to the default timestamp path.\r\n\r\nAs in this example:\r\n\r\n```\r\n# SDF specifies <path>/tmp/log</path>\r\n$ ign gazebo -v 4 -r examples/worlds/log_record_resources.sdf --record --log-compress -log-overwrite\r\n[Wrn] [ServerPrivate.cc:229] --record-path is not specified on command line. <path> is specified in SDF. Will record to <path>. Console will be logged to [/home/master/.ignition/gazebo/log/2019-09-20T19:51:33.996055619]. Note: In Ignition-D, <path> will be ignored, and all recordings will be written to default console log path if no path is specified on command line.\r\n[Msg] Overwriting existing file [/tmp/log/state.tlog]\r\n[Msg] Recording to log file [/tmp/log/state.tlog]\r\n...\r\n[Msg] Removing existing file [/tmp/log.zip].\r\n[Msg] Compressed log file and resources to [/tmp/log.zip].\r\nRemoving recorded directory [/tmp/log].\r\n```\r\n\r\nIn Ignition-D, `<path>` will be permanently ignored. Recordings and console log will go to same default path.\r\n\r\nIf `--record-path` is specified, then recording and console log will go to this path in Blueprint, Citadel, and Ignition-D.\r\n\r\n## Future Work\r\n\r\nFiles are outputted in `/tmp/log` and `/tmp/log.zip` in this example. During record, the original path in `file://` is prepended with the specified path, e.g. `/tmp/log`. During playback, the specified path is prepended to the URIs in the SDF.", "title": "[Blueprint] Logging meshes and materials", "destination": {"commit": {"hash": "d21db16d0d03", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/commit/d21db16d0d03.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/commits/d21db16d0d03"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{f98d11fe-f287-4dfb-99c3-e2b76a13232e}ts=2082645"}}, "type": "repository", "name": "ign-gazebo", "full_name": "ignitionrobotics/ign-gazebo", "uuid": "{f98d11fe-f287-4dfb-99c3-e2b76a13232e}"}, "branch": {"name": "ign-gazebo2"}}, "reason": "", "source": {"commit": {"hash": "5e65a699e032", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/commit/5e65a699e032.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/commits/5e65a699e032"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{f98d11fe-f287-4dfb-99c3-e2b76a13232e}ts=2082645"}}, "type": "repository", "name": "ign-gazebo", "full_name": "ignitionrobotics/ign-gazebo", "uuid": "{f98d11fe-f287-4dfb-99c3-e2b76a13232e}"}, "branch": {"name": "log_resources"}}, "state": "OPEN", "author": {"display_name": "Mabel Zhang", "uuid": "{4b0e38fb-bf50-45c0-a496-61147518b2bf}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B4b0e38fb-bf50-45c0-a496-61147518b2bf%7D"}, "html": {"href": "https://bitbucket.org/%7B4b0e38fb-bf50-45c0-a496-61147518b2bf%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:ceb5942c-6843-408c-8550-3ce4899d299b/4d48e5ea-cf28-4fa7-9715-8fc9e315d831/128"}}, "nickname": "mabelmzhang", "type": "user", "account_id": "557058:ceb5942c-6843-408c-8550-3ce4899d299b"}, "date": "2019-12-17T02:09:10.288585+00:00"}, "pull_request": {"type": "pullrequest", "id": 397, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397"}}, "title": "[Blueprint] Logging meshes and materials"}}, {"comment": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397/comments/129026720.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397/_/diff#comment-129026720"}}, "parent": {"id": 129025142, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397/comments/129025142.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397/_/diff#comment-129025142"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 397, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397"}}, "title": "[Blueprint] Logging meshes and materials"}, "content": {"raw": "c7c133a", "markup": "markdown", "html": "<p><a href=\"#!/ignitionrobotics/ign-gazebo/commits/c7c133a\" rel=\"nofollow\" class=\"ap-connect-link\">c7c133a</a></p>", "type": "rendered"}, "created_on": "2019-12-17T00:50:33.548976+00:00", "user": {"display_name": "Mabel Zhang", "uuid": "{4b0e38fb-bf50-45c0-a496-61147518b2bf}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B4b0e38fb-bf50-45c0-a496-61147518b2bf%7D"}, "html": {"href": "https://bitbucket.org/%7B4b0e38fb-bf50-45c0-a496-61147518b2bf%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:ceb5942c-6843-408c-8550-3ce4899d299b/4d48e5ea-cf28-4fa7-9715-8fc9e315d831/128"}}, "nickname": "mabelmzhang", "type": "user", "account_id": "557058:ceb5942c-6843-408c-8550-3ce4899d299b"}, "inline": {}, "updated_on": "2019-12-17T00:50:33.555780+00:00", "type": "pullrequest_comment", "id": 129026720}, "pull_request": {"type": "pullrequest", "id": 397, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/397"}}, "title": "[Blueprint] Logging meshes and materials"}}], "next": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/397/activity_ctx=8ys7sps9.json"}