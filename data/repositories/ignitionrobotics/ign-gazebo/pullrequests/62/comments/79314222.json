{"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/62/comments/79314222.json"}, "code": {"href": "https://api.bitbucket.org/2.0/repositories/ignitionrobotics/ign-gazebo/diff/ignitionrobotics/ign-gazebo:ab020bc83e73..14a619f929f7?path=src%2FSimulationRunner.cc"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/62/_/diff#comment-79314222"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 62, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/pullrequests/62.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/pull-requests/62"}}, "title": "Erase entity [Ready for review]"}, "content": {"raw": "The integration test is segfaulting here:\n\n~~~\nThread 1 \"INTEGRATION_ent\" received signal SIGSEGV, Segmentation fault.           \n0x000055555558e0a6 in std::__cxx11::basic_string<char, std::char_traits<char>, std\n::allocator<char> >::size (this=0x0)                                              \n    at /usr/include/c++/8/bits/basic_string.h:912                                 \n912           { return _M_string_length; }                                        \n(gdb) bt                                                                          \n#0  0x000055555558e0a6 in std::__cxx11::basic_string<char, std::char_traits<char>,\n std::allocator<char> >::size (this=0x0)                                          \n    at /usr/include/c++/8/bits/basic_string.h:912                                 \n#1  0x00005555555fa964 in std::operator==<char> (                                 \n    __lhs=<error reading variable: Cannot access memory at address 0x8>,          \n    __rhs=\"box\") at /usr/include/c++/8/bits/basic_string.h:6019                   \n#2  0x00007ffff7a7f5ed in ignition::gazebo::v0::SimulationRunner::<lambda(ignition\n::gazebo::v0::EntityId, const ignition::gazebo::components::v0::Name*)>::operator(\n)(ignition::gazebo::v0::EntityId, const ignition::gazebo::components::v0::Name *) \nconst (__closure=0x7fffffffde90, _entityName=0x5555564ed6e0)                      \n    at /home/developer/ign-gazebo/src/SimulationRunner.cc:589                     \n#3  0x00007ffff7a801ef in std::_Function_handler<bool(int const&, const ignition:$gazebo::components::v0::Name*), ignition::gazebo::v0::SimulationRunner::HasEntity$const string&) const::<lambda(ignition::gazebo::v0::EntityId, const ignition::gaz$bo::components::v0::Name*)> >::_M_invoke(const std::_Any_data &, const int &, con$t ignition::gazebo::components::v0::Name *&&) (__functor=...,\n    __args#0=@0x7fffffffde34: 12, __args#1=@0x7fffffffdde8: 0x5555564ed6e0)\n    at /usr/include/c++/8/bits/std_function.h:282\n#4  0x00007ffff7a8e4bf in std::function<bool (int const&, ignition::gazebo::compo$ents::v0::Name const*)>::operator()(int const&, ignition::gazebo::components::v0:$Name const*) const (this=0x7fffffffde90, __args#0=@0x7fffffffde34: 12,\n    __args#1=0x5555564ed6e0) at /usr/include/c++/8/bits/std_function.h:687\n#5  0x00007ffff7a87fe4 in ignition::gazebo::v0::EntityComponentManager::Each<igni$ion::gazebo::components::v0::Name>(ignition::gazebo::v0::EntityComponentManager::$dentity<std::function<bool (int const&, ignition::gazebo::components::v0::Name co$st*)> >::type) const (this=0x5555564ebb70, _f=...)\n    at /home/developer/ign-gazebo/include/ignition/gazebo/EntityComponentManager.$h:578\n#6  0x00007ffff7a7f6b7 in ignition::gazebo::v0::SimulationRunner::HasEntity (\n    this=0x5555564ebb00, _name=\"box\")\n    at /home/developer/ign-gazebo/src/SimulationRunner.cc:586\n#7  0x00007ffff7a56ca8 in ignition::gazebo::v0::Server::HasEntity (\n    this=0x7fffffffdf40, _name=\"box\", _worldIndex=0)\n    at /home/developer/ign-gazebo/src/Server.cc:271\n#8  0x00005555555890a1 in PhysicsSystemFixture_CreatePhysicsWorld_Test::TestBody\n    (this=0x5555559a73b0)\n~~~", "markup": "markdown", "html": "<p>The integration test is segfaulting here:</p>\n<div class=\"codehilite\"><pre><span></span><span class=\"n\">Thread</span> <span class=\"mi\">1</span> <span class=\"s\">&quot;INTEGRATION_ent&quot;</span> <span class=\"n\">received</span> <span class=\"n\">signal</span> <span class=\"n\">SIGSEGV</span><span class=\"p\">,</span> <span class=\"n\">Segmentation</span> <span class=\"n\">fault</span><span class=\"p\">.</span>           \n<span class=\"mh\">0x000055555558e0a6</span> <span class=\"k\">in</span> <span class=\"n\">std</span><span class=\"o\">::</span><span class=\"n\">__cxx11</span><span class=\"o\">::</span><span class=\"n\">basic_string</span><span class=\"o\">&lt;</span><span class=\"kt\">char</span><span class=\"p\">,</span> <span class=\"n\">std</span><span class=\"o\">::</span><span class=\"n\">char_traits</span><span class=\"o\">&lt;</span><span class=\"kt\">char</span><span class=\"o\">&gt;</span><span class=\"p\">,</span> <span class=\"n\">std</span>\n<span class=\"o\">::</span><span class=\"n\">allocator</span><span class=\"o\">&lt;</span><span class=\"kt\">char</span><span class=\"o\">&gt;</span> <span class=\"o\">&gt;::</span><span class=\"n\">size</span> <span class=\"p\">(</span><span class=\"n\">this</span><span class=\"o\">=</span><span class=\"mh\">0x0</span><span class=\"p\">)</span>                                              \n    <span class=\"n\">at</span> <span class=\"o\">/</span><span class=\"n\">usr</span><span class=\"o\">/</span><span class=\"n\">include</span><span class=\"o\">/</span><span class=\"n\">c</span><span class=\"o\">++/</span><span class=\"mi\">8</span><span class=\"o\">/</span><span class=\"n\">bits</span><span class=\"o\">/</span><span class=\"n\">basic_string</span><span class=\"p\">.</span><span class=\"nl\">h</span><span class=\"p\">:</span><span class=\"mi\">912</span>                                 \n<span class=\"mi\">912</span>           <span class=\"p\">{</span> <span class=\"k\">return</span> <span class=\"n\">_M_string_length</span><span class=\"p\">;</span> <span class=\"p\">}</span>                                        \n<span class=\"p\">(</span><span class=\"n\">gdb</span><span class=\"p\">)</span> <span class=\"n\">bt</span>                                                                          \n<span class=\"cp\">#0  0x000055555558e0a6 in std::__cxx11::basic_string&lt;char, std::char_traits&lt;char&gt;,</span>\n <span class=\"n\">std</span><span class=\"o\">::</span><span class=\"n\">allocator</span><span class=\"o\">&lt;</span><span class=\"kt\">char</span><span class=\"o\">&gt;</span> <span class=\"o\">&gt;::</span><span class=\"n\">size</span> <span class=\"p\">(</span><span class=\"n\">this</span><span class=\"o\">=</span><span class=\"mh\">0x0</span><span class=\"p\">)</span>                                          \n    <span class=\"n\">at</span> <span class=\"o\">/</span><span class=\"n\">usr</span><span class=\"o\">/</span><span class=\"n\">include</span><span class=\"o\">/</span><span class=\"n\">c</span><span class=\"o\">++/</span><span class=\"mi\">8</span><span class=\"o\">/</span><span class=\"n\">bits</span><span class=\"o\">/</span><span class=\"n\">basic_string</span><span class=\"p\">.</span><span class=\"nl\">h</span><span class=\"p\">:</span><span class=\"mi\">912</span>                                 \n<span class=\"cp\">#1  0x00005555555fa964 in std::operator==&lt;char&gt; (                                 </span>\n    <span class=\"n\">__lhs</span><span class=\"o\">=&lt;</span><span class=\"n\">error</span> <span class=\"n\">reading</span> <span class=\"nl\">variable</span><span class=\"p\">:</span> <span class=\"n\">Cannot</span> <span class=\"n\">access</span> <span class=\"n\">memory</span> <span class=\"n\">at</span> <span class=\"n\">address</span> <span class=\"mh\">0x8</span><span class=\"o\">&gt;</span><span class=\"p\">,</span>          \n    <span class=\"n\">__rhs</span><span class=\"o\">=</span><span class=\"s\">&quot;box&quot;</span><span class=\"p\">)</span> <span class=\"n\">at</span> <span class=\"o\">/</span><span class=\"n\">usr</span><span class=\"o\">/</span><span class=\"n\">include</span><span class=\"o\">/</span><span class=\"n\">c</span><span class=\"o\">++/</span><span class=\"mi\">8</span><span class=\"o\">/</span><span class=\"n\">bits</span><span class=\"o\">/</span><span class=\"n\">basic_string</span><span class=\"p\">.</span><span class=\"nl\">h</span><span class=\"p\">:</span><span class=\"mi\">6019</span>                   \n<span class=\"cp\">#2  0x00007ffff7a7f5ed in ignition::gazebo::v0::SimulationRunner::&lt;lambda(ignition</span>\n<span class=\"o\">::</span><span class=\"n\">gazebo</span><span class=\"o\">::</span><span class=\"n\">v0</span><span class=\"o\">::</span><span class=\"n\">EntityId</span><span class=\"p\">,</span> <span class=\"k\">const</span> <span class=\"n\">ignition</span><span class=\"o\">::</span><span class=\"n\">gazebo</span><span class=\"o\">::</span><span class=\"n\">components</span><span class=\"o\">::</span><span class=\"n\">v0</span><span class=\"o\">::</span><span class=\"n\">Name</span><span class=\"o\">*</span><span class=\"p\">)</span><span class=\"o\">&gt;::</span><span class=\"n\">operator</span><span class=\"p\">(</span>\n<span class=\"p\">)(</span><span class=\"n\">ignition</span><span class=\"o\">::</span><span class=\"n\">gazebo</span><span class=\"o\">::</span><span class=\"n\">v0</span><span class=\"o\">::</span><span class=\"n\">EntityId</span><span class=\"p\">,</span> <span class=\"k\">const</span> <span class=\"n\">ignition</span><span class=\"o\">::</span><span class=\"n\">gazebo</span><span class=\"o\">::</span><span class=\"n\">components</span><span class=\"o\">::</span><span class=\"n\">v0</span><span class=\"o\">::</span><span class=\"n\">Name</span> <span class=\"o\">*</span><span class=\"p\">)</span> \n<span class=\"k\">const</span> <span class=\"p\">(</span><span class=\"n\">__closure</span><span class=\"o\">=</span><span class=\"mh\">0x7fffffffde90</span><span class=\"p\">,</span> <span class=\"n\">_entityName</span><span class=\"o\">=</span><span class=\"mh\">0x5555564ed6e0</span><span class=\"p\">)</span>                      \n    <span class=\"n\">at</span> <span class=\"o\">/</span><span class=\"n\">home</span><span class=\"o\">/</span><span class=\"n\">developer</span><span class=\"o\">/</span><span class=\"n\">ign</span><span class=\"o\">-</span><span class=\"n\">gazebo</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">SimulationRunner</span><span class=\"p\">.</span><span class=\"nl\">cc</span><span class=\"p\">:</span><span class=\"mi\">589</span>                     \n<span class=\"cp\">#3  0x00007ffff7a801ef in std::_Function_handler&lt;bool(int const&amp;, const ignition:$gazebo::components::v0::Name*), ignition::gazebo::v0::SimulationRunner::HasEntity$const string&amp;) const::&lt;lambda(ignition::gazebo::v0::EntityId, const ignition::gaz$bo::components::v0::Name*)&gt; &gt;::_M_invoke(const std::_Any_data &amp;, const int &amp;, con$t ignition::gazebo::components::v0::Name *&amp;&amp;) (__functor=...,</span>\n    <span class=\"n\">__args</span><span class=\"err\">#</span><span class=\"mi\">0</span><span class=\"o\">=</span><span class=\"mh\">@0x7fffffffde34</span><span class=\"o\">:</span> <span class=\"mi\">12</span><span class=\"p\">,</span> <span class=\"n\">__args</span><span class=\"err\">#</span><span class=\"mi\">1</span><span class=\"o\">=</span><span class=\"mh\">@0x7fffffffdde8</span><span class=\"o\">:</span> <span class=\"mh\">0x5555564ed6e0</span><span class=\"p\">)</span>\n    <span class=\"n\">at</span> <span class=\"o\">/</span><span class=\"n\">usr</span><span class=\"o\">/</span><span class=\"n\">include</span><span class=\"o\">/</span><span class=\"n\">c</span><span class=\"o\">++/</span><span class=\"mi\">8</span><span class=\"o\">/</span><span class=\"n\">bits</span><span class=\"o\">/</span><span class=\"n\">std_function</span><span class=\"p\">.</span><span class=\"nl\">h</span><span class=\"p\">:</span><span class=\"mi\">282</span>\n<span class=\"cp\">#4  0x00007ffff7a8e4bf in std::function&lt;bool (int const&amp;, ignition::gazebo::compo$ents::v0::Name const*)&gt;::operator()(int const&amp;, ignition::gazebo::components::v0:$Name const*) const (this=0x7fffffffde90, __args#0=@0x7fffffffde34: 12,</span>\n    <span class=\"n\">__args</span><span class=\"err\">#</span><span class=\"mi\">1</span><span class=\"o\">=</span><span class=\"mh\">0x5555564ed6e0</span><span class=\"p\">)</span> <span class=\"n\">at</span> <span class=\"o\">/</span><span class=\"n\">usr</span><span class=\"o\">/</span><span class=\"n\">include</span><span class=\"o\">/</span><span class=\"n\">c</span><span class=\"o\">++/</span><span class=\"mi\">8</span><span class=\"o\">/</span><span class=\"n\">bits</span><span class=\"o\">/</span><span class=\"n\">std_function</span><span class=\"p\">.</span><span class=\"nl\">h</span><span class=\"p\">:</span><span class=\"mi\">687</span>\n<span class=\"cp\">#5  0x00007ffff7a87fe4 in ignition::gazebo::v0::EntityComponentManager::Each&lt;igni$ion::gazebo::components::v0::Name&gt;(ignition::gazebo::v0::EntityComponentManager::$dentity&lt;std::function&lt;bool (int const&amp;, ignition::gazebo::components::v0::Name co$st*)&gt; &gt;::type) const (this=0x5555564ebb70, _f=...)</span>\n    <span class=\"n\">at</span> <span class=\"o\">/</span><span class=\"n\">home</span><span class=\"o\">/</span><span class=\"n\">developer</span><span class=\"o\">/</span><span class=\"n\">ign</span><span class=\"o\">-</span><span class=\"n\">gazebo</span><span class=\"o\">/</span><span class=\"n\">include</span><span class=\"o\">/</span><span class=\"n\">ignition</span><span class=\"o\">/</span><span class=\"n\">gazebo</span><span class=\"o\">/</span><span class=\"n\">EntityComponentManager</span><span class=\"p\">.</span><span class=\"err\">$</span><span class=\"nl\">h</span><span class=\"p\">:</span><span class=\"mi\">578</span>\n<span class=\"cp\">#6  0x00007ffff7a7f6b7 in ignition::gazebo::v0::SimulationRunner::HasEntity (</span>\n    <span class=\"n\">this</span><span class=\"o\">=</span><span class=\"mh\">0x5555564ebb00</span><span class=\"p\">,</span> <span class=\"n\">_name</span><span class=\"o\">=</span><span class=\"s\">&quot;box&quot;</span><span class=\"p\">)</span>\n    <span class=\"n\">at</span> <span class=\"o\">/</span><span class=\"n\">home</span><span class=\"o\">/</span><span class=\"n\">developer</span><span class=\"o\">/</span><span class=\"n\">ign</span><span class=\"o\">-</span><span class=\"n\">gazebo</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">SimulationRunner</span><span class=\"p\">.</span><span class=\"nl\">cc</span><span class=\"p\">:</span><span class=\"mi\">586</span>\n<span class=\"cp\">#7  0x00007ffff7a56ca8 in ignition::gazebo::v0::Server::HasEntity (</span>\n    <span class=\"n\">this</span><span class=\"o\">=</span><span class=\"mh\">0x7fffffffdf40</span><span class=\"p\">,</span> <span class=\"n\">_name</span><span class=\"o\">=</span><span class=\"s\">&quot;box&quot;</span><span class=\"p\">,</span> <span class=\"n\">_worldIndex</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"p\">)</span>\n    <span class=\"n\">at</span> <span class=\"o\">/</span><span class=\"n\">home</span><span class=\"o\">/</span><span class=\"n\">developer</span><span class=\"o\">/</span><span class=\"n\">ign</span><span class=\"o\">-</span><span class=\"n\">gazebo</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">Server</span><span class=\"p\">.</span><span class=\"nl\">cc</span><span class=\"p\">:</span><span class=\"mi\">271</span>\n<span class=\"cp\">#8  0x00005555555890a1 in PhysicsSystemFixture_CreatePhysicsWorld_Test::TestBody</span>\n    <span class=\"p\">(</span><span class=\"n\">this</span><span class=\"o\">=</span><span class=\"mh\">0x5555559a73b0</span><span class=\"p\">)</span>\n</pre></div>", "type": "rendered"}, "created_on": "2018-10-17T01:20:42.443254+00:00", "user": {"display_name": "Louise Poubel", "uuid": "{5cfa2075-477b-4ded-bdb9-8d2479544ec4}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D"}, "html": {"href": "https://bitbucket.org/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8/7d903d90-c5ea-4182-b7ef-0d467e9e1c74/128"}}, "nickname": "chapulina", "type": "user", "account_id": "557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8"}, "inline": {"to": null, "from": 586, "outdated": true, "path": "src/SimulationRunner.cc"}, "updated_on": "2018-10-17T01:20:42.459524+00:00", "type": "pullrequest_comment", "id": 79314222}