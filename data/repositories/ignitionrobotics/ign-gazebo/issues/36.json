{"priority": "major", "kind": "bug", "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{f98d11fe-f287-4dfb-99c3-e2b76a13232e}ts=2082645"}}, "type": "repository", "name": "ign-gazebo", "full_name": "ignitionrobotics/ign-gazebo", "uuid": "{f98d11fe-f287-4dfb-99c3-e2b76a13232e}"}, "links": {"attachments": {"href": "data/repositories/ignitionrobotics/ign-gazebo/issues/36/attachments_page=1.json"}, "self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/issues/36.json"}, "watch": {"href": "https://api.bitbucket.org/2.0/repositories/ignitionrobotics/ign-gazebo/issues/36/watch"}, "comments": {"href": "data/repositories/ignitionrobotics/ign-gazebo/issues/36/comments_page=1.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/issues/36/regression-for-systems-that-use-rendering"}, "vote": {"href": "https://api.bitbucket.org/2.0/repositories/ignitionrobotics/ign-gazebo/issues/36/vote"}}, "reporter": {"display_name": "Louise Poubel", "uuid": "{5cfa2075-477b-4ded-bdb9-8d2479544ec4}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D"}, "html": {"href": "https://bitbucket.org/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8/7d903d90-c5ea-4182-b7ef-0d467e9e1c74/128"}}, "nickname": "chapulina", "type": "user", "account_id": "557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8"}, "title": "Regression for systems that use rendering", "component": null, "votes": 0, "watches": 1, "content": {"raw": "# Description \r\n\r\nUntil version 2.6.1, it was possible to run multiple systems which accessed the rendering engine. This is how [ros1_ign_point_cloud](https://github.com/osrf/ros1_ign/tree/master/ros1_ign_point_cloud) used to work. But since pull request #387, when 2 systems call `ignition::rendering::engine`, the 2nd call crashes with:\r\n\r\n`ruby: /var/lib/jenkins/workspace/ogre-2.1-debbuilder/repo/OgreMain/include/OgreSingleton.h:80: Ogre::Singleton<T>::Singleton() [with T = Ogre::LogManager]: Assertion `!msSingle\r\nton' failed.`\r\n\r\n# Steps to Reproduce\r\n\r\nI created a simple [example](#!/ignitionrobotics/ign-gazebo/commits/f1d3743a36f217713e515d9d91209483cf6495b5) in a branch which reproduces the issue:\r\n\r\n```\r\nhg up rendering_plugin\r\n# follow README instructions\r\n```\r\n\r\nOr you could try using `ros1_ign_point_cloud` like this:\r\n\r\n`roslaunch ros1_ign_gazebo_demos depth_camera.launch`\r\n\r\n**Expected behavior:**  \r\n\r\nNo crash when running `ign gazebo -s -v 4 rendering_plugin.sdf`\r\n\r\n**Actual behavior:**\r\n\r\nCrash with the Ogre assertion above.\r\n\r\n**Reproduces how often:** \r\n\r\n100%\r\n\r\n# Versions\r\n\r\nCurrent `ign-gazebo2` branch (the last release was 2.7.1) crashes. If you build Gazebo from the 2.6.1 tag, you can see there's no crash.\r\n\r\n# Additional Information\r\n\r\nWe could consider the performance improvements from pull request #387 to be more important than this use case and no longer support it. But we could also see if it's possible to fix it.", "markup": "markdown", "html": "<h1 id=\"markdown-header-description\">Description</h1>\n<p>Until version 2.6.1, it was possible to run multiple systems which accessed the rendering engine. This is how <a data-is-external-link=\"true\" href=\"https://github.com/osrf/ros1_ign/tree/master/ros1_ign_point_cloud\" rel=\"nofollow\">ros1_ign_point_cloud</a> used to work. But since <a href=\"#!/ignitionrobotics/ign-gazebo/pull-requests/387/add-worker-threads-for-system-postupdate\" rel=\"nofollow\" class=\"ap-connect-link\">pull request #387</a>, when 2 systems call <code>ignition::rendering::engine</code>, the 2nd call crashes with:</p>\n<p><code>ruby: /var/lib/jenkins/workspace/ogre-2.1-debbuilder/repo/OgreMain/include/OgreSingleton.h:80: Ogre::Singleton&lt;T&gt;::Singleton() [with T = Ogre::LogManager]: Assertion</code>!msSingle\nton' failed.`</p>\n<h1 id=\"markdown-header-steps-to-reproduce\">Steps to Reproduce</h1>\n<p>I created a simple <a data-is-external-link=\"true\" href=\"#!/ignitionrobotics/ign-gazebo/commits/f1d3743a36f217713e515d9d91209483cf6495b5\" rel=\"nofollow\">example</a> in a branch which reproduces the issue:</p>\n<div class=\"codehilite\"><pre><span></span>hg up rendering_plugin\n# follow README instructions\n</pre></div>\n\n\n<p>Or you could try using <code>ros1_ign_point_cloud</code> like this:</p>\n<p><code>roslaunch ros1_ign_gazebo_demos depth_camera.launch</code></p>\n<p><strong>Expected behavior:</strong>  </p>\n<p>No crash when running <code>ign gazebo -s -v 4 rendering_plugin.sdf</code></p>\n<p><strong>Actual behavior:</strong></p>\n<p>Crash with the Ogre assertion above.</p>\n<p><strong>Reproduces how often:</strong> </p>\n<p>100%</p>\n<h1 id=\"markdown-header-versions\">Versions</h1>\n<p>Current <code>ign-gazebo2</code> branch (the last release was 2.7.1) crashes. If you build Gazebo from the 2.6.1 tag, you can see there's no crash.</p>\n<h1 id=\"markdown-header-additional-information\">Additional Information</h1>\n<p>We could consider the performance improvements from <a href=\"#!/ignitionrobotics/ign-gazebo/pull-requests/387/add-worker-threads-for-system-postupdate\" rel=\"nofollow\" class=\"ap-connect-link\">pull request #387</a> to be more important than this use case and no longer support it. But we could also see if it's possible to fix it.</p>", "type": "rendered"}, "assignee": null, "state": "new", "version": null, "edited_on": null, "created_on": "2019-08-16T00:59:08.109992+00:00", "milestone": null, "updated_on": "2019-08-16T01:00:24.247630+00:00", "type": "issue", "id": 36}