{"pagelen": 100, "values": [{"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/issues/2/comments/48232254.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/issues/2#comment-48232254"}}, "issue": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/issues/2.json"}}, "type": "issue", "id": 2, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{f98d11fe-f287-4dfb-99c3-e2b76a13232e}ts=2082645"}}, "type": "repository", "name": "ign-gazebo", "full_name": "ignitionrobotics/ign-gazebo", "uuid": "{f98d11fe-f287-4dfb-99c3-e2b76a13232e}"}, "title": "Transport segfault on shutdown"}, "content": {"raw": "I can only make this happen when the GUI is running. Do you see the same?", "markup": "markdown", "html": "<p>I can only make this happen when the GUI is running. Do you see the same?</p>", "type": "rendered"}, "created_on": "2018-10-08T20:13:26.612069+00:00", "user": {"display_name": "Nate Koenig", "uuid": "{c862cdd9-fcc8-4419-9fc7-e20db14b8fcb}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Bc862cdd9-fcc8-4419-9fc7-e20db14b8fcb%7D"}, "html": {"href": "https://bitbucket.org/%7Bc862cdd9-fcc8-4419-9fc7-e20db14b8fcb%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:095b1e12-74ed-4e20-b44f-2f0745b616e0/ca24bb11-4787-4b14-a20d-d91835e9bde2/128"}}, "nickname": "Nathan Koenig", "type": "user", "account_id": "557058:095b1e12-74ed-4e20-b44f-2f0745b616e0"}, "updated_on": null, "type": "issue_comment", "id": 48232254}, {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/issues/2/comments/48232310.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/issues/2#comment-48232310"}}, "issue": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/issues/2.json"}}, "type": "issue", "id": 2, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{f98d11fe-f287-4dfb-99c3-e2b76a13232e}ts=2082645"}}, "type": "repository", "name": "ign-gazebo", "full_name": "ignitionrobotics/ign-gazebo", "uuid": "{f98d11fe-f287-4dfb-99c3-e2b76a13232e}"}, "title": "Transport segfault on shutdown"}, "content": {"raw": "Yes, I can't reproduce it without the GUI. I also tried running `ign topic -e -t /world/default/stats` on a separate terminal as I shutdown ign-gazebo and couldn't get a transport segfault.", "markup": "markdown", "html": "<p>Yes, I can't reproduce it without the GUI. I also tried running <code>ign topic -e -t /world/default/stats</code> on a separate terminal as I shutdown ign-gazebo and couldn't get a transport segfault.</p>", "type": "rendered"}, "created_on": "2018-10-08T20:18:33.798339+00:00", "user": {"display_name": "Louise Poubel", "uuid": "{5cfa2075-477b-4ded-bdb9-8d2479544ec4}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D"}, "html": {"href": "https://bitbucket.org/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8/7d903d90-c5ea-4182-b7ef-0d467e9e1c74/128"}}, "nickname": "chapulina", "type": "user", "account_id": "557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8"}, "updated_on": null, "type": "issue_comment", "id": 48232310}, {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/issues/2/comments/48234196.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/issues/2#comment-48234196"}}, "issue": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/issues/2.json"}}, "type": "issue", "id": 2, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{f98d11fe-f287-4dfb-99c3-e2b76a13232e}ts=2082645"}}, "type": "repository", "name": "ign-gazebo", "full_name": "ignitionrobotics/ign-gazebo", "uuid": "{f98d11fe-f287-4dfb-99c3-e2b76a13232e}"}, "title": "Transport segfault on shutdown"}, "content": {"raw": "@caguero , do you think this could happen if a subscription callback is deleted while an incoming message is being processed by ign-transport?", "markup": "markdown", "html": "<p>@caguero , do you think this could happen if a subscription callback is deleted while an incoming message is being processed by ign-transport?</p>", "type": "rendered"}, "created_on": "2018-10-08T23:57:12.648593+00:00", "user": {"display_name": "Nate Koenig", "uuid": "{c862cdd9-fcc8-4419-9fc7-e20db14b8fcb}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Bc862cdd9-fcc8-4419-9fc7-e20db14b8fcb%7D"}, "html": {"href": "https://bitbucket.org/%7Bc862cdd9-fcc8-4419-9fc7-e20db14b8fcb%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:095b1e12-74ed-4e20-b44f-2f0745b616e0/ca24bb11-4787-4b14-a20d-d91835e9bde2/128"}}, "nickname": "Nathan Koenig", "type": "user", "account_id": "557058:095b1e12-74ed-4e20-b44f-2f0745b616e0"}, "updated_on": null, "type": "issue_comment", "id": 48234196}, {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/issues/2/comments/48234258.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/issues/2#comment-48234258"}}, "issue": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/issues/2.json"}}, "type": "issue", "id": 2, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{f98d11fe-f287-4dfb-99c3-e2b76a13232e}ts=2082645"}}, "type": "repository", "name": "ign-gazebo", "full_name": "ignitionrobotics/ign-gazebo", "uuid": "{f98d11fe-f287-4dfb-99c3-e2b76a13232e}"}, "title": "Transport segfault on shutdown"}, "content": {"raw": "So far, I found that the segfaults happens with the WorldControl and WorldStats plugins but not with the Scene3D plugin.", "markup": "markdown", "html": "<p>So far, I found that the segfaults happens with the WorldControl and WorldStats plugins but not with the Scene3D plugin.</p>", "type": "rendered"}, "created_on": "2018-10-09T00:03:56.281322+00:00", "user": {"display_name": "Nate Koenig", "uuid": "{c862cdd9-fcc8-4419-9fc7-e20db14b8fcb}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Bc862cdd9-fcc8-4419-9fc7-e20db14b8fcb%7D"}, "html": {"href": "https://bitbucket.org/%7Bc862cdd9-fcc8-4419-9fc7-e20db14b8fcb%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:095b1e12-74ed-4e20-b44f-2f0745b616e0/ca24bb11-4787-4b14-a20d-d91835e9bde2/128"}}, "nickname": "Nathan Koenig", "type": "user", "account_id": "557058:095b1e12-74ed-4e20-b44f-2f0745b616e0"}, "updated_on": null, "type": "issue_comment", "id": 48234258}, {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/issues/2/comments/48273769.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/issues/2#comment-48273769"}}, "issue": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/issues/2.json"}}, "type": "issue", "id": 2, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{f98d11fe-f287-4dfb-99c3-e2b76a13232e}ts=2082645"}}, "type": "repository", "name": "ign-gazebo", "full_name": "ignitionrobotics/ign-gazebo", "uuid": "{f98d11fe-f287-4dfb-99c3-e2b76a13232e}"}, "title": "Transport segfault on shutdown"}, "content": {"raw": "I spent some time looking into this and the problem seems to be in this lambda in Node.cc:336\n\n```\nthis->dataPtr->shared->dataPtr->workerPool.AddWork(\n              [localHandler, msgCopy, info] ()\n              {\n                try\n                {\n                  localHandler->RunLocalCallback(*msgCopy, *info);\n                }\n                catch (...)\n                {\n                  std::cerr << \"Exception occurred in a local callback \"\n                    << \"on topic [\" << info->Topic() << \"] with message [\"\n                    << msgCopy->DebugString() << \"]\" << std::endl;\n                }\n              });\n```\n\nIn particular, the `localHandler` shared pointer. My hypothesis is that during the NodeShared destructor, the thread pool still have pending jobs containing this lambda that cause the segfault.", "markup": "markdown", "html": "<p>I spent some time looking into this and the problem seems to be in this lambda in Node.cc:336</p>\n<div class=\"codehilite\"><pre><span></span><span class=\"nt\">this-</span><span class=\"o\">&gt;</span><span class=\"nt\">dataPtr-</span><span class=\"o\">&gt;</span><span class=\"nt\">shared-</span><span class=\"o\">&gt;</span><span class=\"nt\">dataPtr-</span><span class=\"o\">&gt;</span><span class=\"nt\">workerPool</span><span class=\"p\">.</span><span class=\"nc\">AddWork</span><span class=\"o\">(</span>\n              <span class=\"cp\">[</span><span class=\"nx\">localHandler</span><span class=\"p\">,</span> <span class=\"nx\">msgCopy</span><span class=\"p\">,</span> <span class=\"nx\">info</span><span class=\"cp\">]</span> <span class=\"o\">()</span>\n              <span class=\"p\">{</span>\n                <span class=\"err\">try</span>\n                <span class=\"err\">{</span>\n                  <span class=\"err\">localHandler-&gt;RunLocalCallback(*msgCopy,</span> <span class=\"err\">*info)</span><span class=\"p\">;</span>\n                <span class=\"p\">}</span>\n                <span class=\"nt\">catch</span> <span class=\"o\">(...)</span>\n                <span class=\"p\">{</span>\n                  <span class=\"n\">std</span><span class=\"p\">:</span><span class=\"o\">:</span><span class=\"n\">cerr</span> <span class=\"o\">&lt;&lt;</span> <span class=\"s2\">&quot;Exception occurred in a local callback &quot;</span>\n                    <span class=\"o\">&lt;&lt;</span> <span class=\"s2\">&quot;on topic </span><span class=\"cp\">[</span><span class=\"s2\">&quot; &lt;&lt; info-&gt;Topic() &lt;&lt; &quot;</span><span class=\"cp\">]</span><span class=\"s2\"> with message </span><span class=\"cp\">[</span><span class=\"s2\">&quot;</span>\n<span class=\"s2\">                    &lt;&lt; msgCopy-&gt;DebugString() &lt;&lt; &quot;</span><span class=\"cp\">]</span><span class=\"s2\">&quot;</span> <span class=\"o\">&lt;&lt;</span> <span class=\"n\">std</span><span class=\"o\">::</span><span class=\"n\">endl</span><span class=\"p\">;</span>\n                <span class=\"p\">}</span>\n              <span class=\"err\">}</span><span class=\"o\">);</span>\n</pre></div>\n\n\n<p>In particular, the <code>localHandler</code> shared pointer. My hypothesis is that during the NodeShared destructor, the thread pool still have pending jobs containing this lambda that cause the segfault.</p>", "type": "rendered"}, "created_on": "2018-10-10T17:25:29.231746+00:00", "user": {"display_name": "Carlos Ag\u00fcero", "uuid": "{da8a8e89-4bb0-421b-bd0e-dbbed3d4ed6a}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Bda8a8e89-4bb0-421b-bd0e-dbbed3d4ed6a%7D"}, "html": {"href": "https://bitbucket.org/%7Bda8a8e89-4bb0-421b-bd0e-dbbed3d4ed6a%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/692bf15758111acaddae4da15a47f9e5d=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsCA-0.png"}}, "nickname": "caguero", "type": "user", "account_id": "557058:4ded1ddf-947e-4154-bbd1-3dba24f1bdbd"}, "updated_on": null, "type": "issue_comment", "id": 48273769}, {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/issues/2/comments/49557806.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/issues/2#comment-49557806"}}, "issue": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/issues/2.json"}}, "type": "issue", "id": 2, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{f98d11fe-f287-4dfb-99c3-e2b76a13232e}ts=2082645"}}, "type": "repository", "name": "ign-gazebo", "full_name": "ignitionrobotics/ign-gazebo", "uuid": "{f98d11fe-f287-4dfb-99c3-e2b76a13232e}"}, "title": "Transport segfault on shutdown"}, "content": {"raw": "Potential solution: #!/ignitionrobotics/ign-transport/pull-requests/352", "markup": "markdown", "html": "<p>Potential solution: <a href=\"#!/ignitionrobotics/ign-transport/pull-requests/352\" rel=\"nofollow\" class=\"ap-connect-link\">#!/ignitionrobotics/ign-transport/pull-requests/352</a></p>", "type": "rendered"}, "created_on": "2018-12-20T00:32:40.857338+00:00", "user": {"display_name": "Nate Koenig", "uuid": "{c862cdd9-fcc8-4419-9fc7-e20db14b8fcb}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Bc862cdd9-fcc8-4419-9fc7-e20db14b8fcb%7D"}, "html": {"href": "https://bitbucket.org/%7Bc862cdd9-fcc8-4419-9fc7-e20db14b8fcb%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:095b1e12-74ed-4e20-b44f-2f0745b616e0/ca24bb11-4787-4b14-a20d-d91835e9bde2/128"}}, "nickname": "Nathan Koenig", "type": "user", "account_id": "557058:095b1e12-74ed-4e20-b44f-2f0745b616e0"}, "updated_on": null, "type": "issue_comment", "id": 49557806}, {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/issues/2/comments/49593480.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/issues/2#comment-49593480"}}, "issue": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/issues/2.json"}}, "type": "issue", "id": 2, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{f98d11fe-f287-4dfb-99c3-e2b76a13232e}ts=2082645"}}, "type": "repository", "name": "ign-gazebo", "full_name": "ignitionrobotics/ign-gazebo", "uuid": "{f98d11fe-f287-4dfb-99c3-e2b76a13232e}"}, "title": "Transport segfault on shutdown"}, "content": {"raw": "Resolved for now in the afore mentioned pull request.", "markup": "markdown", "html": "<p>Resolved for now in the afore mentioned pull request.</p>", "type": "rendered"}, "created_on": "2018-12-21T23:56:27.857016+00:00", "user": {"display_name": "Nate Koenig", "uuid": "{c862cdd9-fcc8-4419-9fc7-e20db14b8fcb}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Bc862cdd9-fcc8-4419-9fc7-e20db14b8fcb%7D"}, "html": {"href": "https://bitbucket.org/%7Bc862cdd9-fcc8-4419-9fc7-e20db14b8fcb%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:095b1e12-74ed-4e20-b44f-2f0745b616e0/ca24bb11-4787-4b14-a20d-d91835e9bde2/128"}}, "nickname": "Nathan Koenig", "type": "user", "account_id": "557058:095b1e12-74ed-4e20-b44f-2f0745b616e0"}, "updated_on": null, "type": "issue_comment", "id": 49593480}], "page": 1, "size": 7}