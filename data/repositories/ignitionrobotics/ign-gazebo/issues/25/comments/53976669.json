{"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/issues/25/comments/53976669.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo/issues/25#comment-53976669"}}, "issue": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo/issues/25.json"}}, "type": "issue", "id": 25, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-gazebo.json"}, "html": {"href": "#!/ignitionrobotics/ign-gazebo"}, "avatar": {"href": "data/bytebucket.org/ravatar/{f98d11fe-f287-4dfb-99c3-e2b76a13232e}ts=2082645"}}, "type": "repository", "name": "ign-gazebo", "full_name": "ignitionrobotics/ign-gazebo", "uuid": "{f98d11fe-f287-4dfb-99c3-e2b76a13232e}"}, "title": "Apple support for ign command line tool"}, "content": {"raw": "This bug is kinda odd because other ign commands like `ign transport` and `ign msg` work just fine on macOS. One difference is that the implementation of `ign gazebo` functionality is in the `ign-gazebo2-ign` component library that must be dynamically linked to the main library. The `ign log` command is similar in that it uses a component library that is linked to the main library. I tested `ign log record` on high sierra and mojave, and it works on high sierra but fails on mojave as follows:\n\n~~~\n$ ign log record\nLibrary error: [/usr/local/Cellar/ignition-transport7/7.1.0_1/lib/libignition-transport7-log.7.1.0.dylib] not found.\n~~~\n\nIt's hard to find documentation about the changes in SIP from 10.13 to 10.14, but I believe that starting in 10.14 any binaries in `/usr/bin` will ignore the `DYLD_LIBRARY_PATH`. This is relevant because `ign` uses `/usr/bin/ruby`, and I believe it explains why it can't load the component libraries.\n\nAs a test, I installed another ruby implementation with `brew install ruby` and modified the shebang line of `/usr/local/bin/ign` to point to that other ruby in `/usr/local`, and it was successful!\n\nSo I think this is a clear diagnosis of the problem, though I don't have a suggested solution at this point.", "markup": "markdown", "html": "<p>This bug is kinda odd because other ign commands like <code>ign transport</code> and <code>ign msg</code> work just fine on macOS. One difference is that the implementation of <code>ign gazebo</code> functionality is in the <code>ign-gazebo2-ign</code> component library that must be dynamically linked to the main library. The <code>ign log</code> command is similar in that it uses a component library that is linked to the main library. I tested <code>ign log record</code> on high sierra and mojave, and it works on high sierra but fails on mojave as follows:</p>\n<div class=\"codehilite\"><pre><span></span>$ ign log record\nLibrary error: <span class=\"o\">[</span>/usr/local/Cellar/ignition-transport7/7.1.0_1/lib/libignition-transport7-log.7.1.0.dylib<span class=\"o\">]</span> not found.\n</pre></div>\n\n\n<p>It's hard to find documentation about the changes in SIP from 10.13 to 10.14, but I believe that starting in 10.14 any binaries in <code>/usr/bin</code> will ignore the <code>DYLD_LIBRARY_PATH</code>. This is relevant because <code>ign</code> uses <code>/usr/bin/ruby</code>, and I believe it explains why it can't load the component libraries.</p>\n<p>As a test, I installed another ruby implementation with <code>brew install ruby</code> and modified the shebang line of <code>/usr/local/bin/ign</code> to point to that other ruby in <code>/usr/local</code>, and it was successful!</p>\n<p>So I think this is a clear diagnosis of the problem, though I don't have a suggested solution at this point.</p>", "type": "rendered"}, "created_on": "2019-09-19T06:08:07.967741+00:00", "user": {"display_name": "Steve Peters", "uuid": "{2ccfed09-18b8-4921-8d58-15ef01092802}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D"}, "html": {"href": "https://bitbucket.org/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/1fb4816dad9e68337d3096f750951f6cd=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsSP-1.png"}}, "nickname": "Steven Peters", "type": "user", "account_id": "557058:5de38267-b118-494c-aa76-4fab35448816"}, "updated_on": null, "type": "issue_comment", "id": 53976669}