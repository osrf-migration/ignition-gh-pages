{"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-rendering/pullrequests/234/comments/136884992.json"}, "html": {"href": "#!/ignitionrobotics/ign-rendering/pull-requests/234/_/diff#comment-136884992"}}, "parent": {"id": 135706124, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-rendering/pullrequests/234/comments/135706124.json"}, "html": {"href": "#!/ignitionrobotics/ign-rendering/pull-requests/234/_/diff#comment-135706124"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 234, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-rendering/pullrequests/234.json"}, "html": {"href": "#!/ignitionrobotics/ign-rendering/pull-requests/234"}}, "title": "Prevent flaky crash"}, "content": {"raw": "I was able to reproduce the crash with that entire block commented out. My backtrace looks different from John's though:\n\n```\nInvalid parameter at line 374 (@foreach). 'hlms_lights_directional' is not a number nor a variable\nterminate called after throwing an instance of 'Ogre::ItemIdentityException'\n  what():  OGRE EXCEPTION(5:ItemIdentityException): Parameter called f3dGrid does not exist.  in GpuProgramParameters::_findNamedConstantDefinition at /var/lib/jenkins/workspace/ogre-2.1-debbuilder/repo/OgreMain/src/OgreGpuProgramParams.cpp (line 2218)\n\nThread 13 \"ignition::gazeb\" received signal SIGABRT, Aborted.\n[Switching to Thread 0x7fffa31fe700 (LWP 8843)]\n__GI_raise (sig=sig@entry=6) at ../sysdeps/unix/sysv/linux/raise.c:51\n51      ../sysdeps/unix/sysv/linux/raise.c: No such file or directory.\n(gdb) bt\n#0  0x00007ffff7571e97 in __GI_raise (sig=sig@entry=6) at ../sysdeps/unix/sysv/linux/raise.c:51\n#1  0x00007ffff7573801 in __GI_abort () at abort.c:79\n#2  0x00007ffff1be0957 in  () at /usr/lib/x86_64-linux-gnu/libstdc++.so.6\n#3  0x00007ffff1be6ab6 in  () at /usr/lib/x86_64-linux-gnu/libstdc++.so.6\n#4  0x00007ffff1be6af1 in  () at /usr/lib/x86_64-linux-gnu/libstdc++.so.6\n#5  0x00007ffff1be6d24 in  () at /usr/lib/x86_64-linux-gnu/libstdc++.so.6\n#6  0x00007fffa1fa5a8e in  () at /usr/lib/x86_64-linux-gnu/libOgreMain.so.2.1.0\n#7  0x00007fffa202681b in Ogre::GpuProgramParameters::_findNamedConstantDefinition(std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, bool) const () at /usr/lib/x86_64-linux-gnu/libOgreMain.so.2.1.0\n#8  0x00007fffa2026b7d in Ogre::GpuProgramParameters::setNamedConstant(std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int) ()\n    at /usr/lib/x86_64-linux-gnu/libOgreMain.so.2.1.0\n#9  0x00007fffa1c33260 in Ogre::HlmsPbs::createShaderCacheEntry(unsigned int, Ogre::HlmsCache const&, unsigned int, Ogre::QueuedRenderable const&) ()\n    at /usr/lib/x86_64-linux-gnu/libOgreHlmsPbs.so.2.1.0\n#10 0x00007fffa216ed34 in Ogre::RenderQueue::renderGL3(bool, bool, Ogre::HlmsCache*, Ogre::RenderQueue::RenderQueueGroup const&, Ogre::IndirectBufferPacked*, unsigned char*, unsigned char*) () at /usr/lib/x86_64-linux-gnu/libOgreMain.so.2.1.0\n#11 0x00007fffa21714a9 in Ogre::RenderQueue::render(Ogre::RenderSystem*, unsigned char, unsigned char, bool, bool) () at /usr/lib/x86_64-linux-gnu/libOgreMain.so.2.1.0\n#12 0x00007fffa21b8802 in Ogre::SceneManager::_renderPhase02(Ogre::Camera*, Ogre::Camera const*, Ogre::Viewport*, unsigned char, unsigned char, bool) ()\n    at /usr/lib/x86_64-linux-gnu/libOgreMain.so.2.1.0\n#13 0x00007fffa1fd2716 in Ogre::Camera::_renderScenePhase02(Ogre::Camera const*, Ogre::Viewport*, unsigned char, unsigned char, bool) ()\n    at /usr/lib/x86_64-linux-gnu/libOgreMain.so.2.1.0\n#14 0x00007fffa218b9b9 in Ogre::RenderTarget::_updateViewportRenderPhase02(Ogre::Viewport*, Ogre::Camera*, Ogre::Camera const*, unsigned char, unsigned char, bool) ()\n    at /usr/lib/x86_64-linux-gnu/libOgreMain.so.2.1.0\n#15 0x00007fffa22e39ca in Ogre::CompositorPassScene::execute(Ogre::Camera const*) () at /usr/lib/x86_64-linux-gnu/libOgreMain.so.2.1.0\n#16 0x00007fffa22bec67 in Ogre::CompositorNode::_update(Ogre::Camera const*, Ogre::SceneManager*) () at /usr/lib/x86_64-linux-gnu/libOgreMain.so.2.1.0\n#17 0x00007fffa22d18ca in Ogre::CompositorWorkspace::_update() () at /usr/lib/x86_64-linux-gnu/libOgreMain.so.2.1.0\n#18 0x00007fffa22b93c1 in Ogre::CompositorManager2::_updateImplementation(Ogre::SceneManagerEnumerator&, Ogre::HlmsManager*) ()\n    at /usr/lib/x86_64-linux-gnu/libOgreMain.so.2.1.0\n#19 0x00007fffa21aaf95 in Ogre::Root::_updateAllRenderTargets() () at /usr/lib/x86_64-linux-gnu/libOgreMain.so.2.1.0\n#20 0x00007fffa21ab0fc in Ogre::Root::renderOneFrame() () at /usr/lib/x86_64-linux-gnu/libOgreMain.so.2.1.0\n#21 0x00007fffa2781785 in ignition::rendering::v2::Ogre2RenderTarget::Render() (this=0x7fff982fedd0)\n    at /home/chapulina/blueprint_ws/src/ign-rendering/ogre2/src/Ogre2RenderTarget.cc:173\n#22 0x00007fffa27373d6 in ignition::rendering::v2::BaseCamera<ignition::rendering::v2::Ogre2Sensor>::Update() (this=0x7fff982cdce0) at /usr/include/c++/8/ext/atomicity.h:82\n#23 0x00007fffbc91236d in ignition::gazebo::v2::IgnRenderer::Render() (this=0x555556dfc530) at /usr/include/c++/8/bits/shared_ptr_base.h:1018\n#24 0x00007fffbc9130c6 in ignition::gazebo::v2::RenderThread::RenderNext() (this=0x555556dfc510)\n    at /home/chapulina/blueprint_ws/src/ign-gazebo/src/gui/plugins/scene3d/Scene3D.cc:1337\n#25 0x00007ffff2197122 in QObject::event(QEvent*) () at /usr/lib/x86_64-linux-gnu/libQt5Core.so.5\n#26 0x00007ffff216783a in QCoreApplication::notify(QObject*, QEvent*) () at /usr/lib/x86_64-linux-gnu/libQt5Core.so.5\n#27 0x00007ffff21679a8 in QCoreApplication::notifyInternal2(QObject*, QEvent*) () at /usr/lib/x86_64-linux-gnu/libQt5Core.so.5\n#28 0x00007ffff216a11d in QCoreApplicationPrivate::sendPostedEvents(QObject*, int, QThreadData*) () at /usr/lib/x86_64-linux-gnu/libQt5Core.so.5\n#29 0x00007ffff21c12c3 in  () at /usr/lib/x86_64-linux-gnu/libQt5Core.so.5\n---Type <return> to continue, or q <return> to quit---\n#30 0x00007fffeec36417 in g_main_context_dispatch () at /usr/lib/x86_64-linux-gnu/libglib-2.0.so.0\n#31 0x00007fffeec36650 in  () at /usr/lib/x86_64-linux-gnu/libglib-2.0.so.0\n#32 0x00007fffeec366dc in g_main_context_iteration () at /usr/lib/x86_64-linux-gnu/libglib-2.0.so.0\n#33 0x00007ffff21c08ef in QEventDispatcherGlib::processEvents(QFlags<QEventLoop::ProcessEventsFlag>) () at /usr/lib/x86_64-linux-gnu/libQt5Core.so.5\n#34 0x00007ffff21659ea in QEventLoop::exec(QFlags<QEventLoop::ProcessEventsFlag>) () at /usr/lib/x86_64-linux-gnu/libQt5Core.so.5\n#35 0x00007ffff1f8422a in QThread::exec() () at /usr/lib/x86_64-linux-gnu/libQt5Core.so.5\n#36 0x00007ffff1f8916d in  () at /usr/lib/x86_64-linux-gnu/libQt5Core.so.5\n#37 0x00007ffff731b6db in start_thread (arg=0x7fffa31fe700) at pthread_create.c:463\n#38 0x00007ffff765488f in clone () at ../sysdeps/unix/sysv/linux/x86_64/clone.S:95\n```", "markup": "markdown", "html": "<p>I was able to reproduce the crash with that entire block commented out. My backtrace looks different from John's though:</p>\n<div class=\"codehilite\"><pre><span></span>Invalid parameter at line 374 (@foreach). &#39;hlms_lights_directional&#39; is not a number nor a variable\nterminate called after throwing an instance of &#39;Ogre::ItemIdentityException&#39;\n  what():  OGRE EXCEPTION(5:ItemIdentityException): Parameter called f3dGrid does not exist.  in GpuProgramParameters::_findNamedConstantDefinition at /var/lib/jenkins/workspace/ogre-2.1-debbuilder/repo/OgreMain/src/OgreGpuProgramParams.cpp (line 2218)\n\nThread 13 &quot;ignition::gazeb&quot; received signal SIGABRT, Aborted.\n[Switching to Thread 0x7fffa31fe700 (LWP 8843)]\n__GI_raise (sig=sig@entry=6) at ../sysdeps/unix/sysv/linux/raise.c:51\n51      ../sysdeps/unix/sysv/linux/raise.c: No such file or directory.\n(gdb) bt\n#0  0x00007ffff7571e97 in __GI_raise (sig=sig@entry=6) at ../sysdeps/unix/sysv/linux/raise.c:51\n#1  0x00007ffff7573801 in __GI_abort () at abort.c:79\n#2  0x00007ffff1be0957 in  () at /usr/lib/x86_64-linux-gnu/libstdc++.so.6\n#3  0x00007ffff1be6ab6 in  () at /usr/lib/x86_64-linux-gnu/libstdc++.so.6\n#4  0x00007ffff1be6af1 in  () at /usr/lib/x86_64-linux-gnu/libstdc++.so.6\n#5  0x00007ffff1be6d24 in  () at /usr/lib/x86_64-linux-gnu/libstdc++.so.6\n#6  0x00007fffa1fa5a8e in  () at /usr/lib/x86_64-linux-gnu/libOgreMain.so.2.1.0\n#7  0x00007fffa202681b in Ogre::GpuProgramParameters::_findNamedConstantDefinition(std::__cxx11::basic_string&lt;char, std::char_traits&lt;char&gt;, std::allocator&lt;char&gt; &gt; const&amp;, bool) const () at /usr/lib/x86_64-linux-gnu/libOgreMain.so.2.1.0\n#8  0x00007fffa2026b7d in Ogre::GpuProgramParameters::setNamedConstant(std::__cxx11::basic_string&lt;char, std::char_traits&lt;char&gt;, std::allocator&lt;char&gt; &gt; const&amp;, int) ()\n    at /usr/lib/x86_64-linux-gnu/libOgreMain.so.2.1.0\n#9  0x00007fffa1c33260 in Ogre::HlmsPbs::createShaderCacheEntry(unsigned int, Ogre::HlmsCache const&amp;, unsigned int, Ogre::QueuedRenderable const&amp;) ()\n    at /usr/lib/x86_64-linux-gnu/libOgreHlmsPbs.so.2.1.0\n#10 0x00007fffa216ed34 in Ogre::RenderQueue::renderGL3(bool, bool, Ogre::HlmsCache*, Ogre::RenderQueue::RenderQueueGroup const&amp;, Ogre::IndirectBufferPacked*, unsigned char*, unsigned char*) () at /usr/lib/x86_64-linux-gnu/libOgreMain.so.2.1.0\n#11 0x00007fffa21714a9 in Ogre::RenderQueue::render(Ogre::RenderSystem*, unsigned char, unsigned char, bool, bool) () at /usr/lib/x86_64-linux-gnu/libOgreMain.so.2.1.0\n#12 0x00007fffa21b8802 in Ogre::SceneManager::_renderPhase02(Ogre::Camera*, Ogre::Camera const*, Ogre::Viewport*, unsigned char, unsigned char, bool) ()\n    at /usr/lib/x86_64-linux-gnu/libOgreMain.so.2.1.0\n#13 0x00007fffa1fd2716 in Ogre::Camera::_renderScenePhase02(Ogre::Camera const*, Ogre::Viewport*, unsigned char, unsigned char, bool) ()\n    at /usr/lib/x86_64-linux-gnu/libOgreMain.so.2.1.0\n#14 0x00007fffa218b9b9 in Ogre::RenderTarget::_updateViewportRenderPhase02(Ogre::Viewport*, Ogre::Camera*, Ogre::Camera const*, unsigned char, unsigned char, bool) ()\n    at /usr/lib/x86_64-linux-gnu/libOgreMain.so.2.1.0\n#15 0x00007fffa22e39ca in Ogre::CompositorPassScene::execute(Ogre::Camera const*) () at /usr/lib/x86_64-linux-gnu/libOgreMain.so.2.1.0\n#16 0x00007fffa22bec67 in Ogre::CompositorNode::_update(Ogre::Camera const*, Ogre::SceneManager*) () at /usr/lib/x86_64-linux-gnu/libOgreMain.so.2.1.0\n#17 0x00007fffa22d18ca in Ogre::CompositorWorkspace::_update() () at /usr/lib/x86_64-linux-gnu/libOgreMain.so.2.1.0\n#18 0x00007fffa22b93c1 in Ogre::CompositorManager2::_updateImplementation(Ogre::SceneManagerEnumerator&amp;, Ogre::HlmsManager*) ()\n    at /usr/lib/x86_64-linux-gnu/libOgreMain.so.2.1.0\n#19 0x00007fffa21aaf95 in Ogre::Root::_updateAllRenderTargets() () at /usr/lib/x86_64-linux-gnu/libOgreMain.so.2.1.0\n#20 0x00007fffa21ab0fc in Ogre::Root::renderOneFrame() () at /usr/lib/x86_64-linux-gnu/libOgreMain.so.2.1.0\n#21 0x00007fffa2781785 in ignition::rendering::v2::Ogre2RenderTarget::Render() (this=0x7fff982fedd0)\n    at /home/chapulina/blueprint_ws/src/ign-rendering/ogre2/src/Ogre2RenderTarget.cc:173\n#22 0x00007fffa27373d6 in ignition::rendering::v2::BaseCamera&lt;ignition::rendering::v2::Ogre2Sensor&gt;::Update() (this=0x7fff982cdce0) at /usr/include/c++/8/ext/atomicity.h:82\n#23 0x00007fffbc91236d in ignition::gazebo::v2::IgnRenderer::Render() (this=0x555556dfc530) at /usr/include/c++/8/bits/shared_ptr_base.h:1018\n#24 0x00007fffbc9130c6 in ignition::gazebo::v2::RenderThread::RenderNext() (this=0x555556dfc510)\n    at /home/chapulina/blueprint_ws/src/ign-gazebo/src/gui/plugins/scene3d/Scene3D.cc:1337\n#25 0x00007ffff2197122 in QObject::event(QEvent*) () at /usr/lib/x86_64-linux-gnu/libQt5Core.so.5\n#26 0x00007ffff216783a in QCoreApplication::notify(QObject*, QEvent*) () at /usr/lib/x86_64-linux-gnu/libQt5Core.so.5\n#27 0x00007ffff21679a8 in QCoreApplication::notifyInternal2(QObject*, QEvent*) () at /usr/lib/x86_64-linux-gnu/libQt5Core.so.5\n#28 0x00007ffff216a11d in QCoreApplicationPrivate::sendPostedEvents(QObject*, int, QThreadData*) () at /usr/lib/x86_64-linux-gnu/libQt5Core.so.5\n#29 0x00007ffff21c12c3 in  () at /usr/lib/x86_64-linux-gnu/libQt5Core.so.5\n---Type &lt;return&gt; to continue, or q &lt;return&gt; to quit---\n#30 0x00007fffeec36417 in g_main_context_dispatch () at /usr/lib/x86_64-linux-gnu/libglib-2.0.so.0\n#31 0x00007fffeec36650 in  () at /usr/lib/x86_64-linux-gnu/libglib-2.0.so.0\n#32 0x00007fffeec366dc in g_main_context_iteration () at /usr/lib/x86_64-linux-gnu/libglib-2.0.so.0\n#33 0x00007ffff21c08ef in QEventDispatcherGlib::processEvents(QFlags&lt;QEventLoop::ProcessEventsFlag&gt;) () at /usr/lib/x86_64-linux-gnu/libQt5Core.so.5\n#34 0x00007ffff21659ea in QEventLoop::exec(QFlags&lt;QEventLoop::ProcessEventsFlag&gt;) () at /usr/lib/x86_64-linux-gnu/libQt5Core.so.5\n#35 0x00007ffff1f8422a in QThread::exec() () at /usr/lib/x86_64-linux-gnu/libQt5Core.so.5\n#36 0x00007ffff1f8916d in  () at /usr/lib/x86_64-linux-gnu/libQt5Core.so.5\n#37 0x00007ffff731b6db in start_thread (arg=0x7fffa31fe700) at pthread_create.c:463\n#38 0x00007ffff765488f in clone () at ../sysdeps/unix/sysv/linux/x86_64/clone.S:95\n</pre></div>", "type": "rendered"}, "created_on": "2020-02-20T23:06:46.613159+00:00", "user": {"display_name": "Louise Poubel", "uuid": "{5cfa2075-477b-4ded-bdb9-8d2479544ec4}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D"}, "html": {"href": "https://bitbucket.org/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8/7d903d90-c5ea-4182-b7ef-0d467e9e1c74/128"}}, "nickname": "chapulina", "type": "user", "account_id": "557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8"}, "updated_on": "2020-02-20T23:06:46.624179+00:00", "type": "pullrequest_comment", "id": 136884992}