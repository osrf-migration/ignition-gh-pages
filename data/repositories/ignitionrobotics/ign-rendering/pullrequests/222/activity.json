{"pagelen": 50, "values": [{"update": {"description": "Replaces pull request #217. Third attempt - Shadows should hopefully work properly now!\r\n\r\nThe main cause of a problem was that the shadow casting lights did not match the ones statically defined in `PbsMaterials.compositor`. The original PR tries to workaround the issue but I ran into a bug in ogre2 that prevents it from working in some cases.\r\n\r\nTo fix the problem, I now programmatically construct the shadow node whenever the number of shadow casting lights changes so that we always use the correct number of shadow maps. \r\n\r\nI ran into a different bug in ogre2 for dynamically creating the shadow nodes. I had to adapt its code and fix the bug in `Ogre2RenderTarget::CreateShadowNodeWithSettings` function.\r\n\r\nScreenshot from tunnel.sdf that uses version 3 of X1 UGV model from fuel\r\n\r\n![](https://bitbucket.org/repo/zq9ear/images/445905331-spot_light_shadows_tunnel.png)\r\n\u200c\r\n\r\n\u200c", "title": "Ogre2: Fix shadows by dynamically generating shadow maps", "destination": {"commit": {"hash": "68150130746f", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-rendering/commit/68150130746f.json"}, "html": {"href": "#!/ignitionrobotics/ign-rendering/commits/68150130746f"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-rendering.json"}, "html": {"href": "#!/ignitionrobotics/ign-rendering"}, "avatar": {"href": "data/bytebucket.org/ravatar/{f6b404b6-f373-460d-a470-69ff6f27cd93}ts=1533308"}}, "type": "repository", "name": "ign-rendering", "full_name": "ignitionrobotics/ign-rendering", "uuid": "{f6b404b6-f373-460d-a470-69ff6f27cd93}"}, "branch": {"name": "ign-rendering2"}}, "reason": "", "source": {"commit": {"hash": "8004c2a168dd", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-rendering/commit/8004c2a168dd.json"}, "html": {"href": "#!/ignitionrobotics/ign-rendering/commits/8004c2a168dd"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-rendering.json"}, "html": {"href": "#!/ignitionrobotics/ign-rendering"}, "avatar": {"href": "data/bytebucket.org/ravatar/{f6b404b6-f373-460d-a470-69ff6f27cd93}ts=1533308"}}, "type": "repository", "name": "ign-rendering", "full_name": "ignitionrobotics/ign-rendering", "uuid": "{f6b404b6-f373-460d-a470-69ff6f27cd93}"}, "branch": {"name": "ogre2_light_shadows"}}, "state": "MERGED", "author": {"display_name": "Ian Chen", "uuid": "{eaa6fca5-6deb-43f6-907f-971c144735dd}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Beaa6fca5-6deb-43f6-907f-971c144735dd%7D"}, "html": {"href": "https://bitbucket.org/%7Beaa6fca5-6deb-43f6-907f-971c144735dd%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:10b01d41-a2e9-4a41-a907-e6e2f03b6cd5/1e4adcdf-1946-4280-9aea-eb5f15a7f912/128"}}, "nickname": "Ian Chen", "type": "user", "account_id": "557058:10b01d41-a2e9-4a41-a907-e6e2f03b6cd5"}, "date": "2019-12-17T21:30:57.534834+00:00"}, "pull_request": {"type": "pullrequest", "id": 222, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-rendering/pullrequests/222.json"}, "html": {"href": "#!/ignitionrobotics/ign-rendering/pull-requests/222"}}, "title": "Ogre2: Fix shadows by dynamically generating shadow maps"}}, {"update": {"description": "Replaces pull request #217. Third attempt - Shadows should hopefully work properly now!\r\n\r\nThe main cause of a problem was that the shadow casting lights did not match the ones statically defined in `PbsMaterials.compositor`. The original PR tries to workaround the issue but I ran into a bug in ogre2 that prevents it from working in some cases.\r\n\r\nTo fix the problem, I now programmatically construct the shadow node whenever the number of shadow casting lights changes so that we always use the correct number of shadow maps. \r\n\r\nI ran into a different bug in ogre2 for dynamically creating the shadow nodes. I had to adapt its code and fix the bug in `Ogre2RenderTarget::CreateShadowNodeWithSettings` function.\r\n\r\nScreenshot from tunnel.sdf that uses version 3 of X1 UGV model from fuel\r\n\r\n![](https://bitbucket.org/repo/zq9ear/images/445905331-spot_light_shadows_tunnel.png)\r\n\u200c\r\n\r\n\u200c", "title": "Ogre2: Fix shadows by dynamically generating shadow maps", "destination": {"commit": {"hash": "68150130746f", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-rendering/commit/68150130746f.json"}, "html": {"href": "#!/ignitionrobotics/ign-rendering/commits/68150130746f"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-rendering.json"}, "html": {"href": "#!/ignitionrobotics/ign-rendering"}, "avatar": {"href": "data/bytebucket.org/ravatar/{f6b404b6-f373-460d-a470-69ff6f27cd93}ts=1533308"}}, "type": "repository", "name": "ign-rendering", "full_name": "ignitionrobotics/ign-rendering", "uuid": "{f6b404b6-f373-460d-a470-69ff6f27cd93}"}, "branch": {"name": "ign-rendering2"}}, "reason": "", "source": {"commit": {"hash": "8004c2a168dd", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-rendering/commit/8004c2a168dd.json"}, "html": {"href": "#!/ignitionrobotics/ign-rendering/commits/8004c2a168dd"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-rendering.json"}, "html": {"href": "#!/ignitionrobotics/ign-rendering"}, "avatar": {"href": "data/bytebucket.org/ravatar/{f6b404b6-f373-460d-a470-69ff6f27cd93}ts=1533308"}}, "type": "repository", "name": "ign-rendering", "full_name": "ignitionrobotics/ign-rendering", "uuid": "{f6b404b6-f373-460d-a470-69ff6f27cd93}"}, "branch": {"name": "ogre2_light_shadows"}}, "state": "OPEN", "author": {"display_name": "Nate Koenig", "uuid": "{c862cdd9-fcc8-4419-9fc7-e20db14b8fcb}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Bc862cdd9-fcc8-4419-9fc7-e20db14b8fcb%7D"}, "html": {"href": "https://bitbucket.org/%7Bc862cdd9-fcc8-4419-9fc7-e20db14b8fcb%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:095b1e12-74ed-4e20-b44f-2f0745b616e0/ca24bb11-4787-4b14-a20d-d91835e9bde2/128"}}, "nickname": "Nathan Koenig", "type": "user", "account_id": "557058:095b1e12-74ed-4e20-b44f-2f0745b616e0"}, "date": "2019-12-17T19:08:57.905398+00:00"}, "pull_request": {"type": "pullrequest", "id": 222, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-rendering/pullrequests/222.json"}, "html": {"href": "#!/ignitionrobotics/ign-rendering/pull-requests/222"}}, "title": "Ogre2: Fix shadows by dynamically generating shadow maps"}}, {"approval": {"date": "2019-12-17T19:08:32.688344+00:00", "pullrequest": {"type": "pullrequest", "id": 222, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-rendering/pullrequests/222.json"}, "html": {"href": "#!/ignitionrobotics/ign-rendering/pull-requests/222"}}, "title": "Ogre2: Fix shadows by dynamically generating shadow maps"}, "user": {"display_name": "Nate Koenig", "uuid": "{c862cdd9-fcc8-4419-9fc7-e20db14b8fcb}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Bc862cdd9-fcc8-4419-9fc7-e20db14b8fcb%7D"}, "html": {"href": "https://bitbucket.org/%7Bc862cdd9-fcc8-4419-9fc7-e20db14b8fcb%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:095b1e12-74ed-4e20-b44f-2f0745b616e0/ca24bb11-4787-4b14-a20d-d91835e9bde2/128"}}, "nickname": "Nathan Koenig", "type": "user", "account_id": "557058:095b1e12-74ed-4e20-b44f-2f0745b616e0"}}, "pull_request": {"type": "pullrequest", "id": 222, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-rendering/pullrequests/222.json"}, "html": {"href": "#!/ignitionrobotics/ign-rendering/pull-requests/222"}}, "title": "Ogre2: Fix shadows by dynamically generating shadow maps"}}, {"comment": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-rendering/pullrequests/222/comments/129177265.json"}, "html": {"href": "#!/ignitionrobotics/ign-rendering/pull-requests/222/_/diff#comment-129177265"}}, "parent": {"id": 129144051, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-rendering/pullrequests/222/comments/129144051.json"}, "html": {"href": "#!/ignitionrobotics/ign-rendering/pull-requests/222/_/diff#comment-129144051"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 222, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-rendering/pullrequests/222.json"}, "html": {"href": "#!/ignitionrobotics/ign-rendering/pull-requests/222"}}, "title": "Ogre2: Fix shadows by dynamically generating shadow maps"}, "content": {"raw": "There is an impact on resource usage. I found that in the previous approach of using statically defined shadow texture, all those textures were created on startup even if they are not used. So for the typical use case outside of subt, it\u2019s a waste. The new approach recreates these resources whenever the number of shadow casting light changes but the downside of this approach is that all these resources needs to be destroyed and recreated so there is a performance impact when a new shadow-casting light is added or removed. I have yet to find a way to avoid this.", "markup": "markdown", "html": "<p>There is an impact on resource usage. I found that in the previous approach of using statically defined shadow texture, all those textures were created on startup even if they are not used. So for the typical use case outside of subt, it\u2019s a waste. The new approach recreates these resources whenever the number of shadow casting light changes but the downside of this approach is that all these resources needs to be destroyed and recreated so there is a performance impact when a new shadow-casting light is added or removed. I have yet to find a way to avoid this.</p>", "type": "rendered"}, "created_on": "2019-12-17T18:42:39.097774+00:00", "user": {"display_name": "Ian Chen", "uuid": "{eaa6fca5-6deb-43f6-907f-971c144735dd}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Beaa6fca5-6deb-43f6-907f-971c144735dd%7D"}, "html": {"href": "https://bitbucket.org/%7Beaa6fca5-6deb-43f6-907f-971c144735dd%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:10b01d41-a2e9-4a41-a907-e6e2f03b6cd5/1e4adcdf-1946-4280-9aea-eb5f15a7f912/128"}}, "nickname": "Ian Chen", "type": "user", "account_id": "557058:10b01d41-a2e9-4a41-a907-e6e2f03b6cd5"}, "updated_on": "2019-12-17T18:43:25.214575+00:00", "type": "pullrequest_comment", "id": 129177265}, "pull_request": {"type": "pullrequest", "id": 222, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-rendering/pullrequests/222.json"}, "html": {"href": "#!/ignitionrobotics/ign-rendering/pull-requests/222"}}, "title": "Ogre2: Fix shadows by dynamically generating shadow maps"}}, {"comment": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-rendering/pullrequests/222/comments/129176336.json"}, "html": {"href": "#!/ignitionrobotics/ign-rendering/pull-requests/222/_/diff#comment-129176336"}}, "parent": {"id": 129156239, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-rendering/pullrequests/222/comments/129156239.json"}, "html": {"href": "#!/ignitionrobotics/ign-rendering/pull-requests/222/_/diff#comment-129156239"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 222, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-rendering/pullrequests/222.json"}, "html": {"href": "#!/ignitionrobotics/ign-rendering/pull-requests/222"}}, "title": "Ogre2: Fix shadows by dynamically generating shadow maps"}, "content": {"raw": "expanded doxygen comment to describe what a texture atlas is. [4d91f5d](#!/ignitionrobotics/ign-rendering/commits/4d91f5dc58206846045a98dc6fd2be79308c9552)", "markup": "markdown", "html": "<p>expanded doxygen comment to describe what a texture atlas is. <a data-is-external-link=\"true\" href=\"#!/ignitionrobotics/ign-rendering/commits/4d91f5dc58206846045a98dc6fd2be79308c9552\" rel=\"nofollow\">4d91f5d</a></p>", "type": "rendered"}, "created_on": "2019-12-17T18:35:53.484367+00:00", "user": {"display_name": "Ian Chen", "uuid": "{eaa6fca5-6deb-43f6-907f-971c144735dd}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Beaa6fca5-6deb-43f6-907f-971c144735dd%7D"}, "html": {"href": "https://bitbucket.org/%7Beaa6fca5-6deb-43f6-907f-971c144735dd%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:10b01d41-a2e9-4a41-a907-e6e2f03b6cd5/1e4adcdf-1946-4280-9aea-eb5f15a7f912/128"}}, "nickname": "Ian Chen", "type": "user", "account_id": "557058:10b01d41-a2e9-4a41-a907-e6e2f03b6cd5"}, "inline": {}, "updated_on": "2019-12-17T18:35:53.492854+00:00", "type": "pullrequest_comment", "id": 129176336}, "pull_request": {"type": "pullrequest", "id": 222, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-rendering/pullrequests/222.json"}, "html": {"href": "#!/ignitionrobotics/ign-rendering/pull-requests/222"}}, "title": "Ogre2: Fix shadows by dynamically generating shadow maps"}}, {"comment": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-rendering/pullrequests/222/comments/129176207.json"}, "html": {"href": "#!/ignitionrobotics/ign-rendering/pull-requests/222/_/diff#comment-129176207"}}, "parent": {"id": 129157690, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-rendering/pullrequests/222/comments/129157690.json"}, "html": {"href": "#!/ignitionrobotics/ign-rendering/pull-requests/222/_/diff#comment-129157690"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 222, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-rendering/pullrequests/222.json"}, "html": {"href": "#!/ignitionrobotics/ign-rendering/pull-requests/222"}}, "title": "Ogre2: Fix shadows by dynamically generating shadow maps"}, "content": {"raw": "I see. I wanted to discourage users from calling this internal function. Adding `\\cond` and `\\endcond` worked and the functions no longer appear in the generated doc.  [4d91f5d](#!/ignitionrobotics/ign-rendering/commits/4d91f5dc58206846045a98dc6fd2be79308c9552)", "markup": "markdown", "html": "<p>I see. I wanted to discourage users from calling this internal function. Adding <code>\\cond</code> and <code>\\endcond</code> worked and the functions no longer appear in the generated doc.  <a data-is-external-link=\"true\" href=\"#!/ignitionrobotics/ign-rendering/commits/4d91f5dc58206846045a98dc6fd2be79308c9552\" rel=\"nofollow\">4d91f5d</a></p>", "type": "rendered"}, "created_on": "2019-12-17T18:34:59.344776+00:00", "user": {"display_name": "Ian Chen", "uuid": "{eaa6fca5-6deb-43f6-907f-971c144735dd}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Beaa6fca5-6deb-43f6-907f-971c144735dd%7D"}, "html": {"href": "https://bitbucket.org/%7Beaa6fca5-6deb-43f6-907f-971c144735dd%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:10b01d41-a2e9-4a41-a907-e6e2f03b6cd5/1e4adcdf-1946-4280-9aea-eb5f15a7f912/128"}}, "nickname": "Ian Chen", "type": "user", "account_id": "557058:10b01d41-a2e9-4a41-a907-e6e2f03b6cd5"}, "inline": {}, "updated_on": "2019-12-17T18:34:59.352842+00:00", "type": "pullrequest_comment", "id": 129176207}, "pull_request": {"type": "pullrequest", "id": 222, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-rendering/pullrequests/222.json"}, "html": {"href": "#!/ignitionrobotics/ign-rendering/pull-requests/222"}}, "title": "Ogre2: Fix shadows by dynamically generating shadow maps"}}, {"comment": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-rendering/pullrequests/222/comments/129176002.json"}, "html": {"href": "#!/ignitionrobotics/ign-rendering/pull-requests/222/_/diff#comment-129176002"}}, "parent": {"id": 129157817, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-rendering/pullrequests/222/comments/129157817.json"}, "html": {"href": "#!/ignitionrobotics/ign-rendering/pull-requests/222/_/diff#comment-129157817"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 222, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-rendering/pullrequests/222.json"}, "html": {"href": "#!/ignitionrobotics/ign-rendering/pull-requests/222"}}, "title": "Ogre2: Fix shadows by dynamically generating shadow maps"}, "content": {"raw": "yep, updated comment to mention ign-rendering4\n\n[4d91f5d](#!/ignitionrobotics/ign-rendering/commits/4d91f5dc58206846045a98dc6fd2be79308c9552)", "markup": "markdown", "html": "<p>yep, updated comment to mention ign-rendering4</p>\n<p><a data-is-external-link=\"true\" href=\"#!/ignitionrobotics/ign-rendering/commits/4d91f5dc58206846045a98dc6fd2be79308c9552\" rel=\"nofollow\">4d91f5d</a></p>", "type": "rendered"}, "created_on": "2019-12-17T18:33:21.154742+00:00", "user": {"display_name": "Ian Chen", "uuid": "{eaa6fca5-6deb-43f6-907f-971c144735dd}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Beaa6fca5-6deb-43f6-907f-971c144735dd%7D"}, "html": {"href": "https://bitbucket.org/%7Beaa6fca5-6deb-43f6-907f-971c144735dd%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:10b01d41-a2e9-4a41-a907-e6e2f03b6cd5/1e4adcdf-1946-4280-9aea-eb5f15a7f912/128"}}, "nickname": "Ian Chen", "type": "user", "account_id": "557058:10b01d41-a2e9-4a41-a907-e6e2f03b6cd5"}, "inline": {}, "updated_on": "2019-12-17T18:33:21.165313+00:00", "type": "pullrequest_comment", "id": 129176002}, "pull_request": {"type": "pullrequest", "id": 222, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-rendering/pullrequests/222.json"}, "html": {"href": "#!/ignitionrobotics/ign-rendering/pull-requests/222"}}, "title": "Ogre2: Fix shadows by dynamically generating shadow maps"}}, {"update": {"description": "Replaces pull request #217. Third attempt - Shadows should hopefully work properly now!\r\n\r\nThe main cause of a problem was that the shadow casting lights did not match the ones statically defined in `PbsMaterials.compositor`. The original PR tries to workaround the issue but I ran into a bug in ogre2 that prevents it from working in some cases.\r\n\r\nTo fix the problem, I now programmatically construct the shadow node whenever the number of shadow casting lights changes so that we always use the correct number of shadow maps. \r\n\r\nI ran into a different bug in ogre2 for dynamically creating the shadow nodes. I had to adapt its code and fix the bug in `Ogre2RenderTarget::CreateShadowNodeWithSettings` function.\r\n\r\nScreenshot from tunnel.sdf that uses version 3 of X1 UGV model from fuel\r\n\r\n![](https://bitbucket.org/repo/zq9ear/images/445905331-spot_light_shadows_tunnel.png)\r\n\u200c\r\n\r\n\u200c", "title": "Ogre2: Fix shadows by dynamically generating shadow maps", "destination": {"commit": {"hash": "68150130746f", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-rendering/commit/68150130746f.json"}, "html": {"href": "#!/ignitionrobotics/ign-rendering/commits/68150130746f"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-rendering.json"}, "html": {"href": "#!/ignitionrobotics/ign-rendering"}, "avatar": {"href": "data/bytebucket.org/ravatar/{f6b404b6-f373-460d-a470-69ff6f27cd93}ts=1533308"}}, "type": "repository", "name": "ign-rendering", "full_name": "ignitionrobotics/ign-rendering", "uuid": "{f6b404b6-f373-460d-a470-69ff6f27cd93}"}, "branch": {"name": "ign-rendering2"}}, "reason": "", "source": {"commit": {"hash": "4d91f5dc5820", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-rendering/commit/4d91f5dc5820.json"}, "html": {"href": "#!/ignitionrobotics/ign-rendering/commits/4d91f5dc5820"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-rendering.json"}, "html": {"href": "#!/ignitionrobotics/ign-rendering"}, "avatar": {"href": "data/bytebucket.org/ravatar/{f6b404b6-f373-460d-a470-69ff6f27cd93}ts=1533308"}}, "type": "repository", "name": "ign-rendering", "full_name": "ignitionrobotics/ign-rendering", "uuid": "{f6b404b6-f373-460d-a470-69ff6f27cd93}"}, "branch": {"name": "ogre2_light_shadows"}}, "state": "OPEN", "author": {"display_name": "Ian Chen", "uuid": "{eaa6fca5-6deb-43f6-907f-971c144735dd}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Beaa6fca5-6deb-43f6-907f-971c144735dd%7D"}, "html": {"href": "https://bitbucket.org/%7Beaa6fca5-6deb-43f6-907f-971c144735dd%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:10b01d41-a2e9-4a41-a907-e6e2f03b6cd5/1e4adcdf-1946-4280-9aea-eb5f15a7f912/128"}}, "nickname": "Ian Chen", "type": "user", "account_id": "557058:10b01d41-a2e9-4a41-a907-e6e2f03b6cd5"}, "date": "2019-12-17T18:32:43.461053+00:00"}, "pull_request": {"type": "pullrequest", "id": 222, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-rendering/pullrequests/222.json"}, "html": {"href": "#!/ignitionrobotics/ign-rendering/pull-requests/222"}}, "title": "Ogre2: Fix shadows by dynamically generating shadow maps"}}, {"comment": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-rendering/pullrequests/222/comments/129157817.json"}, "html": {"href": "#!/ignitionrobotics/ign-rendering/pull-requests/222/_/diff#comment-129157817"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 222, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-rendering/pullrequests/222.json"}, "html": {"href": "#!/ignitionrobotics/ign-rendering/pull-requests/222"}}, "title": "Ogre2: Fix shadows by dynamically generating shadow maps"}, "content": {"raw": "Is this something that can be done in ign-rendering4?", "markup": "markdown", "html": "<p>Is this something that can be done in ign-rendering4?</p>", "type": "rendered"}, "created_on": "2019-12-17T16:34:25.128856+00:00", "user": {"display_name": "Nate Koenig", "uuid": "{c862cdd9-fcc8-4419-9fc7-e20db14b8fcb}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Bc862cdd9-fcc8-4419-9fc7-e20db14b8fcb%7D"}, "html": {"href": "https://bitbucket.org/%7Bc862cdd9-fcc8-4419-9fc7-e20db14b8fcb%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:095b1e12-74ed-4e20-b44f-2f0745b616e0/ca24bb11-4787-4b14-a20d-d91835e9bde2/128"}}, "nickname": "Nathan Koenig", "type": "user", "account_id": "557058:095b1e12-74ed-4e20-b44f-2f0745b616e0"}, "inline": {}, "updated_on": "2019-12-17T16:34:25.137298+00:00", "type": "pullrequest_comment", "id": 129157817}, "pull_request": {"type": "pullrequest", "id": 222, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-rendering/pullrequests/222.json"}, "html": {"href": "#!/ignitionrobotics/ign-rendering/pull-requests/222"}}, "title": "Ogre2: Fix shadows by dynamically generating shadow maps"}}, {"comment": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-rendering/pullrequests/222/comments/129157690.json"}, "html": {"href": "#!/ignitionrobotics/ign-rendering/pull-requests/222/_/diff#comment-129157690"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 222, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-rendering/pullrequests/222.json"}, "html": {"href": "#!/ignitionrobotics/ign-rendering/pull-requests/222"}}, "title": "Ogre2: Fix shadows by dynamically generating shadow maps"}, "content": {"raw": "Do you want these functions to appear in doxygen? The `\\internal` doxygen command doesn't do this. I think you need to surround the document block and function definition with `\\cond` ... `\\endcond`.", "markup": "markdown", "html": "<p>Do you want these functions to appear in doxygen? The <code>\\internal</code> doxygen command doesn't do this. I think you need to surround the document block and function definition with <code>\\cond</code> ... <code>\\endcond</code>.</p>", "type": "rendered"}, "created_on": "2019-12-17T16:33:48.850232+00:00", "user": {"display_name": "Nate Koenig", "uuid": "{c862cdd9-fcc8-4419-9fc7-e20db14b8fcb}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Bc862cdd9-fcc8-4419-9fc7-e20db14b8fcb%7D"}, "html": {"href": "https://bitbucket.org/%7Bc862cdd9-fcc8-4419-9fc7-e20db14b8fcb%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:095b1e12-74ed-4e20-b44f-2f0745b616e0/ca24bb11-4787-4b14-a20d-d91835e9bde2/128"}}, "nickname": "Nathan Koenig", "type": "user", "account_id": "557058:095b1e12-74ed-4e20-b44f-2f0745b616e0"}, "inline": {}, "updated_on": "2019-12-17T16:33:48.861834+00:00", "type": "pullrequest_comment", "id": 129157690}, "pull_request": {"type": "pullrequest", "id": 222, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-rendering/pullrequests/222.json"}, "html": {"href": "#!/ignitionrobotics/ign-rendering/pull-requests/222"}}, "title": "Ogre2: Fix shadows by dynamically generating shadow maps"}}, {"comment": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-rendering/pullrequests/222/comments/129156239.json"}, "html": {"href": "#!/ignitionrobotics/ign-rendering/pull-requests/222/_/diff#comment-129156239"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 222, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-rendering/pullrequests/222.json"}, "html": {"href": "#!/ignitionrobotics/ign-rendering/pull-requests/222"}}, "title": "Ogre2: Fix shadows by dynamically generating shadow maps"}, "content": {"raw": "What is the \"atlas\"?", "markup": "markdown", "html": "<p>What is the \"atlas\"?</p>", "type": "rendered"}, "created_on": "2019-12-17T16:26:57.033171+00:00", "user": {"display_name": "Nate Koenig", "uuid": "{c862cdd9-fcc8-4419-9fc7-e20db14b8fcb}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Bc862cdd9-fcc8-4419-9fc7-e20db14b8fcb%7D"}, "html": {"href": "https://bitbucket.org/%7Bc862cdd9-fcc8-4419-9fc7-e20db14b8fcb%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:095b1e12-74ed-4e20-b44f-2f0745b616e0/ca24bb11-4787-4b14-a20d-d91835e9bde2/128"}}, "nickname": "Nathan Koenig", "type": "user", "account_id": "557058:095b1e12-74ed-4e20-b44f-2f0745b616e0"}, "inline": {}, "updated_on": "2019-12-17T16:26:57.043483+00:00", "type": "pullrequest_comment", "id": 129156239}, "pull_request": {"type": "pullrequest", "id": 222, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-rendering/pullrequests/222.json"}, "html": {"href": "#!/ignitionrobotics/ign-rendering/pull-requests/222"}}, "title": "Ogre2: Fix shadows by dynamically generating shadow maps"}}, {"comment": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-rendering/pullrequests/222/comments/129144051.json"}, "html": {"href": "#!/ignitionrobotics/ign-rendering/pull-requests/222/_/diff#comment-129144051"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 222, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-rendering/pullrequests/222.json"}, "html": {"href": "#!/ignitionrobotics/ign-rendering/pull-requests/222"}}, "title": "Ogre2: Fix shadows by dynamically generating shadow maps"}, "content": {"raw": "Does this have an impact on performance of rendering?", "markup": "markdown", "html": "<p>Does this have an impact on performance of rendering?</p>", "type": "rendered"}, "created_on": "2019-12-17T15:30:36.816416+00:00", "user": {"display_name": "Michael Carroll", "uuid": "{17dbbc15-cbc0-42f0-a985-cde9061c78a0}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B17dbbc15-cbc0-42f0-a985-cde9061c78a0%7D"}, "html": {"href": "https://bitbucket.org/%7B17dbbc15-cbc0-42f0-a985-cde9061c78a0%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:65740f22-cc56-4418-9608-7e17d0ed47b7/2aa259f5-4de1-4f68-9156-eded72041d84/128"}}, "nickname": "Michael Carroll", "type": "user", "account_id": "557058:65740f22-cc56-4418-9608-7e17d0ed47b7"}, "updated_on": "2019-12-17T15:30:36.826348+00:00", "type": "pullrequest_comment", "id": 129144051}, "pull_request": {"type": "pullrequest", "id": 222, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-rendering/pullrequests/222.json"}, "html": {"href": "#!/ignitionrobotics/ign-rendering/pull-requests/222"}}, "title": "Ogre2: Fix shadows by dynamically generating shadow maps"}}, {"approval": {"date": "2019-12-16T04:51:12.115352+00:00", "pullrequest": {"type": "pullrequest", "id": 222, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-rendering/pullrequests/222.json"}, "html": {"href": "#!/ignitionrobotics/ign-rendering/pull-requests/222"}}, "title": "Ogre2: Fix shadows by dynamically generating shadow maps"}, "user": {"display_name": "Alfredo Bencomo", "uuid": "{84891a71-dff2-4b97-8891-9446c16e6f89}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B84891a71-dff2-4b97-8891-9446c16e6f89%7D"}, "html": {"href": "https://bitbucket.org/%7B84891a71-dff2-4b97-8891-9446c16e6f89%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/5cf75629ff02b50ea27b2817/82be1d48-d490-4d7b-8ddb-a8093b9417a6/128"}}, "nickname": "bencomo", "type": "user", "account_id": "5cf75629ff02b50ea27b2817"}}, "pull_request": {"type": "pullrequest", "id": 222, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-rendering/pullrequests/222.json"}, "html": {"href": "#!/ignitionrobotics/ign-rendering/pull-requests/222"}}, "title": "Ogre2: Fix shadows by dynamically generating shadow maps"}}, {"update": {"description": "Replaces pull request #217. Third attempt - Shadows should hopefully work properly now!\r\n\r\nThe main cause of a problem was that the shadow casting lights did not match the ones statically defined in `PbsMaterials.compositor`. The original PR tries to workaround the issue but I ran into a bug in ogre2 that prevents it from working in some cases.\r\n\r\nTo fix the problem, I now programmatically construct the shadow node whenever the number of shadow casting lights changes so that we always use the correct number of shadow maps. \r\n\r\nI ran into a different bug in ogre2 for dynamically creating the shadow nodes. I had to adapt its code and fix the bug in `Ogre2RenderTarget::CreateShadowNodeWithSettings` function.\r\n\r\nScreenshot from tunnel.sdf that uses version 3 of X1 UGV model from fuel\r\n\r\n![](https://bitbucket.org/repo/zq9ear/images/445905331-spot_light_shadows_tunnel.png)\r\n\u200c\r\n\r\n\u200c", "title": "Ogre2: Fix shadows by dynamically generating shadow maps", "destination": {"commit": {"hash": "68150130746f", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-rendering/commit/68150130746f.json"}, "html": {"href": "#!/ignitionrobotics/ign-rendering/commits/68150130746f"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-rendering.json"}, "html": {"href": "#!/ignitionrobotics/ign-rendering"}, "avatar": {"href": "data/bytebucket.org/ravatar/{f6b404b6-f373-460d-a470-69ff6f27cd93}ts=1533308"}}, "type": "repository", "name": "ign-rendering", "full_name": "ignitionrobotics/ign-rendering", "uuid": "{f6b404b6-f373-460d-a470-69ff6f27cd93}"}, "branch": {"name": "ign-rendering2"}}, "reason": "", "source": {"commit": {"hash": "17f2b4f71b63", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-rendering/commit/17f2b4f71b63.json"}, "html": {"href": "#!/ignitionrobotics/ign-rendering/commits/17f2b4f71b63"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-rendering.json"}, "html": {"href": "#!/ignitionrobotics/ign-rendering"}, "avatar": {"href": "data/bytebucket.org/ravatar/{f6b404b6-f373-460d-a470-69ff6f27cd93}ts=1533308"}}, "type": "repository", "name": "ign-rendering", "full_name": "ignitionrobotics/ign-rendering", "uuid": "{f6b404b6-f373-460d-a470-69ff6f27cd93}"}, "branch": {"name": "ogre2_light_shadows"}}, "state": "OPEN", "author": {"display_name": "Ian Chen", "uuid": "{eaa6fca5-6deb-43f6-907f-971c144735dd}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Beaa6fca5-6deb-43f6-907f-971c144735dd%7D"}, "html": {"href": "https://bitbucket.org/%7Beaa6fca5-6deb-43f6-907f-971c144735dd%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:10b01d41-a2e9-4a41-a907-e6e2f03b6cd5/1e4adcdf-1946-4280-9aea-eb5f15a7f912/128"}}, "nickname": "Ian Chen", "type": "user", "account_id": "557058:10b01d41-a2e9-4a41-a907-e6e2f03b6cd5"}, "date": "2019-12-13T22:10:44.523556+00:00"}, "pull_request": {"type": "pullrequest", "id": 222, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-rendering/pullrequests/222.json"}, "html": {"href": "#!/ignitionrobotics/ign-rendering/pull-requests/222"}}, "title": "Ogre2: Fix shadows by dynamically generating shadow maps"}}, {"update": {"description": "Replaces pull request #217. Third attempt - Shadows should hopefully work properly now!\r\n\r\nThe main cause of a problem was that the shadow casting lights did not match the ones statically defined in `PbsMaterials.compositor`. The original PR tries to workaround the issue but I ran into a bug in ogre2 that prevents it from working in some cases.\r\n\r\nTo fix the problem, I now programmatically construct the shadow node whenever the number of shadow casting lights changes so that we always use the correct number of shadow maps. \r\n\r\nI ran into a different bug in ogre2 for dynamically creating the shadow nodes. I had to adapt its code and fix the bug in `Ogre2RenderTarget::CreateShadowNodeWithSettings` function.\r\n\r\nScreenshot from tunnel.sdf that uses version 3 of X1 UGV model from fuel\r\n\r\n![](https://bitbucket.org/repo/zq9ear/images/445905331-spot_light_shadows_tunnel.png)\r\n\u200c\r\n\r\n\u200c", "title": "Ogre2: Fix shadows by dynamically generating shadow maps", "destination": {"commit": {"hash": "68150130746f", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-rendering/commit/68150130746f.json"}, "html": {"href": "#!/ignitionrobotics/ign-rendering/commits/68150130746f"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-rendering.json"}, "html": {"href": "#!/ignitionrobotics/ign-rendering"}, "avatar": {"href": "data/bytebucket.org/ravatar/{f6b404b6-f373-460d-a470-69ff6f27cd93}ts=1533308"}}, "type": "repository", "name": "ign-rendering", "full_name": "ignitionrobotics/ign-rendering", "uuid": "{f6b404b6-f373-460d-a470-69ff6f27cd93}"}, "branch": {"name": "ign-rendering2"}}, "reason": "", "source": {"commit": {"hash": "17f2b4f71b63", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-rendering/commit/17f2b4f71b63.json"}, "html": {"href": "#!/ignitionrobotics/ign-rendering/commits/17f2b4f71b63"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-rendering.json"}, "html": {"href": "#!/ignitionrobotics/ign-rendering"}, "avatar": {"href": "data/bytebucket.org/ravatar/{f6b404b6-f373-460d-a470-69ff6f27cd93}ts=1533308"}}, "type": "repository", "name": "ign-rendering", "full_name": "ignitionrobotics/ign-rendering", "uuid": "{f6b404b6-f373-460d-a470-69ff6f27cd93}"}, "branch": {"name": "ogre2_light_shadows"}}, "state": "OPEN", "author": {"display_name": "Ian Chen", "uuid": "{eaa6fca5-6deb-43f6-907f-971c144735dd}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Beaa6fca5-6deb-43f6-907f-971c144735dd%7D"}, "html": {"href": "https://bitbucket.org/%7Beaa6fca5-6deb-43f6-907f-971c144735dd%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:10b01d41-a2e9-4a41-a907-e6e2f03b6cd5/1e4adcdf-1946-4280-9aea-eb5f15a7f912/128"}}, "nickname": "Ian Chen", "type": "user", "account_id": "557058:10b01d41-a2e9-4a41-a907-e6e2f03b6cd5"}, "date": "2019-12-13T22:10:44.471865+00:00"}, "pull_request": {"type": "pullrequest", "id": 222, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-rendering/pullrequests/222.json"}, "html": {"href": "#!/ignitionrobotics/ign-rendering/pull-requests/222"}}, "title": "Ogre2: Fix shadows by dynamically generating shadow maps"}}]}