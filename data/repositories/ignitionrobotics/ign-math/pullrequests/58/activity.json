{"pagelen": 50, "values": [{"comment": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-math/pullrequests/58/comments/22434617.json"}, "html": {"href": "#!/ignitionrobotics/ign-math/pull-requests/58/_/diff#comment-22434617"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 58, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-math/pullrequests/58.json"}, "html": {"href": "#!/ignitionrobotics/ign-math/pull-requests/58"}}, "title": "Change equality helper to work with 387 fp unit"}, "content": {"raw": "Backporting this to `ign-math2` in pull request #125", "markup": "markdown", "html": "<p>Backporting this to <code>ign-math2</code> in <a href=\"#!/ignitionrobotics/ign-math/pull-requests/125/backport-from-default-to-ign-math2-and-fix\" rel=\"nofollow\" class=\"ap-connect-link\">pull request #125</a></p>", "type": "rendered"}, "created_on": "2016-08-16T22:56:23.228494+00:00", "user": {"display_name": "Louise Poubel", "uuid": "{5cfa2075-477b-4ded-bdb9-8d2479544ec4}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D"}, "html": {"href": "https://bitbucket.org/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8/7d903d90-c5ea-4182-b7ef-0d467e9e1c74/128"}}, "nickname": "chapulina", "type": "user", "account_id": "557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8"}, "updated_on": "2016-08-16T22:56:23.232193+00:00", "type": "pullrequest_comment", "id": 22434617}, "pull_request": {"type": "pullrequest", "id": 58, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-math/pullrequests/58.json"}, "html": {"href": "#!/ignitionrobotics/ign-math/pull-requests/58"}}, "title": "Change equality helper to work with 387 fp unit"}}, {"update": {"description": "When building on i686 without SSE, the ign equality helper uses the extra\r\nprecision within the x87 floating point module when comparing the difference\r\nbetween the two arguments to the epsilon value.  This causes the\r\nLine2Test.CollinearPoint unit test to fail when epsilon is set to .0001\r\n\r\n```\r\n13/44 Testing: UNIT_Line2_TEST\r\n13/44 Test: UNIT_Line2_TEST\r\nCommand: \"/builddir/build/BUILD/ignition-math2-2.2.2/build/src/UNIT_Line2_TEST\" \"--gtest_output=xml:/builddir/build/BUILD/ignition-math2-2.2.2/build/test_results/UNIT_Line2_TEST.xml\"\r\nDirectory: /builddir/build/BUILD/ignition-math2-2.2.2/build/src\r\n\"UNIT_Line2_TEST\" start time: Aug 21 00:43 UTC\r\nOutput:\r\n----------------------------------------------------------\r\nRunning main() from gtest_main.cc\r\n[==========] Running 9 tests from 1 test case.\r\n[----------] Global test environment set-up.\r\n[----------] 9 tests from Line2Test\r\n[ RUN      ] Line2Test.Constructor\r\n[       OK ] Line2Test.Constructor (0 ms)\r\n[ RUN      ] Line2Test.Length\r\n[       OK ] Line2Test.Length (0 ms)\r\n[ RUN      ] Line2Test.Slope\r\n[       OK ] Line2Test.Slope (0 ms)\r\n[ RUN      ] Line2Test.ParallelLine\r\n[       OK ] Line2Test.ParallelLine (0 ms)\r\n[ RUN      ] Line2Test.CollinearLine\r\n[       OK ] Line2Test.CollinearLine (0 ms)\r\n[ RUN      ] Line2Test.CollinearPoint\r\n/builddir/build/BUILD/ignition-math2-2.2.2/src/Line2_TEST.cc:152: Failure\r\nValue of: lineA.Collinear(pt, 1e-4)\r\n  Actual: false\r\nExpected: true\r\n/builddir/build/BUILD/ignition-math2-2.2.2/src/Line2_TEST.cc:164: Failure\r\nValue of: lineA.Collinear(pt, 1e-4)\r\n  Actual: false\r\nExpected: true\r\n[  FAILED  ] Line2Test.CollinearPoint (0 ms)\r\n[ RUN      ] Line2Test.Intersect\r\n[       OK ] Line2Test.Intersect (0 ms)\r\n[ RUN      ] Line2Test.Equality\r\n[       OK ] Line2Test.Equality (0 ms)\r\n[ RUN      ] Line2Test.OperatorStreamOut\r\n[       OK ] Line2Test.OperatorStreamOut (0 ms)\r\n[----------] 9 tests from Line2Test (0 ms total)\r\n[----------] Global test environment tear-down\r\n[==========] 9 tests from 1 test case ran. (0 ms total)\r\n[  PASSED  ] 8 tests.\r\n[  FAILED  ] 1 test, listed below:\r\n[  FAILED  ] Line2Test.CollinearPoint\r\n 1 FAILED TEST\r\n<end of output>\r\nTest time =   0.00 sec\r\n----------------------------------------------------------\r\nTest Failed.\r\n\"UNIT_Line2_TEST\" end time: Aug 21 00:43 UTC\r\n\"UNIT_Line2_TEST\" time elapsed: 00:00:00\r\n----------------------------------------------------------\r\n```\r\n\r\nThis patch creates an intermediate value for the difference between the two\r\narguments to be compared, which gets rid of the extra x87 precision. The\r\nresulting comparison is then performed without the extra precision, allowing\r\nthe test to pass.\r\n\r\nThis test was performed against ignition-math2-2.2.2\r\n\r\nSee http://stackoverflow.com/questions/16325277/floating-point-equality-test-and-extra-precision-can-this-code-fail for a discussion of x87 equality pitfalls.", "title": "Change equality helper to work with 387 fp unit", "destination": {"commit": {"hash": "7f2a000a3476", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-math/commit/7f2a000a3476.json"}, "html": {"href": "#!/ignitionrobotics/ign-math/commits/7f2a000a3476"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-math.json"}, "html": {"href": "#!/ignitionrobotics/ign-math"}, "avatar": {"href": "data/bytebucket.org/ravatar/{18503e50-08ea-4d88-ab99-110fde3c7256}ts=1533305"}}, "type": "repository", "name": "ign-math", "full_name": "ignitionrobotics/ign-math", "uuid": "{18503e50-08ea-4d88-ab99-110fde3c7256}"}, "branch": {"name": "default"}}, "reason": "", "source": {"commit": {"hash": "1cc536745543", "type": "commit", "links": {"self": {"href": "https://api.bitbucket.org/2.0/repositories/richmattes/ign-math/commit/1cc536745543"}, "html": {"href": "https://bitbucket.org/richmattes/ign-math/commits/1cc536745543"}}}, "repository": {"links": {"self": {"href": "https://api.bitbucket.org/2.0/repositories/richmattes/ign-math"}, "html": {"href": "https://bitbucket.org/richmattes/ign-math"}, "avatar": {"href": "data/bytebucket.org/ravatar/{ec8da820-bc0a-4654-a8be-676a74e7bae5}ts=c_plus_plus"}}, "type": "repository", "name": "ign-math", "full_name": "richmattes/ign-math", "uuid": "{ec8da820-bc0a-4654-a8be-676a74e7bae5}"}, "branch": {"name": "387_equality"}}, "state": "MERGED", "author": {"display_name": "Nate Koenig", "uuid": "{c862cdd9-fcc8-4419-9fc7-e20db14b8fcb}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Bc862cdd9-fcc8-4419-9fc7-e20db14b8fcb%7D"}, "html": {"href": "https://bitbucket.org/%7Bc862cdd9-fcc8-4419-9fc7-e20db14b8fcb%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:095b1e12-74ed-4e20-b44f-2f0745b616e0/ca24bb11-4787-4b14-a20d-d91835e9bde2/128"}}, "nickname": "Nathan Koenig", "type": "user", "account_id": "557058:095b1e12-74ed-4e20-b44f-2f0745b616e0"}, "date": "2015-09-18T21:41:21.173297+00:00"}, "pull_request": {"type": "pullrequest", "id": 58, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-math/pullrequests/58.json"}, "html": {"href": "#!/ignitionrobotics/ign-math/pull-requests/58"}}, "title": "Change equality helper to work with 387 fp unit"}}, {"approval": {"date": "2015-09-18T20:59:46.100530+00:00", "pullrequest": {"type": "pullrequest", "id": 58, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-math/pullrequests/58.json"}, "html": {"href": "#!/ignitionrobotics/ign-math/pull-requests/58"}}, "title": "Change equality helper to work with 387 fp unit"}, "user": {"display_name": "Carlos Ag\u00fcero", "uuid": "{da8a8e89-4bb0-421b-bd0e-dbbed3d4ed6a}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Bda8a8e89-4bb0-421b-bd0e-dbbed3d4ed6a%7D"}, "html": {"href": "https://bitbucket.org/%7Bda8a8e89-4bb0-421b-bd0e-dbbed3d4ed6a%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/692bf15758111acaddae4da15a47f9e5d=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsCA-0.png"}}, "nickname": "caguero", "type": "user", "account_id": "557058:4ded1ddf-947e-4154-bbd1-3dba24f1bdbd"}}, "pull_request": {"type": "pullrequest", "id": 58, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-math/pullrequests/58.json"}, "html": {"href": "#!/ignitionrobotics/ign-math/pull-requests/58"}}, "title": "Change equality helper to work with 387 fp unit"}}, {"approval": {"date": "2015-09-14T15:20:42.621227+00:00", "pullrequest": {"type": "pullrequest", "id": 58, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-math/pullrequests/58.json"}, "html": {"href": "#!/ignitionrobotics/ign-math/pull-requests/58"}}, "title": "Change equality helper to work with 387 fp unit"}, "user": {"display_name": "Nate Koenig", "uuid": "{c862cdd9-fcc8-4419-9fc7-e20db14b8fcb}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Bc862cdd9-fcc8-4419-9fc7-e20db14b8fcb%7D"}, "html": {"href": "https://bitbucket.org/%7Bc862cdd9-fcc8-4419-9fc7-e20db14b8fcb%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:095b1e12-74ed-4e20-b44f-2f0745b616e0/ca24bb11-4787-4b14-a20d-d91835e9bde2/128"}}, "nickname": "Nathan Koenig", "type": "user", "account_id": "557058:095b1e12-74ed-4e20-b44f-2f0745b616e0"}}, "pull_request": {"type": "pullrequest", "id": 58, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-math/pullrequests/58.json"}, "html": {"href": "#!/ignitionrobotics/ign-math/pull-requests/58"}}, "title": "Change equality helper to work with 387 fp unit"}}, {"comment": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-math/pullrequests/58/comments/9680694.json"}, "html": {"href": "#!/ignitionrobotics/ign-math/pull-requests/58/_/diff#comment-9680694"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 58, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-math/pullrequests/58.json"}, "html": {"href": "#!/ignitionrobotics/ign-math/pull-requests/58"}}, "title": "Change equality helper to work with 387 fp unit"}, "content": {"raw": "The update to the PR uses an approach similar to the Atlas one, where volatile vars are used when the 387 fp coprocessor is detected.  I've pushed a minimal change that fixes the unit test failure I'm seeing on i686 - successful build log with the updated patch can be found [here](https://kojipkgs.fedoraproject.org//work/tasks/497/10980497/build.log)", "markup": "markdown", "html": "<p>The update to the PR uses an approach similar to the Atlas one, where volatile vars are used when the 387 fp coprocessor is detected.  I've pushed a minimal change that fixes the unit test failure I'm seeing on i686 - successful build log with the updated patch can be found <a data-is-external-link=\"true\" href=\"https://kojipkgs.fedoraproject.org//work/tasks/497/10980497/build.log\" rel=\"nofollow\">here</a></p>", "type": "rendered"}, "created_on": "2015-09-06T17:23:17.802300+00:00", "user": {"display_name": "Rich Mattes", "uuid": "{1ef6f3dd-b8db-412b-94e9-e430e7aafd23}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B1ef6f3dd-b8db-412b-94e9-e430e7aafd23%7D"}, "html": {"href": "https://bitbucket.org/%7B1ef6f3dd-b8db-412b-94e9-e430e7aafd23%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/d431baafeedf5d8921cb50a3c9902e16d=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsRM-0.png"}}, "nickname": "richmattes", "type": "user", "account_id": "557058:a38935e3-9a08-40d9-917a-ff19973e58df"}, "updated_on": "2015-09-06T17:23:17.875531+00:00", "type": "pullrequest_comment", "id": 9680694}, "pull_request": {"type": "pullrequest", "id": 58, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-math/pullrequests/58.json"}, "html": {"href": "#!/ignitionrobotics/ign-math/pull-requests/58"}}, "title": "Change equality helper to work with 387 fp unit"}}, {"update": {"description": "When building on i686 without SSE, the ign equality helper uses the extra\r\nprecision within the x87 floating point module when comparing the difference\r\nbetween the two arguments to the epsilon value.  This causes the\r\nLine2Test.CollinearPoint unit test to fail when epsilon is set to .0001\r\n\r\n```\r\n13/44 Testing: UNIT_Line2_TEST\r\n13/44 Test: UNIT_Line2_TEST\r\nCommand: \"/builddir/build/BUILD/ignition-math2-2.2.2/build/src/UNIT_Line2_TEST\" \"--gtest_output=xml:/builddir/build/BUILD/ignition-math2-2.2.2/build/test_results/UNIT_Line2_TEST.xml\"\r\nDirectory: /builddir/build/BUILD/ignition-math2-2.2.2/build/src\r\n\"UNIT_Line2_TEST\" start time: Aug 21 00:43 UTC\r\nOutput:\r\n----------------------------------------------------------\r\nRunning main() from gtest_main.cc\r\n[==========] Running 9 tests from 1 test case.\r\n[----------] Global test environment set-up.\r\n[----------] 9 tests from Line2Test\r\n[ RUN      ] Line2Test.Constructor\r\n[       OK ] Line2Test.Constructor (0 ms)\r\n[ RUN      ] Line2Test.Length\r\n[       OK ] Line2Test.Length (0 ms)\r\n[ RUN      ] Line2Test.Slope\r\n[       OK ] Line2Test.Slope (0 ms)\r\n[ RUN      ] Line2Test.ParallelLine\r\n[       OK ] Line2Test.ParallelLine (0 ms)\r\n[ RUN      ] Line2Test.CollinearLine\r\n[       OK ] Line2Test.CollinearLine (0 ms)\r\n[ RUN      ] Line2Test.CollinearPoint\r\n/builddir/build/BUILD/ignition-math2-2.2.2/src/Line2_TEST.cc:152: Failure\r\nValue of: lineA.Collinear(pt, 1e-4)\r\n  Actual: false\r\nExpected: true\r\n/builddir/build/BUILD/ignition-math2-2.2.2/src/Line2_TEST.cc:164: Failure\r\nValue of: lineA.Collinear(pt, 1e-4)\r\n  Actual: false\r\nExpected: true\r\n[  FAILED  ] Line2Test.CollinearPoint (0 ms)\r\n[ RUN      ] Line2Test.Intersect\r\n[       OK ] Line2Test.Intersect (0 ms)\r\n[ RUN      ] Line2Test.Equality\r\n[       OK ] Line2Test.Equality (0 ms)\r\n[ RUN      ] Line2Test.OperatorStreamOut\r\n[       OK ] Line2Test.OperatorStreamOut (0 ms)\r\n[----------] 9 tests from Line2Test (0 ms total)\r\n[----------] Global test environment tear-down\r\n[==========] 9 tests from 1 test case ran. (0 ms total)\r\n[  PASSED  ] 8 tests.\r\n[  FAILED  ] 1 test, listed below:\r\n[  FAILED  ] Line2Test.CollinearPoint\r\n 1 FAILED TEST\r\n<end of output>\r\nTest time =   0.00 sec\r\n----------------------------------------------------------\r\nTest Failed.\r\n\"UNIT_Line2_TEST\" end time: Aug 21 00:43 UTC\r\n\"UNIT_Line2_TEST\" time elapsed: 00:00:00\r\n----------------------------------------------------------\r\n```\r\n\r\nThis patch creates an intermediate value for the difference between the two\r\narguments to be compared, which gets rid of the extra x87 precision. The\r\nresulting comparison is then performed without the extra precision, allowing\r\nthe test to pass.\r\n\r\nThis test was performed against ignition-math2-2.2.2\r\n\r\nSee http://stackoverflow.com/questions/16325277/floating-point-equality-test-and-extra-precision-can-this-code-fail for a discussion of x87 equality pitfalls.", "title": "Change equality helper to work with 387 fp unit", "destination": {"commit": {"hash": "20099df0cd2e", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-math/commit/20099df0cd2e.json"}, "html": {"href": "#!/ignitionrobotics/ign-math/commits/20099df0cd2e"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-math.json"}, "html": {"href": "#!/ignitionrobotics/ign-math"}, "avatar": {"href": "data/bytebucket.org/ravatar/{18503e50-08ea-4d88-ab99-110fde3c7256}ts=1533305"}}, "type": "repository", "name": "ign-math", "full_name": "ignitionrobotics/ign-math", "uuid": "{18503e50-08ea-4d88-ab99-110fde3c7256}"}, "branch": {"name": "default"}}, "reason": "", "source": {"commit": {"hash": "1cc536745543", "type": "commit", "links": {"self": {"href": "https://api.bitbucket.org/2.0/repositories/richmattes/ign-math/commit/1cc536745543"}, "html": {"href": "https://bitbucket.org/richmattes/ign-math/commits/1cc536745543"}}}, "repository": {"links": {"self": {"href": "https://api.bitbucket.org/2.0/repositories/richmattes/ign-math"}, "html": {"href": "https://bitbucket.org/richmattes/ign-math"}, "avatar": {"href": "data/bytebucket.org/ravatar/{ec8da820-bc0a-4654-a8be-676a74e7bae5}ts=c_plus_plus"}}, "type": "repository", "name": "ign-math", "full_name": "richmattes/ign-math", "uuid": "{ec8da820-bc0a-4654-a8be-676a74e7bae5}"}, "branch": {"name": "387_equality"}}, "state": "OPEN", "author": {"display_name": "Rich Mattes", "uuid": "{1ef6f3dd-b8db-412b-94e9-e430e7aafd23}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B1ef6f3dd-b8db-412b-94e9-e430e7aafd23%7D"}, "html": {"href": "https://bitbucket.org/%7B1ef6f3dd-b8db-412b-94e9-e430e7aafd23%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/d431baafeedf5d8921cb50a3c9902e16d=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsRM-0.png"}}, "nickname": "richmattes", "type": "user", "account_id": "557058:a38935e3-9a08-40d9-917a-ff19973e58df"}, "date": "2015-09-06T17:20:30.762428+00:00"}, "pull_request": {"type": "pullrequest", "id": 58, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-math/pullrequests/58.json"}, "html": {"href": "#!/ignitionrobotics/ign-math/pull-requests/58"}}, "title": "Change equality helper to work with 387 fp unit"}}, {"comment": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-math/pullrequests/58/comments/9680670.json"}, "html": {"href": "#!/ignitionrobotics/ign-math/pull-requests/58/_/diff#comment-9680670"}}, "parent": {"id": 9585293, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-math/pullrequests/58/comments/9585293.json"}, "html": {"href": "#!/ignitionrobotics/ign-math/pull-requests/58/_/diff#comment-9585293"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 58, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-math/pullrequests/58.json"}, "html": {"href": "#!/ignitionrobotics/ign-math/pull-requests/58"}}, "title": "Change equality helper to work with 387 fp unit"}, "content": {"raw": "I tried, it looks like it doesn't work:\n\nhttps://kojipkgs.fedoraproject.org//work/tasks/330/10980330/build.log\n\nI was able to get it to work using an approach similar to the Atlas approach, I'll update the PR with it.", "markup": "markdown", "html": "<p>I tried, it looks like it doesn't work:</p>\n<p><a href=\"https://kojipkgs.fedoraproject.org//work/tasks/330/10980330/build.log\" rel=\"nofollow\" class=\"ap-connect-link\">https://kojipkgs.fedoraproject.org//work/tasks/330/10980330/build.log</a></p>\n<p>I was able to get it to work using an approach similar to the Atlas approach, I'll update the PR with it.</p>", "type": "rendered"}, "created_on": "2015-09-06T17:13:33.274911+00:00", "user": {"display_name": "Rich Mattes", "uuid": "{1ef6f3dd-b8db-412b-94e9-e430e7aafd23}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B1ef6f3dd-b8db-412b-94e9-e430e7aafd23%7D"}, "html": {"href": "https://bitbucket.org/%7B1ef6f3dd-b8db-412b-94e9-e430e7aafd23%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/d431baafeedf5d8921cb50a3c9902e16d=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsRM-0.png"}}, "nickname": "richmattes", "type": "user", "account_id": "557058:a38935e3-9a08-40d9-917a-ff19973e58df"}, "inline": {}, "updated_on": "2015-09-06T17:13:33.351320+00:00", "type": "pullrequest_comment", "id": 9680670}, "pull_request": {"type": "pullrequest", "id": 58, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-math/pullrequests/58.json"}, "html": {"href": "#!/ignitionrobotics/ign-math/pull-requests/58"}}, "title": "Change equality helper to work with 387 fp unit"}}, {"comment": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-math/pullrequests/58/comments/9585293.json"}, "html": {"href": "#!/ignitionrobotics/ign-math/pull-requests/58/_/diff#comment-9585293"}}, "parent": {"id": 9585126, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-math/pullrequests/58/comments/9585126.json"}, "html": {"href": "#!/ignitionrobotics/ign-math/pull-requests/58/_/diff#comment-9585126"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 58, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-math/pullrequests/58.json"}, "html": {"href": "#!/ignitionrobotics/ign-math/pull-requests/58"}}, "title": "Change equality helper to work with 387 fp unit"}, "content": {"raw": "I think this might be a bit more efficient, assuming it works.", "markup": "markdown", "html": "<p>I think this might be a bit more efficient, assuming it works.</p>", "type": "rendered"}, "created_on": "2015-09-02T15:39:37.009133+00:00", "user": {"display_name": "Nate Koenig", "uuid": "{c862cdd9-fcc8-4419-9fc7-e20db14b8fcb}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Bc862cdd9-fcc8-4419-9fc7-e20db14b8fcb%7D"}, "html": {"href": "https://bitbucket.org/%7Bc862cdd9-fcc8-4419-9fc7-e20db14b8fcb%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:095b1e12-74ed-4e20-b44f-2f0745b616e0/ca24bb11-4787-4b14-a20d-d91835e9bde2/128"}}, "nickname": "Nathan Koenig", "type": "user", "account_id": "557058:095b1e12-74ed-4e20-b44f-2f0745b616e0"}, "inline": {}, "updated_on": "2015-09-02T15:39:37.055378+00:00", "type": "pullrequest_comment", "id": 9585293}, "pull_request": {"type": "pullrequest", "id": 58, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-math/pullrequests/58.json"}, "html": {"href": "#!/ignitionrobotics/ign-math/pull-requests/58"}}, "title": "Change equality helper to work with 387 fp unit"}}, {"comment": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-math/pullrequests/58/comments/9585126.json"}, "html": {"href": "#!/ignitionrobotics/ign-math/pull-requests/58/_/diff#comment-9585126"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 58, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-math/pullrequests/58.json"}, "html": {"href": "#!/ignitionrobotics/ign-math/pull-requests/58"}}, "title": "Change equality helper to work with 387 fp unit"}, "content": {"raw": "Out of curiosity, does this work?\n\n`return static_cast<T>(std::abs(_a - _b)) <= _epsilon`", "markup": "markdown", "html": "<p>Out of curiosity, does this work?</p>\n<p><code>return static_cast&lt;T&gt;(std::abs(_a - _b)) &lt;= _epsilon</code></p>", "type": "rendered"}, "created_on": "2015-09-02T15:30:47.561733+00:00", "user": {"display_name": "Nate Koenig", "uuid": "{c862cdd9-fcc8-4419-9fc7-e20db14b8fcb}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Bc862cdd9-fcc8-4419-9fc7-e20db14b8fcb%7D"}, "html": {"href": "https://bitbucket.org/%7Bc862cdd9-fcc8-4419-9fc7-e20db14b8fcb%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:095b1e12-74ed-4e20-b44f-2f0745b616e0/ca24bb11-4787-4b14-a20d-d91835e9bde2/128"}}, "nickname": "Nathan Koenig", "type": "user", "account_id": "557058:095b1e12-74ed-4e20-b44f-2f0745b616e0"}, "inline": {}, "updated_on": "2015-09-02T15:30:47.574146+00:00", "type": "pullrequest_comment", "id": 9585126}, "pull_request": {"type": "pullrequest", "id": 58, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-math/pullrequests/58.json"}, "html": {"href": "#!/ignitionrobotics/ign-math/pull-requests/58"}}, "title": "Change equality helper to work with 387 fp unit"}}, {"comment": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-math/pullrequests/58/comments/9268569.json"}, "html": {"href": "#!/ignitionrobotics/ign-math/pull-requests/58/_/diff#comment-9268569"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 58, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-math/pullrequests/58.json"}, "html": {"href": "#!/ignitionrobotics/ign-math/pull-requests/58"}}, "title": "Change equality helper to work with 387 fp unit"}, "content": {"raw": "I did some more digging.  Atlas gets around this particular issue by declaring the operands of the equality checks to be volatile when the x87 fpu is being used:\nhttp://atlas-computing.web.cern.ch/atlas-computing/links/buildDirectory/AtlasOffline/19.0.0/InstallArea/doc/CxxUtils/html/fpcompare_8h_source.html\n\nDeclaring a, b, and epsilon as volatile does fix the issue in this bug.  I can do something similar to what atlas does with preprocessor macros and update the PR.", "markup": "markdown", "html": "<p>I did some more digging.  Atlas gets around this particular issue by declaring the operands of the equality checks to be volatile when the x87 fpu is being used:\n<a href=\"http://atlas-computing.web.cern.ch/atlas-computing/links/buildDirectory/AtlasOffline/19.0.0/InstallArea/doc/CxxUtils/html/fpcompare_8h_source.html\" rel=\"nofollow\" class=\"ap-connect-link\">http://atlas-computing.web.cern.ch/atlas-computing/links/buildDirectory/AtlasOffline/19.0.0/InstallArea/doc/CxxUtils/html/fpcompare_8h_source.html</a></p>\n<p>Declaring a, b, and epsilon as volatile does fix the issue in this bug.  I can do something similar to what atlas does with preprocessor macros and update the PR.</p>", "type": "rendered"}, "created_on": "2015-08-21T02:33:24.649050+00:00", "user": {"display_name": "Rich Mattes", "uuid": "{1ef6f3dd-b8db-412b-94e9-e430e7aafd23}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B1ef6f3dd-b8db-412b-94e9-e430e7aafd23%7D"}, "html": {"href": "https://bitbucket.org/%7B1ef6f3dd-b8db-412b-94e9-e430e7aafd23%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/d431baafeedf5d8921cb50a3c9902e16d=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsRM-0.png"}}, "nickname": "richmattes", "type": "user", "account_id": "557058:a38935e3-9a08-40d9-917a-ff19973e58df"}, "updated_on": "2015-08-21T02:33:24.726663+00:00", "type": "pullrequest_comment", "id": 9268569}, "pull_request": {"type": "pullrequest", "id": 58, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-math/pullrequests/58.json"}, "html": {"href": "#!/ignitionrobotics/ign-math/pull-requests/58"}}, "title": "Change equality helper to work with 387 fp unit"}}, {"comment": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-math/pullrequests/58/comments/9268140.json"}, "html": {"href": "#!/ignitionrobotics/ign-math/pull-requests/58/_/diff#comment-9268140"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 58, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-math/pullrequests/58.json"}, "html": {"href": "#!/ignitionrobotics/ign-math/pull-requests/58"}}, "title": "Change equality helper to work with 387 fp unit"}, "content": {"raw": "It actually looks like this didn't fix the test - I'm going to keep working on it.", "markup": "markdown", "html": "<p>It actually looks like this didn't fix the test - I'm going to keep working on it.</p>", "type": "rendered"}, "created_on": "2015-08-21T01:41:42.872948+00:00", "user": {"display_name": "Rich Mattes", "uuid": "{1ef6f3dd-b8db-412b-94e9-e430e7aafd23}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B1ef6f3dd-b8db-412b-94e9-e430e7aafd23%7D"}, "html": {"href": "https://bitbucket.org/%7B1ef6f3dd-b8db-412b-94e9-e430e7aafd23%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/d431baafeedf5d8921cb50a3c9902e16d=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsRM-0.png"}}, "nickname": "richmattes", "type": "user", "account_id": "557058:a38935e3-9a08-40d9-917a-ff19973e58df"}, "updated_on": "2015-08-21T01:41:42.929801+00:00", "type": "pullrequest_comment", "id": 9268140}, "pull_request": {"type": "pullrequest", "id": 58, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-math/pullrequests/58.json"}, "html": {"href": "#!/ignitionrobotics/ign-math/pull-requests/58"}}, "title": "Change equality helper to work with 387 fp unit"}}, {"comment": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-math/pullrequests/58/comments/9267995.json"}, "html": {"href": "#!/ignitionrobotics/ign-math/pull-requests/58/_/diff#comment-9267995"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 58, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-math/pullrequests/58.json"}, "html": {"href": "#!/ignitionrobotics/ign-math/pull-requests/58"}}, "title": "Change equality helper to work with 387 fp unit"}, "content": {"raw": "Full build log available at: https://kojipkgs.fedoraproject.org//work/tasks/468/10770468/build.log\n\nThe build log will get cleaned up in a week or so, but you can see the build flags being used.", "markup": "markdown", "html": "<p>Full build log available at: <a href=\"https://kojipkgs.fedoraproject.org//work/tasks/468/10770468/build.log\" rel=\"nofollow\" class=\"ap-connect-link\">https://kojipkgs.fedoraproject.org//work/tasks/468/10770468/build.log</a></p>\n<p>The build log will get cleaned up in a week or so, but you can see the build flags being used.</p>", "type": "rendered"}, "created_on": "2015-08-21T01:24:59.212905+00:00", "user": {"display_name": "Rich Mattes", "uuid": "{1ef6f3dd-b8db-412b-94e9-e430e7aafd23}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B1ef6f3dd-b8db-412b-94e9-e430e7aafd23%7D"}, "html": {"href": "https://bitbucket.org/%7B1ef6f3dd-b8db-412b-94e9-e430e7aafd23%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/d431baafeedf5d8921cb50a3c9902e16d=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsRM-0.png"}}, "nickname": "richmattes", "type": "user", "account_id": "557058:a38935e3-9a08-40d9-917a-ff19973e58df"}, "updated_on": "2015-08-21T01:24:59.275075+00:00", "type": "pullrequest_comment", "id": 9267995}, "pull_request": {"type": "pullrequest", "id": 58, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-math/pullrequests/58.json"}, "html": {"href": "#!/ignitionrobotics/ign-math/pull-requests/58"}}, "title": "Change equality helper to work with 387 fp unit"}}, {"update": {"description": "When building on i686 without SSE, the ign equality helper uses the extra\r\nprecision within the x87 floating point module when comparing the difference\r\nbetween the two arguments to the epsilon value.  This causes the\r\nLine2Test.CollinearPoint unit test to fail when epsilon is set to .0001\r\n\r\n```\r\n13/44 Testing: UNIT_Line2_TEST\r\n13/44 Test: UNIT_Line2_TEST\r\nCommand: \"/builddir/build/BUILD/ignition-math2-2.2.2/build/src/UNIT_Line2_TEST\" \"--gtest_output=xml:/builddir/build/BUILD/ignition-math2-2.2.2/build/test_results/UNIT_Line2_TEST.xml\"\r\nDirectory: /builddir/build/BUILD/ignition-math2-2.2.2/build/src\r\n\"UNIT_Line2_TEST\" start time: Aug 21 00:43 UTC\r\nOutput:\r\n----------------------------------------------------------\r\nRunning main() from gtest_main.cc\r\n[==========] Running 9 tests from 1 test case.\r\n[----------] Global test environment set-up.\r\n[----------] 9 tests from Line2Test\r\n[ RUN      ] Line2Test.Constructor\r\n[       OK ] Line2Test.Constructor (0 ms)\r\n[ RUN      ] Line2Test.Length\r\n[       OK ] Line2Test.Length (0 ms)\r\n[ RUN      ] Line2Test.Slope\r\n[       OK ] Line2Test.Slope (0 ms)\r\n[ RUN      ] Line2Test.ParallelLine\r\n[       OK ] Line2Test.ParallelLine (0 ms)\r\n[ RUN      ] Line2Test.CollinearLine\r\n[       OK ] Line2Test.CollinearLine (0 ms)\r\n[ RUN      ] Line2Test.CollinearPoint\r\n/builddir/build/BUILD/ignition-math2-2.2.2/src/Line2_TEST.cc:152: Failure\r\nValue of: lineA.Collinear(pt, 1e-4)\r\n  Actual: false\r\nExpected: true\r\n/builddir/build/BUILD/ignition-math2-2.2.2/src/Line2_TEST.cc:164: Failure\r\nValue of: lineA.Collinear(pt, 1e-4)\r\n  Actual: false\r\nExpected: true\r\n[  FAILED  ] Line2Test.CollinearPoint (0 ms)\r\n[ RUN      ] Line2Test.Intersect\r\n[       OK ] Line2Test.Intersect (0 ms)\r\n[ RUN      ] Line2Test.Equality\r\n[       OK ] Line2Test.Equality (0 ms)\r\n[ RUN      ] Line2Test.OperatorStreamOut\r\n[       OK ] Line2Test.OperatorStreamOut (0 ms)\r\n[----------] 9 tests from Line2Test (0 ms total)\r\n[----------] Global test environment tear-down\r\n[==========] 9 tests from 1 test case ran. (0 ms total)\r\n[  PASSED  ] 8 tests.\r\n[  FAILED  ] 1 test, listed below:\r\n[  FAILED  ] Line2Test.CollinearPoint\r\n 1 FAILED TEST\r\n<end of output>\r\nTest time =   0.00 sec\r\n----------------------------------------------------------\r\nTest Failed.\r\n\"UNIT_Line2_TEST\" end time: Aug 21 00:43 UTC\r\n\"UNIT_Line2_TEST\" time elapsed: 00:00:00\r\n----------------------------------------------------------\r\n```\r\n\r\nThis patch creates an intermediate value for the difference between the two\r\narguments to be compared, which gets rid of the extra x87 precision. The\r\nresulting comparison is then performed without the extra precision, allowing\r\nthe test to pass.\r\n\r\nThis test was performed against ignition-math2-2.2.2\r\n\r\nSee http://stackoverflow.com/questions/16325277/floating-point-equality-test-and-extra-precision-can-this-code-fail for a discussion of x87 equality pitfalls.", "title": "Change equality helper to work with 387 fp unit", "destination": {"commit": {"hash": "6d684eb7c3b6", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-math/commit/6d684eb7c3b6.json"}, "html": {"href": "#!/ignitionrobotics/ign-math/commits/6d684eb7c3b6"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-math.json"}, "html": {"href": "#!/ignitionrobotics/ign-math"}, "avatar": {"href": "data/bytebucket.org/ravatar/{18503e50-08ea-4d88-ab99-110fde3c7256}ts=1533305"}}, "type": "repository", "name": "ign-math", "full_name": "ignitionrobotics/ign-math", "uuid": "{18503e50-08ea-4d88-ab99-110fde3c7256}"}, "branch": {"name": "default"}}, "reason": "", "source": {"commit": {"hash": "e8d45c8c2c3a", "type": "commit", "links": {"self": {"href": "https://api.bitbucket.org/2.0/repositories/richmattes/ign-math/commit/e8d45c8c2c3a"}, "html": {"href": "https://bitbucket.org/richmattes/ign-math/commits/e8d45c8c2c3a"}}}, "repository": {"links": {"self": {"href": "https://api.bitbucket.org/2.0/repositories/richmattes/ign-math"}, "html": {"href": "https://bitbucket.org/richmattes/ign-math"}, "avatar": {"href": "data/bytebucket.org/ravatar/{ec8da820-bc0a-4654-a8be-676a74e7bae5}ts=c_plus_plus"}}, "type": "repository", "name": "ign-math", "full_name": "richmattes/ign-math", "uuid": "{ec8da820-bc0a-4654-a8be-676a74e7bae5}"}, "branch": {"name": "387_equality"}}, "state": "OPEN", "author": {"display_name": "Rich Mattes", "uuid": "{1ef6f3dd-b8db-412b-94e9-e430e7aafd23}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B1ef6f3dd-b8db-412b-94e9-e430e7aafd23%7D"}, "html": {"href": "https://bitbucket.org/%7B1ef6f3dd-b8db-412b-94e9-e430e7aafd23%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/d431baafeedf5d8921cb50a3c9902e16d=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsRM-0.png"}}, "nickname": "richmattes", "type": "user", "account_id": "557058:a38935e3-9a08-40d9-917a-ff19973e58df"}, "date": "2015-08-21T01:23:52.413248+00:00"}, "pull_request": {"type": "pullrequest", "id": 58, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-math/pullrequests/58.json"}, "html": {"href": "#!/ignitionrobotics/ign-math/pull-requests/58"}}, "title": "Change equality helper to work with 387 fp unit"}}, {"update": {"description": "When building on i686 without SSE, the ign equality helper uses the extra\r\nprecision within the x87 floating point module when comparing the difference\r\nbetween the two arguments to the epsilon value.  This causes the\r\nLine2Test.CollinearPoint unit test to fail when epsilon is set to .0001\r\n\r\n13/44 Testing: UNIT_Line2_TEST\r\n13/44 Test: UNIT_Line2_TEST\r\nCommand: \"/builddir/build/BUILD/ignition-math2-2.2.2/build/src/UNIT_Line2_TEST\" \"--gtest_output=xml:/builddir/build/BUILD/ignition-math2-2.2.2/build/test_results/UNIT_Line2_TEST.xml\"\r\nDirectory: /builddir/build/BUILD/ignition-math2-2.2.2/build/src\r\n\"UNIT_Line2_TEST\" start time: Aug 21 00:43 UTC\r\nOutput:\r\n----------------------------------------------------------\r\nRunning main() from gtest_main.cc\r\n[==========] Running 9 tests from 1 test case.\r\n[----------] Global test environment set-up.\r\n[----------] 9 tests from Line2Test\r\n[ RUN      ] Line2Test.Constructor\r\n[       OK ] Line2Test.Constructor (0 ms)\r\n[ RUN      ] Line2Test.Length\r\n[       OK ] Line2Test.Length (0 ms)\r\n[ RUN      ] Line2Test.Slope\r\n[       OK ] Line2Test.Slope (0 ms)\r\n[ RUN      ] Line2Test.ParallelLine\r\n[       OK ] Line2Test.ParallelLine (0 ms)\r\n[ RUN      ] Line2Test.CollinearLine\r\n[       OK ] Line2Test.CollinearLine (0 ms)\r\n[ RUN      ] Line2Test.CollinearPoint\r\n/builddir/build/BUILD/ignition-math2-2.2.2/src/Line2_TEST.cc:152: Failure\r\nValue of: lineA.Collinear(pt, 1e-4)\r\n  Actual: false\r\nExpected: true\r\n/builddir/build/BUILD/ignition-math2-2.2.2/src/Line2_TEST.cc:164: Failure\r\nValue of: lineA.Collinear(pt, 1e-4)\r\n  Actual: false\r\nExpected: true\r\n[  FAILED  ] Line2Test.CollinearPoint (0 ms)\r\n[ RUN      ] Line2Test.Intersect\r\n[       OK ] Line2Test.Intersect (0 ms)\r\n[ RUN      ] Line2Test.Equality\r\n[       OK ] Line2Test.Equality (0 ms)\r\n[ RUN      ] Line2Test.OperatorStreamOut\r\n[       OK ] Line2Test.OperatorStreamOut (0 ms)\r\n[----------] 9 tests from Line2Test (0 ms total)\r\n[----------] Global test environment tear-down\r\n[==========] 9 tests from 1 test case ran. (0 ms total)\r\n[  PASSED  ] 8 tests.\r\n[  FAILED  ] 1 test, listed below:\r\n[  FAILED  ] Line2Test.CollinearPoint\r\n 1 FAILED TEST\r\n<end of output>\r\nTest time =   0.00 sec\r\n----------------------------------------------------------\r\nTest Failed.\r\n\"UNIT_Line2_TEST\" end time: Aug 21 00:43 UTC\r\n\"UNIT_Line2_TEST\" time elapsed: 00:00:00\r\n----------------------------------------------------------\r\n\r\nThis patch creates an intermediate value for the difference between the two\r\narguments to be compared, which gets rid of the extra x87 precision. The\r\nresulting comparison is then performed without the extra precision, allowing\r\nthe test to pass.\r\n\r\nThis test was performed against ignition-math2-2.2.2\r\n\r\nSee http://stackoverflow.com/questions/16325277/floating-point-equality-test-and-extra-precision-can-this-code-fail for a discussion of x87 equality pitfalls.", "title": "Change equality helper to work with 387 fp unit", "destination": {"commit": {"hash": "6d684eb7c3b6", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-math/commit/6d684eb7c3b6.json"}, "html": {"href": "#!/ignitionrobotics/ign-math/commits/6d684eb7c3b6"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-math.json"}, "html": {"href": "#!/ignitionrobotics/ign-math"}, "avatar": {"href": "data/bytebucket.org/ravatar/{18503e50-08ea-4d88-ab99-110fde3c7256}ts=1533305"}}, "type": "repository", "name": "ign-math", "full_name": "ignitionrobotics/ign-math", "uuid": "{18503e50-08ea-4d88-ab99-110fde3c7256}"}, "branch": {"name": "default"}}, "reason": "", "source": {"commit": {"hash": "e8d45c8c2c3a", "type": "commit", "links": {"self": {"href": "https://api.bitbucket.org/2.0/repositories/richmattes/ign-math/commit/e8d45c8c2c3a"}, "html": {"href": "https://bitbucket.org/richmattes/ign-math/commits/e8d45c8c2c3a"}}}, "repository": {"links": {"self": {"href": "https://api.bitbucket.org/2.0/repositories/richmattes/ign-math"}, "html": {"href": "https://bitbucket.org/richmattes/ign-math"}, "avatar": {"href": "data/bytebucket.org/ravatar/{ec8da820-bc0a-4654-a8be-676a74e7bae5}ts=c_plus_plus"}}, "type": "repository", "name": "ign-math", "full_name": "richmattes/ign-math", "uuid": "{ec8da820-bc0a-4654-a8be-676a74e7bae5}"}, "branch": {"name": "387_equality"}}, "state": "OPEN", "author": {"display_name": "Rich Mattes", "uuid": "{1ef6f3dd-b8db-412b-94e9-e430e7aafd23}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B1ef6f3dd-b8db-412b-94e9-e430e7aafd23%7D"}, "html": {"href": "https://bitbucket.org/%7B1ef6f3dd-b8db-412b-94e9-e430e7aafd23%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/d431baafeedf5d8921cb50a3c9902e16d=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsRM-0.png"}}, "nickname": "richmattes", "type": "user", "account_id": "557058:a38935e3-9a08-40d9-917a-ff19973e58df"}, "date": "2015-08-21T01:23:21.635185+00:00"}, "pull_request": {"type": "pullrequest", "id": 58, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-math/pullrequests/58.json"}, "html": {"href": "#!/ignitionrobotics/ign-math/pull-requests/58"}}, "title": "Change equality helper to work with 387 fp unit"}}, {"update": {"description": "When building on i686 without SSE, the ign equality helper uses the extra\r\nprecision within the x87 floating point module when comparing the difference\r\nbetween the two arguments to the epsilon value.  This causes the\r\nLine2Test.CollinearPoint unit test to fail when epsilon is set to .0001\r\n\r\n13/44 Testing: UNIT_Line2_TEST\r\n13/44 Test: UNIT_Line2_TEST\r\nCommand: \"/builddir/build/BUILD/ignition-math2-2.2.2/build/src/UNIT_Line2_TEST\" \"--gtest_output=xml:/builddir/build/BUILD/ignition-math2-2.2.2/build/test_results/UNIT_Line2_TEST.xml\"\r\nDirectory: /builddir/build/BUILD/ignition-math2-2.2.2/build/src\r\n\"UNIT_Line2_TEST\" start time: Aug 21 00:43 UTC\r\nOutput:\r\n----------------------------------------------------------\r\nRunning main() from gtest_main.cc\r\n[==========] Running 9 tests from 1 test case.\r\n[----------] Global test environment set-up.\r\n[----------] 9 tests from Line2Test\r\n[ RUN      ] Line2Test.Constructor\r\n[       OK ] Line2Test.Constructor (0 ms)\r\n[ RUN      ] Line2Test.Length\r\n[       OK ] Line2Test.Length (0 ms)\r\n[ RUN      ] Line2Test.Slope\r\n[       OK ] Line2Test.Slope (0 ms)\r\n[ RUN      ] Line2Test.ParallelLine\r\n[       OK ] Line2Test.ParallelLine (0 ms)\r\n[ RUN      ] Line2Test.CollinearLine\r\n[       OK ] Line2Test.CollinearLine (0 ms)\r\n[ RUN      ] Line2Test.CollinearPoint\r\n/builddir/build/BUILD/ignition-math2-2.2.2/src/Line2_TEST.cc:152: Failure\r\nValue of: lineA.Collinear(pt, 1e-4)\r\n  Actual: false\r\nExpected: true\r\n/builddir/build/BUILD/ignition-math2-2.2.2/src/Line2_TEST.cc:164: Failure\r\nValue of: lineA.Collinear(pt, 1e-4)\r\n  Actual: false\r\nExpected: true\r\n[  FAILED  ] Line2Test.CollinearPoint (0 ms)\r\n[ RUN      ] Line2Test.Intersect\r\n[       OK ] Line2Test.Intersect (0 ms)\r\n[ RUN      ] Line2Test.Equality\r\n[       OK ] Line2Test.Equality (0 ms)\r\n[ RUN      ] Line2Test.OperatorStreamOut\r\n[       OK ] Line2Test.OperatorStreamOut (0 ms)\r\n[----------] 9 tests from Line2Test (0 ms total)\r\n[----------] Global test environment tear-down\r\n[==========] 9 tests from 1 test case ran. (0 ms total)\r\n[  PASSED  ] 8 tests.\r\n[  FAILED  ] 1 test, listed below:\r\n[  FAILED  ] Line2Test.CollinearPoint\r\n 1 FAILED TEST\r\n<end of output>\r\nTest time =   0.00 sec\r\n----------------------------------------------------------\r\nTest Failed.\r\n\"UNIT_Line2_TEST\" end time: Aug 21 00:43 UTC\r\n\"UNIT_Line2_TEST\" time elapsed: 00:00:00\r\n----------------------------------------------------------\r\n\r\nThis patch creates an intermediate value for the difference between the two\r\narguments to be compared, which gets rid of the extra x87 precision. The\r\nresulting comparison is then performed without the extra precision, allowing\r\nthe test to pass.\r\n\r\nThis test was performed against ignition-math2-2.2.2\r\n\r\nSee http://stackoverflow.com/questions/16325277/floating-point-equality-test-and-extra-precision-can-this-code-fail for a discussion of x87 equality pitfalls.", "title": "Change equality helper to work with 387 fp unit", "destination": {"commit": {"hash": "6d684eb7c3b6", "type": "commit", "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-math/commit/6d684eb7c3b6.json"}, "html": {"href": "#!/ignitionrobotics/ign-math/commits/6d684eb7c3b6"}}}, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-math.json"}, "html": {"href": "#!/ignitionrobotics/ign-math"}, "avatar": {"href": "data/bytebucket.org/ravatar/{18503e50-08ea-4d88-ab99-110fde3c7256}ts=1533305"}}, "type": "repository", "name": "ign-math", "full_name": "ignitionrobotics/ign-math", "uuid": "{18503e50-08ea-4d88-ab99-110fde3c7256}"}, "branch": {"name": "default"}}, "reason": "", "source": {"commit": {"hash": "e8d45c8c2c3a", "type": "commit", "links": {"self": {"href": "https://api.bitbucket.org/2.0/repositories/richmattes/ign-math/commit/e8d45c8c2c3a"}, "html": {"href": "https://bitbucket.org/richmattes/ign-math/commits/e8d45c8c2c3a"}}}, "repository": {"links": {"self": {"href": "https://api.bitbucket.org/2.0/repositories/richmattes/ign-math"}, "html": {"href": "https://bitbucket.org/richmattes/ign-math"}, "avatar": {"href": "data/bytebucket.org/ravatar/{ec8da820-bc0a-4654-a8be-676a74e7bae5}ts=c_plus_plus"}}, "type": "repository", "name": "ign-math", "full_name": "richmattes/ign-math", "uuid": "{ec8da820-bc0a-4654-a8be-676a74e7bae5}"}, "branch": {"name": "387_equality"}}, "state": "OPEN", "author": {"display_name": "Rich Mattes", "uuid": "{1ef6f3dd-b8db-412b-94e9-e430e7aafd23}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B1ef6f3dd-b8db-412b-94e9-e430e7aafd23%7D"}, "html": {"href": "https://bitbucket.org/%7B1ef6f3dd-b8db-412b-94e9-e430e7aafd23%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/d431baafeedf5d8921cb50a3c9902e16d=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsRM-0.png"}}, "nickname": "richmattes", "type": "user", "account_id": "557058:a38935e3-9a08-40d9-917a-ff19973e58df"}, "date": "2015-08-21T01:23:21.602552+00:00"}, "pull_request": {"type": "pullrequest", "id": 58, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-math/pullrequests/58.json"}, "html": {"href": "#!/ignitionrobotics/ign-math/pull-requests/58"}}, "title": "Change equality helper to work with 387 fp unit"}}]}