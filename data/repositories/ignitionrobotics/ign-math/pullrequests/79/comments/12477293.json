{"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-math/pullrequests/79/comments/12477293.json"}, "html": {"href": "#!/ignitionrobotics/ign-math/pull-requests/79/_/diff#comment-12477293"}}, "parent": {"id": 12469543, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-math/pullrequests/79/comments/12469543.json"}, "html": {"href": "#!/ignitionrobotics/ign-math/pull-requests/79/_/diff#comment-12469543"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 79, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-math/pullrequests/79.json"}, "html": {"href": "#!/ignitionrobotics/ign-math/pull-requests/79"}}, "title": "MassMatrix3::PrincipalMoments, diagonalizing the moment of inertia matrix"}, "content": {"raw": "Oh, that's interesting Steve! I tried it in Simbody and it didn't complain. Changing one of the off-diagonals to `-1.0000001` made it fail though, with this error message:\n```\nTest failed due to exception: SimTK Exception thrown at MassProperties.h:555:\n  Error detected by Simbody method Inertia::Inertia(moments,products): \n  The magnitude of a product of inertia was too large to be physical.\n```\nBut from the eigenvalues it looks like this is *way* violated so I should have caught it. Diagonalizing would be a much better way for check for badness -- I didn't realize the current check was inadequate and will be complaining to the guy who gave me that checking code! Here's the check in Simbody:\n```c++\n    // Thanks to Paul Mitiguy for this condition on products of inertia.\n    SimTK_ERRCHK(   Ixx+Slop>=std::abs(2*Iyz) \n                 && Iyy+Slop>=std::abs(2*Ixz)\n                 && Izz+Slop>=std::abs(2*Ixy),\n        methodName,\n        \"The magnitude of a product of inertia was too large to be physical.\");\n```\n\"Slop\" is around 1e-8.", "markup": "markdown", "html": "<p>Oh, that's interesting Steve! I tried it in Simbody and it didn't complain. Changing one of the off-diagonals to <code>-1.0000001</code> made it fail though, with this error message:</p>\n<div class=\"codehilite\"><pre><span></span>Test failed due to exception: SimTK Exception thrown at MassProperties.h:555:\n  Error detected by Simbody method Inertia::Inertia(moments,products): \n  The magnitude of a product of inertia was too large to be physical.\n</pre></div>\n\n\n<p>But from the eigenvalues it looks like this is <em>way</em> violated so I should have caught it. Diagonalizing would be a much better way for check for badness -- I didn't realize the current check was inadequate and will be complaining to the guy who gave me that checking code! Here's the check in Simbody:</p>\n<div class=\"codehilite language-c++\"><pre><span></span>    <span class=\"c1\">// Thanks to Paul Mitiguy for this condition on products of inertia.</span>\n    <span class=\"n\">SimTK_ERRCHK</span><span class=\"p\">(</span>   <span class=\"n\">Ixx</span><span class=\"o\">+</span><span class=\"n\">Slop</span><span class=\"o\">&gt;=</span><span class=\"n\">std</span><span class=\"o\">::</span><span class=\"n\">abs</span><span class=\"p\">(</span><span class=\"mi\">2</span><span class=\"o\">*</span><span class=\"n\">Iyz</span><span class=\"p\">)</span> \n                 <span class=\"o\">&amp;&amp;</span> <span class=\"n\">Iyy</span><span class=\"o\">+</span><span class=\"n\">Slop</span><span class=\"o\">&gt;=</span><span class=\"n\">std</span><span class=\"o\">::</span><span class=\"n\">abs</span><span class=\"p\">(</span><span class=\"mi\">2</span><span class=\"o\">*</span><span class=\"n\">Ixz</span><span class=\"p\">)</span>\n                 <span class=\"o\">&amp;&amp;</span> <span class=\"n\">Izz</span><span class=\"o\">+</span><span class=\"n\">Slop</span><span class=\"o\">&gt;=</span><span class=\"n\">std</span><span class=\"o\">::</span><span class=\"n\">abs</span><span class=\"p\">(</span><span class=\"mi\">2</span><span class=\"o\">*</span><span class=\"n\">Ixy</span><span class=\"p\">),</span>\n        <span class=\"n\">methodName</span><span class=\"p\">,</span>\n        <span class=\"s\">&quot;The magnitude of a product of inertia was too large to be physical.&quot;</span><span class=\"p\">);</span>\n</pre></div>\n\n\n<p>\"Slop\" is around 1e-8.</p>", "type": "rendered"}, "created_on": "2015-12-05T00:41:29.979768+00:00", "user": {"display_name": "Michael Sherman", "uuid": "{997c6f1e-e2a3-4f0e-8fa4-fed745840d50}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B997c6f1e-e2a3-4f0e-8fa4-fed745840d50%7D"}, "html": {"href": "https://bitbucket.org/%7B997c6f1e-e2a3-4f0e-8fa4-fed745840d50%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/355dea43ed612b7be3c9361df2d52213d=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsMS-2.png"}}, "nickname": "sherm1", "type": "user", "account_id": "557058:4590c319-b75f-4187-93d4-6cec61da74f7"}, "updated_on": "2015-12-05T00:41:30.066099+00:00", "type": "pullrequest_comment", "id": 12477293}