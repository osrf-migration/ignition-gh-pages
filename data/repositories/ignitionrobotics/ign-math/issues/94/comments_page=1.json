{"pagelen": 100, "values": [{"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-math/issues/94/comments/46051766.json"}, "html": {"href": "#!/ignitionrobotics/ign-math/issues/94#comment-46051766"}}, "issue": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-math/issues/94.json"}}, "type": "issue", "id": 94, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-math.json"}, "html": {"href": "#!/ignitionrobotics/ign-math"}, "avatar": {"href": "data/bytebucket.org/ravatar/{18503e50-08ea-4d88-ab99-110fde3c7256}ts=1533305"}}, "type": "repository", "name": "ign-math", "full_name": "ignitionrobotics/ign-math", "uuid": "{18503e50-08ea-4d88-ab99-110fde3c7256}"}, "title": "Fix test coverage on gz11 branch"}, "content": {"raw": "Here is an updated coverage link:\n\n* https://codecov.io/bb/ignitionrobotics/ign-math/branch/gz11", "markup": "markdown", "html": "<p>Here is an updated coverage link:</p>\n<ul>\n<li><a href=\"https://codecov.io/bb/ignitionrobotics/ign-math/branch/gz11\" rel=\"nofollow\" class=\"ap-connect-link\">https://codecov.io/bb/ignitionrobotics/ign-math/branch/gz11</a></li>\n</ul>", "type": "rendered"}, "created_on": "2018-06-08T23:48:10.883318+00:00", "user": {"display_name": "Steve Peters", "uuid": "{2ccfed09-18b8-4921-8d58-15ef01092802}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D"}, "html": {"href": "https://bitbucket.org/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/1fb4816dad9e68337d3096f750951f6cd=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsSP-1.png"}}, "nickname": "Steven Peters", "type": "user", "account_id": "557058:5de38267-b118-494c-aa76-4fab35448816"}, "updated_on": null, "type": "issue_comment", "id": 46051766}, {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-math/issues/94/comments/46051794.json"}, "html": {"href": "#!/ignitionrobotics/ign-math/issues/94#comment-46051794"}}, "issue": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-math/issues/94.json"}}, "type": "issue", "id": 94, "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-math.json"}, "html": {"href": "#!/ignitionrobotics/ign-math"}, "avatar": {"href": "data/bytebucket.org/ravatar/{18503e50-08ea-4d88-ab99-110fde3c7256}ts=1533305"}}, "type": "repository", "name": "ign-math", "full_name": "ignitionrobotics/ign-math", "uuid": "{18503e50-08ea-4d88-ab99-110fde3c7256}"}, "title": "Fix test coverage on gz11 branch"}, "content": {"raw": "I currently see two issues:\n\n* [gtest source code is not excluded from coverage results](https://codecov.io/bb/ignitionrobotics/ign-math/src/gz11/test/gtest/src/gtest_main.cc). I believe this is due to a [change in behavior of lcov](https://github.com/linux-test-project/lcov/commit/e32aab1b4c85503a6592a91326c4b362613e1d66). I think we could fix it in a backwards compatible way with a patch to ign-cmake (`'test/*'` -> `'*/test/*'`):\n\n~~~\ndiff -r 6de1e2ffb267 cmake/IgnCodeCoverage.cmake\n--- a/cmake/IgnCodeCoverage.cmake\tThu Jun 07 16:29:52 2018 +0000\n+++ b/cmake/IgnCodeCoverage.cmake\tFri Jun 08 16:50:50 2018 -0700\n@@ -132,7 +132,7 @@\n     # Remove negative counts\n     COMMAND sed -i '/,-/d' ${_outputname}.info\n     COMMAND ${LCOV_PATH} ${_branch_flags} -q\n-      --remove ${_outputname}.info 'test/*' '/usr/*' '*_TEST*' '*.cxx' 'moc_*.cpp' 'qrc_*.cpp' --output-file ${_outputname}.info.cleaned\n+      --remove ${_outputname}.info '*/test/*' '/usr/*' '*_TEST*' '*.cxx' 'moc_*.cpp' 'qrc_*.cpp' --output-file ${_outputname}.info.cleaned\n     COMMAND ${GENHTML_PATH} ${_branch_flags} -q\n     --legend -o ${_outputname} ${_outputname}.info.cleaned\n     COMMAND ${LCOV_PATH} --summary ${_outputname}.info.cleaned 2>&1 | grep \"lines\" | cut -d ' ' -f 4 | cut -d '%' -f 1 > ${_outputname}/lines.txt\n~~~\n\n* the files that should be excluded are still in the results but with no coverage, which makes our percentages look bad:\n    * https://codecov.io/bb/ignitionrobotics/ign-math/src/gz11/src/Angle_TEST.cc", "markup": "markdown", "html": "<p>I currently see two issues:</p>\n<ul>\n<li><a data-is-external-link=\"true\" href=\"https://codecov.io/bb/ignitionrobotics/ign-math/src/gz11/test/gtest/src/gtest_main.cc\" rel=\"nofollow\">gtest source code is not excluded from coverage results</a>. I believe this is due to a <a data-is-external-link=\"true\" href=\"https://github.com/linux-test-project/lcov/commit/e32aab1b4c85503a6592a91326c4b362613e1d66\" rel=\"nofollow\">change in behavior of lcov</a>. I think we could fix it in a backwards compatible way with a patch to ign-cmake (<code>'test/*'</code> -&gt; <code>'*/test/*'</code>):</li>\n</ul>\n<div class=\"codehilite\"><pre><span></span><span class=\"gh\">diff -r 6de1e2ffb267 cmake/IgnCodeCoverage.cmake</span>\n<span class=\"gd\">--- a/cmake/IgnCodeCoverage.cmake   Thu Jun 07 16:29:52 2018 +0000</span>\n<span class=\"gi\">+++ b/cmake/IgnCodeCoverage.cmake   Fri Jun 08 16:50:50 2018 -0700</span>\n<span class=\"gu\">@@ -132,7 +132,7 @@</span>\n     # Remove negative counts\n     COMMAND sed -i &#39;/,-/d&#39; ${_outputname}.info\n     COMMAND ${LCOV_PATH} ${_branch_flags} -q\n<span class=\"gd\">-      --remove ${_outputname}.info &#39;test/*&#39; &#39;/usr/*&#39; &#39;*_TEST*&#39; &#39;*.cxx&#39; &#39;moc_*.cpp&#39; &#39;qrc_*.cpp&#39; --output-file ${_outputname}.info.cleaned</span>\n<span class=\"gi\">+      --remove ${_outputname}.info &#39;*/test/*&#39; &#39;/usr/*&#39; &#39;*_TEST*&#39; &#39;*.cxx&#39; &#39;moc_*.cpp&#39; &#39;qrc_*.cpp&#39; --output-file ${_outputname}.info.cleaned</span>\n     COMMAND ${GENHTML_PATH} ${_branch_flags} -q\n     --legend -o ${_outputname} ${_outputname}.info.cleaned\n     COMMAND ${LCOV_PATH} --summary ${_outputname}.info.cleaned 2&gt;&amp;1 | grep &quot;lines&quot; | cut -d &#39; &#39; -f 4 | cut -d &#39;%&#39; -f 1 &gt; ${_outputname}/lines.txt\n</pre></div>\n\n\n<ul>\n<li>the files that should be excluded are still in the results but with no coverage, which makes our percentages look bad:<ul>\n<li><a href=\"https://codecov.io/bb/ignitionrobotics/ign-math/src/gz11/src/Angle_TEST.cc\" rel=\"nofollow\" class=\"ap-connect-link\">https://codecov.io/bb/ignitionrobotics/ign-math/src/gz11/src/Angle_TEST.cc</a></li>\n</ul>\n</li>\n</ul>", "type": "rendered"}, "created_on": "2018-06-08T23:53:26.615872+00:00", "user": {"display_name": "Steve Peters", "uuid": "{2ccfed09-18b8-4921-8d58-15ef01092802}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D"}, "html": {"href": "https://bitbucket.org/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/1fb4816dad9e68337d3096f750951f6cd=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsSP-1.png"}}, "nickname": "Steven Peters", "type": "user", "account_id": "557058:5de38267-b118-494c-aa76-4fab35448816"}, "updated_on": null, "type": "issue_comment", "id": 46051794}], "page": 1, "size": 2}