{"priority": "major", "kind": "bug", "repository": {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-math.json"}, "html": {"href": "#!/ignitionrobotics/ign-math"}, "avatar": {"href": "data/bytebucket.org/ravatar/{18503e50-08ea-4d88-ab99-110fde3c7256}ts=1533305"}}, "type": "repository", "name": "ign-math", "full_name": "ignitionrobotics/ign-math", "uuid": "{18503e50-08ea-4d88-ab99-110fde3c7256}"}, "links": {"attachments": {"href": "data/repositories/ignitionrobotics/ign-math/issues/78/attachments_page=1.json"}, "self": {"href": "data/repositories/ignitionrobotics/ign-math/issues/78.json"}, "watch": {"href": "https://api.bitbucket.org/2.0/repositories/ignitionrobotics/ign-math/issues/78/watch"}, "comments": {"href": "data/repositories/ignitionrobotics/ign-math/issues/78/comments_page=1.json"}, "html": {"href": "#!/ignitionrobotics/ign-math/issues/78/frustum-incorrectly-reports-that-it"}, "vote": {"href": "https://api.bitbucket.org/2.0/repositories/ignitionrobotics/ign-math/issues/78/vote"}}, "reporter": {"display_name": "Shane Loretz", "uuid": "{656e3311-aad9-45a1-aaf7-b0ee0e84b287}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B656e3311-aad9-45a1-aaf7-b0ee0e84b287%7D"}, "html": {"href": "https://bitbucket.org/%7B656e3311-aad9-45a1-aaf7-b0ee0e84b287%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:684383ab-ac95-4859-a350-4a6f41a94a22/c7a1ebf5-cade-4115-9f26-9d3facb776db/128"}}, "nickname": "Shane Loretz", "type": "user", "account_id": "557058:684383ab-ac95-4859-a350-4a6f41a94a22"}, "title": "Frustum incorrectly reports that it contains a box", "component": null, "votes": 0, "watches": 1, "content": {"raw": "The frustum class appears to incorrectly report that it contains a box in the following example.\r\n\r\n```\r\n      const ignition::math::Vector3d corner1(2.2, -0.5, 0);\r\n      const ignition::math::Vector3d corner2(3.2, 0.5, 1);\r\n      ignition::math::Box bb(corner1, corner2);\r\n      const double near = 0.55;\r\n      const double far = 2.5;\r\n      const double horizontalFieldOfView = 1.05;\r\n      const double aspectRatio = 1.8;\r\n      const ignition::math::Pose3d fPose(0, 0, 2, 0, 0, 0);\r\n      ignition::math::Frustum frustum(near, far, horizontalFieldOfView, aspectRatio, fPose);\r\n      if (frustum.Contains(bb))\r\n      {\r\n        std::cerr << \"Oops, frustum should have returned false! \\n\";\r\n      }\r\n```\r\nHere's a side view of the example at y=0\r\n\r\n![frustum_incorrect_collision.png](data/bitbucket.org/repo/dg5enz/images/3245666792-frustum_incorrect_collision.png)", "markup": "markdown", "html": "<p>The frustum class appears to incorrectly report that it contains a box in the following example.</p>\n<div class=\"codehilite\"><pre><span></span>      <span class=\"nt\">const</span> <span class=\"nt\">ignition</span><span class=\"p\">::</span><span class=\"nd\">math</span><span class=\"p\">::</span><span class=\"nd\">Vector3d</span> <span class=\"nt\">corner1</span><span class=\"o\">(</span><span class=\"nt\">2</span><span class=\"p\">.</span><span class=\"nc\">2</span><span class=\"o\">,</span> <span class=\"nt\">-0</span><span class=\"p\">.</span><span class=\"nc\">5</span><span class=\"o\">,</span> <span class=\"nt\">0</span><span class=\"o\">);</span>\n      <span class=\"nt\">const</span> <span class=\"nt\">ignition</span><span class=\"p\">::</span><span class=\"nd\">math</span><span class=\"p\">::</span><span class=\"nd\">Vector3d</span> <span class=\"nt\">corner2</span><span class=\"o\">(</span><span class=\"nt\">3</span><span class=\"p\">.</span><span class=\"nc\">2</span><span class=\"o\">,</span> <span class=\"nt\">0</span><span class=\"p\">.</span><span class=\"nc\">5</span><span class=\"o\">,</span> <span class=\"nt\">1</span><span class=\"o\">);</span>\n      <span class=\"nt\">ignition</span><span class=\"p\">::</span><span class=\"nd\">math</span><span class=\"p\">::</span><span class=\"nd\">Box</span> <span class=\"nt\">bb</span><span class=\"o\">(</span><span class=\"nt\">corner1</span><span class=\"o\">,</span> <span class=\"nt\">corner2</span><span class=\"o\">);</span>\n      <span class=\"nt\">const</span> <span class=\"nt\">double</span> <span class=\"nt\">near</span> <span class=\"o\">=</span> <span class=\"nt\">0</span><span class=\"p\">.</span><span class=\"nc\">55</span><span class=\"o\">;</span>\n      <span class=\"nt\">const</span> <span class=\"nt\">double</span> <span class=\"nt\">far</span> <span class=\"o\">=</span> <span class=\"nt\">2</span><span class=\"p\">.</span><span class=\"nc\">5</span><span class=\"o\">;</span>\n      <span class=\"nt\">const</span> <span class=\"nt\">double</span> <span class=\"nt\">horizontalFieldOfView</span> <span class=\"o\">=</span> <span class=\"nt\">1</span><span class=\"p\">.</span><span class=\"nc\">05</span><span class=\"o\">;</span>\n      <span class=\"nt\">const</span> <span class=\"nt\">double</span> <span class=\"nt\">aspectRatio</span> <span class=\"o\">=</span> <span class=\"nt\">1</span><span class=\"p\">.</span><span class=\"nc\">8</span><span class=\"o\">;</span>\n      <span class=\"nt\">const</span> <span class=\"nt\">ignition</span><span class=\"p\">::</span><span class=\"nd\">math</span><span class=\"p\">::</span><span class=\"nd\">Pose3d</span> <span class=\"nt\">fPose</span><span class=\"o\">(</span><span class=\"nt\">0</span><span class=\"o\">,</span> <span class=\"nt\">0</span><span class=\"o\">,</span> <span class=\"nt\">2</span><span class=\"o\">,</span> <span class=\"nt\">0</span><span class=\"o\">,</span> <span class=\"nt\">0</span><span class=\"o\">,</span> <span class=\"nt\">0</span><span class=\"o\">);</span>\n      <span class=\"nt\">ignition</span><span class=\"p\">::</span><span class=\"nd\">math</span><span class=\"p\">::</span><span class=\"nd\">Frustum</span> <span class=\"nt\">frustum</span><span class=\"o\">(</span><span class=\"nt\">near</span><span class=\"o\">,</span> <span class=\"nt\">far</span><span class=\"o\">,</span> <span class=\"nt\">horizontalFieldOfView</span><span class=\"o\">,</span> <span class=\"nt\">aspectRatio</span><span class=\"o\">,</span> <span class=\"nt\">fPose</span><span class=\"o\">);</span>\n      <span class=\"nt\">if</span> <span class=\"o\">(</span><span class=\"nt\">frustum</span><span class=\"p\">.</span><span class=\"nc\">Contains</span><span class=\"o\">(</span><span class=\"nt\">bb</span><span class=\"o\">))</span>\n      <span class=\"p\">{</span>\n        <span class=\"n\">std</span><span class=\"p\">:</span><span class=\"o\">:</span><span class=\"n\">cerr</span> <span class=\"o\">&lt;&lt;</span> <span class=\"s2\">&quot;Oops, frustum should have returned false! \\n&quot;</span><span class=\"p\">;</span>\n      <span class=\"p\">}</span>\n</pre></div>\n\n\n<p>Here's a side view of the example at y=0</p>\n<p><img alt=\"frustum_incorrect_collision.png\" src=\"data/bitbucket.org/repo/dg5enz/images/3245666792-frustum_incorrect_collision.png\" /></p>", "type": "rendered"}, "assignee": null, "state": "resolved", "version": null, "edited_on": null, "created_on": "2017-08-29T22:12:06.049439+00:00", "milestone": null, "updated_on": "2018-03-22T18:34:08.899526+00:00", "type": "issue", "id": 78}