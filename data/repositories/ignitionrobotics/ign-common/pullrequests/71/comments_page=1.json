{"pagelen": 100, "values": [{"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-common/pullrequests/71/comments/46425420.json"}, "html": {"href": "#!/ignitionrobotics/ign-common/pull-requests/71/_/diff#comment-46425420"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 71, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-common/pullrequests/71.json"}, "html": {"href": "#!/ignitionrobotics/ign-common/pull-requests/71"}}, "title": "PluginPtrSemantics minus CRTP and SFINAE"}, "content": {"raw": "Naturally I have some concerns about removing the ~~SFINAE~~ (edit: We're actually using template specialization here, not SFINAE). From the perspective of the physics design, nearly every function that we call from a plugin is going to be masked by a call to `Interface<T>()`. A map lookup might not sound like much, but imagine replacing the cost of every function call in the physics pipeline with the cost of a map lookup. Of course we could dodge that by retrieving all the relevant interfaces from the plugin once when the plugin is loaded and then manually managing all of those interface pointers, but that would expose us to multiple-source-of-truth issues and it would be very bug prone, not to mention a major increase in maintenance effort. The plugin specialization framework effectively automates all of that interface management for us so that we get both clean semantics (single-source-of-truth) and high performance (no map lookups when they aren't necessary).\n\nThe `PluginPtr` can be replaced with `std::shared_ptr` if we take out the plugin specialization, but if we were to keep plugin specialization, we would need to keep the `PluginPtr` as well. (Believe me, I'd much prefer `std::shared_ptr` over our own custom smart pointer, but `std::shared_ptr` wouldn't jive with plugin specializations.)\n\n", "markup": "markdown", "html": "<p>Naturally I have some concerns about removing the <del>SFINAE</del> (edit: We're actually using template specialization here, not SFINAE). From the perspective of the physics design, nearly every function that we call from a plugin is going to be masked by a call to <code>Interface&lt;T&gt;()</code>. A map lookup might not sound like much, but imagine replacing the cost of every function call in the physics pipeline with the cost of a map lookup. Of course we could dodge that by retrieving all the relevant interfaces from the plugin once when the plugin is loaded and then manually managing all of those interface pointers, but that would expose us to multiple-source-of-truth issues and it would be very bug prone, not to mention a major increase in maintenance effort. The plugin specialization framework effectively automates all of that interface management for us so that we get both clean semantics (single-source-of-truth) and high performance (no map lookups when they aren't necessary).</p>\n<p>The <code>PluginPtr</code> can be replaced with <code>std::shared_ptr</code> if we take out the plugin specialization, but if we were to keep plugin specialization, we would need to keep the <code>PluginPtr</code> as well. (Believe me, I'd much prefer <code>std::shared_ptr</code> over our own custom smart pointer, but <code>std::shared_ptr</code> wouldn't jive with plugin specializations.)</p>", "type": "rendered"}, "created_on": "2017-10-04T17:08:06.097740+00:00", "user": {"display_name": "Michael Grey", "uuid": "{c1cdfe52-2887-474c-ae99-72fdc53a59c9}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Bc1cdfe52-2887-474c-ae99-72fdc53a59c9%7D"}, "html": {"href": "https://bitbucket.org/%7Bc1cdfe52-2887-474c-ae99-72fdc53a59c9%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:67759e29-d1df-465f-868d-047738e36fc9/d42d74cf-c1bd-4431-8288-07f543bbe325/128"}}, "nickname": "mxgrey", "type": "user", "account_id": "557058:67759e29-d1df-465f-868d-047738e36fc9"}, "updated_on": "2017-10-04T17:28:41.209187+00:00", "type": "pullrequest_comment", "id": 46425420}, {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-common/pullrequests/71/comments/46425611.json"}, "html": {"href": "#!/ignitionrobotics/ign-common/pull-requests/71/_/diff#comment-46425611"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 71, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-common/pullrequests/71.json"}, "html": {"href": "#!/ignitionrobotics/ign-common/pull-requests/71"}}, "title": "PluginPtrSemantics minus CRTP and SFINAE"}, "content": {"raw": "That said, if we want to use this as a first step in the review process to make reviewing easier, I'd certainly be on board with that.", "markup": "markdown", "html": "<p>That said, if we want to use this as a first step in the review process to make reviewing easier, I'd certainly be on board with that.</p>", "type": "rendered"}, "created_on": "2017-10-04T17:10:42.485714+00:00", "user": {"display_name": "Michael Grey", "uuid": "{c1cdfe52-2887-474c-ae99-72fdc53a59c9}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Bc1cdfe52-2887-474c-ae99-72fdc53a59c9%7D"}, "html": {"href": "https://bitbucket.org/%7Bc1cdfe52-2887-474c-ae99-72fdc53a59c9%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:67759e29-d1df-465f-868d-047738e36fc9/d42d74cf-c1bd-4431-8288-07f543bbe325/128"}}, "nickname": "mxgrey", "type": "user", "account_id": "557058:67759e29-d1df-465f-868d-047738e36fc9"}, "updated_on": "2017-10-04T17:10:42.488614+00:00", "type": "pullrequest_comment", "id": 46425611}, {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-common/pullrequests/71/comments/46539895.json"}, "html": {"href": "#!/ignitionrobotics/ign-common/pull-requests/71/_/diff#comment-46539895"}}, "parent": {"id": 46425611, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-common/pullrequests/71/comments/46425611.json"}, "html": {"href": "#!/ignitionrobotics/ign-common/pull-requests/71/_/diff#comment-46425611"}}, "depth": 1}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 71, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-common/pullrequests/71.json"}, "html": {"href": "#!/ignitionrobotics/ign-common/pull-requests/71"}}, "title": "PluginPtrSemantics minus CRTP and SFINAE"}, "content": {"raw": "That's the intent. Bitbucket notifications seem to be totally broken right now, so you may not have seen this comment #!/ignitionrobotics/ign-common/pull-requests/59/expanding-the-functionality-of-the-plugin/diff#comment-46421867\n\nedit: And you probably won't be notified of this comment either :(", "markup": "markdown", "html": "<p>That's the intent. Bitbucket notifications seem to be totally broken right now, so you may not have seen this comment <a href=\"#!/ignitionrobotics/ign-common/pull-requests/59/expanding-the-functionality-of-the-plugin/diff#comment-46421867\" rel=\"nofollow\" class=\"ap-connect-link\">#!/ignitionrobotics/ign-common/pull-requests/59/expanding-the-functionality-of-the-plugin/diff#comment-46421867</a></p>\n<p>edit: And you probably won't be notified of this comment either :(</p>", "type": "rendered"}, "created_on": "2017-10-05T20:09:17.107232+00:00", "user": {"display_name": "Shane Loretz", "uuid": "{656e3311-aad9-45a1-aaf7-b0ee0e84b287}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B656e3311-aad9-45a1-aaf7-b0ee0e84b287%7D"}, "html": {"href": "https://bitbucket.org/%7B656e3311-aad9-45a1-aaf7-b0ee0e84b287%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:684383ab-ac95-4859-a350-4a6f41a94a22/c7a1ebf5-cade-4115-9f26-9d3facb776db/128"}}, "nickname": "Shane Loretz", "type": "user", "account_id": "557058:684383ab-ac95-4859-a350-4a6f41a94a22"}, "updated_on": "2017-10-05T20:09:39.471419+00:00", "type": "pullrequest_comment", "id": 46539895}, {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-common/pullrequests/71/comments/46540408.json"}, "html": {"href": "#!/ignitionrobotics/ign-common/pull-requests/71/_/diff#comment-46540408"}}, "parent": {"id": 46539895, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-common/pullrequests/71/comments/46539895.json"}, "html": {"href": "#!/ignitionrobotics/ign-common/pull-requests/71/_/diff#comment-46539895"}}, "depth": 2}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 71, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-common/pullrequests/71.json"}, "html": {"href": "#!/ignitionrobotics/ign-common/pull-requests/71"}}, "title": "PluginPtrSemantics minus CRTP and SFINAE"}, "content": {"raw": "Hah, I did get a notification on this comment, but not the one from yesterday.", "markup": "markdown", "html": "<p>Hah, I did get a notification on this comment, but not the one from yesterday.</p>", "type": "rendered"}, "created_on": "2017-10-05T20:16:38.708869+00:00", "user": {"display_name": "Michael Grey", "uuid": "{c1cdfe52-2887-474c-ae99-72fdc53a59c9}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Bc1cdfe52-2887-474c-ae99-72fdc53a59c9%7D"}, "html": {"href": "https://bitbucket.org/%7Bc1cdfe52-2887-474c-ae99-72fdc53a59c9%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:67759e29-d1df-465f-868d-047738e36fc9/d42d74cf-c1bd-4431-8288-07f543bbe325/128"}}, "nickname": "mxgrey", "type": "user", "account_id": "557058:67759e29-d1df-465f-868d-047738e36fc9"}, "updated_on": "2017-10-05T20:16:38.712014+00:00", "type": "pullrequest_comment", "id": 46540408}, {"links": {"self": {"href": "data/repositories/ignitionrobotics/ign-common/pullrequests/71/comments/46630846.json"}, "html": {"href": "#!/ignitionrobotics/ign-common/pull-requests/71/_/diff#comment-46630846"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 71, "links": {"self": {"href": "data/repositories/ignitionrobotics/ign-common/pullrequests/71.json"}, "html": {"href": "#!/ignitionrobotics/ign-common/pull-requests/71"}}, "title": "PluginPtrSemantics minus CRTP and SFINAE"}, "content": {"raw": "Since I've opened up pull request #73, I'm going to go ahead and decline this PR. The main issue with this PR is it would add a huge amount of removals (and then later re-additions) to the version history, which I think would be kind of wasteful and may cause confusion to anyone who looks back over it. Pull request #73 should be able to preserve the version history as it originally emerged. Thanks for the suggestion of breaking down the PR, though! Hopefully the review will be at least a little more manageable.\n\nA few things that pull request #73 does not address:\n\n1. It contains some vestigial functions which are not necessarily needed in the absence of the `PluginPtr` class. Those functions aren't hurting anything and will be needed later, so I'm leaving them in for now. If you feel that they are harmful to the review process, I can remove them in pull request #73 and then add them back in pull request #59.  The only reason I'm not doing that yet is because it would cause some redundant removals and reversions in the version history.\n\n2. I haven't made any of the style changes (yet) because I think we deal with style after we're satisfied with the implementation. If you feel that the current style is blocking the review process, I can certainly revise that right away, but I'd rather keep further changes to the branch stable and minor as people try to grok the implementation. Again, if you feel that changing the style would help with the grokking, then I'm totally on board with doing that.", "markup": "markdown", "html": "<p>Since I've opened up <a href=\"#!/ignitionrobotics/ign-common/pull-requests/73/slimmed-down-the-plugin-pull-request-no\" rel=\"nofollow\" class=\"ap-connect-link\">pull request #73</a>, I'm going to go ahead and decline this PR. The main issue with this PR is it would add a huge amount of removals (and then later re-additions) to the version history, which I think would be kind of wasteful and may cause confusion to anyone who looks back over it. <a href=\"#!/ignitionrobotics/ign-common/pull-requests/73/slimmed-down-the-plugin-pull-request-no\" rel=\"nofollow\" class=\"ap-connect-link\">Pull request #73</a> should be able to preserve the version history as it originally emerged. Thanks for the suggestion of breaking down the PR, though! Hopefully the review will be at least a little more manageable.</p>\n<p>A few things that <a href=\"#!/ignitionrobotics/ign-common/pull-requests/73/slimmed-down-the-plugin-pull-request-no\" rel=\"nofollow\" class=\"ap-connect-link\">pull request #73</a> does not address:</p>\n<ol>\n<li>\n<p>It contains some vestigial functions which are not necessarily needed in the absence of the <code>PluginPtr</code> class. Those functions aren't hurting anything and will be needed later, so I'm leaving them in for now. If you feel that they are harmful to the review process, I can remove them in <a href=\"#!/ignitionrobotics/ign-common/pull-requests/73/slimmed-down-the-plugin-pull-request-no\" rel=\"nofollow\" class=\"ap-connect-link\">pull request #73</a> and then add them back in <a href=\"#!/ignitionrobotics/ign-common/pull-requests/59/expanding-the-functionality-of-the-plugin\" rel=\"nofollow\" class=\"ap-connect-link\">pull request #59</a>.  The only reason I'm not doing that yet is because it would cause some redundant removals and reversions in the version history.</p>\n</li>\n<li>\n<p>I haven't made any of the style changes (yet) because I think we deal with style after we're satisfied with the implementation. If you feel that the current style is blocking the review process, I can certainly revise that right away, but I'd rather keep further changes to the branch stable and minor as people try to grok the implementation. Again, if you feel that changing the style would help with the grokking, then I'm totally on board with doing that.</p>\n</li>\n</ol>", "type": "rendered"}, "created_on": "2017-10-06T19:03:45.888812+00:00", "user": {"display_name": "Michael Grey", "uuid": "{c1cdfe52-2887-474c-ae99-72fdc53a59c9}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Bc1cdfe52-2887-474c-ae99-72fdc53a59c9%7D"}, "html": {"href": "https://bitbucket.org/%7Bc1cdfe52-2887-474c-ae99-72fdc53a59c9%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:67759e29-d1df-465f-868d-047738e36fc9/d42d74cf-c1bd-4431-8288-07f543bbe325/128"}}, "nickname": "mxgrey", "type": "user", "account_id": "557058:67759e29-d1df-465f-868d-047738e36fc9"}, "updated_on": "2017-10-06T19:27:03.627246+00:00", "type": "pullrequest_comment", "id": 46630846}], "page": 1, "size": 5}